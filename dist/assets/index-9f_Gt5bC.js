var r2=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports);var h3=r2((v3,Yb)=>{function Ay(e,t){for(var n=0;n<t.length;n++){const r=t[n];if(typeof r!="string"&&!Array.isArray(r)){for(const o in r)if(o!=="default"&&!(o in e)){const i=Object.getOwnPropertyDescriptor(r,o);i&&Object.defineProperty(e,o,i.get?i:{enumerable:!0,get:()=>r[o]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))r(o);new MutationObserver(o=>{for(const i of o)if(i.type==="childList")for(const a of i.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&r(a)}).observe(document,{childList:!0,subtree:!0});function n(o){const i={};return o.integrity&&(i.integrity=o.integrity),o.referrerPolicy&&(i.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?i.credentials="include":o.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(o){if(o.ep)return;o.ep=!0;const i=n(o);fetch(o.href,i)}})();var o2=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function _h(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var Py={exports:{}},nc={},Fy={exports:{}},Me={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Bs=Symbol.for("react.element"),i2=Symbol.for("react.portal"),a2=Symbol.for("react.fragment"),s2=Symbol.for("react.strict_mode"),u2=Symbol.for("react.profiler"),l2=Symbol.for("react.provider"),c2=Symbol.for("react.context"),f2=Symbol.for("react.forward_ref"),d2=Symbol.for("react.suspense"),h2=Symbol.for("react.memo"),p2=Symbol.for("react.lazy"),Wv=Symbol.iterator;function v2(e){return e===null||typeof e!="object"?null:(e=Wv&&e[Wv]||e["@@iterator"],typeof e=="function"?e:null)}var My={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Oy=Object.assign,Ly={};function Ea(e,t,n){this.props=e,this.context=t,this.refs=Ly,this.updater=n||My}Ea.prototype.isReactComponent={};Ea.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};Ea.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function By(){}By.prototype=Ea.prototype;function Sh(e,t,n){this.props=e,this.context=t,this.refs=Ly,this.updater=n||My}var Rh=Sh.prototype=new By;Rh.constructor=Sh;Oy(Rh,Ea.prototype);Rh.isPureReactComponent=!0;var zv=Array.isArray,Uy=Object.prototype.hasOwnProperty,kh={current:null},Wy={key:!0,ref:!0,__self:!0,__source:!0};function zy(e,t,n){var r,o={},i=null,a=null;if(t!=null)for(r in t.ref!==void 0&&(a=t.ref),t.key!==void 0&&(i=""+t.key),t)Uy.call(t,r)&&!Wy.hasOwnProperty(r)&&(o[r]=t[r]);var s=arguments.length-2;if(s===1)o.children=n;else if(1<s){for(var u=Array(s),l=0;l<s;l++)u[l]=arguments[l+2];o.children=u}if(e&&e.defaultProps)for(r in s=e.defaultProps,s)o[r]===void 0&&(o[r]=s[r]);return{$$typeof:Bs,type:e,key:i,ref:a,props:o,_owner:kh.current}}function m2(e,t){return{$$typeof:Bs,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function Ih(e){return typeof e=="object"&&e!==null&&e.$$typeof===Bs}function g2(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(n){return t[n]})}var jv=/\/+/g;function Gc(e,t){return typeof e=="object"&&e!==null&&e.key!=null?g2(""+e.key):t.toString(36)}function zu(e,t,n,r,o){var i=typeof e;(i==="undefined"||i==="boolean")&&(e=null);var a=!1;if(e===null)a=!0;else switch(i){case"string":case"number":a=!0;break;case"object":switch(e.$$typeof){case Bs:case i2:a=!0}}if(a)return a=e,o=o(a),e=r===""?"."+Gc(a,0):r,zv(o)?(n="",e!=null&&(n=e.replace(jv,"$&/")+"/"),zu(o,t,n,"",function(l){return l})):o!=null&&(Ih(o)&&(o=m2(o,n+(!o.key||a&&a.key===o.key?"":(""+o.key).replace(jv,"$&/")+"/")+e)),t.push(o)),1;if(a=0,r=r===""?".":r+":",zv(e))for(var s=0;s<e.length;s++){i=e[s];var u=r+Gc(i,s);a+=zu(i,t,n,u,o)}else if(u=v2(e),typeof u=="function")for(e=u.call(e),s=0;!(i=e.next()).done;)i=i.value,u=r+Gc(i,s++),a+=zu(i,t,n,u,o);else if(i==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return a}function cu(e,t,n){if(e==null)return e;var r=[],o=0;return zu(e,r,"","",function(i){return t.call(n,i,o++)}),r}function y2(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(n){(e._status===0||e._status===-1)&&(e._status=1,e._result=n)},function(n){(e._status===0||e._status===-1)&&(e._status=2,e._result=n)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var on={current:null},ju={transition:null},x2={ReactCurrentDispatcher:on,ReactCurrentBatchConfig:ju,ReactCurrentOwner:kh};function jy(){throw Error("act(...) is not supported in production builds of React.")}Me.Children={map:cu,forEach:function(e,t,n){cu(e,function(){t.apply(this,arguments)},n)},count:function(e){var t=0;return cu(e,function(){t++}),t},toArray:function(e){return cu(e,function(t){return t})||[]},only:function(e){if(!Ih(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};Me.Component=Ea;Me.Fragment=a2;Me.Profiler=u2;Me.PureComponent=Sh;Me.StrictMode=s2;Me.Suspense=d2;Me.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=x2;Me.act=jy;Me.cloneElement=function(e,t,n){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var r=Oy({},e.props),o=e.key,i=e.ref,a=e._owner;if(t!=null){if(t.ref!==void 0&&(i=t.ref,a=kh.current),t.key!==void 0&&(o=""+t.key),e.type&&e.type.defaultProps)var s=e.type.defaultProps;for(u in t)Uy.call(t,u)&&!Wy.hasOwnProperty(u)&&(r[u]=t[u]===void 0&&s!==void 0?s[u]:t[u])}var u=arguments.length-2;if(u===1)r.children=n;else if(1<u){s=Array(u);for(var l=0;l<u;l++)s[l]=arguments[l+2];r.children=s}return{$$typeof:Bs,type:e.type,key:o,ref:i,props:r,_owner:a}};Me.createContext=function(e){return e={$$typeof:c2,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:l2,_context:e},e.Consumer=e};Me.createElement=zy;Me.createFactory=function(e){var t=zy.bind(null,e);return t.type=e,t};Me.createRef=function(){return{current:null}};Me.forwardRef=function(e){return{$$typeof:f2,render:e}};Me.isValidElement=Ih;Me.lazy=function(e){return{$$typeof:p2,_payload:{_status:-1,_result:e},_init:y2}};Me.memo=function(e,t){return{$$typeof:h2,type:e,compare:t===void 0?null:t}};Me.startTransition=function(e){var t=ju.transition;ju.transition={};try{e()}finally{ju.transition=t}};Me.unstable_act=jy;Me.useCallback=function(e,t){return on.current.useCallback(e,t)};Me.useContext=function(e){return on.current.useContext(e)};Me.useDebugValue=function(){};Me.useDeferredValue=function(e){return on.current.useDeferredValue(e)};Me.useEffect=function(e,t){return on.current.useEffect(e,t)};Me.useId=function(){return on.current.useId()};Me.useImperativeHandle=function(e,t,n){return on.current.useImperativeHandle(e,t,n)};Me.useInsertionEffect=function(e,t){return on.current.useInsertionEffect(e,t)};Me.useLayoutEffect=function(e,t){return on.current.useLayoutEffect(e,t)};Me.useMemo=function(e,t){return on.current.useMemo(e,t)};Me.useReducer=function(e,t,n){return on.current.useReducer(e,t,n)};Me.useRef=function(e){return on.current.useRef(e)};Me.useState=function(e){return on.current.useState(e)};Me.useSyncExternalStore=function(e,t,n){return on.current.useSyncExternalStore(e,t,n)};Me.useTransition=function(){return on.current.useTransition()};Me.version="18.3.1";Fy.exports=Me;var X=Fy.exports;const Vy=_h(X),w2=Ay({__proto__:null,default:Vy},[X]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var b2=X,E2=Symbol.for("react.element"),C2=Symbol.for("react.fragment"),_2=Object.prototype.hasOwnProperty,S2=b2.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,R2={key:!0,ref:!0,__self:!0,__source:!0};function $y(e,t,n){var r,o={},i=null,a=null;n!==void 0&&(i=""+n),t.key!==void 0&&(i=""+t.key),t.ref!==void 0&&(a=t.ref);for(r in t)_2.call(t,r)&&!R2.hasOwnProperty(r)&&(o[r]=t[r]);if(e&&e.defaultProps)for(r in t=e.defaultProps,t)o[r]===void 0&&(o[r]=t[r]);return{$$typeof:E2,type:e,key:i,ref:a,props:o,_owner:S2.current}}nc.Fragment=C2;nc.jsx=$y;nc.jsxs=$y;Py.exports=nc;var Z=Py.exports,Zf={},Hy={exports:{}},Nn={},Gy={exports:{}},qy={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(F,L){var U=F.length;F.push(L);e:for(;0<U;){var Q=U-1>>>1,ee=F[Q];if(0<o(ee,L))F[Q]=L,F[U]=ee,U=Q;else break e}}function n(F){return F.length===0?null:F[0]}function r(F){if(F.length===0)return null;var L=F[0],U=F.pop();if(U!==L){F[0]=U;e:for(var Q=0,ee=F.length,ae=ee>>>1;Q<ae;){var he=2*(Q+1)-1,ye=F[he],ve=he+1,Se=F[ve];if(0>o(ye,U))ve<ee&&0>o(Se,ye)?(F[Q]=Se,F[ve]=U,Q=ve):(F[Q]=ye,F[he]=U,Q=he);else if(ve<ee&&0>o(Se,U))F[Q]=Se,F[ve]=U,Q=ve;else break e}}return L}function o(F,L){var U=F.sortIndex-L.sortIndex;return U!==0?U:F.id-L.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;e.unstable_now=function(){return i.now()}}else{var a=Date,s=a.now();e.unstable_now=function(){return a.now()-s}}var u=[],l=[],c=1,f=null,d=3,h=!1,p=!1,v=!1,g=typeof setTimeout=="function"?setTimeout:null,m=typeof clearTimeout=="function"?clearTimeout:null,y=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function x(F){for(var L=n(l);L!==null;){if(L.callback===null)r(l);else if(L.startTime<=F)r(l),L.sortIndex=L.expirationTime,t(u,L);else break;L=n(l)}}function w(F){if(v=!1,x(F),!p)if(n(u)!==null)p=!0,q(E);else{var L=n(l);L!==null&&V(w,L.startTime-F)}}function E(F,L){p=!1,v&&(v=!1,m(_),_=-1),h=!0;var U=d;try{for(x(L),f=n(u);f!==null&&(!(f.expirationTime>L)||F&&!D());){var Q=f.callback;if(typeof Q=="function"){f.callback=null,d=f.priorityLevel;var ee=Q(f.expirationTime<=L);L=e.unstable_now(),typeof ee=="function"?f.callback=ee:f===n(u)&&r(u),x(L)}else r(u);f=n(u)}if(f!==null)var ae=!0;else{var he=n(l);he!==null&&V(w,he.startTime-L),ae=!1}return ae}finally{f=null,d=U,h=!1}}var b=!1,C=null,_=-1,S=5,R=-1;function D(){return!(e.unstable_now()-R<S)}function T(){if(C!==null){var F=e.unstable_now();R=F;var L=!0;try{L=C(!0,F)}finally{L?z():(b=!1,C=null)}}else b=!1}var z;if(typeof y=="function")z=function(){y(T)};else if(typeof MessageChannel<"u"){var O=new MessageChannel,$=O.port2;O.port1.onmessage=T,z=function(){$.postMessage(null)}}else z=function(){g(T,0)};function q(F){C=F,b||(b=!0,z())}function V(F,L){_=g(function(){F(e.unstable_now())},L)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(F){F.callback=null},e.unstable_continueExecution=function(){p||h||(p=!0,q(E))},e.unstable_forceFrameRate=function(F){0>F||125<F?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):S=0<F?Math.floor(1e3/F):5},e.unstable_getCurrentPriorityLevel=function(){return d},e.unstable_getFirstCallbackNode=function(){return n(u)},e.unstable_next=function(F){switch(d){case 1:case 2:case 3:var L=3;break;default:L=d}var U=d;d=L;try{return F()}finally{d=U}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(F,L){switch(F){case 1:case 2:case 3:case 4:case 5:break;default:F=3}var U=d;d=F;try{return L()}finally{d=U}},e.unstable_scheduleCallback=function(F,L,U){var Q=e.unstable_now();switch(typeof U=="object"&&U!==null?(U=U.delay,U=typeof U=="number"&&0<U?Q+U:Q):U=Q,F){case 1:var ee=-1;break;case 2:ee=250;break;case 5:ee=1073741823;break;case 4:ee=1e4;break;default:ee=5e3}return ee=U+ee,F={id:c++,callback:L,priorityLevel:F,startTime:U,expirationTime:ee,sortIndex:-1},U>Q?(F.sortIndex=U,t(l,F),n(u)===null&&F===n(l)&&(v?(m(_),_=-1):v=!0,V(w,U-Q))):(F.sortIndex=ee,t(u,F),p||h||(p=!0,q(E))),F},e.unstable_shouldYield=D,e.unstable_wrapCallback=function(F){var L=d;return function(){var U=d;d=L;try{return F.apply(this,arguments)}finally{d=U}}}})(qy);Gy.exports=qy;var k2=Gy.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var I2=X,Tn=k2;function J(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var Ky=new Set,cs={};function fi(e,t){ca(e,t),ca(e+"Capture",t)}function ca(e,t){for(cs[e]=t,e=0;e<t.length;e++)Ky.add(t[e])}var Vr=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),ed=Object.prototype.hasOwnProperty,D2=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Vv={},$v={};function T2(e){return ed.call($v,e)?!0:ed.call(Vv,e)?!1:D2.test(e)?$v[e]=!0:(Vv[e]=!0,!1)}function N2(e,t,n,r){if(n!==null&&n.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function A2(e,t,n,r){if(t===null||typeof t>"u"||N2(e,t,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function an(e,t,n,r,o,i,a){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=r,this.attributeNamespace=o,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=i,this.removeEmptyString=a}var jt={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){jt[e]=new an(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];jt[t]=new an(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){jt[e]=new an(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){jt[e]=new an(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){jt[e]=new an(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){jt[e]=new an(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){jt[e]=new an(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){jt[e]=new an(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){jt[e]=new an(e,5,!1,e.toLowerCase(),null,!1,!1)});var Dh=/[\-:]([a-z])/g;function Th(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(Dh,Th);jt[t]=new an(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(Dh,Th);jt[t]=new an(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(Dh,Th);jt[t]=new an(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){jt[e]=new an(e,1,!1,e.toLowerCase(),null,!1,!1)});jt.xlinkHref=new an("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){jt[e]=new an(e,1,!1,e.toLowerCase(),null,!0,!0)});function Nh(e,t,n,r){var o=jt.hasOwnProperty(t)?jt[t]:null;(o!==null?o.type!==0:r||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(A2(t,n,o,r)&&(n=null),r||o===null?T2(t)&&(n===null?e.removeAttribute(t):e.setAttribute(t,""+n)):o.mustUseProperty?e[o.propertyName]=n===null?o.type===3?!1:"":n:(t=o.attributeName,r=o.attributeNamespace,n===null?e.removeAttribute(t):(o=o.type,n=o===3||o===4&&n===!0?"":""+n,r?e.setAttributeNS(r,t,n):e.setAttribute(t,n))))}var qr=I2.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,fu=Symbol.for("react.element"),Li=Symbol.for("react.portal"),Bi=Symbol.for("react.fragment"),Ah=Symbol.for("react.strict_mode"),td=Symbol.for("react.profiler"),Xy=Symbol.for("react.provider"),Yy=Symbol.for("react.context"),Ph=Symbol.for("react.forward_ref"),nd=Symbol.for("react.suspense"),rd=Symbol.for("react.suspense_list"),Fh=Symbol.for("react.memo"),so=Symbol.for("react.lazy"),Qy=Symbol.for("react.offscreen"),Hv=Symbol.iterator;function Na(e){return e===null||typeof e!="object"?null:(e=Hv&&e[Hv]||e["@@iterator"],typeof e=="function"?e:null)}var ct=Object.assign,qc;function qa(e){if(qc===void 0)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);qc=t&&t[1]||""}return`
`+qc+e}var Kc=!1;function Xc(e,t){if(!e||Kc)return"";Kc=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(l){var r=l}Reflect.construct(e,[],t)}else{try{t.call()}catch(l){r=l}e.call(t.prototype)}else{try{throw Error()}catch(l){r=l}e()}}catch(l){if(l&&r&&typeof l.stack=="string"){for(var o=l.stack.split(`
`),i=r.stack.split(`
`),a=o.length-1,s=i.length-1;1<=a&&0<=s&&o[a]!==i[s];)s--;for(;1<=a&&0<=s;a--,s--)if(o[a]!==i[s]){if(a!==1||s!==1)do if(a--,s--,0>s||o[a]!==i[s]){var u=`
`+o[a].replace(" at new "," at ");return e.displayName&&u.includes("<anonymous>")&&(u=u.replace("<anonymous>",e.displayName)),u}while(1<=a&&0<=s);break}}}finally{Kc=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?qa(e):""}function P2(e){switch(e.tag){case 5:return qa(e.type);case 16:return qa("Lazy");case 13:return qa("Suspense");case 19:return qa("SuspenseList");case 0:case 2:case 15:return e=Xc(e.type,!1),e;case 11:return e=Xc(e.type.render,!1),e;case 1:return e=Xc(e.type,!0),e;default:return""}}function od(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case Bi:return"Fragment";case Li:return"Portal";case td:return"Profiler";case Ah:return"StrictMode";case nd:return"Suspense";case rd:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case Yy:return(e.displayName||"Context")+".Consumer";case Xy:return(e._context.displayName||"Context")+".Provider";case Ph:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case Fh:return t=e.displayName||null,t!==null?t:od(e.type)||"Memo";case so:t=e._payload,e=e._init;try{return od(e(t))}catch{}}return null}function F2(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return od(t);case 8:return t===Ah?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function ko(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function Jy(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function M2(e){var t=Jy(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),r=""+e[t];if(!e.hasOwnProperty(t)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var o=n.get,i=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return o.call(this)},set:function(a){r=""+a,i.call(this,a)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(a){r=""+a},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function du(e){e._valueTracker||(e._valueTracker=M2(e))}function Zy(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),r="";return e&&(r=Jy(e)?e.checked?"true":"false":e.value),e=r,e!==n?(t.setValue(e),!0):!1}function rl(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function id(e,t){var n=t.checked;return ct({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??e._wrapperState.initialChecked})}function Gv(e,t){var n=t.defaultValue==null?"":t.defaultValue,r=t.checked!=null?t.checked:t.defaultChecked;n=ko(t.value!=null?t.value:n),e._wrapperState={initialChecked:r,initialValue:n,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function e0(e,t){t=t.checked,t!=null&&Nh(e,"checked",t,!1)}function ad(e,t){e0(e,t);var n=ko(t.value),r=t.type;if(n!=null)r==="number"?(n===0&&e.value===""||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if(r==="submit"||r==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?sd(e,t.type,n):t.hasOwnProperty("defaultValue")&&sd(e,t.type,ko(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function qv(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var r=t.type;if(!(r!=="submit"&&r!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}n=e.name,n!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,n!==""&&(e.name=n)}function sd(e,t,n){(t!=="number"||rl(e.ownerDocument)!==e)&&(n==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var Ka=Array.isArray;function Yi(e,t,n,r){if(e=e.options,t){t={};for(var o=0;o<n.length;o++)t["$"+n[o]]=!0;for(n=0;n<e.length;n++)o=t.hasOwnProperty("$"+e[n].value),e[n].selected!==o&&(e[n].selected=o),o&&r&&(e[n].defaultSelected=!0)}else{for(n=""+ko(n),t=null,o=0;o<e.length;o++){if(e[o].value===n){e[o].selected=!0,r&&(e[o].defaultSelected=!0);return}t!==null||e[o].disabled||(t=e[o])}t!==null&&(t.selected=!0)}}function ud(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(J(91));return ct({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function Kv(e,t){var n=t.value;if(n==null){if(n=t.children,t=t.defaultValue,n!=null){if(t!=null)throw Error(J(92));if(Ka(n)){if(1<n.length)throw Error(J(93));n=n[0]}t=n}t==null&&(t=""),n=t}e._wrapperState={initialValue:ko(n)}}function t0(e,t){var n=ko(t.value),r=ko(t.defaultValue);n!=null&&(n=""+n,n!==e.value&&(e.value=n),t.defaultValue==null&&e.defaultValue!==n&&(e.defaultValue=n)),r!=null&&(e.defaultValue=""+r)}function Xv(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function n0(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function ld(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?n0(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var hu,r0=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,n,r,o){MSApp.execUnsafeLocalFunction(function(){return e(t,n,r,o)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(hu=hu||document.createElement("div"),hu.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=hu.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function fs(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&n.nodeType===3){n.nodeValue=t;return}}e.textContent=t}var Ja={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},O2=["Webkit","ms","Moz","O"];Object.keys(Ja).forEach(function(e){O2.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),Ja[t]=Ja[e]})});function o0(e,t,n){return t==null||typeof t=="boolean"||t===""?"":n||typeof t!="number"||t===0||Ja.hasOwnProperty(e)&&Ja[e]?(""+t).trim():t+"px"}function i0(e,t){e=e.style;for(var n in t)if(t.hasOwnProperty(n)){var r=n.indexOf("--")===0,o=o0(n,t[n],r);n==="float"&&(n="cssFloat"),r?e.setProperty(n,o):e[n]=o}}var L2=ct({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function cd(e,t){if(t){if(L2[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(J(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(J(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(J(61))}if(t.style!=null&&typeof t.style!="object")throw Error(J(62))}}function fd(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var dd=null;function Mh(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var hd=null,Qi=null,Ji=null;function Yv(e){if(e=zs(e)){if(typeof hd!="function")throw Error(J(280));var t=e.stateNode;t&&(t=sc(t),hd(e.stateNode,e.type,t))}}function a0(e){Qi?Ji?Ji.push(e):Ji=[e]:Qi=e}function s0(){if(Qi){var e=Qi,t=Ji;if(Ji=Qi=null,Yv(e),t)for(e=0;e<t.length;e++)Yv(t[e])}}function u0(e,t){return e(t)}function l0(){}var Yc=!1;function c0(e,t,n){if(Yc)return e(t,n);Yc=!0;try{return u0(e,t,n)}finally{Yc=!1,(Qi!==null||Ji!==null)&&(l0(),s0())}}function ds(e,t){var n=e.stateNode;if(n===null)return null;var r=sc(n);if(r===null)return null;n=r[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(e=e.type,r=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!r;break e;default:e=!1}if(e)return null;if(n&&typeof n!="function")throw Error(J(231,t,typeof n));return n}var pd=!1;if(Vr)try{var Aa={};Object.defineProperty(Aa,"passive",{get:function(){pd=!0}}),window.addEventListener("test",Aa,Aa),window.removeEventListener("test",Aa,Aa)}catch{pd=!1}function B2(e,t,n,r,o,i,a,s,u){var l=Array.prototype.slice.call(arguments,3);try{t.apply(n,l)}catch(c){this.onError(c)}}var Za=!1,ol=null,il=!1,vd=null,U2={onError:function(e){Za=!0,ol=e}};function W2(e,t,n,r,o,i,a,s,u){Za=!1,ol=null,B2.apply(U2,arguments)}function z2(e,t,n,r,o,i,a,s,u){if(W2.apply(this,arguments),Za){if(Za){var l=ol;Za=!1,ol=null}else throw Error(J(198));il||(il=!0,vd=l)}}function di(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(n=t.return),e=t.return;while(e)}return t.tag===3?n:null}function f0(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function Qv(e){if(di(e)!==e)throw Error(J(188))}function j2(e){var t=e.alternate;if(!t){if(t=di(e),t===null)throw Error(J(188));return t!==e?null:e}for(var n=e,r=t;;){var o=n.return;if(o===null)break;var i=o.alternate;if(i===null){if(r=o.return,r!==null){n=r;continue}break}if(o.child===i.child){for(i=o.child;i;){if(i===n)return Qv(o),e;if(i===r)return Qv(o),t;i=i.sibling}throw Error(J(188))}if(n.return!==r.return)n=o,r=i;else{for(var a=!1,s=o.child;s;){if(s===n){a=!0,n=o,r=i;break}if(s===r){a=!0,r=o,n=i;break}s=s.sibling}if(!a){for(s=i.child;s;){if(s===n){a=!0,n=i,r=o;break}if(s===r){a=!0,r=i,n=o;break}s=s.sibling}if(!a)throw Error(J(189))}}if(n.alternate!==r)throw Error(J(190))}if(n.tag!==3)throw Error(J(188));return n.stateNode.current===n?e:t}function d0(e){return e=j2(e),e!==null?h0(e):null}function h0(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=h0(e);if(t!==null)return t;e=e.sibling}return null}var p0=Tn.unstable_scheduleCallback,Jv=Tn.unstable_cancelCallback,V2=Tn.unstable_shouldYield,$2=Tn.unstable_requestPaint,vt=Tn.unstable_now,H2=Tn.unstable_getCurrentPriorityLevel,Oh=Tn.unstable_ImmediatePriority,v0=Tn.unstable_UserBlockingPriority,al=Tn.unstable_NormalPriority,G2=Tn.unstable_LowPriority,m0=Tn.unstable_IdlePriority,rc=null,Cr=null;function q2(e){if(Cr&&typeof Cr.onCommitFiberRoot=="function")try{Cr.onCommitFiberRoot(rc,e,void 0,(e.current.flags&128)===128)}catch{}}var rr=Math.clz32?Math.clz32:Y2,K2=Math.log,X2=Math.LN2;function Y2(e){return e>>>=0,e===0?32:31-(K2(e)/X2|0)|0}var pu=64,vu=4194304;function Xa(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function sl(e,t){var n=e.pendingLanes;if(n===0)return 0;var r=0,o=e.suspendedLanes,i=e.pingedLanes,a=n&268435455;if(a!==0){var s=a&~o;s!==0?r=Xa(s):(i&=a,i!==0&&(r=Xa(i)))}else a=n&~o,a!==0?r=Xa(a):i!==0&&(r=Xa(i));if(r===0)return 0;if(t!==0&&t!==r&&!(t&o)&&(o=r&-r,i=t&-t,o>=i||o===16&&(i&4194240)!==0))return t;if(r&4&&(r|=n&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=r;0<t;)n=31-rr(t),o=1<<n,r|=e[n],t&=~o;return r}function Q2(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function J2(e,t){for(var n=e.suspendedLanes,r=e.pingedLanes,o=e.expirationTimes,i=e.pendingLanes;0<i;){var a=31-rr(i),s=1<<a,u=o[a];u===-1?(!(s&n)||s&r)&&(o[a]=Q2(s,t)):u<=t&&(e.expiredLanes|=s),i&=~s}}function md(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function g0(){var e=pu;return pu<<=1,!(pu&4194240)&&(pu=64),e}function Qc(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function Us(e,t,n){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-rr(t),e[t]=n}function Z2(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var r=e.eventTimes;for(e=e.expirationTimes;0<n;){var o=31-rr(n),i=1<<o;t[o]=0,r[o]=-1,e[o]=-1,n&=~i}}function Lh(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var r=31-rr(n),o=1<<r;o&t|e[r]&t&&(e[r]|=t),n&=~o}}var $e=0;function y0(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var x0,Bh,w0,b0,E0,gd=!1,mu=[],mo=null,go=null,yo=null,hs=new Map,ps=new Map,lo=[],eE="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Zv(e,t){switch(e){case"focusin":case"focusout":mo=null;break;case"dragenter":case"dragleave":go=null;break;case"mouseover":case"mouseout":yo=null;break;case"pointerover":case"pointerout":hs.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":ps.delete(t.pointerId)}}function Pa(e,t,n,r,o,i){return e===null||e.nativeEvent!==i?(e={blockedOn:t,domEventName:n,eventSystemFlags:r,nativeEvent:i,targetContainers:[o]},t!==null&&(t=zs(t),t!==null&&Bh(t)),e):(e.eventSystemFlags|=r,t=e.targetContainers,o!==null&&t.indexOf(o)===-1&&t.push(o),e)}function tE(e,t,n,r,o){switch(t){case"focusin":return mo=Pa(mo,e,t,n,r,o),!0;case"dragenter":return go=Pa(go,e,t,n,r,o),!0;case"mouseover":return yo=Pa(yo,e,t,n,r,o),!0;case"pointerover":var i=o.pointerId;return hs.set(i,Pa(hs.get(i)||null,e,t,n,r,o)),!0;case"gotpointercapture":return i=o.pointerId,ps.set(i,Pa(ps.get(i)||null,e,t,n,r,o)),!0}return!1}function C0(e){var t=Ho(e.target);if(t!==null){var n=di(t);if(n!==null){if(t=n.tag,t===13){if(t=f0(n),t!==null){e.blockedOn=t,E0(e.priority,function(){w0(n)});return}}else if(t===3&&n.stateNode.current.memoizedState.isDehydrated){e.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}e.blockedOn=null}function Vu(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var n=yd(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(n===null){n=e.nativeEvent;var r=new n.constructor(n.type,n);dd=r,n.target.dispatchEvent(r),dd=null}else return t=zs(n),t!==null&&Bh(t),e.blockedOn=n,!1;t.shift()}return!0}function em(e,t,n){Vu(e)&&n.delete(t)}function nE(){gd=!1,mo!==null&&Vu(mo)&&(mo=null),go!==null&&Vu(go)&&(go=null),yo!==null&&Vu(yo)&&(yo=null),hs.forEach(em),ps.forEach(em)}function Fa(e,t){e.blockedOn===t&&(e.blockedOn=null,gd||(gd=!0,Tn.unstable_scheduleCallback(Tn.unstable_NormalPriority,nE)))}function vs(e){function t(o){return Fa(o,e)}if(0<mu.length){Fa(mu[0],e);for(var n=1;n<mu.length;n++){var r=mu[n];r.blockedOn===e&&(r.blockedOn=null)}}for(mo!==null&&Fa(mo,e),go!==null&&Fa(go,e),yo!==null&&Fa(yo,e),hs.forEach(t),ps.forEach(t),n=0;n<lo.length;n++)r=lo[n],r.blockedOn===e&&(r.blockedOn=null);for(;0<lo.length&&(n=lo[0],n.blockedOn===null);)C0(n),n.blockedOn===null&&lo.shift()}var Zi=qr.ReactCurrentBatchConfig,ul=!0;function rE(e,t,n,r){var o=$e,i=Zi.transition;Zi.transition=null;try{$e=1,Uh(e,t,n,r)}finally{$e=o,Zi.transition=i}}function oE(e,t,n,r){var o=$e,i=Zi.transition;Zi.transition=null;try{$e=4,Uh(e,t,n,r)}finally{$e=o,Zi.transition=i}}function Uh(e,t,n,r){if(ul){var o=yd(e,t,n,r);if(o===null)uf(e,t,r,ll,n),Zv(e,r);else if(tE(o,e,t,n,r))r.stopPropagation();else if(Zv(e,r),t&4&&-1<eE.indexOf(e)){for(;o!==null;){var i=zs(o);if(i!==null&&x0(i),i=yd(e,t,n,r),i===null&&uf(e,t,r,ll,n),i===o)break;o=i}o!==null&&r.stopPropagation()}else uf(e,t,r,null,n)}}var ll=null;function yd(e,t,n,r){if(ll=null,e=Mh(r),e=Ho(e),e!==null)if(t=di(e),t===null)e=null;else if(n=t.tag,n===13){if(e=f0(t),e!==null)return e;e=null}else if(n===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return ll=e,null}function _0(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(H2()){case Oh:return 1;case v0:return 4;case al:case G2:return 16;case m0:return 536870912;default:return 16}default:return 16}}var fo=null,Wh=null,$u=null;function S0(){if($u)return $u;var e,t=Wh,n=t.length,r,o="value"in fo?fo.value:fo.textContent,i=o.length;for(e=0;e<n&&t[e]===o[e];e++);var a=n-e;for(r=1;r<=a&&t[n-r]===o[i-r];r++);return $u=o.slice(e,1<r?1-r:void 0)}function Hu(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function gu(){return!0}function tm(){return!1}function An(e){function t(n,r,o,i,a){this._reactName=n,this._targetInst=o,this.type=r,this.nativeEvent=i,this.target=a,this.currentTarget=null;for(var s in e)e.hasOwnProperty(s)&&(n=e[s],this[s]=n?n(i):i[s]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?gu:tm,this.isPropagationStopped=tm,this}return ct(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=gu)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=gu)},persist:function(){},isPersistent:gu}),t}var Ca={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},zh=An(Ca),Ws=ct({},Ca,{view:0,detail:0}),iE=An(Ws),Jc,Zc,Ma,oc=ct({},Ws,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:jh,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==Ma&&(Ma&&e.type==="mousemove"?(Jc=e.screenX-Ma.screenX,Zc=e.screenY-Ma.screenY):Zc=Jc=0,Ma=e),Jc)},movementY:function(e){return"movementY"in e?e.movementY:Zc}}),nm=An(oc),aE=ct({},oc,{dataTransfer:0}),sE=An(aE),uE=ct({},Ws,{relatedTarget:0}),ef=An(uE),lE=ct({},Ca,{animationName:0,elapsedTime:0,pseudoElement:0}),cE=An(lE),fE=ct({},Ca,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),dE=An(fE),hE=ct({},Ca,{data:0}),rm=An(hE),pE={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},vE={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},mE={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function gE(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=mE[e])?!!t[e]:!1}function jh(){return gE}var yE=ct({},Ws,{key:function(e){if(e.key){var t=pE[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=Hu(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?vE[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:jh,charCode:function(e){return e.type==="keypress"?Hu(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?Hu(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),xE=An(yE),wE=ct({},oc,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),om=An(wE),bE=ct({},Ws,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:jh}),EE=An(bE),CE=ct({},Ca,{propertyName:0,elapsedTime:0,pseudoElement:0}),_E=An(CE),SE=ct({},oc,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),RE=An(SE),kE=[9,13,27,32],Vh=Vr&&"CompositionEvent"in window,es=null;Vr&&"documentMode"in document&&(es=document.documentMode);var IE=Vr&&"TextEvent"in window&&!es,R0=Vr&&(!Vh||es&&8<es&&11>=es),im=" ",am=!1;function k0(e,t){switch(e){case"keyup":return kE.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function I0(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var Ui=!1;function DE(e,t){switch(e){case"compositionend":return I0(t);case"keypress":return t.which!==32?null:(am=!0,im);case"textInput":return e=t.data,e===im&&am?null:e;default:return null}}function TE(e,t){if(Ui)return e==="compositionend"||!Vh&&k0(e,t)?(e=S0(),$u=Wh=fo=null,Ui=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return R0&&t.locale!=="ko"?null:t.data;default:return null}}var NE={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function sm(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!NE[e.type]:t==="textarea"}function D0(e,t,n,r){a0(r),t=cl(t,"onChange"),0<t.length&&(n=new zh("onChange","change",null,n,r),e.push({event:n,listeners:t}))}var ts=null,ms=null;function AE(e){W0(e,0)}function ic(e){var t=ji(e);if(Zy(t))return e}function PE(e,t){if(e==="change")return t}var T0=!1;if(Vr){var tf;if(Vr){var nf="oninput"in document;if(!nf){var um=document.createElement("div");um.setAttribute("oninput","return;"),nf=typeof um.oninput=="function"}tf=nf}else tf=!1;T0=tf&&(!document.documentMode||9<document.documentMode)}function lm(){ts&&(ts.detachEvent("onpropertychange",N0),ms=ts=null)}function N0(e){if(e.propertyName==="value"&&ic(ms)){var t=[];D0(t,ms,e,Mh(e)),c0(AE,t)}}function FE(e,t,n){e==="focusin"?(lm(),ts=t,ms=n,ts.attachEvent("onpropertychange",N0)):e==="focusout"&&lm()}function ME(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return ic(ms)}function OE(e,t){if(e==="click")return ic(t)}function LE(e,t){if(e==="input"||e==="change")return ic(t)}function BE(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var sr=typeof Object.is=="function"?Object.is:BE;function gs(e,t){if(sr(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var o=n[r];if(!ed.call(t,o)||!sr(e[o],t[o]))return!1}return!0}function cm(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function fm(e,t){var n=cm(e);e=0;for(var r;n;){if(n.nodeType===3){if(r=e+n.textContent.length,e<=t&&r>=t)return{node:n,offset:t-e};e=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=cm(n)}}function A0(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?A0(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function P0(){for(var e=window,t=rl();t instanceof e.HTMLIFrameElement;){try{var n=typeof t.contentWindow.location.href=="string"}catch{n=!1}if(n)e=t.contentWindow;else break;t=rl(e.document)}return t}function $h(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function UE(e){var t=P0(),n=e.focusedElem,r=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&A0(n.ownerDocument.documentElement,n)){if(r!==null&&$h(n)){if(t=r.start,e=r.end,e===void 0&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if(e=(t=n.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var o=n.textContent.length,i=Math.min(r.start,o);r=r.end===void 0?i:Math.min(r.end,o),!e.extend&&i>r&&(o=r,r=i,i=o),o=fm(n,i);var a=fm(n,r);o&&a&&(e.rangeCount!==1||e.anchorNode!==o.node||e.anchorOffset!==o.offset||e.focusNode!==a.node||e.focusOffset!==a.offset)&&(t=t.createRange(),t.setStart(o.node,o.offset),e.removeAllRanges(),i>r?(e.addRange(t),e.extend(a.node,a.offset)):(t.setEnd(a.node,a.offset),e.addRange(t)))}}for(t=[],e=n;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<t.length;n++)e=t[n],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var WE=Vr&&"documentMode"in document&&11>=document.documentMode,Wi=null,xd=null,ns=null,wd=!1;function dm(e,t,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;wd||Wi==null||Wi!==rl(r)||(r=Wi,"selectionStart"in r&&$h(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),ns&&gs(ns,r)||(ns=r,r=cl(xd,"onSelect"),0<r.length&&(t=new zh("onSelect","select",null,t,n),e.push({event:t,listeners:r}),t.target=Wi)))}function yu(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var zi={animationend:yu("Animation","AnimationEnd"),animationiteration:yu("Animation","AnimationIteration"),animationstart:yu("Animation","AnimationStart"),transitionend:yu("Transition","TransitionEnd")},rf={},F0={};Vr&&(F0=document.createElement("div").style,"AnimationEvent"in window||(delete zi.animationend.animation,delete zi.animationiteration.animation,delete zi.animationstart.animation),"TransitionEvent"in window||delete zi.transitionend.transition);function ac(e){if(rf[e])return rf[e];if(!zi[e])return e;var t=zi[e],n;for(n in t)if(t.hasOwnProperty(n)&&n in F0)return rf[e]=t[n];return e}var M0=ac("animationend"),O0=ac("animationiteration"),L0=ac("animationstart"),B0=ac("transitionend"),U0=new Map,hm="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function No(e,t){U0.set(e,t),fi(t,[e])}for(var of=0;of<hm.length;of++){var af=hm[of],zE=af.toLowerCase(),jE=af[0].toUpperCase()+af.slice(1);No(zE,"on"+jE)}No(M0,"onAnimationEnd");No(O0,"onAnimationIteration");No(L0,"onAnimationStart");No("dblclick","onDoubleClick");No("focusin","onFocus");No("focusout","onBlur");No(B0,"onTransitionEnd");ca("onMouseEnter",["mouseout","mouseover"]);ca("onMouseLeave",["mouseout","mouseover"]);ca("onPointerEnter",["pointerout","pointerover"]);ca("onPointerLeave",["pointerout","pointerover"]);fi("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));fi("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));fi("onBeforeInput",["compositionend","keypress","textInput","paste"]);fi("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));fi("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));fi("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Ya="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),VE=new Set("cancel close invalid load scroll toggle".split(" ").concat(Ya));function pm(e,t,n){var r=e.type||"unknown-event";e.currentTarget=n,z2(r,t,void 0,e),e.currentTarget=null}function W0(e,t){t=(t&4)!==0;for(var n=0;n<e.length;n++){var r=e[n],o=r.event;r=r.listeners;e:{var i=void 0;if(t)for(var a=r.length-1;0<=a;a--){var s=r[a],u=s.instance,l=s.currentTarget;if(s=s.listener,u!==i&&o.isPropagationStopped())break e;pm(o,s,l),i=u}else for(a=0;a<r.length;a++){if(s=r[a],u=s.instance,l=s.currentTarget,s=s.listener,u!==i&&o.isPropagationStopped())break e;pm(o,s,l),i=u}}}if(il)throw e=vd,il=!1,vd=null,e}function Ze(e,t){var n=t[Sd];n===void 0&&(n=t[Sd]=new Set);var r=e+"__bubble";n.has(r)||(z0(t,e,2,!1),n.add(r))}function sf(e,t,n){var r=0;t&&(r|=4),z0(n,e,r,t)}var xu="_reactListening"+Math.random().toString(36).slice(2);function ys(e){if(!e[xu]){e[xu]=!0,Ky.forEach(function(n){n!=="selectionchange"&&(VE.has(n)||sf(n,!1,e),sf(n,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[xu]||(t[xu]=!0,sf("selectionchange",!1,t))}}function z0(e,t,n,r){switch(_0(t)){case 1:var o=rE;break;case 4:o=oE;break;default:o=Uh}n=o.bind(null,t,n,e),o=void 0,!pd||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(o=!0),r?o!==void 0?e.addEventListener(t,n,{capture:!0,passive:o}):e.addEventListener(t,n,!0):o!==void 0?e.addEventListener(t,n,{passive:o}):e.addEventListener(t,n,!1)}function uf(e,t,n,r,o){var i=r;if(!(t&1)&&!(t&2)&&r!==null)e:for(;;){if(r===null)return;var a=r.tag;if(a===3||a===4){var s=r.stateNode.containerInfo;if(s===o||s.nodeType===8&&s.parentNode===o)break;if(a===4)for(a=r.return;a!==null;){var u=a.tag;if((u===3||u===4)&&(u=a.stateNode.containerInfo,u===o||u.nodeType===8&&u.parentNode===o))return;a=a.return}for(;s!==null;){if(a=Ho(s),a===null)return;if(u=a.tag,u===5||u===6){r=i=a;continue e}s=s.parentNode}}r=r.return}c0(function(){var l=i,c=Mh(n),f=[];e:{var d=U0.get(e);if(d!==void 0){var h=zh,p=e;switch(e){case"keypress":if(Hu(n)===0)break e;case"keydown":case"keyup":h=xE;break;case"focusin":p="focus",h=ef;break;case"focusout":p="blur",h=ef;break;case"beforeblur":case"afterblur":h=ef;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":h=nm;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":h=sE;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":h=EE;break;case M0:case O0:case L0:h=cE;break;case B0:h=_E;break;case"scroll":h=iE;break;case"wheel":h=RE;break;case"copy":case"cut":case"paste":h=dE;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":h=om}var v=(t&4)!==0,g=!v&&e==="scroll",m=v?d!==null?d+"Capture":null:d;v=[];for(var y=l,x;y!==null;){x=y;var w=x.stateNode;if(x.tag===5&&w!==null&&(x=w,m!==null&&(w=ds(y,m),w!=null&&v.push(xs(y,w,x)))),g)break;y=y.return}0<v.length&&(d=new h(d,p,null,n,c),f.push({event:d,listeners:v}))}}if(!(t&7)){e:{if(d=e==="mouseover"||e==="pointerover",h=e==="mouseout"||e==="pointerout",d&&n!==dd&&(p=n.relatedTarget||n.fromElement)&&(Ho(p)||p[$r]))break e;if((h||d)&&(d=c.window===c?c:(d=c.ownerDocument)?d.defaultView||d.parentWindow:window,h?(p=n.relatedTarget||n.toElement,h=l,p=p?Ho(p):null,p!==null&&(g=di(p),p!==g||p.tag!==5&&p.tag!==6)&&(p=null)):(h=null,p=l),h!==p)){if(v=nm,w="onMouseLeave",m="onMouseEnter",y="mouse",(e==="pointerout"||e==="pointerover")&&(v=om,w="onPointerLeave",m="onPointerEnter",y="pointer"),g=h==null?d:ji(h),x=p==null?d:ji(p),d=new v(w,y+"leave",h,n,c),d.target=g,d.relatedTarget=x,w=null,Ho(c)===l&&(v=new v(m,y+"enter",p,n,c),v.target=x,v.relatedTarget=g,w=v),g=w,h&&p)t:{for(v=h,m=p,y=0,x=v;x;x=ki(x))y++;for(x=0,w=m;w;w=ki(w))x++;for(;0<y-x;)v=ki(v),y--;for(;0<x-y;)m=ki(m),x--;for(;y--;){if(v===m||m!==null&&v===m.alternate)break t;v=ki(v),m=ki(m)}v=null}else v=null;h!==null&&vm(f,d,h,v,!1),p!==null&&g!==null&&vm(f,g,p,v,!0)}}e:{if(d=l?ji(l):window,h=d.nodeName&&d.nodeName.toLowerCase(),h==="select"||h==="input"&&d.type==="file")var E=PE;else if(sm(d))if(T0)E=LE;else{E=ME;var b=FE}else(h=d.nodeName)&&h.toLowerCase()==="input"&&(d.type==="checkbox"||d.type==="radio")&&(E=OE);if(E&&(E=E(e,l))){D0(f,E,n,c);break e}b&&b(e,d,l),e==="focusout"&&(b=d._wrapperState)&&b.controlled&&d.type==="number"&&sd(d,"number",d.value)}switch(b=l?ji(l):window,e){case"focusin":(sm(b)||b.contentEditable==="true")&&(Wi=b,xd=l,ns=null);break;case"focusout":ns=xd=Wi=null;break;case"mousedown":wd=!0;break;case"contextmenu":case"mouseup":case"dragend":wd=!1,dm(f,n,c);break;case"selectionchange":if(WE)break;case"keydown":case"keyup":dm(f,n,c)}var C;if(Vh)e:{switch(e){case"compositionstart":var _="onCompositionStart";break e;case"compositionend":_="onCompositionEnd";break e;case"compositionupdate":_="onCompositionUpdate";break e}_=void 0}else Ui?k0(e,n)&&(_="onCompositionEnd"):e==="keydown"&&n.keyCode===229&&(_="onCompositionStart");_&&(R0&&n.locale!=="ko"&&(Ui||_!=="onCompositionStart"?_==="onCompositionEnd"&&Ui&&(C=S0()):(fo=c,Wh="value"in fo?fo.value:fo.textContent,Ui=!0)),b=cl(l,_),0<b.length&&(_=new rm(_,e,null,n,c),f.push({event:_,listeners:b}),C?_.data=C:(C=I0(n),C!==null&&(_.data=C)))),(C=IE?DE(e,n):TE(e,n))&&(l=cl(l,"onBeforeInput"),0<l.length&&(c=new rm("onBeforeInput","beforeinput",null,n,c),f.push({event:c,listeners:l}),c.data=C))}W0(f,t)})}function xs(e,t,n){return{instance:e,listener:t,currentTarget:n}}function cl(e,t){for(var n=t+"Capture",r=[];e!==null;){var o=e,i=o.stateNode;o.tag===5&&i!==null&&(o=i,i=ds(e,n),i!=null&&r.unshift(xs(e,i,o)),i=ds(e,t),i!=null&&r.push(xs(e,i,o))),e=e.return}return r}function ki(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function vm(e,t,n,r,o){for(var i=t._reactName,a=[];n!==null&&n!==r;){var s=n,u=s.alternate,l=s.stateNode;if(u!==null&&u===r)break;s.tag===5&&l!==null&&(s=l,o?(u=ds(n,i),u!=null&&a.unshift(xs(n,u,s))):o||(u=ds(n,i),u!=null&&a.push(xs(n,u,s)))),n=n.return}a.length!==0&&e.push({event:t,listeners:a})}var $E=/\r\n?/g,HE=/\u0000|\uFFFD/g;function mm(e){return(typeof e=="string"?e:""+e).replace($E,`
`).replace(HE,"")}function wu(e,t,n){if(t=mm(t),mm(e)!==t&&n)throw Error(J(425))}function fl(){}var bd=null,Ed=null;function Cd(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var _d=typeof setTimeout=="function"?setTimeout:void 0,GE=typeof clearTimeout=="function"?clearTimeout:void 0,gm=typeof Promise=="function"?Promise:void 0,qE=typeof queueMicrotask=="function"?queueMicrotask:typeof gm<"u"?function(e){return gm.resolve(null).then(e).catch(KE)}:_d;function KE(e){setTimeout(function(){throw e})}function lf(e,t){var n=t,r=0;do{var o=n.nextSibling;if(e.removeChild(n),o&&o.nodeType===8)if(n=o.data,n==="/$"){if(r===0){e.removeChild(o),vs(t);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=o}while(n);vs(t)}function xo(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function ym(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="$"||n==="$!"||n==="$?"){if(t===0)return e;t--}else n==="/$"&&t++}e=e.previousSibling}return null}var _a=Math.random().toString(36).slice(2),xr="__reactFiber$"+_a,ws="__reactProps$"+_a,$r="__reactContainer$"+_a,Sd="__reactEvents$"+_a,XE="__reactListeners$"+_a,YE="__reactHandles$"+_a;function Ho(e){var t=e[xr];if(t)return t;for(var n=e.parentNode;n;){if(t=n[$r]||n[xr]){if(n=t.alternate,t.child!==null||n!==null&&n.child!==null)for(e=ym(e);e!==null;){if(n=e[xr])return n;e=ym(e)}return t}e=n,n=e.parentNode}return null}function zs(e){return e=e[xr]||e[$r],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function ji(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(J(33))}function sc(e){return e[ws]||null}var Rd=[],Vi=-1;function Ao(e){return{current:e}}function tt(e){0>Vi||(e.current=Rd[Vi],Rd[Vi]=null,Vi--)}function Ke(e,t){Vi++,Rd[Vi]=e.current,e.current=t}var Io={},Jt=Ao(Io),fn=Ao(!1),ni=Io;function fa(e,t){var n=e.type.contextTypes;if(!n)return Io;var r=e.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===t)return r.__reactInternalMemoizedMaskedChildContext;var o={},i;for(i in n)o[i]=t[i];return r&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=o),o}function dn(e){return e=e.childContextTypes,e!=null}function dl(){tt(fn),tt(Jt)}function xm(e,t,n){if(Jt.current!==Io)throw Error(J(168));Ke(Jt,t),Ke(fn,n)}function j0(e,t,n){var r=e.stateNode;if(t=t.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var o in r)if(!(o in t))throw Error(J(108,F2(e)||"Unknown",o));return ct({},n,r)}function hl(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Io,ni=Jt.current,Ke(Jt,e),Ke(fn,fn.current),!0}function wm(e,t,n){var r=e.stateNode;if(!r)throw Error(J(169));n?(e=j0(e,t,ni),r.__reactInternalMemoizedMergedChildContext=e,tt(fn),tt(Jt),Ke(Jt,e)):tt(fn),Ke(fn,n)}var Lr=null,uc=!1,cf=!1;function V0(e){Lr===null?Lr=[e]:Lr.push(e)}function QE(e){uc=!0,V0(e)}function Po(){if(!cf&&Lr!==null){cf=!0;var e=0,t=$e;try{var n=Lr;for($e=1;e<n.length;e++){var r=n[e];do r=r(!0);while(r!==null)}Lr=null,uc=!1}catch(o){throw Lr!==null&&(Lr=Lr.slice(e+1)),p0(Oh,Po),o}finally{$e=t,cf=!1}}return null}var $i=[],Hi=0,pl=null,vl=0,Ln=[],Bn=0,ri=null,Ur=1,Wr="";function Uo(e,t){$i[Hi++]=vl,$i[Hi++]=pl,pl=e,vl=t}function $0(e,t,n){Ln[Bn++]=Ur,Ln[Bn++]=Wr,Ln[Bn++]=ri,ri=e;var r=Ur;e=Wr;var o=32-rr(r)-1;r&=~(1<<o),n+=1;var i=32-rr(t)+o;if(30<i){var a=o-o%5;i=(r&(1<<a)-1).toString(32),r>>=a,o-=a,Ur=1<<32-rr(t)+o|n<<o|r,Wr=i+e}else Ur=1<<i|n<<o|r,Wr=e}function Hh(e){e.return!==null&&(Uo(e,1),$0(e,1,0))}function Gh(e){for(;e===pl;)pl=$i[--Hi],$i[Hi]=null,vl=$i[--Hi],$i[Hi]=null;for(;e===ri;)ri=Ln[--Bn],Ln[Bn]=null,Wr=Ln[--Bn],Ln[Bn]=null,Ur=Ln[--Bn],Ln[Bn]=null}var In=null,_n=null,rt=!1,er=null;function H0(e,t){var n=zn(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,t=e.deletions,t===null?(e.deletions=[n],e.flags|=16):t.push(n)}function bm(e,t){switch(e.tag){case 5:var n=e.type;return t=t.nodeType!==1||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,In=e,_n=xo(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,In=e,_n=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(n=ri!==null?{id:Ur,overflow:Wr}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},n=zn(18,null,null,0),n.stateNode=t,n.return=e,e.child=n,In=e,_n=null,!0):!1;default:return!1}}function kd(e){return(e.mode&1)!==0&&(e.flags&128)===0}function Id(e){if(rt){var t=_n;if(t){var n=t;if(!bm(e,t)){if(kd(e))throw Error(J(418));t=xo(n.nextSibling);var r=In;t&&bm(e,t)?H0(r,n):(e.flags=e.flags&-4097|2,rt=!1,In=e)}}else{if(kd(e))throw Error(J(418));e.flags=e.flags&-4097|2,rt=!1,In=e}}}function Em(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;In=e}function bu(e){if(e!==In)return!1;if(!rt)return Em(e),rt=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!Cd(e.type,e.memoizedProps)),t&&(t=_n)){if(kd(e))throw G0(),Error(J(418));for(;t;)H0(e,t),t=xo(t.nextSibling)}if(Em(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(J(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="/$"){if(t===0){_n=xo(e.nextSibling);break e}t--}else n!=="$"&&n!=="$!"&&n!=="$?"||t++}e=e.nextSibling}_n=null}}else _n=In?xo(e.stateNode.nextSibling):null;return!0}function G0(){for(var e=_n;e;)e=xo(e.nextSibling)}function da(){_n=In=null,rt=!1}function qh(e){er===null?er=[e]:er.push(e)}var JE=qr.ReactCurrentBatchConfig;function Oa(e,t,n){if(e=n.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(J(309));var r=n.stateNode}if(!r)throw Error(J(147,e));var o=r,i=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===i?t.ref:(t=function(a){var s=o.refs;a===null?delete s[i]:s[i]=a},t._stringRef=i,t)}if(typeof e!="string")throw Error(J(284));if(!n._owner)throw Error(J(290,e))}return e}function Eu(e,t){throw e=Object.prototype.toString.call(t),Error(J(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function Cm(e){var t=e._init;return t(e._payload)}function q0(e){function t(m,y){if(e){var x=m.deletions;x===null?(m.deletions=[y],m.flags|=16):x.push(y)}}function n(m,y){if(!e)return null;for(;y!==null;)t(m,y),y=y.sibling;return null}function r(m,y){for(m=new Map;y!==null;)y.key!==null?m.set(y.key,y):m.set(y.index,y),y=y.sibling;return m}function o(m,y){return m=Co(m,y),m.index=0,m.sibling=null,m}function i(m,y,x){return m.index=x,e?(x=m.alternate,x!==null?(x=x.index,x<y?(m.flags|=2,y):x):(m.flags|=2,y)):(m.flags|=1048576,y)}function a(m){return e&&m.alternate===null&&(m.flags|=2),m}function s(m,y,x,w){return y===null||y.tag!==6?(y=gf(x,m.mode,w),y.return=m,y):(y=o(y,x),y.return=m,y)}function u(m,y,x,w){var E=x.type;return E===Bi?c(m,y,x.props.children,w,x.key):y!==null&&(y.elementType===E||typeof E=="object"&&E!==null&&E.$$typeof===so&&Cm(E)===y.type)?(w=o(y,x.props),w.ref=Oa(m,y,x),w.return=m,w):(w=Ju(x.type,x.key,x.props,null,m.mode,w),w.ref=Oa(m,y,x),w.return=m,w)}function l(m,y,x,w){return y===null||y.tag!==4||y.stateNode.containerInfo!==x.containerInfo||y.stateNode.implementation!==x.implementation?(y=yf(x,m.mode,w),y.return=m,y):(y=o(y,x.children||[]),y.return=m,y)}function c(m,y,x,w,E){return y===null||y.tag!==7?(y=Zo(x,m.mode,w,E),y.return=m,y):(y=o(y,x),y.return=m,y)}function f(m,y,x){if(typeof y=="string"&&y!==""||typeof y=="number")return y=gf(""+y,m.mode,x),y.return=m,y;if(typeof y=="object"&&y!==null){switch(y.$$typeof){case fu:return x=Ju(y.type,y.key,y.props,null,m.mode,x),x.ref=Oa(m,null,y),x.return=m,x;case Li:return y=yf(y,m.mode,x),y.return=m,y;case so:var w=y._init;return f(m,w(y._payload),x)}if(Ka(y)||Na(y))return y=Zo(y,m.mode,x,null),y.return=m,y;Eu(m,y)}return null}function d(m,y,x,w){var E=y!==null?y.key:null;if(typeof x=="string"&&x!==""||typeof x=="number")return E!==null?null:s(m,y,""+x,w);if(typeof x=="object"&&x!==null){switch(x.$$typeof){case fu:return x.key===E?u(m,y,x,w):null;case Li:return x.key===E?l(m,y,x,w):null;case so:return E=x._init,d(m,y,E(x._payload),w)}if(Ka(x)||Na(x))return E!==null?null:c(m,y,x,w,null);Eu(m,x)}return null}function h(m,y,x,w,E){if(typeof w=="string"&&w!==""||typeof w=="number")return m=m.get(x)||null,s(y,m,""+w,E);if(typeof w=="object"&&w!==null){switch(w.$$typeof){case fu:return m=m.get(w.key===null?x:w.key)||null,u(y,m,w,E);case Li:return m=m.get(w.key===null?x:w.key)||null,l(y,m,w,E);case so:var b=w._init;return h(m,y,x,b(w._payload),E)}if(Ka(w)||Na(w))return m=m.get(x)||null,c(y,m,w,E,null);Eu(y,w)}return null}function p(m,y,x,w){for(var E=null,b=null,C=y,_=y=0,S=null;C!==null&&_<x.length;_++){C.index>_?(S=C,C=null):S=C.sibling;var R=d(m,C,x[_],w);if(R===null){C===null&&(C=S);break}e&&C&&R.alternate===null&&t(m,C),y=i(R,y,_),b===null?E=R:b.sibling=R,b=R,C=S}if(_===x.length)return n(m,C),rt&&Uo(m,_),E;if(C===null){for(;_<x.length;_++)C=f(m,x[_],w),C!==null&&(y=i(C,y,_),b===null?E=C:b.sibling=C,b=C);return rt&&Uo(m,_),E}for(C=r(m,C);_<x.length;_++)S=h(C,m,_,x[_],w),S!==null&&(e&&S.alternate!==null&&C.delete(S.key===null?_:S.key),y=i(S,y,_),b===null?E=S:b.sibling=S,b=S);return e&&C.forEach(function(D){return t(m,D)}),rt&&Uo(m,_),E}function v(m,y,x,w){var E=Na(x);if(typeof E!="function")throw Error(J(150));if(x=E.call(x),x==null)throw Error(J(151));for(var b=E=null,C=y,_=y=0,S=null,R=x.next();C!==null&&!R.done;_++,R=x.next()){C.index>_?(S=C,C=null):S=C.sibling;var D=d(m,C,R.value,w);if(D===null){C===null&&(C=S);break}e&&C&&D.alternate===null&&t(m,C),y=i(D,y,_),b===null?E=D:b.sibling=D,b=D,C=S}if(R.done)return n(m,C),rt&&Uo(m,_),E;if(C===null){for(;!R.done;_++,R=x.next())R=f(m,R.value,w),R!==null&&(y=i(R,y,_),b===null?E=R:b.sibling=R,b=R);return rt&&Uo(m,_),E}for(C=r(m,C);!R.done;_++,R=x.next())R=h(C,m,_,R.value,w),R!==null&&(e&&R.alternate!==null&&C.delete(R.key===null?_:R.key),y=i(R,y,_),b===null?E=R:b.sibling=R,b=R);return e&&C.forEach(function(T){return t(m,T)}),rt&&Uo(m,_),E}function g(m,y,x,w){if(typeof x=="object"&&x!==null&&x.type===Bi&&x.key===null&&(x=x.props.children),typeof x=="object"&&x!==null){switch(x.$$typeof){case fu:e:{for(var E=x.key,b=y;b!==null;){if(b.key===E){if(E=x.type,E===Bi){if(b.tag===7){n(m,b.sibling),y=o(b,x.props.children),y.return=m,m=y;break e}}else if(b.elementType===E||typeof E=="object"&&E!==null&&E.$$typeof===so&&Cm(E)===b.type){n(m,b.sibling),y=o(b,x.props),y.ref=Oa(m,b,x),y.return=m,m=y;break e}n(m,b);break}else t(m,b);b=b.sibling}x.type===Bi?(y=Zo(x.props.children,m.mode,w,x.key),y.return=m,m=y):(w=Ju(x.type,x.key,x.props,null,m.mode,w),w.ref=Oa(m,y,x),w.return=m,m=w)}return a(m);case Li:e:{for(b=x.key;y!==null;){if(y.key===b)if(y.tag===4&&y.stateNode.containerInfo===x.containerInfo&&y.stateNode.implementation===x.implementation){n(m,y.sibling),y=o(y,x.children||[]),y.return=m,m=y;break e}else{n(m,y);break}else t(m,y);y=y.sibling}y=yf(x,m.mode,w),y.return=m,m=y}return a(m);case so:return b=x._init,g(m,y,b(x._payload),w)}if(Ka(x))return p(m,y,x,w);if(Na(x))return v(m,y,x,w);Eu(m,x)}return typeof x=="string"&&x!==""||typeof x=="number"?(x=""+x,y!==null&&y.tag===6?(n(m,y.sibling),y=o(y,x),y.return=m,m=y):(n(m,y),y=gf(x,m.mode,w),y.return=m,m=y),a(m)):n(m,y)}return g}var ha=q0(!0),K0=q0(!1),ml=Ao(null),gl=null,Gi=null,Kh=null;function Xh(){Kh=Gi=gl=null}function Yh(e){var t=ml.current;tt(ml),e._currentValue=t}function Dd(e,t,n){for(;e!==null;){var r=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,r!==null&&(r.childLanes|=t)):r!==null&&(r.childLanes&t)!==t&&(r.childLanes|=t),e===n)break;e=e.return}}function ea(e,t){gl=e,Kh=Gi=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(cn=!0),e.firstContext=null)}function Hn(e){var t=e._currentValue;if(Kh!==e)if(e={context:e,memoizedValue:t,next:null},Gi===null){if(gl===null)throw Error(J(308));Gi=e,gl.dependencies={lanes:0,firstContext:e}}else Gi=Gi.next=e;return t}var Go=null;function Qh(e){Go===null?Go=[e]:Go.push(e)}function X0(e,t,n,r){var o=t.interleaved;return o===null?(n.next=n,Qh(t)):(n.next=o.next,o.next=n),t.interleaved=n,Hr(e,r)}function Hr(e,t){e.lanes|=t;var n=e.alternate;for(n!==null&&(n.lanes|=t),n=e,e=e.return;e!==null;)e.childLanes|=t,n=e.alternate,n!==null&&(n.childLanes|=t),n=e,e=e.return;return n.tag===3?n.stateNode:null}var uo=!1;function Jh(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Y0(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function zr(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function wo(e,t,n){var r=e.updateQueue;if(r===null)return null;if(r=r.shared,Be&2){var o=r.pending;return o===null?t.next=t:(t.next=o.next,o.next=t),r.pending=t,Hr(e,n)}return o=r.interleaved,o===null?(t.next=t,Qh(r)):(t.next=o.next,o.next=t),r.interleaved=t,Hr(e,n)}function Gu(e,t,n){if(t=t.updateQueue,t!==null&&(t=t.shared,(n&4194240)!==0)){var r=t.lanes;r&=e.pendingLanes,n|=r,t.lanes=n,Lh(e,n)}}function _m(e,t){var n=e.updateQueue,r=e.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var o=null,i=null;if(n=n.firstBaseUpdate,n!==null){do{var a={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};i===null?o=i=a:i=i.next=a,n=n.next}while(n!==null);i===null?o=i=t:i=i.next=t}else o=i=t;n={baseState:r.baseState,firstBaseUpdate:o,lastBaseUpdate:i,shared:r.shared,effects:r.effects},e.updateQueue=n;return}e=n.lastBaseUpdate,e===null?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function yl(e,t,n,r){var o=e.updateQueue;uo=!1;var i=o.firstBaseUpdate,a=o.lastBaseUpdate,s=o.shared.pending;if(s!==null){o.shared.pending=null;var u=s,l=u.next;u.next=null,a===null?i=l:a.next=l,a=u;var c=e.alternate;c!==null&&(c=c.updateQueue,s=c.lastBaseUpdate,s!==a&&(s===null?c.firstBaseUpdate=l:s.next=l,c.lastBaseUpdate=u))}if(i!==null){var f=o.baseState;a=0,c=l=u=null,s=i;do{var d=s.lane,h=s.eventTime;if((r&d)===d){c!==null&&(c=c.next={eventTime:h,lane:0,tag:s.tag,payload:s.payload,callback:s.callback,next:null});e:{var p=e,v=s;switch(d=t,h=n,v.tag){case 1:if(p=v.payload,typeof p=="function"){f=p.call(h,f,d);break e}f=p;break e;case 3:p.flags=p.flags&-65537|128;case 0:if(p=v.payload,d=typeof p=="function"?p.call(h,f,d):p,d==null)break e;f=ct({},f,d);break e;case 2:uo=!0}}s.callback!==null&&s.lane!==0&&(e.flags|=64,d=o.effects,d===null?o.effects=[s]:d.push(s))}else h={eventTime:h,lane:d,tag:s.tag,payload:s.payload,callback:s.callback,next:null},c===null?(l=c=h,u=f):c=c.next=h,a|=d;if(s=s.next,s===null){if(s=o.shared.pending,s===null)break;d=s,s=d.next,d.next=null,o.lastBaseUpdate=d,o.shared.pending=null}}while(!0);if(c===null&&(u=f),o.baseState=u,o.firstBaseUpdate=l,o.lastBaseUpdate=c,t=o.shared.interleaved,t!==null){o=t;do a|=o.lane,o=o.next;while(o!==t)}else i===null&&(o.shared.lanes=0);ii|=a,e.lanes=a,e.memoizedState=f}}function Sm(e,t,n){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var r=e[t],o=r.callback;if(o!==null){if(r.callback=null,r=n,typeof o!="function")throw Error(J(191,o));o.call(r)}}}var js={},_r=Ao(js),bs=Ao(js),Es=Ao(js);function qo(e){if(e===js)throw Error(J(174));return e}function Zh(e,t){switch(Ke(Es,t),Ke(bs,e),Ke(_r,js),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:ld(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=ld(t,e)}tt(_r),Ke(_r,t)}function pa(){tt(_r),tt(bs),tt(Es)}function Q0(e){qo(Es.current);var t=qo(_r.current),n=ld(t,e.type);t!==n&&(Ke(bs,e),Ke(_r,n))}function ep(e){bs.current===e&&(tt(_r),tt(bs))}var at=Ao(0);function xl(e){for(var t=e;t!==null;){if(t.tag===13){var n=t.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var ff=[];function tp(){for(var e=0;e<ff.length;e++)ff[e]._workInProgressVersionPrimary=null;ff.length=0}var qu=qr.ReactCurrentDispatcher,df=qr.ReactCurrentBatchConfig,oi=0,lt=null,Ct=null,Nt=null,wl=!1,rs=!1,Cs=0,ZE=0;function $t(){throw Error(J(321))}function np(e,t){if(t===null)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!sr(e[n],t[n]))return!1;return!0}function rp(e,t,n,r,o,i){if(oi=i,lt=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,qu.current=e===null||e.memoizedState===null?rC:oC,e=n(r,o),rs){i=0;do{if(rs=!1,Cs=0,25<=i)throw Error(J(301));i+=1,Nt=Ct=null,t.updateQueue=null,qu.current=iC,e=n(r,o)}while(rs)}if(qu.current=bl,t=Ct!==null&&Ct.next!==null,oi=0,Nt=Ct=lt=null,wl=!1,t)throw Error(J(300));return e}function op(){var e=Cs!==0;return Cs=0,e}function mr(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Nt===null?lt.memoizedState=Nt=e:Nt=Nt.next=e,Nt}function Gn(){if(Ct===null){var e=lt.alternate;e=e!==null?e.memoizedState:null}else e=Ct.next;var t=Nt===null?lt.memoizedState:Nt.next;if(t!==null)Nt=t,Ct=e;else{if(e===null)throw Error(J(310));Ct=e,e={memoizedState:Ct.memoizedState,baseState:Ct.baseState,baseQueue:Ct.baseQueue,queue:Ct.queue,next:null},Nt===null?lt.memoizedState=Nt=e:Nt=Nt.next=e}return Nt}function _s(e,t){return typeof t=="function"?t(e):t}function hf(e){var t=Gn(),n=t.queue;if(n===null)throw Error(J(311));n.lastRenderedReducer=e;var r=Ct,o=r.baseQueue,i=n.pending;if(i!==null){if(o!==null){var a=o.next;o.next=i.next,i.next=a}r.baseQueue=o=i,n.pending=null}if(o!==null){i=o.next,r=r.baseState;var s=a=null,u=null,l=i;do{var c=l.lane;if((oi&c)===c)u!==null&&(u=u.next={lane:0,action:l.action,hasEagerState:l.hasEagerState,eagerState:l.eagerState,next:null}),r=l.hasEagerState?l.eagerState:e(r,l.action);else{var f={lane:c,action:l.action,hasEagerState:l.hasEagerState,eagerState:l.eagerState,next:null};u===null?(s=u=f,a=r):u=u.next=f,lt.lanes|=c,ii|=c}l=l.next}while(l!==null&&l!==i);u===null?a=r:u.next=s,sr(r,t.memoizedState)||(cn=!0),t.memoizedState=r,t.baseState=a,t.baseQueue=u,n.lastRenderedState=r}if(e=n.interleaved,e!==null){o=e;do i=o.lane,lt.lanes|=i,ii|=i,o=o.next;while(o!==e)}else o===null&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function pf(e){var t=Gn(),n=t.queue;if(n===null)throw Error(J(311));n.lastRenderedReducer=e;var r=n.dispatch,o=n.pending,i=t.memoizedState;if(o!==null){n.pending=null;var a=o=o.next;do i=e(i,a.action),a=a.next;while(a!==o);sr(i,t.memoizedState)||(cn=!0),t.memoizedState=i,t.baseQueue===null&&(t.baseState=i),n.lastRenderedState=i}return[i,r]}function J0(){}function Z0(e,t){var n=lt,r=Gn(),o=t(),i=!sr(r.memoizedState,o);if(i&&(r.memoizedState=o,cn=!0),r=r.queue,ip(n1.bind(null,n,r,e),[e]),r.getSnapshot!==t||i||Nt!==null&&Nt.memoizedState.tag&1){if(n.flags|=2048,Ss(9,t1.bind(null,n,r,o,t),void 0,null),Pt===null)throw Error(J(349));oi&30||e1(n,t,o)}return o}function e1(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},t=lt.updateQueue,t===null?(t={lastEffect:null,stores:null},lt.updateQueue=t,t.stores=[e]):(n=t.stores,n===null?t.stores=[e]:n.push(e))}function t1(e,t,n,r){t.value=n,t.getSnapshot=r,r1(t)&&o1(e)}function n1(e,t,n){return n(function(){r1(t)&&o1(e)})}function r1(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!sr(e,n)}catch{return!0}}function o1(e){var t=Hr(e,1);t!==null&&or(t,e,1,-1)}function Rm(e){var t=mr();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:_s,lastRenderedState:e},t.queue=e,e=e.dispatch=nC.bind(null,lt,e),[t.memoizedState,e]}function Ss(e,t,n,r){return e={tag:e,create:t,destroy:n,deps:r,next:null},t=lt.updateQueue,t===null?(t={lastEffect:null,stores:null},lt.updateQueue=t,t.lastEffect=e.next=e):(n=t.lastEffect,n===null?t.lastEffect=e.next=e:(r=n.next,n.next=e,e.next=r,t.lastEffect=e)),e}function i1(){return Gn().memoizedState}function Ku(e,t,n,r){var o=mr();lt.flags|=e,o.memoizedState=Ss(1|t,n,void 0,r===void 0?null:r)}function lc(e,t,n,r){var o=Gn();r=r===void 0?null:r;var i=void 0;if(Ct!==null){var a=Ct.memoizedState;if(i=a.destroy,r!==null&&np(r,a.deps)){o.memoizedState=Ss(t,n,i,r);return}}lt.flags|=e,o.memoizedState=Ss(1|t,n,i,r)}function km(e,t){return Ku(8390656,8,e,t)}function ip(e,t){return lc(2048,8,e,t)}function a1(e,t){return lc(4,2,e,t)}function s1(e,t){return lc(4,4,e,t)}function u1(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function l1(e,t,n){return n=n!=null?n.concat([e]):null,lc(4,4,u1.bind(null,t,e),n)}function ap(){}function c1(e,t){var n=Gn();t=t===void 0?null:t;var r=n.memoizedState;return r!==null&&t!==null&&np(t,r[1])?r[0]:(n.memoizedState=[e,t],e)}function f1(e,t){var n=Gn();t=t===void 0?null:t;var r=n.memoizedState;return r!==null&&t!==null&&np(t,r[1])?r[0]:(e=e(),n.memoizedState=[e,t],e)}function d1(e,t,n){return oi&21?(sr(n,t)||(n=g0(),lt.lanes|=n,ii|=n,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,cn=!0),e.memoizedState=n)}function eC(e,t){var n=$e;$e=n!==0&&4>n?n:4,e(!0);var r=df.transition;df.transition={};try{e(!1),t()}finally{$e=n,df.transition=r}}function h1(){return Gn().memoizedState}function tC(e,t,n){var r=Eo(e);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},p1(e))v1(t,n);else if(n=X0(e,t,n,r),n!==null){var o=rn();or(n,e,r,o),m1(n,t,r)}}function nC(e,t,n){var r=Eo(e),o={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(p1(e))v1(t,o);else{var i=e.alternate;if(e.lanes===0&&(i===null||i.lanes===0)&&(i=t.lastRenderedReducer,i!==null))try{var a=t.lastRenderedState,s=i(a,n);if(o.hasEagerState=!0,o.eagerState=s,sr(s,a)){var u=t.interleaved;u===null?(o.next=o,Qh(t)):(o.next=u.next,u.next=o),t.interleaved=o;return}}catch{}finally{}n=X0(e,t,o,r),n!==null&&(o=rn(),or(n,e,r,o),m1(n,t,r))}}function p1(e){var t=e.alternate;return e===lt||t!==null&&t===lt}function v1(e,t){rs=wl=!0;var n=e.pending;n===null?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function m1(e,t,n){if(n&4194240){var r=t.lanes;r&=e.pendingLanes,n|=r,t.lanes=n,Lh(e,n)}}var bl={readContext:Hn,useCallback:$t,useContext:$t,useEffect:$t,useImperativeHandle:$t,useInsertionEffect:$t,useLayoutEffect:$t,useMemo:$t,useReducer:$t,useRef:$t,useState:$t,useDebugValue:$t,useDeferredValue:$t,useTransition:$t,useMutableSource:$t,useSyncExternalStore:$t,useId:$t,unstable_isNewReconciler:!1},rC={readContext:Hn,useCallback:function(e,t){return mr().memoizedState=[e,t===void 0?null:t],e},useContext:Hn,useEffect:km,useImperativeHandle:function(e,t,n){return n=n!=null?n.concat([e]):null,Ku(4194308,4,u1.bind(null,t,e),n)},useLayoutEffect:function(e,t){return Ku(4194308,4,e,t)},useInsertionEffect:function(e,t){return Ku(4,2,e,t)},useMemo:function(e,t){var n=mr();return t=t===void 0?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var r=mr();return t=n!==void 0?n(t):t,r.memoizedState=r.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},r.queue=e,e=e.dispatch=tC.bind(null,lt,e),[r.memoizedState,e]},useRef:function(e){var t=mr();return e={current:e},t.memoizedState=e},useState:Rm,useDebugValue:ap,useDeferredValue:function(e){return mr().memoizedState=e},useTransition:function(){var e=Rm(!1),t=e[0];return e=eC.bind(null,e[1]),mr().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var r=lt,o=mr();if(rt){if(n===void 0)throw Error(J(407));n=n()}else{if(n=t(),Pt===null)throw Error(J(349));oi&30||e1(r,t,n)}o.memoizedState=n;var i={value:n,getSnapshot:t};return o.queue=i,km(n1.bind(null,r,i,e),[e]),r.flags|=2048,Ss(9,t1.bind(null,r,i,n,t),void 0,null),n},useId:function(){var e=mr(),t=Pt.identifierPrefix;if(rt){var n=Wr,r=Ur;n=(r&~(1<<32-rr(r)-1)).toString(32)+n,t=":"+t+"R"+n,n=Cs++,0<n&&(t+="H"+n.toString(32)),t+=":"}else n=ZE++,t=":"+t+"r"+n.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},oC={readContext:Hn,useCallback:c1,useContext:Hn,useEffect:ip,useImperativeHandle:l1,useInsertionEffect:a1,useLayoutEffect:s1,useMemo:f1,useReducer:hf,useRef:i1,useState:function(){return hf(_s)},useDebugValue:ap,useDeferredValue:function(e){var t=Gn();return d1(t,Ct.memoizedState,e)},useTransition:function(){var e=hf(_s)[0],t=Gn().memoizedState;return[e,t]},useMutableSource:J0,useSyncExternalStore:Z0,useId:h1,unstable_isNewReconciler:!1},iC={readContext:Hn,useCallback:c1,useContext:Hn,useEffect:ip,useImperativeHandle:l1,useInsertionEffect:a1,useLayoutEffect:s1,useMemo:f1,useReducer:pf,useRef:i1,useState:function(){return pf(_s)},useDebugValue:ap,useDeferredValue:function(e){var t=Gn();return Ct===null?t.memoizedState=e:d1(t,Ct.memoizedState,e)},useTransition:function(){var e=pf(_s)[0],t=Gn().memoizedState;return[e,t]},useMutableSource:J0,useSyncExternalStore:Z0,useId:h1,unstable_isNewReconciler:!1};function Qn(e,t){if(e&&e.defaultProps){t=ct({},t),e=e.defaultProps;for(var n in e)t[n]===void 0&&(t[n]=e[n]);return t}return t}function Td(e,t,n,r){t=e.memoizedState,n=n(r,t),n=n==null?t:ct({},t,n),e.memoizedState=n,e.lanes===0&&(e.updateQueue.baseState=n)}var cc={isMounted:function(e){return(e=e._reactInternals)?di(e)===e:!1},enqueueSetState:function(e,t,n){e=e._reactInternals;var r=rn(),o=Eo(e),i=zr(r,o);i.payload=t,n!=null&&(i.callback=n),t=wo(e,i,o),t!==null&&(or(t,e,o,r),Gu(t,e,o))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var r=rn(),o=Eo(e),i=zr(r,o);i.tag=1,i.payload=t,n!=null&&(i.callback=n),t=wo(e,i,o),t!==null&&(or(t,e,o,r),Gu(t,e,o))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=rn(),r=Eo(e),o=zr(n,r);o.tag=2,t!=null&&(o.callback=t),t=wo(e,o,r),t!==null&&(or(t,e,r,n),Gu(t,e,r))}};function Im(e,t,n,r,o,i,a){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(r,i,a):t.prototype&&t.prototype.isPureReactComponent?!gs(n,r)||!gs(o,i):!0}function g1(e,t,n){var r=!1,o=Io,i=t.contextType;return typeof i=="object"&&i!==null?i=Hn(i):(o=dn(t)?ni:Jt.current,r=t.contextTypes,i=(r=r!=null)?fa(e,o):Io),t=new t(n,i),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=cc,e.stateNode=t,t._reactInternals=e,r&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=o,e.__reactInternalMemoizedMaskedChildContext=i),t}function Dm(e,t,n,r){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(n,r),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(n,r),t.state!==e&&cc.enqueueReplaceState(t,t.state,null)}function Nd(e,t,n,r){var o=e.stateNode;o.props=n,o.state=e.memoizedState,o.refs={},Jh(e);var i=t.contextType;typeof i=="object"&&i!==null?o.context=Hn(i):(i=dn(t)?ni:Jt.current,o.context=fa(e,i)),o.state=e.memoizedState,i=t.getDerivedStateFromProps,typeof i=="function"&&(Td(e,t,i,n),o.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof o.getSnapshotBeforeUpdate=="function"||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(t=o.state,typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount(),t!==o.state&&cc.enqueueReplaceState(o,o.state,null),yl(e,n,o,r),o.state=e.memoizedState),typeof o.componentDidMount=="function"&&(e.flags|=4194308)}function va(e,t){try{var n="",r=t;do n+=P2(r),r=r.return;while(r);var o=n}catch(i){o=`
Error generating stack: `+i.message+`
`+i.stack}return{value:e,source:t,stack:o,digest:null}}function vf(e,t,n){return{value:e,source:null,stack:n??null,digest:t??null}}function Ad(e,t){try{console.error(t.value)}catch(n){setTimeout(function(){throw n})}}var aC=typeof WeakMap=="function"?WeakMap:Map;function y1(e,t,n){n=zr(-1,n),n.tag=3,n.payload={element:null};var r=t.value;return n.callback=function(){Cl||(Cl=!0,jd=r),Ad(e,t)},n}function x1(e,t,n){n=zr(-1,n),n.tag=3;var r=e.type.getDerivedStateFromError;if(typeof r=="function"){var o=t.value;n.payload=function(){return r(o)},n.callback=function(){Ad(e,t)}}var i=e.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(n.callback=function(){Ad(e,t),typeof r!="function"&&(bo===null?bo=new Set([this]):bo.add(this));var a=t.stack;this.componentDidCatch(t.value,{componentStack:a!==null?a:""})}),n}function Tm(e,t,n){var r=e.pingCache;if(r===null){r=e.pingCache=new aC;var o=new Set;r.set(t,o)}else o=r.get(t),o===void 0&&(o=new Set,r.set(t,o));o.has(n)||(o.add(n),e=wC.bind(null,e,t,n),t.then(e,e))}function Nm(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function Am(e,t,n,r,o){return e.mode&1?(e.flags|=65536,e.lanes=o,e):(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(t=zr(-1,1),t.tag=2,wo(n,t,1))),n.lanes|=1),e)}var sC=qr.ReactCurrentOwner,cn=!1;function nn(e,t,n,r){t.child=e===null?K0(t,null,n,r):ha(t,e.child,n,r)}function Pm(e,t,n,r,o){n=n.render;var i=t.ref;return ea(t,o),r=rp(e,t,n,r,i,o),n=op(),e!==null&&!cn?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~o,Gr(e,t,o)):(rt&&n&&Hh(t),t.flags|=1,nn(e,t,r,o),t.child)}function Fm(e,t,n,r,o){if(e===null){var i=n.type;return typeof i=="function"&&!pp(i)&&i.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(t.tag=15,t.type=i,w1(e,t,i,r,o)):(e=Ju(n.type,null,r,t,t.mode,o),e.ref=t.ref,e.return=t,t.child=e)}if(i=e.child,!(e.lanes&o)){var a=i.memoizedProps;if(n=n.compare,n=n!==null?n:gs,n(a,r)&&e.ref===t.ref)return Gr(e,t,o)}return t.flags|=1,e=Co(i,r),e.ref=t.ref,e.return=t,t.child=e}function w1(e,t,n,r,o){if(e!==null){var i=e.memoizedProps;if(gs(i,r)&&e.ref===t.ref)if(cn=!1,t.pendingProps=r=i,(e.lanes&o)!==0)e.flags&131072&&(cn=!0);else return t.lanes=e.lanes,Gr(e,t,o)}return Pd(e,t,n,r,o)}function b1(e,t,n){var r=t.pendingProps,o=r.children,i=e!==null?e.memoizedState:null;if(r.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Ke(Ki,wn),wn|=n;else{if(!(n&1073741824))return e=i!==null?i.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Ke(Ki,wn),wn|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=i!==null?i.baseLanes:n,Ke(Ki,wn),wn|=r}else i!==null?(r=i.baseLanes|n,t.memoizedState=null):r=n,Ke(Ki,wn),wn|=r;return nn(e,t,o,n),t.child}function E1(e,t){var n=t.ref;(e===null&&n!==null||e!==null&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function Pd(e,t,n,r,o){var i=dn(n)?ni:Jt.current;return i=fa(t,i),ea(t,o),n=rp(e,t,n,r,i,o),r=op(),e!==null&&!cn?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~o,Gr(e,t,o)):(rt&&r&&Hh(t),t.flags|=1,nn(e,t,n,o),t.child)}function Mm(e,t,n,r,o){if(dn(n)){var i=!0;hl(t)}else i=!1;if(ea(t,o),t.stateNode===null)Xu(e,t),g1(t,n,r),Nd(t,n,r,o),r=!0;else if(e===null){var a=t.stateNode,s=t.memoizedProps;a.props=s;var u=a.context,l=n.contextType;typeof l=="object"&&l!==null?l=Hn(l):(l=dn(n)?ni:Jt.current,l=fa(t,l));var c=n.getDerivedStateFromProps,f=typeof c=="function"||typeof a.getSnapshotBeforeUpdate=="function";f||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(s!==r||u!==l)&&Dm(t,a,r,l),uo=!1;var d=t.memoizedState;a.state=d,yl(t,r,a,o),u=t.memoizedState,s!==r||d!==u||fn.current||uo?(typeof c=="function"&&(Td(t,n,c,r),u=t.memoizedState),(s=uo||Im(t,n,s,r,d,u,l))?(f||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount()),typeof a.componentDidMount=="function"&&(t.flags|=4194308)):(typeof a.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=r,t.memoizedState=u),a.props=r,a.state=u,a.context=l,r=s):(typeof a.componentDidMount=="function"&&(t.flags|=4194308),r=!1)}else{a=t.stateNode,Y0(e,t),s=t.memoizedProps,l=t.type===t.elementType?s:Qn(t.type,s),a.props=l,f=t.pendingProps,d=a.context,u=n.contextType,typeof u=="object"&&u!==null?u=Hn(u):(u=dn(n)?ni:Jt.current,u=fa(t,u));var h=n.getDerivedStateFromProps;(c=typeof h=="function"||typeof a.getSnapshotBeforeUpdate=="function")||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(s!==f||d!==u)&&Dm(t,a,r,u),uo=!1,d=t.memoizedState,a.state=d,yl(t,r,a,o);var p=t.memoizedState;s!==f||d!==p||fn.current||uo?(typeof h=="function"&&(Td(t,n,h,r),p=t.memoizedState),(l=uo||Im(t,n,l,r,d,p,u)||!1)?(c||typeof a.UNSAFE_componentWillUpdate!="function"&&typeof a.componentWillUpdate!="function"||(typeof a.componentWillUpdate=="function"&&a.componentWillUpdate(r,p,u),typeof a.UNSAFE_componentWillUpdate=="function"&&a.UNSAFE_componentWillUpdate(r,p,u)),typeof a.componentDidUpdate=="function"&&(t.flags|=4),typeof a.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof a.componentDidUpdate!="function"||s===e.memoizedProps&&d===e.memoizedState||(t.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||s===e.memoizedProps&&d===e.memoizedState||(t.flags|=1024),t.memoizedProps=r,t.memoizedState=p),a.props=r,a.state=p,a.context=u,r=l):(typeof a.componentDidUpdate!="function"||s===e.memoizedProps&&d===e.memoizedState||(t.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||s===e.memoizedProps&&d===e.memoizedState||(t.flags|=1024),r=!1)}return Fd(e,t,n,r,i,o)}function Fd(e,t,n,r,o,i){E1(e,t);var a=(t.flags&128)!==0;if(!r&&!a)return o&&wm(t,n,!1),Gr(e,t,i);r=t.stateNode,sC.current=t;var s=a&&typeof n.getDerivedStateFromError!="function"?null:r.render();return t.flags|=1,e!==null&&a?(t.child=ha(t,e.child,null,i),t.child=ha(t,null,s,i)):nn(e,t,s,i),t.memoizedState=r.state,o&&wm(t,n,!0),t.child}function C1(e){var t=e.stateNode;t.pendingContext?xm(e,t.pendingContext,t.pendingContext!==t.context):t.context&&xm(e,t.context,!1),Zh(e,t.containerInfo)}function Om(e,t,n,r,o){return da(),qh(o),t.flags|=256,nn(e,t,n,r),t.child}var Md={dehydrated:null,treeContext:null,retryLane:0};function Od(e){return{baseLanes:e,cachePool:null,transitions:null}}function _1(e,t,n){var r=t.pendingProps,o=at.current,i=!1,a=(t.flags&128)!==0,s;if((s=a)||(s=e!==null&&e.memoizedState===null?!1:(o&2)!==0),s?(i=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(o|=1),Ke(at,o&1),e===null)return Id(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(a=r.children,e=r.fallback,i?(r=t.mode,i=t.child,a={mode:"hidden",children:a},!(r&1)&&i!==null?(i.childLanes=0,i.pendingProps=a):i=hc(a,r,0,null),e=Zo(e,r,n,null),i.return=t,e.return=t,i.sibling=e,t.child=i,t.child.memoizedState=Od(n),t.memoizedState=Md,e):sp(t,a));if(o=e.memoizedState,o!==null&&(s=o.dehydrated,s!==null))return uC(e,t,a,r,s,o,n);if(i){i=r.fallback,a=t.mode,o=e.child,s=o.sibling;var u={mode:"hidden",children:r.children};return!(a&1)&&t.child!==o?(r=t.child,r.childLanes=0,r.pendingProps=u,t.deletions=null):(r=Co(o,u),r.subtreeFlags=o.subtreeFlags&14680064),s!==null?i=Co(s,i):(i=Zo(i,a,n,null),i.flags|=2),i.return=t,r.return=t,r.sibling=i,t.child=r,r=i,i=t.child,a=e.child.memoizedState,a=a===null?Od(n):{baseLanes:a.baseLanes|n,cachePool:null,transitions:a.transitions},i.memoizedState=a,i.childLanes=e.childLanes&~n,t.memoizedState=Md,r}return i=e.child,e=i.sibling,r=Co(i,{mode:"visible",children:r.children}),!(t.mode&1)&&(r.lanes=n),r.return=t,r.sibling=null,e!==null&&(n=t.deletions,n===null?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=r,t.memoizedState=null,r}function sp(e,t){return t=hc({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function Cu(e,t,n,r){return r!==null&&qh(r),ha(t,e.child,null,n),e=sp(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function uC(e,t,n,r,o,i,a){if(n)return t.flags&256?(t.flags&=-257,r=vf(Error(J(422))),Cu(e,t,a,r)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(i=r.fallback,o=t.mode,r=hc({mode:"visible",children:r.children},o,0,null),i=Zo(i,o,a,null),i.flags|=2,r.return=t,i.return=t,r.sibling=i,t.child=r,t.mode&1&&ha(t,e.child,null,a),t.child.memoizedState=Od(a),t.memoizedState=Md,i);if(!(t.mode&1))return Cu(e,t,a,null);if(o.data==="$!"){if(r=o.nextSibling&&o.nextSibling.dataset,r)var s=r.dgst;return r=s,i=Error(J(419)),r=vf(i,r,void 0),Cu(e,t,a,r)}if(s=(a&e.childLanes)!==0,cn||s){if(r=Pt,r!==null){switch(a&-a){case 4:o=2;break;case 16:o=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:o=32;break;case 536870912:o=268435456;break;default:o=0}o=o&(r.suspendedLanes|a)?0:o,o!==0&&o!==i.retryLane&&(i.retryLane=o,Hr(e,o),or(r,e,o,-1))}return hp(),r=vf(Error(J(421))),Cu(e,t,a,r)}return o.data==="$?"?(t.flags|=128,t.child=e.child,t=bC.bind(null,e),o._reactRetry=t,null):(e=i.treeContext,_n=xo(o.nextSibling),In=t,rt=!0,er=null,e!==null&&(Ln[Bn++]=Ur,Ln[Bn++]=Wr,Ln[Bn++]=ri,Ur=e.id,Wr=e.overflow,ri=t),t=sp(t,r.children),t.flags|=4096,t)}function Lm(e,t,n){e.lanes|=t;var r=e.alternate;r!==null&&(r.lanes|=t),Dd(e.return,t,n)}function mf(e,t,n,r,o){var i=e.memoizedState;i===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:o}:(i.isBackwards=t,i.rendering=null,i.renderingStartTime=0,i.last=r,i.tail=n,i.tailMode=o)}function S1(e,t,n){var r=t.pendingProps,o=r.revealOrder,i=r.tail;if(nn(e,t,r.children,n),r=at.current,r&2)r=r&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&Lm(e,n,t);else if(e.tag===19)Lm(e,n,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}r&=1}if(Ke(at,r),!(t.mode&1))t.memoizedState=null;else switch(o){case"forwards":for(n=t.child,o=null;n!==null;)e=n.alternate,e!==null&&xl(e)===null&&(o=n),n=n.sibling;n=o,n===null?(o=t.child,t.child=null):(o=n.sibling,n.sibling=null),mf(t,!1,o,n,i);break;case"backwards":for(n=null,o=t.child,t.child=null;o!==null;){if(e=o.alternate,e!==null&&xl(e)===null){t.child=o;break}e=o.sibling,o.sibling=n,n=o,o=e}mf(t,!0,n,null,i);break;case"together":mf(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Xu(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Gr(e,t,n){if(e!==null&&(t.dependencies=e.dependencies),ii|=t.lanes,!(n&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(J(153));if(t.child!==null){for(e=t.child,n=Co(e,e.pendingProps),t.child=n,n.return=t;e.sibling!==null;)e=e.sibling,n=n.sibling=Co(e,e.pendingProps),n.return=t;n.sibling=null}return t.child}function lC(e,t,n){switch(t.tag){case 3:C1(t),da();break;case 5:Q0(t);break;case 1:dn(t.type)&&hl(t);break;case 4:Zh(t,t.stateNode.containerInfo);break;case 10:var r=t.type._context,o=t.memoizedProps.value;Ke(ml,r._currentValue),r._currentValue=o;break;case 13:if(r=t.memoizedState,r!==null)return r.dehydrated!==null?(Ke(at,at.current&1),t.flags|=128,null):n&t.child.childLanes?_1(e,t,n):(Ke(at,at.current&1),e=Gr(e,t,n),e!==null?e.sibling:null);Ke(at,at.current&1);break;case 19:if(r=(n&t.childLanes)!==0,e.flags&128){if(r)return S1(e,t,n);t.flags|=128}if(o=t.memoizedState,o!==null&&(o.rendering=null,o.tail=null,o.lastEffect=null),Ke(at,at.current),r)break;return null;case 22:case 23:return t.lanes=0,b1(e,t,n)}return Gr(e,t,n)}var R1,Ld,k1,I1;R1=function(e,t){for(var n=t.child;n!==null;){if(n.tag===5||n.tag===6)e.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===t)break;for(;n.sibling===null;){if(n.return===null||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};Ld=function(){};k1=function(e,t,n,r){var o=e.memoizedProps;if(o!==r){e=t.stateNode,qo(_r.current);var i=null;switch(n){case"input":o=id(e,o),r=id(e,r),i=[];break;case"select":o=ct({},o,{value:void 0}),r=ct({},r,{value:void 0}),i=[];break;case"textarea":o=ud(e,o),r=ud(e,r),i=[];break;default:typeof o.onClick!="function"&&typeof r.onClick=="function"&&(e.onclick=fl)}cd(n,r);var a;n=null;for(l in o)if(!r.hasOwnProperty(l)&&o.hasOwnProperty(l)&&o[l]!=null)if(l==="style"){var s=o[l];for(a in s)s.hasOwnProperty(a)&&(n||(n={}),n[a]="")}else l!=="dangerouslySetInnerHTML"&&l!=="children"&&l!=="suppressContentEditableWarning"&&l!=="suppressHydrationWarning"&&l!=="autoFocus"&&(cs.hasOwnProperty(l)?i||(i=[]):(i=i||[]).push(l,null));for(l in r){var u=r[l];if(s=o!=null?o[l]:void 0,r.hasOwnProperty(l)&&u!==s&&(u!=null||s!=null))if(l==="style")if(s){for(a in s)!s.hasOwnProperty(a)||u&&u.hasOwnProperty(a)||(n||(n={}),n[a]="");for(a in u)u.hasOwnProperty(a)&&s[a]!==u[a]&&(n||(n={}),n[a]=u[a])}else n||(i||(i=[]),i.push(l,n)),n=u;else l==="dangerouslySetInnerHTML"?(u=u?u.__html:void 0,s=s?s.__html:void 0,u!=null&&s!==u&&(i=i||[]).push(l,u)):l==="children"?typeof u!="string"&&typeof u!="number"||(i=i||[]).push(l,""+u):l!=="suppressContentEditableWarning"&&l!=="suppressHydrationWarning"&&(cs.hasOwnProperty(l)?(u!=null&&l==="onScroll"&&Ze("scroll",e),i||s===u||(i=[])):(i=i||[]).push(l,u))}n&&(i=i||[]).push("style",n);var l=i;(t.updateQueue=l)&&(t.flags|=4)}};I1=function(e,t,n,r){n!==r&&(t.flags|=4)};function La(e,t){if(!rt)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;t!==null;)t.alternate!==null&&(n=t),t=t.sibling;n===null?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:r.sibling=null}}function Ht(e){var t=e.alternate!==null&&e.alternate.child===e.child,n=0,r=0;if(t)for(var o=e.child;o!==null;)n|=o.lanes|o.childLanes,r|=o.subtreeFlags&14680064,r|=o.flags&14680064,o.return=e,o=o.sibling;else for(o=e.child;o!==null;)n|=o.lanes|o.childLanes,r|=o.subtreeFlags,r|=o.flags,o.return=e,o=o.sibling;return e.subtreeFlags|=r,e.childLanes=n,t}function cC(e,t,n){var r=t.pendingProps;switch(Gh(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ht(t),null;case 1:return dn(t.type)&&dl(),Ht(t),null;case 3:return r=t.stateNode,pa(),tt(fn),tt(Jt),tp(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(e===null||e.child===null)&&(bu(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,er!==null&&(Hd(er),er=null))),Ld(e,t),Ht(t),null;case 5:ep(t);var o=qo(Es.current);if(n=t.type,e!==null&&t.stateNode!=null)k1(e,t,n,r,o),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!r){if(t.stateNode===null)throw Error(J(166));return Ht(t),null}if(e=qo(_r.current),bu(t)){r=t.stateNode,n=t.type;var i=t.memoizedProps;switch(r[xr]=t,r[ws]=i,e=(t.mode&1)!==0,n){case"dialog":Ze("cancel",r),Ze("close",r);break;case"iframe":case"object":case"embed":Ze("load",r);break;case"video":case"audio":for(o=0;o<Ya.length;o++)Ze(Ya[o],r);break;case"source":Ze("error",r);break;case"img":case"image":case"link":Ze("error",r),Ze("load",r);break;case"details":Ze("toggle",r);break;case"input":Gv(r,i),Ze("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!i.multiple},Ze("invalid",r);break;case"textarea":Kv(r,i),Ze("invalid",r)}cd(n,i),o=null;for(var a in i)if(i.hasOwnProperty(a)){var s=i[a];a==="children"?typeof s=="string"?r.textContent!==s&&(i.suppressHydrationWarning!==!0&&wu(r.textContent,s,e),o=["children",s]):typeof s=="number"&&r.textContent!==""+s&&(i.suppressHydrationWarning!==!0&&wu(r.textContent,s,e),o=["children",""+s]):cs.hasOwnProperty(a)&&s!=null&&a==="onScroll"&&Ze("scroll",r)}switch(n){case"input":du(r),qv(r,i,!0);break;case"textarea":du(r),Xv(r);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(r.onclick=fl)}r=o,t.updateQueue=r,r!==null&&(t.flags|=4)}else{a=o.nodeType===9?o:o.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=n0(n)),e==="http://www.w3.org/1999/xhtml"?n==="script"?(e=a.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof r.is=="string"?e=a.createElement(n,{is:r.is}):(e=a.createElement(n),n==="select"&&(a=e,r.multiple?a.multiple=!0:r.size&&(a.size=r.size))):e=a.createElementNS(e,n),e[xr]=t,e[ws]=r,R1(e,t,!1,!1),t.stateNode=e;e:{switch(a=fd(n,r),n){case"dialog":Ze("cancel",e),Ze("close",e),o=r;break;case"iframe":case"object":case"embed":Ze("load",e),o=r;break;case"video":case"audio":for(o=0;o<Ya.length;o++)Ze(Ya[o],e);o=r;break;case"source":Ze("error",e),o=r;break;case"img":case"image":case"link":Ze("error",e),Ze("load",e),o=r;break;case"details":Ze("toggle",e),o=r;break;case"input":Gv(e,r),o=id(e,r),Ze("invalid",e);break;case"option":o=r;break;case"select":e._wrapperState={wasMultiple:!!r.multiple},o=ct({},r,{value:void 0}),Ze("invalid",e);break;case"textarea":Kv(e,r),o=ud(e,r),Ze("invalid",e);break;default:o=r}cd(n,o),s=o;for(i in s)if(s.hasOwnProperty(i)){var u=s[i];i==="style"?i0(e,u):i==="dangerouslySetInnerHTML"?(u=u?u.__html:void 0,u!=null&&r0(e,u)):i==="children"?typeof u=="string"?(n!=="textarea"||u!=="")&&fs(e,u):typeof u=="number"&&fs(e,""+u):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(cs.hasOwnProperty(i)?u!=null&&i==="onScroll"&&Ze("scroll",e):u!=null&&Nh(e,i,u,a))}switch(n){case"input":du(e),qv(e,r,!1);break;case"textarea":du(e),Xv(e);break;case"option":r.value!=null&&e.setAttribute("value",""+ko(r.value));break;case"select":e.multiple=!!r.multiple,i=r.value,i!=null?Yi(e,!!r.multiple,i,!1):r.defaultValue!=null&&Yi(e,!!r.multiple,r.defaultValue,!0);break;default:typeof o.onClick=="function"&&(e.onclick=fl)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return Ht(t),null;case 6:if(e&&t.stateNode!=null)I1(e,t,e.memoizedProps,r);else{if(typeof r!="string"&&t.stateNode===null)throw Error(J(166));if(n=qo(Es.current),qo(_r.current),bu(t)){if(r=t.stateNode,n=t.memoizedProps,r[xr]=t,(i=r.nodeValue!==n)&&(e=In,e!==null))switch(e.tag){case 3:wu(r.nodeValue,n,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&wu(r.nodeValue,n,(e.mode&1)!==0)}i&&(t.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[xr]=t,t.stateNode=r}return Ht(t),null;case 13:if(tt(at),r=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(rt&&_n!==null&&t.mode&1&&!(t.flags&128))G0(),da(),t.flags|=98560,i=!1;else if(i=bu(t),r!==null&&r.dehydrated!==null){if(e===null){if(!i)throw Error(J(318));if(i=t.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(J(317));i[xr]=t}else da(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;Ht(t),i=!1}else er!==null&&(Hd(er),er=null),i=!0;if(!i)return t.flags&65536?t:null}return t.flags&128?(t.lanes=n,t):(r=r!==null,r!==(e!==null&&e.memoizedState!==null)&&r&&(t.child.flags|=8192,t.mode&1&&(e===null||at.current&1?_t===0&&(_t=3):hp())),t.updateQueue!==null&&(t.flags|=4),Ht(t),null);case 4:return pa(),Ld(e,t),e===null&&ys(t.stateNode.containerInfo),Ht(t),null;case 10:return Yh(t.type._context),Ht(t),null;case 17:return dn(t.type)&&dl(),Ht(t),null;case 19:if(tt(at),i=t.memoizedState,i===null)return Ht(t),null;if(r=(t.flags&128)!==0,a=i.rendering,a===null)if(r)La(i,!1);else{if(_t!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(a=xl(e),a!==null){for(t.flags|=128,La(i,!1),r=a.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),t.subtreeFlags=0,r=n,n=t.child;n!==null;)i=n,e=r,i.flags&=14680066,a=i.alternate,a===null?(i.childLanes=0,i.lanes=e,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=a.childLanes,i.lanes=a.lanes,i.child=a.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=a.memoizedProps,i.memoizedState=a.memoizedState,i.updateQueue=a.updateQueue,i.type=a.type,e=a.dependencies,i.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return Ke(at,at.current&1|2),t.child}e=e.sibling}i.tail!==null&&vt()>ma&&(t.flags|=128,r=!0,La(i,!1),t.lanes=4194304)}else{if(!r)if(e=xl(a),e!==null){if(t.flags|=128,r=!0,n=e.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),La(i,!0),i.tail===null&&i.tailMode==="hidden"&&!a.alternate&&!rt)return Ht(t),null}else 2*vt()-i.renderingStartTime>ma&&n!==1073741824&&(t.flags|=128,r=!0,La(i,!1),t.lanes=4194304);i.isBackwards?(a.sibling=t.child,t.child=a):(n=i.last,n!==null?n.sibling=a:t.child=a,i.last=a)}return i.tail!==null?(t=i.tail,i.rendering=t,i.tail=t.sibling,i.renderingStartTime=vt(),t.sibling=null,n=at.current,Ke(at,r?n&1|2:n&1),t):(Ht(t),null);case 22:case 23:return dp(),r=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==r&&(t.flags|=8192),r&&t.mode&1?wn&1073741824&&(Ht(t),t.subtreeFlags&6&&(t.flags|=8192)):Ht(t),null;case 24:return null;case 25:return null}throw Error(J(156,t.tag))}function fC(e,t){switch(Gh(t),t.tag){case 1:return dn(t.type)&&dl(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return pa(),tt(fn),tt(Jt),tp(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return ep(t),null;case 13:if(tt(at),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(J(340));da()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return tt(at),null;case 4:return pa(),null;case 10:return Yh(t.type._context),null;case 22:case 23:return dp(),null;case 24:return null;default:return null}}var _u=!1,qt=!1,dC=typeof WeakSet=="function"?WeakSet:Set,ie=null;function qi(e,t){var n=e.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){pt(e,t,r)}else n.current=null}function Bd(e,t,n){try{n()}catch(r){pt(e,t,r)}}var Bm=!1;function hC(e,t){if(bd=ul,e=P0(),$h(e)){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{n=(n=e.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var o=r.anchorOffset,i=r.focusNode;r=r.focusOffset;try{n.nodeType,i.nodeType}catch{n=null;break e}var a=0,s=-1,u=-1,l=0,c=0,f=e,d=null;t:for(;;){for(var h;f!==n||o!==0&&f.nodeType!==3||(s=a+o),f!==i||r!==0&&f.nodeType!==3||(u=a+r),f.nodeType===3&&(a+=f.nodeValue.length),(h=f.firstChild)!==null;)d=f,f=h;for(;;){if(f===e)break t;if(d===n&&++l===o&&(s=a),d===i&&++c===r&&(u=a),(h=f.nextSibling)!==null)break;f=d,d=f.parentNode}f=h}n=s===-1||u===-1?null:{start:s,end:u}}else n=null}n=n||{start:0,end:0}}else n=null;for(Ed={focusedElem:e,selectionRange:n},ul=!1,ie=t;ie!==null;)if(t=ie,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,ie=e;else for(;ie!==null;){t=ie;try{var p=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(p!==null){var v=p.memoizedProps,g=p.memoizedState,m=t.stateNode,y=m.getSnapshotBeforeUpdate(t.elementType===t.type?v:Qn(t.type,v),g);m.__reactInternalSnapshotBeforeUpdate=y}break;case 3:var x=t.stateNode.containerInfo;x.nodeType===1?x.textContent="":x.nodeType===9&&x.documentElement&&x.removeChild(x.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(J(163))}}catch(w){pt(t,t.return,w)}if(e=t.sibling,e!==null){e.return=t.return,ie=e;break}ie=t.return}return p=Bm,Bm=!1,p}function os(e,t,n){var r=t.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var o=r=r.next;do{if((o.tag&e)===e){var i=o.destroy;o.destroy=void 0,i!==void 0&&Bd(t,n,i)}o=o.next}while(o!==r)}}function fc(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var n=t=t.next;do{if((n.tag&e)===e){var r=n.create;n.destroy=r()}n=n.next}while(n!==t)}}function Ud(e){var t=e.ref;if(t!==null){var n=e.stateNode;switch(e.tag){case 5:e=n;break;default:e=n}typeof t=="function"?t(e):t.current=e}}function D1(e){var t=e.alternate;t!==null&&(e.alternate=null,D1(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[xr],delete t[ws],delete t[Sd],delete t[XE],delete t[YE])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function T1(e){return e.tag===5||e.tag===3||e.tag===4}function Um(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||T1(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function Wd(e,t,n){var r=e.tag;if(r===5||r===6)e=e.stateNode,t?n.nodeType===8?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(n.nodeType===8?(t=n.parentNode,t.insertBefore(e,n)):(t=n,t.appendChild(e)),n=n._reactRootContainer,n!=null||t.onclick!==null||(t.onclick=fl));else if(r!==4&&(e=e.child,e!==null))for(Wd(e,t,n),e=e.sibling;e!==null;)Wd(e,t,n),e=e.sibling}function zd(e,t,n){var r=e.tag;if(r===5||r===6)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(r!==4&&(e=e.child,e!==null))for(zd(e,t,n),e=e.sibling;e!==null;)zd(e,t,n),e=e.sibling}var Lt=null,Jn=!1;function no(e,t,n){for(n=n.child;n!==null;)N1(e,t,n),n=n.sibling}function N1(e,t,n){if(Cr&&typeof Cr.onCommitFiberUnmount=="function")try{Cr.onCommitFiberUnmount(rc,n)}catch{}switch(n.tag){case 5:qt||qi(n,t);case 6:var r=Lt,o=Jn;Lt=null,no(e,t,n),Lt=r,Jn=o,Lt!==null&&(Jn?(e=Lt,n=n.stateNode,e.nodeType===8?e.parentNode.removeChild(n):e.removeChild(n)):Lt.removeChild(n.stateNode));break;case 18:Lt!==null&&(Jn?(e=Lt,n=n.stateNode,e.nodeType===8?lf(e.parentNode,n):e.nodeType===1&&lf(e,n),vs(e)):lf(Lt,n.stateNode));break;case 4:r=Lt,o=Jn,Lt=n.stateNode.containerInfo,Jn=!0,no(e,t,n),Lt=r,Jn=o;break;case 0:case 11:case 14:case 15:if(!qt&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){o=r=r.next;do{var i=o,a=i.destroy;i=i.tag,a!==void 0&&(i&2||i&4)&&Bd(n,t,a),o=o.next}while(o!==r)}no(e,t,n);break;case 1:if(!qt&&(qi(n,t),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(s){pt(n,t,s)}no(e,t,n);break;case 21:no(e,t,n);break;case 22:n.mode&1?(qt=(r=qt)||n.memoizedState!==null,no(e,t,n),qt=r):no(e,t,n);break;default:no(e,t,n)}}function Wm(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var n=e.stateNode;n===null&&(n=e.stateNode=new dC),t.forEach(function(r){var o=EC.bind(null,e,r);n.has(r)||(n.add(r),r.then(o,o))})}}function Yn(e,t){var n=t.deletions;if(n!==null)for(var r=0;r<n.length;r++){var o=n[r];try{var i=e,a=t,s=a;e:for(;s!==null;){switch(s.tag){case 5:Lt=s.stateNode,Jn=!1;break e;case 3:Lt=s.stateNode.containerInfo,Jn=!0;break e;case 4:Lt=s.stateNode.containerInfo,Jn=!0;break e}s=s.return}if(Lt===null)throw Error(J(160));N1(i,a,o),Lt=null,Jn=!1;var u=o.alternate;u!==null&&(u.return=null),o.return=null}catch(l){pt(o,t,l)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)A1(t,e),t=t.sibling}function A1(e,t){var n=e.alternate,r=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(Yn(t,e),pr(e),r&4){try{os(3,e,e.return),fc(3,e)}catch(v){pt(e,e.return,v)}try{os(5,e,e.return)}catch(v){pt(e,e.return,v)}}break;case 1:Yn(t,e),pr(e),r&512&&n!==null&&qi(n,n.return);break;case 5:if(Yn(t,e),pr(e),r&512&&n!==null&&qi(n,n.return),e.flags&32){var o=e.stateNode;try{fs(o,"")}catch(v){pt(e,e.return,v)}}if(r&4&&(o=e.stateNode,o!=null)){var i=e.memoizedProps,a=n!==null?n.memoizedProps:i,s=e.type,u=e.updateQueue;if(e.updateQueue=null,u!==null)try{s==="input"&&i.type==="radio"&&i.name!=null&&e0(o,i),fd(s,a);var l=fd(s,i);for(a=0;a<u.length;a+=2){var c=u[a],f=u[a+1];c==="style"?i0(o,f):c==="dangerouslySetInnerHTML"?r0(o,f):c==="children"?fs(o,f):Nh(o,c,f,l)}switch(s){case"input":ad(o,i);break;case"textarea":t0(o,i);break;case"select":var d=o._wrapperState.wasMultiple;o._wrapperState.wasMultiple=!!i.multiple;var h=i.value;h!=null?Yi(o,!!i.multiple,h,!1):d!==!!i.multiple&&(i.defaultValue!=null?Yi(o,!!i.multiple,i.defaultValue,!0):Yi(o,!!i.multiple,i.multiple?[]:"",!1))}o[ws]=i}catch(v){pt(e,e.return,v)}}break;case 6:if(Yn(t,e),pr(e),r&4){if(e.stateNode===null)throw Error(J(162));o=e.stateNode,i=e.memoizedProps;try{o.nodeValue=i}catch(v){pt(e,e.return,v)}}break;case 3:if(Yn(t,e),pr(e),r&4&&n!==null&&n.memoizedState.isDehydrated)try{vs(t.containerInfo)}catch(v){pt(e,e.return,v)}break;case 4:Yn(t,e),pr(e);break;case 13:Yn(t,e),pr(e),o=e.child,o.flags&8192&&(i=o.memoizedState!==null,o.stateNode.isHidden=i,!i||o.alternate!==null&&o.alternate.memoizedState!==null||(cp=vt())),r&4&&Wm(e);break;case 22:if(c=n!==null&&n.memoizedState!==null,e.mode&1?(qt=(l=qt)||c,Yn(t,e),qt=l):Yn(t,e),pr(e),r&8192){if(l=e.memoizedState!==null,(e.stateNode.isHidden=l)&&!c&&e.mode&1)for(ie=e,c=e.child;c!==null;){for(f=ie=c;ie!==null;){switch(d=ie,h=d.child,d.tag){case 0:case 11:case 14:case 15:os(4,d,d.return);break;case 1:qi(d,d.return);var p=d.stateNode;if(typeof p.componentWillUnmount=="function"){r=d,n=d.return;try{t=r,p.props=t.memoizedProps,p.state=t.memoizedState,p.componentWillUnmount()}catch(v){pt(r,n,v)}}break;case 5:qi(d,d.return);break;case 22:if(d.memoizedState!==null){jm(f);continue}}h!==null?(h.return=d,ie=h):jm(f)}c=c.sibling}e:for(c=null,f=e;;){if(f.tag===5){if(c===null){c=f;try{o=f.stateNode,l?(i=o.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(s=f.stateNode,u=f.memoizedProps.style,a=u!=null&&u.hasOwnProperty("display")?u.display:null,s.style.display=o0("display",a))}catch(v){pt(e,e.return,v)}}}else if(f.tag===6){if(c===null)try{f.stateNode.nodeValue=l?"":f.memoizedProps}catch(v){pt(e,e.return,v)}}else if((f.tag!==22&&f.tag!==23||f.memoizedState===null||f===e)&&f.child!==null){f.child.return=f,f=f.child;continue}if(f===e)break e;for(;f.sibling===null;){if(f.return===null||f.return===e)break e;c===f&&(c=null),f=f.return}c===f&&(c=null),f.sibling.return=f.return,f=f.sibling}}break;case 19:Yn(t,e),pr(e),r&4&&Wm(e);break;case 21:break;default:Yn(t,e),pr(e)}}function pr(e){var t=e.flags;if(t&2){try{e:{for(var n=e.return;n!==null;){if(T1(n)){var r=n;break e}n=n.return}throw Error(J(160))}switch(r.tag){case 5:var o=r.stateNode;r.flags&32&&(fs(o,""),r.flags&=-33);var i=Um(e);zd(e,i,o);break;case 3:case 4:var a=r.stateNode.containerInfo,s=Um(e);Wd(e,s,a);break;default:throw Error(J(161))}}catch(u){pt(e,e.return,u)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function pC(e,t,n){ie=e,P1(e)}function P1(e,t,n){for(var r=(e.mode&1)!==0;ie!==null;){var o=ie,i=o.child;if(o.tag===22&&r){var a=o.memoizedState!==null||_u;if(!a){var s=o.alternate,u=s!==null&&s.memoizedState!==null||qt;s=_u;var l=qt;if(_u=a,(qt=u)&&!l)for(ie=o;ie!==null;)a=ie,u=a.child,a.tag===22&&a.memoizedState!==null?Vm(o):u!==null?(u.return=a,ie=u):Vm(o);for(;i!==null;)ie=i,P1(i),i=i.sibling;ie=o,_u=s,qt=l}zm(e)}else o.subtreeFlags&8772&&i!==null?(i.return=o,ie=i):zm(e)}}function zm(e){for(;ie!==null;){var t=ie;if(t.flags&8772){var n=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:qt||fc(5,t);break;case 1:var r=t.stateNode;if(t.flags&4&&!qt)if(n===null)r.componentDidMount();else{var o=t.elementType===t.type?n.memoizedProps:Qn(t.type,n.memoizedProps);r.componentDidUpdate(o,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var i=t.updateQueue;i!==null&&Sm(t,i,r);break;case 3:var a=t.updateQueue;if(a!==null){if(n=null,t.child!==null)switch(t.child.tag){case 5:n=t.child.stateNode;break;case 1:n=t.child.stateNode}Sm(t,a,n)}break;case 5:var s=t.stateNode;if(n===null&&t.flags&4){n=s;var u=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":u.autoFocus&&n.focus();break;case"img":u.src&&(n.src=u.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var l=t.alternate;if(l!==null){var c=l.memoizedState;if(c!==null){var f=c.dehydrated;f!==null&&vs(f)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(J(163))}qt||t.flags&512&&Ud(t)}catch(d){pt(t,t.return,d)}}if(t===e){ie=null;break}if(n=t.sibling,n!==null){n.return=t.return,ie=n;break}ie=t.return}}function jm(e){for(;ie!==null;){var t=ie;if(t===e){ie=null;break}var n=t.sibling;if(n!==null){n.return=t.return,ie=n;break}ie=t.return}}function Vm(e){for(;ie!==null;){var t=ie;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{fc(4,t)}catch(u){pt(t,n,u)}break;case 1:var r=t.stateNode;if(typeof r.componentDidMount=="function"){var o=t.return;try{r.componentDidMount()}catch(u){pt(t,o,u)}}var i=t.return;try{Ud(t)}catch(u){pt(t,i,u)}break;case 5:var a=t.return;try{Ud(t)}catch(u){pt(t,a,u)}}}catch(u){pt(t,t.return,u)}if(t===e){ie=null;break}var s=t.sibling;if(s!==null){s.return=t.return,ie=s;break}ie=t.return}}var vC=Math.ceil,El=qr.ReactCurrentDispatcher,up=qr.ReactCurrentOwner,Vn=qr.ReactCurrentBatchConfig,Be=0,Pt=null,xt=null,zt=0,wn=0,Ki=Ao(0),_t=0,Rs=null,ii=0,dc=0,lp=0,is=null,sn=null,cp=0,ma=1/0,Or=null,Cl=!1,jd=null,bo=null,Su=!1,ho=null,_l=0,as=0,Vd=null,Yu=-1,Qu=0;function rn(){return Be&6?vt():Yu!==-1?Yu:Yu=vt()}function Eo(e){return e.mode&1?Be&2&&zt!==0?zt&-zt:JE.transition!==null?(Qu===0&&(Qu=g0()),Qu):(e=$e,e!==0||(e=window.event,e=e===void 0?16:_0(e.type)),e):1}function or(e,t,n,r){if(50<as)throw as=0,Vd=null,Error(J(185));Us(e,n,r),(!(Be&2)||e!==Pt)&&(e===Pt&&(!(Be&2)&&(dc|=n),_t===4&&co(e,zt)),hn(e,r),n===1&&Be===0&&!(t.mode&1)&&(ma=vt()+500,uc&&Po()))}function hn(e,t){var n=e.callbackNode;J2(e,t);var r=sl(e,e===Pt?zt:0);if(r===0)n!==null&&Jv(n),e.callbackNode=null,e.callbackPriority=0;else if(t=r&-r,e.callbackPriority!==t){if(n!=null&&Jv(n),t===1)e.tag===0?QE($m.bind(null,e)):V0($m.bind(null,e)),qE(function(){!(Be&6)&&Po()}),n=null;else{switch(y0(r)){case 1:n=Oh;break;case 4:n=v0;break;case 16:n=al;break;case 536870912:n=m0;break;default:n=al}n=z1(n,F1.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function F1(e,t){if(Yu=-1,Qu=0,Be&6)throw Error(J(327));var n=e.callbackNode;if(ta()&&e.callbackNode!==n)return null;var r=sl(e,e===Pt?zt:0);if(r===0)return null;if(r&30||r&e.expiredLanes||t)t=Sl(e,r);else{t=r;var o=Be;Be|=2;var i=O1();(Pt!==e||zt!==t)&&(Or=null,ma=vt()+500,Jo(e,t));do try{yC();break}catch(s){M1(e,s)}while(!0);Xh(),El.current=i,Be=o,xt!==null?t=0:(Pt=null,zt=0,t=_t)}if(t!==0){if(t===2&&(o=md(e),o!==0&&(r=o,t=$d(e,o))),t===1)throw n=Rs,Jo(e,0),co(e,r),hn(e,vt()),n;if(t===6)co(e,r);else{if(o=e.current.alternate,!(r&30)&&!mC(o)&&(t=Sl(e,r),t===2&&(i=md(e),i!==0&&(r=i,t=$d(e,i))),t===1))throw n=Rs,Jo(e,0),co(e,r),hn(e,vt()),n;switch(e.finishedWork=o,e.finishedLanes=r,t){case 0:case 1:throw Error(J(345));case 2:Wo(e,sn,Or);break;case 3:if(co(e,r),(r&130023424)===r&&(t=cp+500-vt(),10<t)){if(sl(e,0)!==0)break;if(o=e.suspendedLanes,(o&r)!==r){rn(),e.pingedLanes|=e.suspendedLanes&o;break}e.timeoutHandle=_d(Wo.bind(null,e,sn,Or),t);break}Wo(e,sn,Or);break;case 4:if(co(e,r),(r&4194240)===r)break;for(t=e.eventTimes,o=-1;0<r;){var a=31-rr(r);i=1<<a,a=t[a],a>o&&(o=a),r&=~i}if(r=o,r=vt()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*vC(r/1960))-r,10<r){e.timeoutHandle=_d(Wo.bind(null,e,sn,Or),r);break}Wo(e,sn,Or);break;case 5:Wo(e,sn,Or);break;default:throw Error(J(329))}}}return hn(e,vt()),e.callbackNode===n?F1.bind(null,e):null}function $d(e,t){var n=is;return e.current.memoizedState.isDehydrated&&(Jo(e,t).flags|=256),e=Sl(e,t),e!==2&&(t=sn,sn=n,t!==null&&Hd(t)),e}function Hd(e){sn===null?sn=e:sn.push.apply(sn,e)}function mC(e){for(var t=e;;){if(t.flags&16384){var n=t.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var o=n[r],i=o.getSnapshot;o=o.value;try{if(!sr(i(),o))return!1}catch{return!1}}}if(n=t.child,t.subtreeFlags&16384&&n!==null)n.return=t,t=n;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function co(e,t){for(t&=~lp,t&=~dc,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-rr(t),r=1<<n;e[n]=-1,t&=~r}}function $m(e){if(Be&6)throw Error(J(327));ta();var t=sl(e,0);if(!(t&1))return hn(e,vt()),null;var n=Sl(e,t);if(e.tag!==0&&n===2){var r=md(e);r!==0&&(t=r,n=$d(e,r))}if(n===1)throw n=Rs,Jo(e,0),co(e,t),hn(e,vt()),n;if(n===6)throw Error(J(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,Wo(e,sn,Or),hn(e,vt()),null}function fp(e,t){var n=Be;Be|=1;try{return e(t)}finally{Be=n,Be===0&&(ma=vt()+500,uc&&Po())}}function ai(e){ho!==null&&ho.tag===0&&!(Be&6)&&ta();var t=Be;Be|=1;var n=Vn.transition,r=$e;try{if(Vn.transition=null,$e=1,e)return e()}finally{$e=r,Vn.transition=n,Be=t,!(Be&6)&&Po()}}function dp(){wn=Ki.current,tt(Ki)}function Jo(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(n!==-1&&(e.timeoutHandle=-1,GE(n)),xt!==null)for(n=xt.return;n!==null;){var r=n;switch(Gh(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&dl();break;case 3:pa(),tt(fn),tt(Jt),tp();break;case 5:ep(r);break;case 4:pa();break;case 13:tt(at);break;case 19:tt(at);break;case 10:Yh(r.type._context);break;case 22:case 23:dp()}n=n.return}if(Pt=e,xt=e=Co(e.current,null),zt=wn=t,_t=0,Rs=null,lp=dc=ii=0,sn=is=null,Go!==null){for(t=0;t<Go.length;t++)if(n=Go[t],r=n.interleaved,r!==null){n.interleaved=null;var o=r.next,i=n.pending;if(i!==null){var a=i.next;i.next=o,r.next=a}n.pending=r}Go=null}return e}function M1(e,t){do{var n=xt;try{if(Xh(),qu.current=bl,wl){for(var r=lt.memoizedState;r!==null;){var o=r.queue;o!==null&&(o.pending=null),r=r.next}wl=!1}if(oi=0,Nt=Ct=lt=null,rs=!1,Cs=0,up.current=null,n===null||n.return===null){_t=1,Rs=t,xt=null;break}e:{var i=e,a=n.return,s=n,u=t;if(t=zt,s.flags|=32768,u!==null&&typeof u=="object"&&typeof u.then=="function"){var l=u,c=s,f=c.tag;if(!(c.mode&1)&&(f===0||f===11||f===15)){var d=c.alternate;d?(c.updateQueue=d.updateQueue,c.memoizedState=d.memoizedState,c.lanes=d.lanes):(c.updateQueue=null,c.memoizedState=null)}var h=Nm(a);if(h!==null){h.flags&=-257,Am(h,a,s,i,t),h.mode&1&&Tm(i,l,t),t=h,u=l;var p=t.updateQueue;if(p===null){var v=new Set;v.add(u),t.updateQueue=v}else p.add(u);break e}else{if(!(t&1)){Tm(i,l,t),hp();break e}u=Error(J(426))}}else if(rt&&s.mode&1){var g=Nm(a);if(g!==null){!(g.flags&65536)&&(g.flags|=256),Am(g,a,s,i,t),qh(va(u,s));break e}}i=u=va(u,s),_t!==4&&(_t=2),is===null?is=[i]:is.push(i),i=a;do{switch(i.tag){case 3:i.flags|=65536,t&=-t,i.lanes|=t;var m=y1(i,u,t);_m(i,m);break e;case 1:s=u;var y=i.type,x=i.stateNode;if(!(i.flags&128)&&(typeof y.getDerivedStateFromError=="function"||x!==null&&typeof x.componentDidCatch=="function"&&(bo===null||!bo.has(x)))){i.flags|=65536,t&=-t,i.lanes|=t;var w=x1(i,s,t);_m(i,w);break e}}i=i.return}while(i!==null)}B1(n)}catch(E){t=E,xt===n&&n!==null&&(xt=n=n.return);continue}break}while(!0)}function O1(){var e=El.current;return El.current=bl,e===null?bl:e}function hp(){(_t===0||_t===3||_t===2)&&(_t=4),Pt===null||!(ii&268435455)&&!(dc&268435455)||co(Pt,zt)}function Sl(e,t){var n=Be;Be|=2;var r=O1();(Pt!==e||zt!==t)&&(Or=null,Jo(e,t));do try{gC();break}catch(o){M1(e,o)}while(!0);if(Xh(),Be=n,El.current=r,xt!==null)throw Error(J(261));return Pt=null,zt=0,_t}function gC(){for(;xt!==null;)L1(xt)}function yC(){for(;xt!==null&&!V2();)L1(xt)}function L1(e){var t=W1(e.alternate,e,wn);e.memoizedProps=e.pendingProps,t===null?B1(e):xt=t,up.current=null}function B1(e){var t=e;do{var n=t.alternate;if(e=t.return,t.flags&32768){if(n=fC(n,t),n!==null){n.flags&=32767,xt=n;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{_t=6,xt=null;return}}else if(n=cC(n,t,wn),n!==null){xt=n;return}if(t=t.sibling,t!==null){xt=t;return}xt=t=e}while(t!==null);_t===0&&(_t=5)}function Wo(e,t,n){var r=$e,o=Vn.transition;try{Vn.transition=null,$e=1,xC(e,t,n,r)}finally{Vn.transition=o,$e=r}return null}function xC(e,t,n,r){do ta();while(ho!==null);if(Be&6)throw Error(J(327));n=e.finishedWork;var o=e.finishedLanes;if(n===null)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(J(177));e.callbackNode=null,e.callbackPriority=0;var i=n.lanes|n.childLanes;if(Z2(e,i),e===Pt&&(xt=Pt=null,zt=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||Su||(Su=!0,z1(al,function(){return ta(),null})),i=(n.flags&15990)!==0,n.subtreeFlags&15990||i){i=Vn.transition,Vn.transition=null;var a=$e;$e=1;var s=Be;Be|=4,up.current=null,hC(e,n),A1(n,e),UE(Ed),ul=!!bd,Ed=bd=null,e.current=n,pC(n),$2(),Be=s,$e=a,Vn.transition=i}else e.current=n;if(Su&&(Su=!1,ho=e,_l=o),i=e.pendingLanes,i===0&&(bo=null),q2(n.stateNode),hn(e,vt()),t!==null)for(r=e.onRecoverableError,n=0;n<t.length;n++)o=t[n],r(o.value,{componentStack:o.stack,digest:o.digest});if(Cl)throw Cl=!1,e=jd,jd=null,e;return _l&1&&e.tag!==0&&ta(),i=e.pendingLanes,i&1?e===Vd?as++:(as=0,Vd=e):as=0,Po(),null}function ta(){if(ho!==null){var e=y0(_l),t=Vn.transition,n=$e;try{if(Vn.transition=null,$e=16>e?16:e,ho===null)var r=!1;else{if(e=ho,ho=null,_l=0,Be&6)throw Error(J(331));var o=Be;for(Be|=4,ie=e.current;ie!==null;){var i=ie,a=i.child;if(ie.flags&16){var s=i.deletions;if(s!==null){for(var u=0;u<s.length;u++){var l=s[u];for(ie=l;ie!==null;){var c=ie;switch(c.tag){case 0:case 11:case 15:os(8,c,i)}var f=c.child;if(f!==null)f.return=c,ie=f;else for(;ie!==null;){c=ie;var d=c.sibling,h=c.return;if(D1(c),c===l){ie=null;break}if(d!==null){d.return=h,ie=d;break}ie=h}}}var p=i.alternate;if(p!==null){var v=p.child;if(v!==null){p.child=null;do{var g=v.sibling;v.sibling=null,v=g}while(v!==null)}}ie=i}}if(i.subtreeFlags&2064&&a!==null)a.return=i,ie=a;else e:for(;ie!==null;){if(i=ie,i.flags&2048)switch(i.tag){case 0:case 11:case 15:os(9,i,i.return)}var m=i.sibling;if(m!==null){m.return=i.return,ie=m;break e}ie=i.return}}var y=e.current;for(ie=y;ie!==null;){a=ie;var x=a.child;if(a.subtreeFlags&2064&&x!==null)x.return=a,ie=x;else e:for(a=y;ie!==null;){if(s=ie,s.flags&2048)try{switch(s.tag){case 0:case 11:case 15:fc(9,s)}}catch(E){pt(s,s.return,E)}if(s===a){ie=null;break e}var w=s.sibling;if(w!==null){w.return=s.return,ie=w;break e}ie=s.return}}if(Be=o,Po(),Cr&&typeof Cr.onPostCommitFiberRoot=="function")try{Cr.onPostCommitFiberRoot(rc,e)}catch{}r=!0}return r}finally{$e=n,Vn.transition=t}}return!1}function Hm(e,t,n){t=va(n,t),t=y1(e,t,1),e=wo(e,t,1),t=rn(),e!==null&&(Us(e,1,t),hn(e,t))}function pt(e,t,n){if(e.tag===3)Hm(e,e,n);else for(;t!==null;){if(t.tag===3){Hm(t,e,n);break}else if(t.tag===1){var r=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(bo===null||!bo.has(r))){e=va(n,e),e=x1(t,e,1),t=wo(t,e,1),e=rn(),t!==null&&(Us(t,1,e),hn(t,e));break}}t=t.return}}function wC(e,t,n){var r=e.pingCache;r!==null&&r.delete(t),t=rn(),e.pingedLanes|=e.suspendedLanes&n,Pt===e&&(zt&n)===n&&(_t===4||_t===3&&(zt&130023424)===zt&&500>vt()-cp?Jo(e,0):lp|=n),hn(e,t)}function U1(e,t){t===0&&(e.mode&1?(t=vu,vu<<=1,!(vu&130023424)&&(vu=4194304)):t=1);var n=rn();e=Hr(e,t),e!==null&&(Us(e,t,n),hn(e,n))}function bC(e){var t=e.memoizedState,n=0;t!==null&&(n=t.retryLane),U1(e,n)}function EC(e,t){var n=0;switch(e.tag){case 13:var r=e.stateNode,o=e.memoizedState;o!==null&&(n=o.retryLane);break;case 19:r=e.stateNode;break;default:throw Error(J(314))}r!==null&&r.delete(t),U1(e,n)}var W1;W1=function(e,t,n){if(e!==null)if(e.memoizedProps!==t.pendingProps||fn.current)cn=!0;else{if(!(e.lanes&n)&&!(t.flags&128))return cn=!1,lC(e,t,n);cn=!!(e.flags&131072)}else cn=!1,rt&&t.flags&1048576&&$0(t,vl,t.index);switch(t.lanes=0,t.tag){case 2:var r=t.type;Xu(e,t),e=t.pendingProps;var o=fa(t,Jt.current);ea(t,n),o=rp(null,t,r,e,o,n);var i=op();return t.flags|=1,typeof o=="object"&&o!==null&&typeof o.render=="function"&&o.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,dn(r)?(i=!0,hl(t)):i=!1,t.memoizedState=o.state!==null&&o.state!==void 0?o.state:null,Jh(t),o.updater=cc,t.stateNode=o,o._reactInternals=t,Nd(t,r,e,n),t=Fd(null,t,r,!0,i,n)):(t.tag=0,rt&&i&&Hh(t),nn(null,t,o,n),t=t.child),t;case 16:r=t.elementType;e:{switch(Xu(e,t),e=t.pendingProps,o=r._init,r=o(r._payload),t.type=r,o=t.tag=_C(r),e=Qn(r,e),o){case 0:t=Pd(null,t,r,e,n);break e;case 1:t=Mm(null,t,r,e,n);break e;case 11:t=Pm(null,t,r,e,n);break e;case 14:t=Fm(null,t,r,Qn(r.type,e),n);break e}throw Error(J(306,r,""))}return t;case 0:return r=t.type,o=t.pendingProps,o=t.elementType===r?o:Qn(r,o),Pd(e,t,r,o,n);case 1:return r=t.type,o=t.pendingProps,o=t.elementType===r?o:Qn(r,o),Mm(e,t,r,o,n);case 3:e:{if(C1(t),e===null)throw Error(J(387));r=t.pendingProps,i=t.memoizedState,o=i.element,Y0(e,t),yl(t,r,null,n);var a=t.memoizedState;if(r=a.element,i.isDehydrated)if(i={element:r,isDehydrated:!1,cache:a.cache,pendingSuspenseBoundaries:a.pendingSuspenseBoundaries,transitions:a.transitions},t.updateQueue.baseState=i,t.memoizedState=i,t.flags&256){o=va(Error(J(423)),t),t=Om(e,t,r,n,o);break e}else if(r!==o){o=va(Error(J(424)),t),t=Om(e,t,r,n,o);break e}else for(_n=xo(t.stateNode.containerInfo.firstChild),In=t,rt=!0,er=null,n=K0(t,null,r,n),t.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(da(),r===o){t=Gr(e,t,n);break e}nn(e,t,r,n)}t=t.child}return t;case 5:return Q0(t),e===null&&Id(t),r=t.type,o=t.pendingProps,i=e!==null?e.memoizedProps:null,a=o.children,Cd(r,o)?a=null:i!==null&&Cd(r,i)&&(t.flags|=32),E1(e,t),nn(e,t,a,n),t.child;case 6:return e===null&&Id(t),null;case 13:return _1(e,t,n);case 4:return Zh(t,t.stateNode.containerInfo),r=t.pendingProps,e===null?t.child=ha(t,null,r,n):nn(e,t,r,n),t.child;case 11:return r=t.type,o=t.pendingProps,o=t.elementType===r?o:Qn(r,o),Pm(e,t,r,o,n);case 7:return nn(e,t,t.pendingProps,n),t.child;case 8:return nn(e,t,t.pendingProps.children,n),t.child;case 12:return nn(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(r=t.type._context,o=t.pendingProps,i=t.memoizedProps,a=o.value,Ke(ml,r._currentValue),r._currentValue=a,i!==null)if(sr(i.value,a)){if(i.children===o.children&&!fn.current){t=Gr(e,t,n);break e}}else for(i=t.child,i!==null&&(i.return=t);i!==null;){var s=i.dependencies;if(s!==null){a=i.child;for(var u=s.firstContext;u!==null;){if(u.context===r){if(i.tag===1){u=zr(-1,n&-n),u.tag=2;var l=i.updateQueue;if(l!==null){l=l.shared;var c=l.pending;c===null?u.next=u:(u.next=c.next,c.next=u),l.pending=u}}i.lanes|=n,u=i.alternate,u!==null&&(u.lanes|=n),Dd(i.return,n,t),s.lanes|=n;break}u=u.next}}else if(i.tag===10)a=i.type===t.type?null:i.child;else if(i.tag===18){if(a=i.return,a===null)throw Error(J(341));a.lanes|=n,s=a.alternate,s!==null&&(s.lanes|=n),Dd(a,n,t),a=i.sibling}else a=i.child;if(a!==null)a.return=i;else for(a=i;a!==null;){if(a===t){a=null;break}if(i=a.sibling,i!==null){i.return=a.return,a=i;break}a=a.return}i=a}nn(e,t,o.children,n),t=t.child}return t;case 9:return o=t.type,r=t.pendingProps.children,ea(t,n),o=Hn(o),r=r(o),t.flags|=1,nn(e,t,r,n),t.child;case 14:return r=t.type,o=Qn(r,t.pendingProps),o=Qn(r.type,o),Fm(e,t,r,o,n);case 15:return w1(e,t,t.type,t.pendingProps,n);case 17:return r=t.type,o=t.pendingProps,o=t.elementType===r?o:Qn(r,o),Xu(e,t),t.tag=1,dn(r)?(e=!0,hl(t)):e=!1,ea(t,n),g1(t,r,o),Nd(t,r,o,n),Fd(null,t,r,!0,e,n);case 19:return S1(e,t,n);case 22:return b1(e,t,n)}throw Error(J(156,t.tag))};function z1(e,t){return p0(e,t)}function CC(e,t,n,r){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function zn(e,t,n,r){return new CC(e,t,n,r)}function pp(e){return e=e.prototype,!(!e||!e.isReactComponent)}function _C(e){if(typeof e=="function")return pp(e)?1:0;if(e!=null){if(e=e.$$typeof,e===Ph)return 11;if(e===Fh)return 14}return 2}function Co(e,t){var n=e.alternate;return n===null?(n=zn(e.tag,t,e.key,e.mode),n.elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=e.flags&14680064,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function Ju(e,t,n,r,o,i){var a=2;if(r=e,typeof e=="function")pp(e)&&(a=1);else if(typeof e=="string")a=5;else e:switch(e){case Bi:return Zo(n.children,o,i,t);case Ah:a=8,o|=8;break;case td:return e=zn(12,n,t,o|2),e.elementType=td,e.lanes=i,e;case nd:return e=zn(13,n,t,o),e.elementType=nd,e.lanes=i,e;case rd:return e=zn(19,n,t,o),e.elementType=rd,e.lanes=i,e;case Qy:return hc(n,o,i,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case Xy:a=10;break e;case Yy:a=9;break e;case Ph:a=11;break e;case Fh:a=14;break e;case so:a=16,r=null;break e}throw Error(J(130,e==null?e:typeof e,""))}return t=zn(a,n,t,o),t.elementType=e,t.type=r,t.lanes=i,t}function Zo(e,t,n,r){return e=zn(7,e,r,t),e.lanes=n,e}function hc(e,t,n,r){return e=zn(22,e,r,t),e.elementType=Qy,e.lanes=n,e.stateNode={isHidden:!1},e}function gf(e,t,n){return e=zn(6,e,null,t),e.lanes=n,e}function yf(e,t,n){return t=zn(4,e.children!==null?e.children:[],e.key,t),t.lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function SC(e,t,n,r,o){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Qc(0),this.expirationTimes=Qc(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Qc(0),this.identifierPrefix=r,this.onRecoverableError=o,this.mutableSourceEagerHydrationData=null}function vp(e,t,n,r,o,i,a,s,u){return e=new SC(e,t,n,s,u),t===1?(t=1,i===!0&&(t|=8)):t=0,i=zn(3,null,null,t),e.current=i,i.stateNode=e,i.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Jh(i),e}function RC(e,t,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Li,key:r==null?null:""+r,children:e,containerInfo:t,implementation:n}}function j1(e){if(!e)return Io;e=e._reactInternals;e:{if(di(e)!==e||e.tag!==1)throw Error(J(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(dn(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(J(171))}if(e.tag===1){var n=e.type;if(dn(n))return j0(e,n,t)}return t}function V1(e,t,n,r,o,i,a,s,u){return e=vp(n,r,!0,e,o,i,a,s,u),e.context=j1(null),n=e.current,r=rn(),o=Eo(n),i=zr(r,o),i.callback=t??null,wo(n,i,o),e.current.lanes=o,Us(e,o,r),hn(e,r),e}function pc(e,t,n,r){var o=t.current,i=rn(),a=Eo(o);return n=j1(n),t.context===null?t.context=n:t.pendingContext=n,t=zr(i,a),t.payload={element:e},r=r===void 0?null:r,r!==null&&(t.callback=r),e=wo(o,t,a),e!==null&&(or(e,o,a,i),Gu(e,o,a)),a}function Rl(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function Gm(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var n=e.retryLane;e.retryLane=n!==0&&n<t?n:t}}function mp(e,t){Gm(e,t),(e=e.alternate)&&Gm(e,t)}function kC(){return null}var $1=typeof reportError=="function"?reportError:function(e){console.error(e)};function gp(e){this._internalRoot=e}vc.prototype.render=gp.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(J(409));pc(e,t,null,null)};vc.prototype.unmount=gp.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;ai(function(){pc(null,e,null,null)}),t[$r]=null}};function vc(e){this._internalRoot=e}vc.prototype.unstable_scheduleHydration=function(e){if(e){var t=b0();e={blockedOn:null,target:e,priority:t};for(var n=0;n<lo.length&&t!==0&&t<lo[n].priority;n++);lo.splice(n,0,e),n===0&&C0(e)}};function yp(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function mc(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function qm(){}function IC(e,t,n,r,o){if(o){if(typeof r=="function"){var i=r;r=function(){var l=Rl(a);i.call(l)}}var a=V1(t,r,e,0,null,!1,!1,"",qm);return e._reactRootContainer=a,e[$r]=a.current,ys(e.nodeType===8?e.parentNode:e),ai(),a}for(;o=e.lastChild;)e.removeChild(o);if(typeof r=="function"){var s=r;r=function(){var l=Rl(u);s.call(l)}}var u=vp(e,0,!1,null,null,!1,!1,"",qm);return e._reactRootContainer=u,e[$r]=u.current,ys(e.nodeType===8?e.parentNode:e),ai(function(){pc(t,u,n,r)}),u}function gc(e,t,n,r,o){var i=n._reactRootContainer;if(i){var a=i;if(typeof o=="function"){var s=o;o=function(){var u=Rl(a);s.call(u)}}pc(t,a,e,o)}else a=IC(n,t,e,o,r);return Rl(a)}x0=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=Xa(t.pendingLanes);n!==0&&(Lh(t,n|1),hn(t,vt()),!(Be&6)&&(ma=vt()+500,Po()))}break;case 13:ai(function(){var r=Hr(e,1);if(r!==null){var o=rn();or(r,e,1,o)}}),mp(e,1)}};Bh=function(e){if(e.tag===13){var t=Hr(e,134217728);if(t!==null){var n=rn();or(t,e,134217728,n)}mp(e,134217728)}};w0=function(e){if(e.tag===13){var t=Eo(e),n=Hr(e,t);if(n!==null){var r=rn();or(n,e,t,r)}mp(e,t)}};b0=function(){return $e};E0=function(e,t){var n=$e;try{return $e=e,t()}finally{$e=n}};hd=function(e,t,n){switch(t){case"input":if(ad(e,n),t=n.name,n.type==="radio"&&t!=null){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var r=n[t];if(r!==e&&r.form===e.form){var o=sc(r);if(!o)throw Error(J(90));Zy(r),ad(r,o)}}}break;case"textarea":t0(e,n);break;case"select":t=n.value,t!=null&&Yi(e,!!n.multiple,t,!1)}};u0=fp;l0=ai;var DC={usingClientEntryPoint:!1,Events:[zs,ji,sc,a0,s0,fp]},Ba={findFiberByHostInstance:Ho,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},TC={bundleType:Ba.bundleType,version:Ba.version,rendererPackageName:Ba.rendererPackageName,rendererConfig:Ba.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:qr.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=d0(e),e===null?null:e.stateNode},findFiberByHostInstance:Ba.findFiberByHostInstance||kC,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Ru=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Ru.isDisabled&&Ru.supportsFiber)try{rc=Ru.inject(TC),Cr=Ru}catch{}}Nn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=DC;Nn.createPortal=function(e,t){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!yp(t))throw Error(J(200));return RC(e,t,null,n)};Nn.createRoot=function(e,t){if(!yp(e))throw Error(J(299));var n=!1,r="",o=$1;return t!=null&&(t.unstable_strictMode===!0&&(n=!0),t.identifierPrefix!==void 0&&(r=t.identifierPrefix),t.onRecoverableError!==void 0&&(o=t.onRecoverableError)),t=vp(e,1,!1,null,null,n,!1,r,o),e[$r]=t.current,ys(e.nodeType===8?e.parentNode:e),new gp(t)};Nn.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(J(188)):(e=Object.keys(e).join(","),Error(J(268,e)));return e=d0(t),e=e===null?null:e.stateNode,e};Nn.flushSync=function(e){return ai(e)};Nn.hydrate=function(e,t,n){if(!mc(t))throw Error(J(200));return gc(null,e,t,!0,n)};Nn.hydrateRoot=function(e,t,n){if(!yp(e))throw Error(J(405));var r=n!=null&&n.hydratedSources||null,o=!1,i="",a=$1;if(n!=null&&(n.unstable_strictMode===!0&&(o=!0),n.identifierPrefix!==void 0&&(i=n.identifierPrefix),n.onRecoverableError!==void 0&&(a=n.onRecoverableError)),t=V1(t,null,e,1,n??null,o,!1,i,a),e[$r]=t.current,ys(e),r)for(e=0;e<r.length;e++)n=r[e],o=n._getVersion,o=o(n._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[n,o]:t.mutableSourceEagerHydrationData.push(n,o);return new vc(t)};Nn.render=function(e,t,n){if(!mc(t))throw Error(J(200));return gc(null,e,t,!1,n)};Nn.unmountComponentAtNode=function(e){if(!mc(e))throw Error(J(40));return e._reactRootContainer?(ai(function(){gc(null,null,e,!1,function(){e._reactRootContainer=null,e[$r]=null})}),!0):!1};Nn.unstable_batchedUpdates=fp;Nn.unstable_renderSubtreeIntoContainer=function(e,t,n,r){if(!mc(n))throw Error(J(200));if(e==null||e._reactInternals===void 0)throw Error(J(38));return gc(e,t,n,!1,r)};Nn.version="18.3.1-next-f1338f8080-20240426";function H1(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(H1)}catch(e){console.error(e)}}H1(),Hy.exports=Nn;var xp=Hy.exports;const NC=_h(xp),AC=Ay({__proto__:null,default:NC},[xp]);var Km=xp;Zf.createRoot=Km.createRoot,Zf.hydrateRoot=Km.hydrateRoot;/**
 * @remix-run/router v1.19.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function it(){return it=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},it.apply(this,arguments)}var yt;(function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"})(yt||(yt={}));const Xm="popstate";function PC(e){e===void 0&&(e={});function t(r,o){let{pathname:i,search:a,hash:s}=r.location;return ks("",{pathname:i,search:a,hash:s},o.state&&o.state.usr||null,o.state&&o.state.key||"default")}function n(r,o){return typeof o=="string"?o:si(o)}return MC(t,n,null,e)}function Ne(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function ga(e,t){if(!e){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function FC(){return Math.random().toString(36).substr(2,8)}function Ym(e,t){return{usr:e.state,key:e.key,idx:t}}function ks(e,t,n,r){return n===void 0&&(n=null),it({pathname:typeof e=="string"?e:e.pathname,search:"",hash:""},typeof t=="string"?Fo(t):t,{state:n,key:t&&t.key||r||FC()})}function si(e){let{pathname:t="/",search:n="",hash:r=""}=e;return n&&n!=="?"&&(t+=n.charAt(0)==="?"?n:"?"+n),r&&r!=="#"&&(t+=r.charAt(0)==="#"?r:"#"+r),t}function Fo(e){let t={};if(e){let n=e.indexOf("#");n>=0&&(t.hash=e.substr(n),e=e.substr(0,n));let r=e.indexOf("?");r>=0&&(t.search=e.substr(r),e=e.substr(0,r)),e&&(t.pathname=e)}return t}function MC(e,t,n,r){r===void 0&&(r={});let{window:o=document.defaultView,v5Compat:i=!1}=r,a=o.history,s=yt.Pop,u=null,l=c();l==null&&(l=0,a.replaceState(it({},a.state,{idx:l}),""));function c(){return(a.state||{idx:null}).idx}function f(){s=yt.Pop;let g=c(),m=g==null?null:g-l;l=g,u&&u({action:s,location:v.location,delta:m})}function d(g,m){s=yt.Push;let y=ks(v.location,g,m);l=c()+1;let x=Ym(y,l),w=v.createHref(y);try{a.pushState(x,"",w)}catch(E){if(E instanceof DOMException&&E.name==="DataCloneError")throw E;o.location.assign(w)}i&&u&&u({action:s,location:v.location,delta:1})}function h(g,m){s=yt.Replace;let y=ks(v.location,g,m);l=c();let x=Ym(y,l),w=v.createHref(y);a.replaceState(x,"",w),i&&u&&u({action:s,location:v.location,delta:0})}function p(g){let m=o.location.origin!=="null"?o.location.origin:o.location.href,y=typeof g=="string"?g:si(g);return y=y.replace(/ $/,"%20"),Ne(m,"No window.location.(origin|href) available to create URL for href: "+y),new URL(y,m)}let v={get action(){return s},get location(){return e(o,a)},listen(g){if(u)throw new Error("A history only accepts one active listener");return o.addEventListener(Xm,f),u=g,()=>{o.removeEventListener(Xm,f),u=null}},createHref(g){return t(o,g)},createURL:p,encodeLocation(g){let m=p(g);return{pathname:m.pathname,search:m.search,hash:m.hash}},push:d,replace:h,go(g){return a.go(g)}};return v}var Ge;(function(e){e.data="data",e.deferred="deferred",e.redirect="redirect",e.error="error"})(Ge||(Ge={}));const OC=new Set(["lazy","caseSensitive","path","id","index","children"]);function LC(e){return e.index===!0}function Is(e,t,n,r){return n===void 0&&(n=[]),r===void 0&&(r={}),e.map((o,i)=>{let a=[...n,String(i)],s=typeof o.id=="string"?o.id:a.join("-");if(Ne(o.index!==!0||!o.children,"Cannot specify children on an index route"),Ne(!r[s],'Found a route id collision on id "'+s+`".  Route id's must be globally unique within Data Router usages`),LC(o)){let u=it({},o,t(o),{id:s});return r[s]=u,u}else{let u=it({},o,t(o),{id:s,children:void 0});return r[s]=u,o.children&&(u.children=Is(o.children,t,a,r)),u}})}function Vo(e,t,n){return n===void 0&&(n="/"),Zu(e,t,n,!1)}function Zu(e,t,n,r){let o=typeof t=="string"?Fo(t):t,i=Sa(o.pathname||"/",n);if(i==null)return null;let a=G1(e);UC(a);let s=null;for(let u=0;s==null&&u<a.length;++u){let l=YC(i);s=KC(a[u],l,r)}return s}function BC(e,t){let{route:n,pathname:r,params:o}=e;return{id:n.id,pathname:r,params:o,data:t[n.id],handle:n.handle}}function G1(e,t,n,r){t===void 0&&(t=[]),n===void 0&&(n=[]),r===void 0&&(r="");let o=(i,a,s)=>{let u={relativePath:s===void 0?i.path||"":s,caseSensitive:i.caseSensitive===!0,childrenIndex:a,route:i};u.relativePath.startsWith("/")&&(Ne(u.relativePath.startsWith(r),'Absolute route path "'+u.relativePath+'" nested under path '+('"'+r+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),u.relativePath=u.relativePath.slice(r.length));let l=jr([r,u.relativePath]),c=n.concat(u);i.children&&i.children.length>0&&(Ne(i.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+l+'".')),G1(i.children,t,c,l)),!(i.path==null&&!i.index)&&t.push({path:l,score:GC(l,i.index),routesMeta:c})};return e.forEach((i,a)=>{var s;if(i.path===""||!((s=i.path)!=null&&s.includes("?")))o(i,a);else for(let u of q1(i.path))o(i,a,u)}),t}function q1(e){let t=e.split("/");if(t.length===0)return[];let[n,...r]=t,o=n.endsWith("?"),i=n.replace(/\?$/,"");if(r.length===0)return o?[i,""]:[i];let a=q1(r.join("/")),s=[];return s.push(...a.map(u=>u===""?i:[i,u].join("/"))),o&&s.push(...a),s.map(u=>e.startsWith("/")&&u===""?"/":u)}function UC(e){e.sort((t,n)=>t.score!==n.score?n.score-t.score:qC(t.routesMeta.map(r=>r.childrenIndex),n.routesMeta.map(r=>r.childrenIndex)))}const WC=/^:[\w-]+$/,zC=3,jC=2,VC=1,$C=10,HC=-2,Qm=e=>e==="*";function GC(e,t){let n=e.split("/"),r=n.length;return n.some(Qm)&&(r+=HC),t&&(r+=jC),n.filter(o=>!Qm(o)).reduce((o,i)=>o+(WC.test(i)?zC:i===""?VC:$C),r)}function qC(e,t){return e.length===t.length&&e.slice(0,-1).every((r,o)=>r===t[o])?e[e.length-1]-t[t.length-1]:0}function KC(e,t,n){n===void 0&&(n=!1);let{routesMeta:r}=e,o={},i="/",a=[];for(let s=0;s<r.length;++s){let u=r[s],l=s===r.length-1,c=i==="/"?t:t.slice(i.length)||"/",f=Jm({path:u.relativePath,caseSensitive:u.caseSensitive,end:l},c),d=u.route;if(!f&&l&&n&&!r[r.length-1].route.index&&(f=Jm({path:u.relativePath,caseSensitive:u.caseSensitive,end:!1},c)),!f)return null;Object.assign(o,f.params),a.push({params:o,pathname:jr([i,f.pathname]),pathnameBase:ZC(jr([i,f.pathnameBase])),route:d}),f.pathnameBase!=="/"&&(i=jr([i,f.pathnameBase]))}return a}function Jm(e,t){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[n,r]=XC(e.path,e.caseSensitive,e.end),o=t.match(n);if(!o)return null;let i=o[0],a=i.replace(/(.)\/+$/,"$1"),s=o.slice(1);return{params:r.reduce((l,c,f)=>{let{paramName:d,isOptional:h}=c;if(d==="*"){let v=s[f]||"";a=i.slice(0,i.length-v.length).replace(/(.)\/+$/,"$1")}const p=s[f];return h&&!p?l[d]=void 0:l[d]=(p||"").replace(/%2F/g,"/"),l},{}),pathname:i,pathnameBase:a,pattern:e}}function XC(e,t,n){t===void 0&&(t=!1),n===void 0&&(n=!0),ga(e==="*"||!e.endsWith("*")||e.endsWith("/*"),'Route path "'+e+'" will be treated as if it were '+('"'+e.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+e.replace(/\*$/,"/*")+'".'));let r=[],o="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(a,s,u)=>(r.push({paramName:s,isOptional:u!=null}),u?"/?([^\\/]+)?":"/([^\\/]+)"));return e.endsWith("*")?(r.push({paramName:"*"}),o+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?o+="\\/*$":e!==""&&e!=="/"&&(o+="(?:(?=\\/|$))"),[new RegExp(o,t?void 0:"i"),r]}function YC(e){try{return e.split("/").map(t=>decodeURIComponent(t).replace(/\//g,"%2F")).join("/")}catch(t){return ga(!1,'The URL path "'+e+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+t+").")),e}}function Sa(e,t){if(t==="/")return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let n=t.endsWith("/")?t.length-1:t.length,r=e.charAt(n);return r&&r!=="/"?null:e.slice(n)||"/"}function QC(e,t){t===void 0&&(t="/");let{pathname:n,search:r="",hash:o=""}=typeof e=="string"?Fo(e):e;return{pathname:n?n.startsWith("/")?n:JC(n,t):t,search:e_(r),hash:t_(o)}}function JC(e,t){let n=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(o=>{o===".."?n.length>1&&n.pop():o!=="."&&n.push(o)}),n.length>1?n.join("/"):"/"}function xf(e,t,n,r){return"Cannot include a '"+e+"' character in a manually specified "+("`to."+t+"` field ["+JSON.stringify(r)+"].  Please separate it out to the ")+("`to."+n+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function K1(e){return e.filter((t,n)=>n===0||t.route.path&&t.route.path.length>0)}function wp(e,t){let n=K1(e);return t?n.map((r,o)=>o===n.length-1?r.pathname:r.pathnameBase):n.map(r=>r.pathnameBase)}function bp(e,t,n,r){r===void 0&&(r=!1);let o;typeof e=="string"?o=Fo(e):(o=it({},e),Ne(!o.pathname||!o.pathname.includes("?"),xf("?","pathname","search",o)),Ne(!o.pathname||!o.pathname.includes("#"),xf("#","pathname","hash",o)),Ne(!o.search||!o.search.includes("#"),xf("#","search","hash",o)));let i=e===""||o.pathname==="",a=i?"/":o.pathname,s;if(a==null)s=n;else{let f=t.length-1;if(!r&&a.startsWith("..")){let d=a.split("/");for(;d[0]==="..";)d.shift(),f-=1;o.pathname=d.join("/")}s=f>=0?t[f]:"/"}let u=QC(o,s),l=a&&a!=="/"&&a.endsWith("/"),c=(i||a===".")&&n.endsWith("/");return!u.pathname.endsWith("/")&&(l||c)&&(u.pathname+="/"),u}const jr=e=>e.join("/").replace(/\/\/+/g,"/"),ZC=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),e_=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,t_=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e;class kl{constructor(t,n,r,o){o===void 0&&(o=!1),this.status=t,this.statusText=n||"",this.internal=o,r instanceof Error?(this.data=r.toString(),this.error=r):this.data=r}}function yc(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}const X1=["post","put","patch","delete"],n_=new Set(X1),r_=["get",...X1],o_=new Set(r_),i_=new Set([301,302,303,307,308]),a_=new Set([307,308]),wf={state:"idle",location:void 0,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0},s_={state:"idle",data:void 0,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0},Ua={state:"unblocked",proceed:void 0,reset:void 0,location:void 0},Ep=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,u_=e=>({hasErrorBoundary:!!e.hasErrorBoundary}),Y1="remix-router-transitions";function l_(e){const t=e.window?e.window:typeof window<"u"?window:void 0,n=typeof t<"u"&&typeof t.document<"u"&&typeof t.document.createElement<"u",r=!n;Ne(e.routes.length>0,"You must provide a non-empty routes array to createRouter");let o;if(e.mapRouteProperties)o=e.mapRouteProperties;else if(e.detectErrorBoundary){let A=e.detectErrorBoundary;o=M=>({hasErrorBoundary:A(M)})}else o=u_;let i={},a=Is(e.routes,o,void 0,i),s,u=e.basename||"/",l=e.unstable_dataStrategy||p_,c=e.unstable_patchRoutesOnMiss,f=it({v7_fetcherPersist:!1,v7_normalizeFormMethod:!1,v7_partialHydration:!1,v7_prependBasename:!1,v7_relativeSplatPath:!1,v7_skipActionErrorRevalidation:!1},e.future),d=null,h=new Set,p=null,v=null,g=null,m=e.hydrationData!=null,y=Vo(a,e.history.location,u),x=null;if(y==null&&!c){let A=tn(404,{pathname:e.history.location.pathname}),{matches:M,route:W}=ug(a);y=M,x={[W.id]:A}}y&&!e.hydrationData&&iu(y,a,e.history.location.pathname).active&&(y=null);let w;if(y)if(y.some(A=>A.route.lazy))w=!1;else if(!y.some(A=>A.route.loader))w=!0;else if(f.v7_partialHydration){let A=e.hydrationData?e.hydrationData.loaderData:null,M=e.hydrationData?e.hydrationData.errors:null,W=K=>K.route.loader?typeof K.route.loader=="function"&&K.route.loader.hydrate===!0?!1:A&&A[K.route.id]!==void 0||M&&M[K.route.id]!==void 0:!0;if(M){let K=y.findIndex(re=>M[re.route.id]!==void 0);w=y.slice(0,K+1).every(W)}else w=y.every(W)}else w=e.hydrationData!=null;else if(w=!1,y=[],f.v7_partialHydration){let A=iu(null,a,e.history.location.pathname);A.active&&A.matches&&(y=A.matches)}let E,b={historyAction:e.history.action,location:e.history.location,matches:y,initialized:w,navigation:wf,restoreScrollPosition:e.hydrationData!=null?!1:null,preventScrollReset:!1,revalidation:"idle",loaderData:e.hydrationData&&e.hydrationData.loaderData||{},actionData:e.hydrationData&&e.hydrationData.actionData||null,errors:e.hydrationData&&e.hydrationData.errors||x,fetchers:new Map,blockers:new Map},C=yt.Pop,_=!1,S,R=!1,D=new Map,T=null,z=!1,O=!1,$=[],q=new Set,V=new Map,F=0,L=-1,U=new Map,Q=new Set,ee=new Map,ae=new Map,he=new Set,ye=new Map,ve=new Map,Se=new Map,De=!1;function Oe(){if(d=e.history.listen(A=>{let{action:M,location:W,delta:K}=A;if(De){De=!1;return}ga(ve.size===0||K!=null,"You are trying to use a blocker on a POP navigation to a location that was not created by @remix-run/router. This will fail silently in production. This can happen if you are navigating outside the router via `window.history.pushState`/`window.location.hash` instead of using router navigation APIs.  This can also happen if you are using createHashRouter and the user manually changes the URL.");let re=Ov({currentLocation:b.location,nextLocation:W,historyAction:M});if(re&&K!=null){De=!0,e.history.go(K*-1),ru(re,{state:"blocked",location:W,proceed(){ru(re,{state:"proceeding",proceed:void 0,reset:void 0,location:W}),e.history.go(K)},reset(){let pe=new Map(b.blockers);pe.set(re,Ua),Ee({blockers:pe})}});return}return Ue(M,W)}),n){k_(t,D);let A=()=>I_(t,D);t.addEventListener("pagehide",A),T=()=>t.removeEventListener("pagehide",A)}return b.initialized||Ue(yt.Pop,b.location,{initialHydration:!0}),E}function ot(){d&&d(),T&&T(),h.clear(),S&&S.abort(),b.fetchers.forEach((A,M)=>bi(M)),b.blockers.forEach((A,M)=>Mv(M))}function Pe(A){return h.add(A),()=>h.delete(A)}function Ee(A,M){M===void 0&&(M={}),b=it({},b,A);let W=[],K=[];f.v7_fetcherPersist&&b.fetchers.forEach((re,pe)=>{re.state==="idle"&&(he.has(pe)?K.push(pe):W.push(pe))}),[...h].forEach(re=>re(b,{deletedFetchers:K,unstable_viewTransitionOpts:M.viewTransitionOpts,unstable_flushSync:M.flushSync===!0})),f.v7_fetcherPersist&&(W.forEach(re=>b.fetchers.delete(re)),K.forEach(re=>bi(re)))}function Te(A,M,W){var K,re;let{flushSync:pe}=W===void 0?{}:W,xe=b.actionData!=null&&b.navigation.formMethod!=null&&Zn(b.navigation.formMethod)&&b.navigation.state==="loading"&&((K=A.state)==null?void 0:K._isRedirect)!==!0,te;M.actionData?Object.keys(M.actionData).length>0?te=M.actionData:te=null:xe?te=b.actionData:te=null;let Re=M.loaderData?ag(b.loaderData,M.loaderData,M.matches||[],M.errors):b.loaderData,me=b.blockers;me.size>0&&(me=new Map(me),me.forEach((Ve,qe)=>me.set(qe,Ua)));let ge=_===!0||b.navigation.formMethod!=null&&Zn(b.navigation.formMethod)&&((re=A.state)==null?void 0:re._isRedirect)!==!0;s&&(a=s,s=void 0),z||C===yt.Pop||(C===yt.Push?e.history.push(A,A.state):C===yt.Replace&&e.history.replace(A,A.state));let He;if(C===yt.Pop){let Ve=D.get(b.location.pathname);Ve&&Ve.has(A.pathname)?He={currentLocation:b.location,nextLocation:A}:D.has(A.pathname)&&(He={currentLocation:A,nextLocation:b.location})}else if(R){let Ve=D.get(b.location.pathname);Ve?Ve.add(A.pathname):(Ve=new Set([A.pathname]),D.set(b.location.pathname,Ve)),He={currentLocation:b.location,nextLocation:A}}Ee(it({},M,{actionData:te,loaderData:Re,historyAction:C,location:A,initialized:!0,navigation:wf,revalidation:"idle",restoreScrollPosition:Bv(A,M.matches||b.matches),preventScrollReset:ge,blockers:me}),{viewTransitionOpts:He,flushSync:pe===!0}),C=yt.Pop,_=!1,R=!1,z=!1,O=!1,$=[]}async function Qe(A,M){if(typeof A=="number"){e.history.go(A);return}let W=Gd(b.location,b.matches,u,f.v7_prependBasename,A,f.v7_relativeSplatPath,M==null?void 0:M.fromRouteId,M==null?void 0:M.relative),{path:K,submission:re,error:pe}=Zm(f.v7_normalizeFormMethod,!1,W,M),xe=b.location,te=ks(b.location,K,M&&M.state);te=it({},te,e.history.encodeLocation(te));let Re=M&&M.replace!=null?M.replace:void 0,me=yt.Push;Re===!0?me=yt.Replace:Re===!1||re!=null&&Zn(re.formMethod)&&re.formAction===b.location.pathname+b.location.search&&(me=yt.Replace);let ge=M&&"preventScrollReset"in M?M.preventScrollReset===!0:void 0,He=(M&&M.unstable_flushSync)===!0,Ve=Ov({currentLocation:xe,nextLocation:te,historyAction:me});if(Ve){ru(Ve,{state:"blocked",location:te,proceed(){ru(Ve,{state:"proceeding",proceed:void 0,reset:void 0,location:te}),Qe(A,M)},reset(){let qe=new Map(b.blockers);qe.set(Ve,Ua),Ee({blockers:qe})}});return}return await Ue(me,te,{submission:re,pendingError:pe,preventScrollReset:ge,replace:M&&M.replace,enableViewTransition:M&&M.unstable_viewTransition,flushSync:He})}function Je(){if(dr(),Ee({revalidation:"loading"}),b.navigation.state!=="submitting"){if(b.navigation.state==="idle"){Ue(b.historyAction,b.location,{startUninterruptedRevalidation:!0});return}Ue(C||b.historyAction,b.navigation.location,{overrideNavigation:b.navigation})}}async function Ue(A,M,W){S&&S.abort(),S=null,C=A,z=(W&&W.startUninterruptedRevalidation)===!0,Zb(b.location,b.matches),_=(W&&W.preventScrollReset)===!0,R=(W&&W.enableViewTransition)===!0;let K=s||a,re=W&&W.overrideNavigation,pe=Vo(K,M,u),xe=(W&&W.flushSync)===!0,te=iu(pe,K,M.pathname);if(te.active&&te.matches&&(pe=te.matches),!pe){let{error:ze,notFoundMatches:Ot,route:gt}=$c(M.pathname);Te(M,{matches:Ot,loaderData:{},errors:{[gt.id]:ze}},{flushSync:xe});return}if(b.initialized&&!O&&w_(b.location,M)&&!(W&&W.submission&&Zn(W.submission.formMethod))){Te(M,{matches:pe},{flushSync:xe});return}S=new AbortController;let Re=Ii(e.history,M,S.signal,W&&W.submission),me;if(W&&W.pendingError)me=[Xi(pe).route.id,{type:Ge.error,error:W.pendingError}];else if(W&&W.submission&&Zn(W.submission.formMethod)){let ze=await Pn(Re,M,W.submission,pe,te.active,{replace:W.replace,flushSync:xe});if(ze.shortCircuited)return;if(ze.pendingActionResult){let[Ot,gt]=ze.pendingActionResult;if(bn(gt)&&yc(gt.error)&&gt.error.status===404){S=null,Te(M,{matches:ze.matches,loaderData:{},errors:{[Ot]:gt.error}});return}}pe=ze.matches||pe,me=ze.pendingActionResult,re=bf(M,W.submission),xe=!1,te.active=!1,Re=Ii(e.history,Re.url,Re.signal)}let{shortCircuited:ge,matches:He,loaderData:Ve,errors:qe}=await Fn(Re,M,pe,te.active,re,W&&W.submission,W&&W.fetcherSubmission,W&&W.replace,W&&W.initialHydration===!0,xe,me);ge||(S=null,Te(M,it({matches:He||pe},sg(me),{loaderData:Ve,errors:qe})))}async function Pn(A,M,W,K,re,pe){pe===void 0&&(pe={}),dr();let xe=S_(M,W);if(Ee({navigation:xe},{flushSync:pe.flushSync===!0}),re){let me=await au(K,M.pathname,A.signal);if(me.type==="aborted")return{shortCircuited:!0};if(me.type==="error"){let{boundaryId:ge,error:He}=ou(M.pathname,me);return{matches:me.partialMatches,pendingActionResult:[ge,{type:Ge.error,error:He}]}}else if(me.matches)K=me.matches;else{let{notFoundMatches:ge,error:He,route:Ve}=$c(M.pathname);return{matches:ge,pendingActionResult:[Ve.id,{type:Ge.error,error:He}]}}}let te,Re=Qa(K,M);if(!Re.route.action&&!Re.route.lazy)te={type:Ge.error,error:tn(405,{method:A.method,pathname:M.pathname,routeId:Re.route.id})};else if(te=(await en("action",A,[Re],K))[0],A.signal.aborted)return{shortCircuited:!0};if(Xo(te)){let me;return pe&&pe.replace!=null?me=pe.replace:me=rg(te.response.headers.get("Location"),new URL(A.url),u)===b.location.pathname+b.location.search,await Mn(A,te,{submission:W,replace:me}),{shortCircuited:!0}}if(Ko(te))throw tn(400,{type:"defer-action"});if(bn(te)){let me=Xi(K,Re.route.id);return(pe&&pe.replace)!==!0&&(C=yt.Push),{matches:K,pendingActionResult:[me.route.id,te]}}return{matches:K,pendingActionResult:[Re.route.id,te]}}async function Fn(A,M,W,K,re,pe,xe,te,Re,me,ge){let He=re||bf(M,pe),Ve=pe||xe||dg(He),qe=!z&&(!f.v7_partialHydration||!Re);if(K){if(qe){let dt=Vt(ge);Ee(it({navigation:He},dt!==void 0?{actionData:dt}:{}),{flushSync:me})}let Ie=await au(W,M.pathname,A.signal);if(Ie.type==="aborted")return{shortCircuited:!0};if(Ie.type==="error"){let{boundaryId:dt,error:xn}=ou(M.pathname,Ie);return{matches:Ie.partialMatches,loaderData:{},errors:{[dt]:xn}}}else if(Ie.matches)W=Ie.matches;else{let{error:dt,notFoundMatches:xn,route:nt}=$c(M.pathname);return{matches:xn,loaderData:{},errors:{[nt.id]:dt}}}}let ze=s||a,[Ot,gt]=eg(e.history,b,W,Ve,M,f.v7_partialHydration&&Re===!0,f.v7_skipActionErrorRevalidation,O,$,q,he,ee,Q,ze,u,ge);if(Hc(Ie=>!(W&&W.some(dt=>dt.route.id===Ie))||Ot&&Ot.some(dt=>dt.route.id===Ie)),L=++F,Ot.length===0&&gt.length===0){let Ie=Ci();return Te(M,it({matches:W,loaderData:{},errors:ge&&bn(ge[1])?{[ge[0]]:ge[1].error}:null},sg(ge),Ie?{fetchers:new Map(b.fetchers)}:{}),{flushSync:me}),{shortCircuited:!0}}if(qe){let Ie={};if(!K){Ie.navigation=He;let dt=Vt(ge);dt!==void 0&&(Ie.actionData=dt)}gt.length>0&&(Ie.fetchers=eo(gt)),Ee(Ie,{flushSync:me})}gt.forEach(Ie=>{V.has(Ie.key)&&On(Ie.key),Ie.controller&&V.set(Ie.key,Ie.controller)});let Ta=()=>gt.forEach(Ie=>On(Ie.key));S&&S.signal.addEventListener("abort",Ta);let{loaderResults:to,fetcherResults:_i}=await wi(b.matches,W,Ot,gt,A);if(A.signal.aborted)return{shortCircuited:!0};S&&S.signal.removeEventListener("abort",Ta),gt.forEach(Ie=>V.delete(Ie.key));let Si=lg([...to,..._i]);if(Si){if(Si.idx>=Ot.length){let Ie=gt[Si.idx-Ot.length].key;Q.add(Ie)}return await Mn(A,Si.result,{replace:te}),{shortCircuited:!0}}let{loaderData:Ri,errors:hr}=ig(b,W,Ot,to,ge,gt,_i,ye);ye.forEach((Ie,dt)=>{Ie.subscribe(xn=>{(xn||Ie.done)&&ye.delete(dt)})}),f.v7_partialHydration&&Re&&b.errors&&Object.entries(b.errors).filter(Ie=>{let[dt]=Ie;return!Ot.some(xn=>xn.route.id===dt)}).forEach(Ie=>{let[dt,xn]=Ie;hr=Object.assign(hr||{},{[dt]:xn})});let su=Ci(),uu=Fv(L),lu=su||uu||gt.length>0;return it({matches:W,loaderData:Ri,errors:hr},lu?{fetchers:new Map(b.fetchers)}:{})}function Vt(A){if(A&&!bn(A[1]))return{[A[0]]:A[1].data};if(b.actionData)return Object.keys(b.actionData).length===0?null:b.actionData}function eo(A){return A.forEach(M=>{let W=b.fetchers.get(M.key),K=Wa(void 0,W?W.data:void 0);b.fetchers.set(M.key,K)}),new Map(b.fetchers)}function Kn(A,M,W,K){if(r)throw new Error("router.fetch() was called during the server render, but it shouldn't be. You are likely calling a useFetcher() method in the body of your component. Try moving it to a useEffect or a callback.");V.has(A)&&On(A);let re=(K&&K.unstable_flushSync)===!0,pe=s||a,xe=Gd(b.location,b.matches,u,f.v7_prependBasename,W,f.v7_relativeSplatPath,M,K==null?void 0:K.relative),te=Vo(pe,xe,u),Re=iu(te,pe,xe);if(Re.active&&Re.matches&&(te=Re.matches),!te){yn(A,M,tn(404,{pathname:xe}),{flushSync:re});return}let{path:me,submission:ge,error:He}=Zm(f.v7_normalizeFormMethod,!0,xe,K);if(He){yn(A,M,He,{flushSync:re});return}let Ve=Qa(te,me);if(_=(K&&K.preventScrollReset)===!0,ge&&Zn(ge.formMethod)){fr(A,M,me,Ve,te,Re.active,re,ge);return}ee.set(A,{routeId:M,path:me}),Xn(A,M,me,Ve,te,Re.active,re,ge)}async function fr(A,M,W,K,re,pe,xe,te){dr(),ee.delete(A);function Re(nt){if(!nt.route.action&&!nt.route.lazy){let Pr=tn(405,{method:te.formMethod,pathname:W,routeId:M});return yn(A,M,Pr,{flushSync:xe}),!0}return!1}if(!pe&&Re(K))return;let me=b.fetchers.get(A);bt(A,R_(te,me),{flushSync:xe});let ge=new AbortController,He=Ii(e.history,W,ge.signal,te);if(pe){let nt=await au(re,W,He.signal);if(nt.type==="aborted")return;if(nt.type==="error"){let{error:Pr}=ou(W,nt);yn(A,M,Pr,{flushSync:xe});return}else if(nt.matches){if(re=nt.matches,K=Qa(re,W),Re(K))return}else{yn(A,M,tn(404,{pathname:W}),{flushSync:xe});return}}V.set(A,ge);let Ve=F,ze=(await en("action",He,[K],re))[0];if(He.signal.aborted){V.get(A)===ge&&V.delete(A);return}if(f.v7_fetcherPersist&&he.has(A)){if(Xo(ze)||bn(ze)){bt(A,ao(void 0));return}}else{if(Xo(ze))if(V.delete(A),L>Ve){bt(A,ao(void 0));return}else return Q.add(A),bt(A,Wa(te)),Mn(He,ze,{fetcherSubmission:te});if(bn(ze)){yn(A,M,ze.error);return}}if(Ko(ze))throw tn(400,{type:"defer-action"});let Ot=b.navigation.location||b.location,gt=Ii(e.history,Ot,ge.signal),Ta=s||a,to=b.navigation.state!=="idle"?Vo(Ta,b.navigation.location,u):b.matches;Ne(to,"Didn't find any matches after fetcher action");let _i=++F;U.set(A,_i);let Si=Wa(te,ze.data);b.fetchers.set(A,Si);let[Ri,hr]=eg(e.history,b,to,te,Ot,!1,f.v7_skipActionErrorRevalidation,O,$,q,he,ee,Q,Ta,u,[K.route.id,ze]);hr.filter(nt=>nt.key!==A).forEach(nt=>{let Pr=nt.key,Uv=b.fetchers.get(Pr),n2=Wa(void 0,Uv?Uv.data:void 0);b.fetchers.set(Pr,n2),V.has(Pr)&&On(Pr),nt.controller&&V.set(Pr,nt.controller)}),Ee({fetchers:new Map(b.fetchers)});let su=()=>hr.forEach(nt=>On(nt.key));ge.signal.addEventListener("abort",su);let{loaderResults:uu,fetcherResults:lu}=await wi(b.matches,to,Ri,hr,gt);if(ge.signal.aborted)return;ge.signal.removeEventListener("abort",su),U.delete(A),V.delete(A),hr.forEach(nt=>V.delete(nt.key));let Ie=lg([...uu,...lu]);if(Ie){if(Ie.idx>=Ri.length){let nt=hr[Ie.idx-Ri.length].key;Q.add(nt)}return Mn(gt,Ie.result)}let{loaderData:dt,errors:xn}=ig(b,b.matches,Ri,uu,void 0,hr,lu,ye);if(b.fetchers.has(A)){let nt=ao(ze.data);b.fetchers.set(A,nt)}Fv(_i),b.navigation.state==="loading"&&_i>L?(Ne(C,"Expected pending action"),S&&S.abort(),Te(b.navigation.location,{matches:to,loaderData:dt,errors:xn,fetchers:new Map(b.fetchers)})):(Ee({errors:xn,loaderData:ag(b.loaderData,dt,to,xn),fetchers:new Map(b.fetchers)}),O=!1)}async function Xn(A,M,W,K,re,pe,xe,te){let Re=b.fetchers.get(A);bt(A,Wa(te,Re?Re.data:void 0),{flushSync:xe});let me=new AbortController,ge=Ii(e.history,W,me.signal);if(pe){let ze=await au(re,W,ge.signal);if(ze.type==="aborted")return;if(ze.type==="error"){let{error:Ot}=ou(W,ze);yn(A,M,Ot,{flushSync:xe});return}else if(ze.matches)re=ze.matches,K=Qa(re,W);else{yn(A,M,tn(404,{pathname:W}),{flushSync:xe});return}}V.set(A,me);let He=F,qe=(await en("loader",ge,[K],re))[0];if(Ko(qe)&&(qe=await tx(qe,ge.signal,!0)||qe),V.get(A)===me&&V.delete(A),!ge.signal.aborted){if(he.has(A)){bt(A,ao(void 0));return}if(Xo(qe))if(L>He){bt(A,ao(void 0));return}else{Q.add(A),await Mn(ge,qe);return}if(bn(qe)){yn(A,M,qe.error);return}Ne(!Ko(qe),"Unhandled fetcher deferred data"),bt(A,ao(qe.data))}}async function Mn(A,M,W){let{submission:K,fetcherSubmission:re,replace:pe}=W===void 0?{}:W;M.response.headers.has("X-Remix-Revalidate")&&(O=!0);let xe=M.response.headers.get("Location");Ne(xe,"Expected a Location header on the redirect Response"),xe=rg(xe,new URL(A.url),u);let te=ks(b.location,xe,{_isRedirect:!0});if(n){let qe=!1;if(M.response.headers.has("X-Remix-Reload-Document"))qe=!0;else if(Ep.test(xe)){const ze=e.history.createURL(xe);qe=ze.origin!==t.location.origin||Sa(ze.pathname,u)==null}if(qe){pe?t.location.replace(xe):t.location.assign(xe);return}}S=null;let Re=pe===!0||M.response.headers.has("X-Remix-Replace")?yt.Replace:yt.Push,{formMethod:me,formAction:ge,formEncType:He}=b.navigation;!K&&!re&&me&&ge&&He&&(K=dg(b.navigation));let Ve=K||re;if(a_.has(M.response.status)&&Ve&&Zn(Ve.formMethod))await Ue(Re,te,{submission:it({},Ve,{formAction:xe}),preventScrollReset:_});else{let qe=bf(te,K);await Ue(Re,te,{overrideNavigation:qe,fetcherSubmission:re,preventScrollReset:_})}}async function en(A,M,W,K){try{let re=await v_(l,A,M,W,K,i,o);return await Promise.all(re.map((pe,xe)=>{if(E_(pe)){let te=pe.result;return{type:Ge.redirect,response:y_(te,M,W[xe].route.id,K,u,f.v7_relativeSplatPath)}}return g_(pe)}))}catch(re){return W.map(()=>({type:Ge.error,error:re}))}}async function wi(A,M,W,K,re){let[pe,...xe]=await Promise.all([W.length?en("loader",re,W,M):[],...K.map(te=>{if(te.matches&&te.match&&te.controller){let Re=Ii(e.history,te.path,te.controller.signal);return en("loader",Re,[te.match],te.matches).then(me=>me[0])}else return Promise.resolve({type:Ge.error,error:tn(404,{pathname:te.path})})})]);return await Promise.all([fg(A,W,pe,pe.map(()=>re.signal),!1,b.loaderData),fg(A,K.map(te=>te.match),xe,K.map(te=>te.controller?te.controller.signal:null),!0)]),{loaderResults:pe,fetcherResults:xe}}function dr(){O=!0,$.push(...Hc()),ee.forEach((A,M)=>{V.has(M)&&(q.add(M),On(M))})}function bt(A,M,W){W===void 0&&(W={}),b.fetchers.set(A,M),Ee({fetchers:new Map(b.fetchers)},{flushSync:(W&&W.flushSync)===!0})}function yn(A,M,W,K){K===void 0&&(K={});let re=Xi(b.matches,M);bi(A),Ee({errors:{[re.route.id]:W},fetchers:new Map(b.fetchers)},{flushSync:(K&&K.flushSync)===!0})}function nu(A){return f.v7_fetcherPersist&&(ae.set(A,(ae.get(A)||0)+1),he.has(A)&&he.delete(A)),b.fetchers.get(A)||s_}function bi(A){let M=b.fetchers.get(A);V.has(A)&&!(M&&M.state==="loading"&&U.has(A))&&On(A),ee.delete(A),U.delete(A),Q.delete(A),he.delete(A),q.delete(A),b.fetchers.delete(A)}function Vc(A){if(f.v7_fetcherPersist){let M=(ae.get(A)||0)-1;M<=0?(ae.delete(A),he.add(A)):ae.set(A,M)}else bi(A);Ee({fetchers:new Map(b.fetchers)})}function On(A){let M=V.get(A);Ne(M,"Expected fetch controller: "+A),M.abort(),V.delete(A)}function Ei(A){for(let M of A){let W=nu(M),K=ao(W.data);b.fetchers.set(M,K)}}function Ci(){let A=[],M=!1;for(let W of Q){let K=b.fetchers.get(W);Ne(K,"Expected fetcher: "+W),K.state==="loading"&&(Q.delete(W),A.push(W),M=!0)}return Ei(A),M}function Fv(A){let M=[];for(let[W,K]of U)if(K<A){let re=b.fetchers.get(W);Ne(re,"Expected fetcher: "+W),re.state==="loading"&&(On(W),U.delete(W),M.push(W))}return Ei(M),M.length>0}function Qb(A,M){let W=b.blockers.get(A)||Ua;return ve.get(A)!==M&&ve.set(A,M),W}function Mv(A){b.blockers.delete(A),ve.delete(A)}function ru(A,M){let W=b.blockers.get(A)||Ua;Ne(W.state==="unblocked"&&M.state==="blocked"||W.state==="blocked"&&M.state==="blocked"||W.state==="blocked"&&M.state==="proceeding"||W.state==="blocked"&&M.state==="unblocked"||W.state==="proceeding"&&M.state==="unblocked","Invalid blocker state transition: "+W.state+" -> "+M.state);let K=new Map(b.blockers);K.set(A,M),Ee({blockers:K})}function Ov(A){let{currentLocation:M,nextLocation:W,historyAction:K}=A;if(ve.size===0)return;ve.size>1&&ga(!1,"A router only supports one blocker at a time");let re=Array.from(ve.entries()),[pe,xe]=re[re.length-1],te=b.blockers.get(pe);if(!(te&&te.state==="proceeding")&&xe({currentLocation:M,nextLocation:W,historyAction:K}))return pe}function $c(A){let M=tn(404,{pathname:A}),W=s||a,{matches:K,route:re}=ug(W);return Hc(),{notFoundMatches:K,route:re,error:M}}function ou(A,M){return{boundaryId:Xi(M.partialMatches).route.id,error:tn(400,{type:"route-discovery",pathname:A,message:M.error!=null&&"message"in M.error?M.error:String(M.error)})}}function Hc(A){let M=[];return ye.forEach((W,K)=>{(!A||A(K))&&(W.cancel(),M.push(K),ye.delete(K))}),M}function Jb(A,M,W){if(p=A,g=M,v=W||null,!m&&b.navigation===wf){m=!0;let K=Bv(b.location,b.matches);K!=null&&Ee({restoreScrollPosition:K})}return()=>{p=null,g=null,v=null}}function Lv(A,M){return v&&v(A,M.map(K=>BC(K,b.loaderData)))||A.key}function Zb(A,M){if(p&&g){let W=Lv(A,M);p[W]=g()}}function Bv(A,M){if(p){let W=Lv(A,M),K=p[W];if(typeof K=="number")return K}return null}function iu(A,M,W){if(c)if(A){let K=A[A.length-1].route;if(K.path&&(K.path==="*"||K.path.endsWith("/*")))return{active:!0,matches:Zu(M,W,u,!0)}}else return{active:!0,matches:Zu(M,W,u,!0)||[]};return{active:!1,matches:null}}async function au(A,M,W){let K=A,re=K.length>0?K[K.length-1].route:null;for(;;){let pe=s==null,xe=s||a;try{await h_(c,M,K,xe,i,o,Se,W)}catch(ge){return{type:"error",error:ge,partialMatches:K}}finally{pe&&(a=[...a])}if(W.aborted)return{type:"aborted"};let te=Vo(xe,M,u),Re=!1;if(te){let ge=te[te.length-1].route;if(ge.index)return{type:"success",matches:te};if(ge.path&&ge.path.length>0)if(ge.path==="*")Re=!0;else return{type:"success",matches:te}}let me=Zu(xe,M,u,!0);if(!me||K.map(ge=>ge.route.id).join("-")===me.map(ge=>ge.route.id).join("-"))return{type:"success",matches:Re?te:null};if(K=me,re=K[K.length-1].route,re.path==="*")return{type:"success",matches:K}}}function e2(A){i={},s=Is(A,o,void 0,i)}function t2(A,M){let W=s==null;J1(A,M,s||a,i,o),W&&(a=[...a],Ee({}))}return E={get basename(){return u},get future(){return f},get state(){return b},get routes(){return a},get window(){return t},initialize:Oe,subscribe:Pe,enableScrollRestoration:Jb,navigate:Qe,fetch:Kn,revalidate:Je,createHref:A=>e.history.createHref(A),encodeLocation:A=>e.history.encodeLocation(A),getFetcher:nu,deleteFetcher:Vc,dispose:ot,getBlocker:Qb,deleteBlocker:Mv,patchRoutes:t2,_internalFetchControllers:V,_internalActiveDeferreds:ye,_internalSetRoutes:e2},E}function c_(e){return e!=null&&("formData"in e&&e.formData!=null||"body"in e&&e.body!==void 0)}function Gd(e,t,n,r,o,i,a,s){let u,l;if(a){u=[];for(let f of t)if(u.push(f),f.route.id===a){l=f;break}}else u=t,l=t[t.length-1];let c=bp(o||".",wp(u,i),Sa(e.pathname,n)||e.pathname,s==="path");return o==null&&(c.search=e.search,c.hash=e.hash),(o==null||o===""||o===".")&&l&&l.route.index&&!Cp(c.search)&&(c.search=c.search?c.search.replace(/^\?/,"?index&"):"?index"),r&&n!=="/"&&(c.pathname=c.pathname==="/"?n:jr([n,c.pathname])),si(c)}function Zm(e,t,n,r){if(!r||!c_(r))return{path:n};if(r.formMethod&&!__(r.formMethod))return{path:n,error:tn(405,{method:r.formMethod})};let o=()=>({path:n,error:tn(400,{type:"invalid-body"})}),i=r.formMethod||"get",a=e?i.toUpperCase():i.toLowerCase(),s=Z1(n);if(r.body!==void 0){if(r.formEncType==="text/plain"){if(!Zn(a))return o();let d=typeof r.body=="string"?r.body:r.body instanceof FormData||r.body instanceof URLSearchParams?Array.from(r.body.entries()).reduce((h,p)=>{let[v,g]=p;return""+h+v+"="+g+`
`},""):String(r.body);return{path:n,submission:{formMethod:a,formAction:s,formEncType:r.formEncType,formData:void 0,json:void 0,text:d}}}else if(r.formEncType==="application/json"){if(!Zn(a))return o();try{let d=typeof r.body=="string"?JSON.parse(r.body):r.body;return{path:n,submission:{formMethod:a,formAction:s,formEncType:r.formEncType,formData:void 0,json:d,text:void 0}}}catch{return o()}}}Ne(typeof FormData=="function","FormData is not available in this environment");let u,l;if(r.formData)u=qd(r.formData),l=r.formData;else if(r.body instanceof FormData)u=qd(r.body),l=r.body;else if(r.body instanceof URLSearchParams)u=r.body,l=og(u);else if(r.body==null)u=new URLSearchParams,l=new FormData;else try{u=new URLSearchParams(r.body),l=og(u)}catch{return o()}let c={formMethod:a,formAction:s,formEncType:r&&r.formEncType||"application/x-www-form-urlencoded",formData:l,json:void 0,text:void 0};if(Zn(c.formMethod))return{path:n,submission:c};let f=Fo(n);return t&&f.search&&Cp(f.search)&&u.append("index",""),f.search="?"+u,{path:si(f),submission:c}}function f_(e,t){let n=e;if(t){let r=e.findIndex(o=>o.route.id===t);r>=0&&(n=e.slice(0,r))}return n}function eg(e,t,n,r,o,i,a,s,u,l,c,f,d,h,p,v){let g=v?bn(v[1])?v[1].error:v[1].data:void 0,m=e.createURL(t.location),y=e.createURL(o),x=v&&bn(v[1])?v[0]:void 0,w=x?f_(n,x):n,E=v?v[1].statusCode:void 0,b=a&&E&&E>=400,C=w.filter((S,R)=>{let{route:D}=S;if(D.lazy)return!0;if(D.loader==null)return!1;if(i)return typeof D.loader!="function"||D.loader.hydrate?!0:t.loaderData[D.id]===void 0&&(!t.errors||t.errors[D.id]===void 0);if(d_(t.loaderData,t.matches[R],S)||u.some(O=>O===S.route.id))return!0;let T=t.matches[R],z=S;return tg(S,it({currentUrl:m,currentParams:T.params,nextUrl:y,nextParams:z.params},r,{actionResult:g,actionStatus:E,defaultShouldRevalidate:b?!1:s||m.pathname+m.search===y.pathname+y.search||m.search!==y.search||Q1(T,z)}))}),_=[];return f.forEach((S,R)=>{if(i||!n.some($=>$.route.id===S.routeId)||c.has(R))return;let D=Vo(h,S.path,p);if(!D){_.push({key:R,routeId:S.routeId,path:S.path,matches:null,match:null,controller:null});return}let T=t.fetchers.get(R),z=Qa(D,S.path),O=!1;d.has(R)?O=!1:l.has(R)?(l.delete(R),O=!0):T&&T.state!=="idle"&&T.data===void 0?O=s:O=tg(z,it({currentUrl:m,currentParams:t.matches[t.matches.length-1].params,nextUrl:y,nextParams:n[n.length-1].params},r,{actionResult:g,actionStatus:E,defaultShouldRevalidate:b?!1:s})),O&&_.push({key:R,routeId:S.routeId,path:S.path,matches:D,match:z,controller:new AbortController})}),[C,_]}function d_(e,t,n){let r=!t||n.route.id!==t.route.id,o=e[n.route.id]===void 0;return r||o}function Q1(e,t){let n=e.route.path;return e.pathname!==t.pathname||n!=null&&n.endsWith("*")&&e.params["*"]!==t.params["*"]}function tg(e,t){if(e.route.shouldRevalidate){let n=e.route.shouldRevalidate(t);if(typeof n=="boolean")return n}return t.defaultShouldRevalidate}async function h_(e,t,n,r,o,i,a,s){let u=[t,...n.map(l=>l.route.id)].join("-");try{let l=a.get(u);l||(l=e({path:t,matches:n,patch:(c,f)=>{s.aborted||J1(c,f,r,o,i)}}),a.set(u,l)),l&&b_(l)&&await l}finally{a.delete(u)}}function J1(e,t,n,r,o){if(e){var i;let a=r[e];Ne(a,"No route found to patch children into: routeId = "+e);let s=Is(t,o,[e,"patch",String(((i=a.children)==null?void 0:i.length)||"0")],r);a.children?a.children.push(...s):a.children=s}else{let a=Is(t,o,["patch",String(n.length||"0")],r);n.push(...a)}}async function ng(e,t,n){if(!e.lazy)return;let r=await e.lazy();if(!e.lazy)return;let o=n[e.id];Ne(o,"No route found in manifest");let i={};for(let a in r){let u=o[a]!==void 0&&a!=="hasErrorBoundary";ga(!u,'Route "'+o.id+'" has a static property "'+a+'" defined but its lazy function is also returning a value for this property. '+('The lazy route property "'+a+'" will be ignored.')),!u&&!OC.has(a)&&(i[a]=r[a])}Object.assign(o,i),Object.assign(o,it({},t(o),{lazy:void 0}))}function p_(e){return Promise.all(e.matches.map(t=>t.resolve()))}async function v_(e,t,n,r,o,i,a,s){let u=r.reduce((f,d)=>f.add(d.route.id),new Set),l=new Set,c=await e({matches:o.map(f=>{let d=u.has(f.route.id);return it({},f,{shouldLoad:d,resolve:p=>(l.add(f.route.id),d?m_(t,n,f,i,a,p,s):Promise.resolve({type:Ge.data,result:void 0}))})}),request:n,params:o[0].params,context:s});return o.forEach(f=>Ne(l.has(f.route.id),'`match.resolve()` was not called for route id "'+f.route.id+'". You must call `match.resolve()` on every match passed to `dataStrategy` to ensure all routes are properly loaded.')),c.filter((f,d)=>u.has(o[d].route.id))}async function m_(e,t,n,r,o,i,a){let s,u,l=c=>{let f,d=new Promise((v,g)=>f=g);u=()=>f(),t.signal.addEventListener("abort",u);let h=v=>typeof c!="function"?Promise.reject(new Error("You cannot call the handler for a route which defines a boolean "+('"'+e+'" [routeId: '+n.route.id+"]"))):c({request:t,params:n.params,context:a},...v!==void 0?[v]:[]),p;return i?p=i(v=>h(v)):p=(async()=>{try{return{type:"data",result:await h()}}catch(v){return{type:"error",result:v}}})(),Promise.race([p,d])};try{let c=n.route[e];if(n.route.lazy)if(c){let f,[d]=await Promise.all([l(c).catch(h=>{f=h}),ng(n.route,o,r)]);if(f!==void 0)throw f;s=d}else if(await ng(n.route,o,r),c=n.route[e],c)s=await l(c);else if(e==="action"){let f=new URL(t.url),d=f.pathname+f.search;throw tn(405,{method:t.method,pathname:d,routeId:n.route.id})}else return{type:Ge.data,result:void 0};else if(c)s=await l(c);else{let f=new URL(t.url),d=f.pathname+f.search;throw tn(404,{pathname:d})}Ne(s.result!==void 0,"You defined "+(e==="action"?"an action":"a loader")+" for route "+('"'+n.route.id+"\" but didn't return anything from your `"+e+"` ")+"function. Please return a value or `null`.")}catch(c){return{type:Ge.error,result:c}}finally{u&&t.signal.removeEventListener("abort",u)}return s}async function g_(e){let{result:t,type:n}=e;if(ex(t)){let l;try{let c=t.headers.get("Content-Type");c&&/\bapplication\/json\b/.test(c)?t.body==null?l=null:l=await t.json():l=await t.text()}catch(c){return{type:Ge.error,error:c}}return n===Ge.error?{type:Ge.error,error:new kl(t.status,t.statusText,l),statusCode:t.status,headers:t.headers}:{type:Ge.data,data:l,statusCode:t.status,headers:t.headers}}if(n===Ge.error){if(cg(t)){var r;if(t.data instanceof Error){var o;return{type:Ge.error,error:t.data,statusCode:(o=t.init)==null?void 0:o.status}}t=new kl(((r=t.init)==null?void 0:r.status)||500,void 0,t.data)}return{type:Ge.error,error:t,statusCode:yc(t)?t.status:void 0}}if(C_(t)){var i,a;return{type:Ge.deferred,deferredData:t,statusCode:(i=t.init)==null?void 0:i.status,headers:((a=t.init)==null?void 0:a.headers)&&new Headers(t.init.headers)}}if(cg(t)){var s,u;return{type:Ge.data,data:t.data,statusCode:(s=t.init)==null?void 0:s.status,headers:(u=t.init)!=null&&u.headers?new Headers(t.init.headers):void 0}}return{type:Ge.data,data:t}}function y_(e,t,n,r,o,i){let a=e.headers.get("Location");if(Ne(a,"Redirects returned/thrown from loaders/actions must have a Location header"),!Ep.test(a)){let s=r.slice(0,r.findIndex(u=>u.route.id===n)+1);a=Gd(new URL(t.url),s,o,!0,a,i),e.headers.set("Location",a)}return e}function rg(e,t,n){if(Ep.test(e)){let r=e,o=r.startsWith("//")?new URL(t.protocol+r):new URL(r),i=Sa(o.pathname,n)!=null;if(o.origin===t.origin&&i)return o.pathname+o.search+o.hash}return e}function Ii(e,t,n,r){let o=e.createURL(Z1(t)).toString(),i={signal:n};if(r&&Zn(r.formMethod)){let{formMethod:a,formEncType:s}=r;i.method=a.toUpperCase(),s==="application/json"?(i.headers=new Headers({"Content-Type":s}),i.body=JSON.stringify(r.json)):s==="text/plain"?i.body=r.text:s==="application/x-www-form-urlencoded"&&r.formData?i.body=qd(r.formData):i.body=r.formData}return new Request(o,i)}function qd(e){let t=new URLSearchParams;for(let[n,r]of e.entries())t.append(n,typeof r=="string"?r:r.name);return t}function og(e){let t=new FormData;for(let[n,r]of e.entries())t.append(n,r);return t}function x_(e,t,n,r,o,i){let a={},s=null,u,l=!1,c={},f=r&&bn(r[1])?r[1].error:void 0;return n.forEach((d,h)=>{let p=t[h].route.id;if(Ne(!Xo(d),"Cannot handle redirect results in processLoaderData"),bn(d)){let v=d.error;f!==void 0&&(v=f,f=void 0),s=s||{};{let g=Xi(e,p);s[g.route.id]==null&&(s[g.route.id]=v)}a[p]=void 0,l||(l=!0,u=yc(d.error)?d.error.status:500),d.headers&&(c[p]=d.headers)}else Ko(d)?(o.set(p,d.deferredData),a[p]=d.deferredData.data,d.statusCode!=null&&d.statusCode!==200&&!l&&(u=d.statusCode),d.headers&&(c[p]=d.headers)):(a[p]=d.data,d.statusCode&&d.statusCode!==200&&!l&&(u=d.statusCode),d.headers&&(c[p]=d.headers))}),f!==void 0&&r&&(s={[r[0]]:f},a[r[0]]=void 0),{loaderData:a,errors:s,statusCode:u||200,loaderHeaders:c}}function ig(e,t,n,r,o,i,a,s){let{loaderData:u,errors:l}=x_(t,n,r,o,s);for(let c=0;c<i.length;c++){let{key:f,match:d,controller:h}=i[c];Ne(a!==void 0&&a[c]!==void 0,"Did not find corresponding fetcher result");let p=a[c];if(!(h&&h.signal.aborted))if(bn(p)){let v=Xi(e.matches,d==null?void 0:d.route.id);l&&l[v.route.id]||(l=it({},l,{[v.route.id]:p.error})),e.fetchers.delete(f)}else if(Xo(p))Ne(!1,"Unhandled fetcher revalidation redirect");else if(Ko(p))Ne(!1,"Unhandled fetcher deferred data");else{let v=ao(p.data);e.fetchers.set(f,v)}}return{loaderData:u,errors:l}}function ag(e,t,n,r){let o=it({},t);for(let i of n){let a=i.route.id;if(t.hasOwnProperty(a)?t[a]!==void 0&&(o[a]=t[a]):e[a]!==void 0&&i.route.loader&&(o[a]=e[a]),r&&r.hasOwnProperty(a))break}return o}function sg(e){return e?bn(e[1])?{actionData:{}}:{actionData:{[e[0]]:e[1].data}}:{}}function Xi(e,t){return(t?e.slice(0,e.findIndex(r=>r.route.id===t)+1):[...e]).reverse().find(r=>r.route.hasErrorBoundary===!0)||e[0]}function ug(e){let t=e.length===1?e[0]:e.find(n=>n.index||!n.path||n.path==="/")||{id:"__shim-error-route__"};return{matches:[{params:{},pathname:"",pathnameBase:"",route:t}],route:t}}function tn(e,t){let{pathname:n,routeId:r,method:o,type:i,message:a}=t===void 0?{}:t,s="Unknown Server Error",u="Unknown @remix-run/router error";return e===400?(s="Bad Request",i==="route-discovery"?u='Unable to match URL "'+n+'" - the `unstable_patchRoutesOnMiss()` '+(`function threw the following error:
`+a):o&&n&&r?u="You made a "+o+' request to "'+n+'" but '+('did not provide a `loader` for route "'+r+'", ')+"so there is no way to handle the request.":i==="defer-action"?u="defer() is not supported in actions":i==="invalid-body"&&(u="Unable to encode submission body")):e===403?(s="Forbidden",u='Route "'+r+'" does not match URL "'+n+'"'):e===404?(s="Not Found",u='No route matches URL "'+n+'"'):e===405&&(s="Method Not Allowed",o&&n&&r?u="You made a "+o.toUpperCase()+' request to "'+n+'" but '+('did not provide an `action` for route "'+r+'", ')+"so there is no way to handle the request.":o&&(u='Invalid request method "'+o.toUpperCase()+'"')),new kl(e||500,s,new Error(u),!0)}function lg(e){for(let t=e.length-1;t>=0;t--){let n=e[t];if(Xo(n))return{result:n,idx:t}}}function Z1(e){let t=typeof e=="string"?Fo(e):e;return si(it({},t,{hash:""}))}function w_(e,t){return e.pathname!==t.pathname||e.search!==t.search?!1:e.hash===""?t.hash!=="":e.hash===t.hash?!0:t.hash!==""}function b_(e){return typeof e=="object"&&e!=null&&"then"in e}function E_(e){return ex(e.result)&&i_.has(e.result.status)}function Ko(e){return e.type===Ge.deferred}function bn(e){return e.type===Ge.error}function Xo(e){return(e&&e.type)===Ge.redirect}function cg(e){return typeof e=="object"&&e!=null&&"type"in e&&"data"in e&&"init"in e&&e.type==="DataWithResponseInit"}function C_(e){let t=e;return t&&typeof t=="object"&&typeof t.data=="object"&&typeof t.subscribe=="function"&&typeof t.cancel=="function"&&typeof t.resolveData=="function"}function ex(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.headers=="object"&&typeof e.body<"u"}function __(e){return o_.has(e.toLowerCase())}function Zn(e){return n_.has(e.toLowerCase())}async function fg(e,t,n,r,o,i){for(let a=0;a<n.length;a++){let s=n[a],u=t[a];if(!u)continue;let l=e.find(f=>f.route.id===u.route.id),c=l!=null&&!Q1(l,u)&&(i&&i[u.route.id])!==void 0;if(Ko(s)&&(o||c)){let f=r[a];Ne(f,"Expected an AbortSignal for revalidating fetcher deferred result"),await tx(s,f,o).then(d=>{d&&(n[a]=d||n[a])})}}}async function tx(e,t,n){if(n===void 0&&(n=!1),!await e.deferredData.resolveData(t)){if(n)try{return{type:Ge.data,data:e.deferredData.unwrappedData}}catch(o){return{type:Ge.error,error:o}}return{type:Ge.data,data:e.deferredData.data}}}function Cp(e){return new URLSearchParams(e).getAll("index").some(t=>t==="")}function Qa(e,t){let n=typeof t=="string"?Fo(t).search:t.search;if(e[e.length-1].route.index&&Cp(n||""))return e[e.length-1];let r=K1(e);return r[r.length-1]}function dg(e){let{formMethod:t,formAction:n,formEncType:r,text:o,formData:i,json:a}=e;if(!(!t||!n||!r)){if(o!=null)return{formMethod:t,formAction:n,formEncType:r,formData:void 0,json:void 0,text:o};if(i!=null)return{formMethod:t,formAction:n,formEncType:r,formData:i,json:void 0,text:void 0};if(a!==void 0)return{formMethod:t,formAction:n,formEncType:r,formData:void 0,json:a,text:void 0}}}function bf(e,t){return t?{state:"loading",location:e,formMethod:t.formMethod,formAction:t.formAction,formEncType:t.formEncType,formData:t.formData,json:t.json,text:t.text}:{state:"loading",location:e,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0}}function S_(e,t){return{state:"submitting",location:e,formMethod:t.formMethod,formAction:t.formAction,formEncType:t.formEncType,formData:t.formData,json:t.json,text:t.text}}function Wa(e,t){return e?{state:"loading",formMethod:e.formMethod,formAction:e.formAction,formEncType:e.formEncType,formData:e.formData,json:e.json,text:e.text,data:t}:{state:"loading",formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0,data:t}}function R_(e,t){return{state:"submitting",formMethod:e.formMethod,formAction:e.formAction,formEncType:e.formEncType,formData:e.formData,json:e.json,text:e.text,data:t?t.data:void 0}}function ao(e){return{state:"idle",formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0,data:e}}function k_(e,t){try{let n=e.sessionStorage.getItem(Y1);if(n){let r=JSON.parse(n);for(let[o,i]of Object.entries(r||{}))i&&Array.isArray(i)&&t.set(o,new Set(i||[]))}}catch{}}function I_(e,t){if(t.size>0){let n={};for(let[r,o]of t)n[r]=[...o];try{e.sessionStorage.setItem(Y1,JSON.stringify(n))}catch(r){ga(!1,"Failed to save applied view transitions in sessionStorage ("+r+").")}}}/**
 * React Router v6.26.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Il(){return Il=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Il.apply(this,arguments)}const xc=X.createContext(null),nx=X.createContext(null),hi=X.createContext(null),_p=X.createContext(null),pi=X.createContext({outlet:null,matches:[],isDataRoute:!1}),rx=X.createContext(null);function D_(e,t){let{relative:n}=t===void 0?{}:t;Vs()||Ne(!1);let{basename:r,navigator:o}=X.useContext(hi),{hash:i,pathname:a,search:s}=ix(e,{relative:n}),u=a;return r!=="/"&&(u=a==="/"?r:jr([r,a])),o.createHref({pathname:u,search:s,hash:i})}function Vs(){return X.useContext(_p)!=null}function wc(){return Vs()||Ne(!1),X.useContext(_p).location}function ox(e){X.useContext(hi).static||X.useLayoutEffect(e)}function bc(){let{isDataRoute:e}=X.useContext(pi);return e?z_():T_()}function T_(){Vs()||Ne(!1);let e=X.useContext(xc),{basename:t,future:n,navigator:r}=X.useContext(hi),{matches:o}=X.useContext(pi),{pathname:i}=wc(),a=JSON.stringify(wp(o,n.v7_relativeSplatPath)),s=X.useRef(!1);return ox(()=>{s.current=!0}),X.useCallback(function(l,c){if(c===void 0&&(c={}),!s.current)return;if(typeof l=="number"){r.go(l);return}let f=bp(l,JSON.parse(a),i,c.relative==="path");e==null&&t!=="/"&&(f.pathname=f.pathname==="/"?t:jr([t,f.pathname])),(c.replace?r.replace:r.push)(f,c.state,c)},[t,r,a,i,e])}function ix(e,t){let{relative:n}=t===void 0?{}:t,{future:r}=X.useContext(hi),{matches:o}=X.useContext(pi),{pathname:i}=wc(),a=JSON.stringify(wp(o,r.v7_relativeSplatPath));return X.useMemo(()=>bp(e,JSON.parse(a),i,n==="path"),[e,a,i,n])}function N_(e,t,n,r){Vs()||Ne(!1);let{navigator:o}=X.useContext(hi),{matches:i}=X.useContext(pi),a=i[i.length-1],s=a?a.params:{};a&&a.pathname;let u=a?a.pathnameBase:"/";a&&a.route;let l=wc(),c;c=l;let f=c.pathname||"/",d=f;if(u!=="/"){let v=u.replace(/^\//,"").split("/");d="/"+f.replace(/^\//,"").split("/").slice(v.length).join("/")}let h=Vo(e,{pathname:d});return O_(h&&h.map(v=>Object.assign({},v,{params:Object.assign({},s,v.params),pathname:jr([u,o.encodeLocation?o.encodeLocation(v.pathname).pathname:v.pathname]),pathnameBase:v.pathnameBase==="/"?u:jr([u,o.encodeLocation?o.encodeLocation(v.pathnameBase).pathname:v.pathnameBase])})),i,n,r)}function A_(){let e=W_(),t=yc(e)?e.status+" "+e.statusText:e instanceof Error?e.message:JSON.stringify(e),n=e instanceof Error?e.stack:null,o={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return X.createElement(X.Fragment,null,X.createElement("h2",null,"Unexpected Application Error!"),X.createElement("h3",{style:{fontStyle:"italic"}},t),n?X.createElement("pre",{style:o},n):null,null)}const P_=X.createElement(A_,null);class F_ extends X.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,n){return n.location!==t.location||n.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:n.error,location:n.location,revalidation:t.revalidation||n.revalidation}}componentDidCatch(t,n){console.error("React Router caught the following error during render",t,n)}render(){return this.state.error!==void 0?X.createElement(pi.Provider,{value:this.props.routeContext},X.createElement(rx.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function M_(e){let{routeContext:t,match:n,children:r}=e,o=X.useContext(xc);return o&&o.static&&o.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(o.staticContext._deepestRenderedBoundaryId=n.route.id),X.createElement(pi.Provider,{value:t},r)}function O_(e,t,n,r){var o;if(t===void 0&&(t=[]),n===void 0&&(n=null),r===void 0&&(r=null),e==null){var i;if(!n)return null;if(n.errors)e=n.matches;else if((i=r)!=null&&i.v7_partialHydration&&t.length===0&&!n.initialized&&n.matches.length>0)e=n.matches;else return null}let a=e,s=(o=n)==null?void 0:o.errors;if(s!=null){let c=a.findIndex(f=>f.route.id&&(s==null?void 0:s[f.route.id])!==void 0);c>=0||Ne(!1),a=a.slice(0,Math.min(a.length,c+1))}let u=!1,l=-1;if(n&&r&&r.v7_partialHydration)for(let c=0;c<a.length;c++){let f=a[c];if((f.route.HydrateFallback||f.route.hydrateFallbackElement)&&(l=c),f.route.id){let{loaderData:d,errors:h}=n,p=f.route.loader&&d[f.route.id]===void 0&&(!h||h[f.route.id]===void 0);if(f.route.lazy||p){u=!0,l>=0?a=a.slice(0,l+1):a=[a[0]];break}}}return a.reduceRight((c,f,d)=>{let h,p=!1,v=null,g=null;n&&(h=s&&f.route.id?s[f.route.id]:void 0,v=f.route.errorElement||P_,u&&(l<0&&d===0?(j_("route-fallback"),p=!0,g=null):l===d&&(p=!0,g=f.route.hydrateFallbackElement||null)));let m=t.concat(a.slice(0,d+1)),y=()=>{let x;return h?x=v:p?x=g:f.route.Component?x=X.createElement(f.route.Component,null):f.route.element?x=f.route.element:x=c,X.createElement(M_,{match:f,routeContext:{outlet:c,matches:m,isDataRoute:n!=null},children:x})};return n&&(f.route.ErrorBoundary||f.route.errorElement||d===0)?X.createElement(F_,{location:n.location,revalidation:n.revalidation,component:v,error:h,children:y(),routeContext:{outlet:null,matches:m,isDataRoute:!0}}):y()},null)}var ax=function(e){return e.UseBlocker="useBlocker",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e}(ax||{}),Dl=function(e){return e.UseBlocker="useBlocker",e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e.UseRouteId="useRouteId",e}(Dl||{});function L_(e){let t=X.useContext(xc);return t||Ne(!1),t}function B_(e){let t=X.useContext(nx);return t||Ne(!1),t}function U_(e){let t=X.useContext(pi);return t||Ne(!1),t}function sx(e){let t=U_(),n=t.matches[t.matches.length-1];return n.route.id||Ne(!1),n.route.id}function W_(){var e;let t=X.useContext(rx),n=B_(Dl.UseRouteError),r=sx(Dl.UseRouteError);return t!==void 0?t:(e=n.errors)==null?void 0:e[r]}function z_(){let{router:e}=L_(ax.UseNavigateStable),t=sx(Dl.UseNavigateStable),n=X.useRef(!1);return ox(()=>{n.current=!0}),X.useCallback(function(o,i){i===void 0&&(i={}),n.current&&(typeof o=="number"?e.navigate(o):e.navigate(o,Il({fromRouteId:t},i)))},[e,t])}const hg={};function j_(e,t,n){hg[e]||(hg[e]=!0)}function V_(e){let{basename:t="/",children:n=null,location:r,navigationType:o=yt.Pop,navigator:i,static:a=!1,future:s}=e;Vs()&&Ne(!1);let u=t.replace(/^\/*/,"/"),l=X.useMemo(()=>({basename:u,navigator:i,static:a,future:Il({v7_relativeSplatPath:!1},s)}),[u,s,i,a]);typeof r=="string"&&(r=Fo(r));let{pathname:c="/",search:f="",hash:d="",state:h=null,key:p="default"}=r,v=X.useMemo(()=>{let g=Sa(c,u);return g==null?null:{location:{pathname:g,search:f,hash:d,state:h,key:p},navigationType:o}},[u,c,f,d,h,p,o]);return v==null?null:X.createElement(hi.Provider,{value:l},X.createElement(_p.Provider,{children:n,value:v}))}new Promise(()=>{});function $_(e){let t={hasErrorBoundary:e.ErrorBoundary!=null||e.errorElement!=null};return e.Component&&Object.assign(t,{element:X.createElement(e.Component),Component:void 0}),e.HydrateFallback&&Object.assign(t,{hydrateFallbackElement:X.createElement(e.HydrateFallback),HydrateFallback:void 0}),e.ErrorBoundary&&Object.assign(t,{errorElement:X.createElement(e.ErrorBoundary),ErrorBoundary:void 0}),t}/**
 * React Router DOM v6.26.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Ds(){return Ds=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Ds.apply(this,arguments)}function H_(e,t){if(e==null)return{};var n={},r=Object.keys(e),o,i;for(i=0;i<r.length;i++)o=r[i],!(t.indexOf(o)>=0)&&(n[o]=e[o]);return n}function G_(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}function q_(e,t){return e.button===0&&(!t||t==="_self")&&!G_(e)}const K_=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","unstable_viewTransition"],X_="6";try{window.__reactRouterVersion=X_}catch{}function Y_(e,t){return l_({basename:void 0,future:Ds({},void 0,{v7_prependBasename:!0}),history:PC({window:void 0}),hydrationData:Q_(),routes:e,mapRouteProperties:$_,unstable_dataStrategy:void 0,unstable_patchRoutesOnMiss:void 0,window:void 0}).initialize()}function Q_(){var e;let t=(e=window)==null?void 0:e.__staticRouterHydrationData;return t&&t.errors&&(t=Ds({},t,{errors:J_(t.errors)})),t}function J_(e){if(!e)return null;let t=Object.entries(e),n={};for(let[r,o]of t)if(o&&o.__type==="RouteErrorResponse")n[r]=new kl(o.status,o.statusText,o.data,o.internal===!0);else if(o&&o.__type==="Error"){if(o.__subType){let i=window[o.__subType];if(typeof i=="function")try{let a=new i(o.message);a.stack="",n[r]=a}catch{}}if(n[r]==null){let i=new Error(o.message);i.stack="",n[r]=i}}else n[r]=o;return n}const Z_=X.createContext({isTransitioning:!1}),eS=X.createContext(new Map),tS="startTransition",pg=w2[tS],nS="flushSync",vg=AC[nS];function rS(e){pg?pg(e):e()}function za(e){vg?vg(e):e()}class oS{constructor(){this.status="pending",this.promise=new Promise((t,n)=>{this.resolve=r=>{this.status==="pending"&&(this.status="resolved",t(r))},this.reject=r=>{this.status==="pending"&&(this.status="rejected",n(r))}})}}function iS(e){let{fallbackElement:t,router:n,future:r}=e,[o,i]=X.useState(n.state),[a,s]=X.useState(),[u,l]=X.useState({isTransitioning:!1}),[c,f]=X.useState(),[d,h]=X.useState(),[p,v]=X.useState(),g=X.useRef(new Map),{v7_startTransition:m}=r||{},y=X.useCallback(_=>{m?rS(_):_()},[m]),x=X.useCallback((_,S)=>{let{deletedFetchers:R,unstable_flushSync:D,unstable_viewTransitionOpts:T}=S;R.forEach(O=>g.current.delete(O)),_.fetchers.forEach((O,$)=>{O.data!==void 0&&g.current.set($,O.data)});let z=n.window==null||n.window.document==null||typeof n.window.document.startViewTransition!="function";if(!T||z){D?za(()=>i(_)):y(()=>i(_));return}if(D){za(()=>{d&&(c&&c.resolve(),d.skipTransition()),l({isTransitioning:!0,flushSync:!0,currentLocation:T.currentLocation,nextLocation:T.nextLocation})});let O=n.window.document.startViewTransition(()=>{za(()=>i(_))});O.finished.finally(()=>{za(()=>{f(void 0),h(void 0),s(void 0),l({isTransitioning:!1})})}),za(()=>h(O));return}d?(c&&c.resolve(),d.skipTransition(),v({state:_,currentLocation:T.currentLocation,nextLocation:T.nextLocation})):(s(_),l({isTransitioning:!0,flushSync:!1,currentLocation:T.currentLocation,nextLocation:T.nextLocation}))},[n.window,d,c,g,y]);X.useLayoutEffect(()=>n.subscribe(x),[n,x]),X.useEffect(()=>{u.isTransitioning&&!u.flushSync&&f(new oS)},[u]),X.useEffect(()=>{if(c&&a&&n.window){let _=a,S=c.promise,R=n.window.document.startViewTransition(async()=>{y(()=>i(_)),await S});R.finished.finally(()=>{f(void 0),h(void 0),s(void 0),l({isTransitioning:!1})}),h(R)}},[y,a,c,n.window]),X.useEffect(()=>{c&&a&&o.location.key===a.location.key&&c.resolve()},[c,d,o.location,a]),X.useEffect(()=>{!u.isTransitioning&&p&&(s(p.state),l({isTransitioning:!0,flushSync:!1,currentLocation:p.currentLocation,nextLocation:p.nextLocation}),v(void 0))},[u.isTransitioning,p]),X.useEffect(()=>{},[]);let w=X.useMemo(()=>({createHref:n.createHref,encodeLocation:n.encodeLocation,go:_=>n.navigate(_),push:(_,S,R)=>n.navigate(_,{state:S,preventScrollReset:R==null?void 0:R.preventScrollReset}),replace:(_,S,R)=>n.navigate(_,{replace:!0,state:S,preventScrollReset:R==null?void 0:R.preventScrollReset})}),[n]),E=n.basename||"/",b=X.useMemo(()=>({router:n,navigator:w,static:!1,basename:E}),[n,w,E]),C=X.useMemo(()=>({v7_relativeSplatPath:n.future.v7_relativeSplatPath}),[n.future.v7_relativeSplatPath]);return X.createElement(X.Fragment,null,X.createElement(xc.Provider,{value:b},X.createElement(nx.Provider,{value:o},X.createElement(eS.Provider,{value:g.current},X.createElement(Z_.Provider,{value:u},X.createElement(V_,{basename:E,location:o.location,navigationType:o.historyAction,navigator:w,future:C},o.initialized||n.future.v7_partialHydration?X.createElement(aS,{routes:n.routes,future:n.future,state:o}):t))))),null)}const aS=X.memo(sS);function sS(e){let{routes:t,future:n,state:r}=e;return N_(t,void 0,r,n)}const uS=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",lS=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Tl=X.forwardRef(function(t,n){let{onClick:r,relative:o,reloadDocument:i,replace:a,state:s,target:u,to:l,preventScrollReset:c,unstable_viewTransition:f}=t,d=H_(t,K_),{basename:h}=X.useContext(hi),p,v=!1;if(typeof l=="string"&&lS.test(l)&&(p=l,uS))try{let x=new URL(window.location.href),w=l.startsWith("//")?new URL(x.protocol+l):new URL(l),E=Sa(w.pathname,h);w.origin===x.origin&&E!=null?l=E+w.search+w.hash:v=!0}catch{}let g=D_(l,{relative:o}),m=cS(l,{replace:a,state:s,target:u,preventScrollReset:c,relative:o,unstable_viewTransition:f});function y(x){r&&r(x),x.defaultPrevented||m(x)}return X.createElement("a",Ds({},d,{href:p||g,onClick:v||i?r:y,ref:n,target:u}))});var mg;(function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmit="useSubmit",e.UseSubmitFetcher="useSubmitFetcher",e.UseFetcher="useFetcher",e.useViewTransitionState="useViewTransitionState"})(mg||(mg={}));var gg;(function(e){e.UseFetcher="useFetcher",e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"})(gg||(gg={}));function cS(e,t){let{target:n,replace:r,state:o,preventScrollReset:i,relative:a,unstable_viewTransition:s}=t===void 0?{}:t,u=bc(),l=wc(),c=ix(e,{relative:a});return X.useCallback(f=>{if(q_(f,n)){f.preventDefault();let d=r!==void 0?r:si(l)===si(c);u(e,{replace:d,state:o,preventScrollReset:i,relative:a,unstable_viewTransition:s})}},[l,u,c,r,o,n,e,i,a,s])}function fS(){return Z.jsx(Z.Fragment,{children:Z.jsxs("div",{className:"home-container",children:[Z.jsx("h1",{children:"HOME"}),Z.jsx(Tl,{to:"/users/login",children:"User LOGIN"}),Z.jsx(Tl,{to:"/admin/login",children:"Admin Login"})]})})}function ux(e,t){return function(){return e.apply(t,arguments)}}const{toString:dS}=Object.prototype,{getPrototypeOf:Sp}=Object,Ec=(e=>t=>{const n=dS.call(t);return e[n]||(e[n]=n.slice(8,-1).toLowerCase())})(Object.create(null)),ur=e=>(e=e.toLowerCase(),t=>Ec(t)===e),Cc=e=>t=>typeof t===e,{isArray:Ra}=Array,Ts=Cc("undefined");function hS(e){return e!==null&&!Ts(e)&&e.constructor!==null&&!Ts(e.constructor)&&$n(e.constructor.isBuffer)&&e.constructor.isBuffer(e)}const lx=ur("ArrayBuffer");function pS(e){let t;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?t=ArrayBuffer.isView(e):t=e&&e.buffer&&lx(e.buffer),t}const vS=Cc("string"),$n=Cc("function"),cx=Cc("number"),_c=e=>e!==null&&typeof e=="object",mS=e=>e===!0||e===!1,el=e=>{if(Ec(e)!=="object")return!1;const t=Sp(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)},gS=ur("Date"),yS=ur("File"),xS=ur("Blob"),wS=ur("FileList"),bS=e=>_c(e)&&$n(e.pipe),ES=e=>{let t;return e&&(typeof FormData=="function"&&e instanceof FormData||$n(e.append)&&((t=Ec(e))==="formdata"||t==="object"&&$n(e.toString)&&e.toString()==="[object FormData]"))},CS=ur("URLSearchParams"),[_S,SS,RS,kS]=["ReadableStream","Request","Response","Headers"].map(ur),IS=e=>e.trim?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function $s(e,t,{allOwnKeys:n=!1}={}){if(e===null||typeof e>"u")return;let r,o;if(typeof e!="object"&&(e=[e]),Ra(e))for(r=0,o=e.length;r<o;r++)t.call(null,e[r],r,e);else{const i=n?Object.getOwnPropertyNames(e):Object.keys(e),a=i.length;let s;for(r=0;r<a;r++)s=i[r],t.call(null,e[s],s,e)}}function fx(e,t){t=t.toLowerCase();const n=Object.keys(e);let r=n.length,o;for(;r-- >0;)if(o=n[r],t===o.toLowerCase())return o;return null}const dx=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,hx=e=>!Ts(e)&&e!==dx;function Kd(){const{caseless:e}=hx(this)&&this||{},t={},n=(r,o)=>{const i=e&&fx(t,o)||o;el(t[i])&&el(r)?t[i]=Kd(t[i],r):el(r)?t[i]=Kd({},r):Ra(r)?t[i]=r.slice():t[i]=r};for(let r=0,o=arguments.length;r<o;r++)arguments[r]&&$s(arguments[r],n);return t}const DS=(e,t,n,{allOwnKeys:r}={})=>($s(t,(o,i)=>{n&&$n(o)?e[i]=ux(o,n):e[i]=o},{allOwnKeys:r}),e),TS=e=>(e.charCodeAt(0)===65279&&(e=e.slice(1)),e),NS=(e,t,n,r)=>{e.prototype=Object.create(t.prototype,r),e.prototype.constructor=e,Object.defineProperty(e,"super",{value:t.prototype}),n&&Object.assign(e.prototype,n)},AS=(e,t,n,r)=>{let o,i,a;const s={};if(t=t||{},e==null)return t;do{for(o=Object.getOwnPropertyNames(e),i=o.length;i-- >0;)a=o[i],(!r||r(a,e,t))&&!s[a]&&(t[a]=e[a],s[a]=!0);e=n!==!1&&Sp(e)}while(e&&(!n||n(e,t))&&e!==Object.prototype);return t},PS=(e,t,n)=>{e=String(e),(n===void 0||n>e.length)&&(n=e.length),n-=t.length;const r=e.indexOf(t,n);return r!==-1&&r===n},FS=e=>{if(!e)return null;if(Ra(e))return e;let t=e.length;if(!cx(t))return null;const n=new Array(t);for(;t-- >0;)n[t]=e[t];return n},MS=(e=>t=>e&&t instanceof e)(typeof Uint8Array<"u"&&Sp(Uint8Array)),OS=(e,t)=>{const r=(e&&e[Symbol.iterator]).call(e);let o;for(;(o=r.next())&&!o.done;){const i=o.value;t.call(e,i[0],i[1])}},LS=(e,t)=>{let n;const r=[];for(;(n=e.exec(t))!==null;)r.push(n);return r},BS=ur("HTMLFormElement"),US=e=>e.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(n,r,o){return r.toUpperCase()+o}),yg=(({hasOwnProperty:e})=>(t,n)=>e.call(t,n))(Object.prototype),WS=ur("RegExp"),px=(e,t)=>{const n=Object.getOwnPropertyDescriptors(e),r={};$s(n,(o,i)=>{let a;(a=t(o,i,e))!==!1&&(r[i]=a||o)}),Object.defineProperties(e,r)},zS=e=>{px(e,(t,n)=>{if($n(e)&&["arguments","caller","callee"].indexOf(n)!==-1)return!1;const r=e[n];if($n(r)){if(t.enumerable=!1,"writable"in t){t.writable=!1;return}t.set||(t.set=()=>{throw Error("Can not rewrite read-only method '"+n+"'")})}})},jS=(e,t)=>{const n={},r=o=>{o.forEach(i=>{n[i]=!0})};return Ra(e)?r(e):r(String(e).split(t)),n},VS=()=>{},$S=(e,t)=>e!=null&&Number.isFinite(e=+e)?e:t,Ef="abcdefghijklmnopqrstuvwxyz",xg="0123456789",vx={DIGIT:xg,ALPHA:Ef,ALPHA_DIGIT:Ef+Ef.toUpperCase()+xg},HS=(e=16,t=vx.ALPHA_DIGIT)=>{let n="";const{length:r}=t;for(;e--;)n+=t[Math.random()*r|0];return n};function GS(e){return!!(e&&$n(e.append)&&e[Symbol.toStringTag]==="FormData"&&e[Symbol.iterator])}const qS=e=>{const t=new Array(10),n=(r,o)=>{if(_c(r)){if(t.indexOf(r)>=0)return;if(!("toJSON"in r)){t[o]=r;const i=Ra(r)?[]:{};return $s(r,(a,s)=>{const u=n(a,o+1);!Ts(u)&&(i[s]=u)}),t[o]=void 0,i}}return r};return n(e,0)},KS=ur("AsyncFunction"),XS=e=>e&&(_c(e)||$n(e))&&$n(e.then)&&$n(e.catch),H={isArray:Ra,isArrayBuffer:lx,isBuffer:hS,isFormData:ES,isArrayBufferView:pS,isString:vS,isNumber:cx,isBoolean:mS,isObject:_c,isPlainObject:el,isReadableStream:_S,isRequest:SS,isResponse:RS,isHeaders:kS,isUndefined:Ts,isDate:gS,isFile:yS,isBlob:xS,isRegExp:WS,isFunction:$n,isStream:bS,isURLSearchParams:CS,isTypedArray:MS,isFileList:wS,forEach:$s,merge:Kd,extend:DS,trim:IS,stripBOM:TS,inherits:NS,toFlatObject:AS,kindOf:Ec,kindOfTest:ur,endsWith:PS,toArray:FS,forEachEntry:OS,matchAll:LS,isHTMLForm:BS,hasOwnProperty:yg,hasOwnProp:yg,reduceDescriptors:px,freezeMethods:zS,toObjectSet:jS,toCamelCase:US,noop:VS,toFiniteNumber:$S,findKey:fx,global:dx,isContextDefined:hx,ALPHABET:vx,generateString:HS,isSpecCompliantForm:GS,toJSONObject:qS,isAsyncFn:KS,isThenable:XS};function _e(e,t,n,r,o){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=e,this.name="AxiosError",t&&(this.code=t),n&&(this.config=n),r&&(this.request=r),o&&(this.response=o)}H.inherits(_e,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:H.toJSONObject(this.config),code:this.code,status:this.response&&this.response.status?this.response.status:null}}});const mx=_e.prototype,gx={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(e=>{gx[e]={value:e}});Object.defineProperties(_e,gx);Object.defineProperty(mx,"isAxiosError",{value:!0});_e.from=(e,t,n,r,o,i)=>{const a=Object.create(mx);return H.toFlatObject(e,a,function(u){return u!==Error.prototype},s=>s!=="isAxiosError"),_e.call(a,e.message,t,n,r,o),a.cause=e,a.name=e.name,i&&Object.assign(a,i),a};const YS=null;function Xd(e){return H.isPlainObject(e)||H.isArray(e)}function yx(e){return H.endsWith(e,"[]")?e.slice(0,-2):e}function wg(e,t,n){return e?e.concat(t).map(function(o,i){return o=yx(o),!n&&i?"["+o+"]":o}).join(n?".":""):t}function QS(e){return H.isArray(e)&&!e.some(Xd)}const JS=H.toFlatObject(H,{},null,function(t){return/^is[A-Z]/.test(t)});function Sc(e,t,n){if(!H.isObject(e))throw new TypeError("target must be an object");t=t||new FormData,n=H.toFlatObject(n,{metaTokens:!0,dots:!1,indexes:!1},!1,function(v,g){return!H.isUndefined(g[v])});const r=n.metaTokens,o=n.visitor||c,i=n.dots,a=n.indexes,u=(n.Blob||typeof Blob<"u"&&Blob)&&H.isSpecCompliantForm(t);if(!H.isFunction(o))throw new TypeError("visitor must be a function");function l(p){if(p===null)return"";if(H.isDate(p))return p.toISOString();if(!u&&H.isBlob(p))throw new _e("Blob is not supported. Use a Buffer instead.");return H.isArrayBuffer(p)||H.isTypedArray(p)?u&&typeof Blob=="function"?new Blob([p]):Buffer.from(p):p}function c(p,v,g){let m=p;if(p&&!g&&typeof p=="object"){if(H.endsWith(v,"{}"))v=r?v:v.slice(0,-2),p=JSON.stringify(p);else if(H.isArray(p)&&QS(p)||(H.isFileList(p)||H.endsWith(v,"[]"))&&(m=H.toArray(p)))return v=yx(v),m.forEach(function(x,w){!(H.isUndefined(x)||x===null)&&t.append(a===!0?wg([v],w,i):a===null?v:v+"[]",l(x))}),!1}return Xd(p)?!0:(t.append(wg(g,v,i),l(p)),!1)}const f=[],d=Object.assign(JS,{defaultVisitor:c,convertValue:l,isVisitable:Xd});function h(p,v){if(!H.isUndefined(p)){if(f.indexOf(p)!==-1)throw Error("Circular reference detected in "+v.join("."));f.push(p),H.forEach(p,function(m,y){(!(H.isUndefined(m)||m===null)&&o.call(t,m,H.isString(y)?y.trim():y,v,d))===!0&&h(m,v?v.concat(y):[y])}),f.pop()}}if(!H.isObject(e))throw new TypeError("data must be an object");return h(e),t}function bg(e){const t={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'()~]|%20|%00/g,function(r){return t[r]})}function Rp(e,t){this._pairs=[],e&&Sc(e,this,t)}const xx=Rp.prototype;xx.append=function(t,n){this._pairs.push([t,n])};xx.toString=function(t){const n=t?function(r){return t.call(this,r,bg)}:bg;return this._pairs.map(function(o){return n(o[0])+"="+n(o[1])},"").join("&")};function ZS(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function wx(e,t,n){if(!t)return e;const r=n&&n.encode||ZS,o=n&&n.serialize;let i;if(o?i=o(t,n):i=H.isURLSearchParams(t)?t.toString():new Rp(t,n).toString(r),i){const a=e.indexOf("#");a!==-1&&(e=e.slice(0,a)),e+=(e.indexOf("?")===-1?"?":"&")+i}return e}class Eg{constructor(){this.handlers=[]}use(t,n,r){return this.handlers.push({fulfilled:t,rejected:n,synchronous:r?r.synchronous:!1,runWhen:r?r.runWhen:null}),this.handlers.length-1}eject(t){this.handlers[t]&&(this.handlers[t]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(t){H.forEach(this.handlers,function(r){r!==null&&t(r)})}}const bx={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},eR=typeof URLSearchParams<"u"?URLSearchParams:Rp,tR=typeof FormData<"u"?FormData:null,nR=typeof Blob<"u"?Blob:null,rR={isBrowser:!0,classes:{URLSearchParams:eR,FormData:tR,Blob:nR},protocols:["http","https","file","blob","url","data"]},kp=typeof window<"u"&&typeof document<"u",oR=(e=>kp&&["ReactNative","NativeScript","NS"].indexOf(e)<0)(typeof navigator<"u"&&navigator.product),iR=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",aR=kp&&window.location.href||"http://localhost",sR=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:kp,hasStandardBrowserEnv:oR,hasStandardBrowserWebWorkerEnv:iR,origin:aR},Symbol.toStringTag,{value:"Module"})),ir={...sR,...rR};function uR(e,t){return Sc(e,new ir.classes.URLSearchParams,Object.assign({visitor:function(n,r,o,i){return ir.isNode&&H.isBuffer(n)?(this.append(r,n.toString("base64")),!1):i.defaultVisitor.apply(this,arguments)}},t))}function lR(e){return H.matchAll(/\w+|\[(\w*)]/g,e).map(t=>t[0]==="[]"?"":t[1]||t[0])}function cR(e){const t={},n=Object.keys(e);let r;const o=n.length;let i;for(r=0;r<o;r++)i=n[r],t[i]=e[i];return t}function Ex(e){function t(n,r,o,i){let a=n[i++];if(a==="__proto__")return!0;const s=Number.isFinite(+a),u=i>=n.length;return a=!a&&H.isArray(o)?o.length:a,u?(H.hasOwnProp(o,a)?o[a]=[o[a],r]:o[a]=r,!s):((!o[a]||!H.isObject(o[a]))&&(o[a]=[]),t(n,r,o[a],i)&&H.isArray(o[a])&&(o[a]=cR(o[a])),!s)}if(H.isFormData(e)&&H.isFunction(e.entries)){const n={};return H.forEachEntry(e,(r,o)=>{t(lR(r),o,n,0)}),n}return null}function fR(e,t,n){if(H.isString(e))try{return(t||JSON.parse)(e),H.trim(e)}catch(r){if(r.name!=="SyntaxError")throw r}return(n||JSON.stringify)(e)}const Hs={transitional:bx,adapter:["xhr","http","fetch"],transformRequest:[function(t,n){const r=n.getContentType()||"",o=r.indexOf("application/json")>-1,i=H.isObject(t);if(i&&H.isHTMLForm(t)&&(t=new FormData(t)),H.isFormData(t))return o?JSON.stringify(Ex(t)):t;if(H.isArrayBuffer(t)||H.isBuffer(t)||H.isStream(t)||H.isFile(t)||H.isBlob(t)||H.isReadableStream(t))return t;if(H.isArrayBufferView(t))return t.buffer;if(H.isURLSearchParams(t))return n.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),t.toString();let s;if(i){if(r.indexOf("application/x-www-form-urlencoded")>-1)return uR(t,this.formSerializer).toString();if((s=H.isFileList(t))||r.indexOf("multipart/form-data")>-1){const u=this.env&&this.env.FormData;return Sc(s?{"files[]":t}:t,u&&new u,this.formSerializer)}}return i||o?(n.setContentType("application/json",!1),fR(t)):t}],transformResponse:[function(t){const n=this.transitional||Hs.transitional,r=n&&n.forcedJSONParsing,o=this.responseType==="json";if(H.isResponse(t)||H.isReadableStream(t))return t;if(t&&H.isString(t)&&(r&&!this.responseType||o)){const a=!(n&&n.silentJSONParsing)&&o;try{return JSON.parse(t)}catch(s){if(a)throw s.name==="SyntaxError"?_e.from(s,_e.ERR_BAD_RESPONSE,this,null,this.response):s}}return t}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:ir.classes.FormData,Blob:ir.classes.Blob},validateStatus:function(t){return t>=200&&t<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};H.forEach(["delete","get","head","post","put","patch"],e=>{Hs.headers[e]={}});const dR=H.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),hR=e=>{const t={};let n,r,o;return e&&e.split(`
`).forEach(function(a){o=a.indexOf(":"),n=a.substring(0,o).trim().toLowerCase(),r=a.substring(o+1).trim(),!(!n||t[n]&&dR[n])&&(n==="set-cookie"?t[n]?t[n].push(r):t[n]=[r]:t[n]=t[n]?t[n]+", "+r:r)}),t},Cg=Symbol("internals");function ja(e){return e&&String(e).trim().toLowerCase()}function tl(e){return e===!1||e==null?e:H.isArray(e)?e.map(tl):String(e)}function pR(e){const t=Object.create(null),n=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let r;for(;r=n.exec(e);)t[r[1]]=r[2];return t}const vR=e=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(e.trim());function Cf(e,t,n,r,o){if(H.isFunction(r))return r.call(this,t,n);if(o&&(t=n),!!H.isString(t)){if(H.isString(r))return t.indexOf(r)!==-1;if(H.isRegExp(r))return r.test(t)}}function mR(e){return e.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(t,n,r)=>n.toUpperCase()+r)}function gR(e,t){const n=H.toCamelCase(" "+t);["get","set","has"].forEach(r=>{Object.defineProperty(e,r+n,{value:function(o,i,a){return this[r].call(this,t,o,i,a)},configurable:!0})})}class pn{constructor(t){t&&this.set(t)}set(t,n,r){const o=this;function i(s,u,l){const c=ja(u);if(!c)throw new Error("header name must be a non-empty string");const f=H.findKey(o,c);(!f||o[f]===void 0||l===!0||l===void 0&&o[f]!==!1)&&(o[f||u]=tl(s))}const a=(s,u)=>H.forEach(s,(l,c)=>i(l,c,u));if(H.isPlainObject(t)||t instanceof this.constructor)a(t,n);else if(H.isString(t)&&(t=t.trim())&&!vR(t))a(hR(t),n);else if(H.isHeaders(t))for(const[s,u]of t.entries())i(u,s,r);else t!=null&&i(n,t,r);return this}get(t,n){if(t=ja(t),t){const r=H.findKey(this,t);if(r){const o=this[r];if(!n)return o;if(n===!0)return pR(o);if(H.isFunction(n))return n.call(this,o,r);if(H.isRegExp(n))return n.exec(o);throw new TypeError("parser must be boolean|regexp|function")}}}has(t,n){if(t=ja(t),t){const r=H.findKey(this,t);return!!(r&&this[r]!==void 0&&(!n||Cf(this,this[r],r,n)))}return!1}delete(t,n){const r=this;let o=!1;function i(a){if(a=ja(a),a){const s=H.findKey(r,a);s&&(!n||Cf(r,r[s],s,n))&&(delete r[s],o=!0)}}return H.isArray(t)?t.forEach(i):i(t),o}clear(t){const n=Object.keys(this);let r=n.length,o=!1;for(;r--;){const i=n[r];(!t||Cf(this,this[i],i,t,!0))&&(delete this[i],o=!0)}return o}normalize(t){const n=this,r={};return H.forEach(this,(o,i)=>{const a=H.findKey(r,i);if(a){n[a]=tl(o),delete n[i];return}const s=t?mR(i):String(i).trim();s!==i&&delete n[i],n[s]=tl(o),r[s]=!0}),this}concat(...t){return this.constructor.concat(this,...t)}toJSON(t){const n=Object.create(null);return H.forEach(this,(r,o)=>{r!=null&&r!==!1&&(n[o]=t&&H.isArray(r)?r.join(", "):r)}),n}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([t,n])=>t+": "+n).join(`
`)}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(t){return t instanceof this?t:new this(t)}static concat(t,...n){const r=new this(t);return n.forEach(o=>r.set(o)),r}static accessor(t){const r=(this[Cg]=this[Cg]={accessors:{}}).accessors,o=this.prototype;function i(a){const s=ja(a);r[s]||(gR(o,a),r[s]=!0)}return H.isArray(t)?t.forEach(i):i(t),this}}pn.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);H.reduceDescriptors(pn.prototype,({value:e},t)=>{let n=t[0].toUpperCase()+t.slice(1);return{get:()=>e,set(r){this[n]=r}}});H.freezeMethods(pn);function _f(e,t){const n=this||Hs,r=t||n,o=pn.from(r.headers);let i=r.data;return H.forEach(e,function(s){i=s.call(n,i,o.normalize(),t?t.status:void 0)}),o.normalize(),i}function Cx(e){return!!(e&&e.__CANCEL__)}function ka(e,t,n){_e.call(this,e??"canceled",_e.ERR_CANCELED,t,n),this.name="CanceledError"}H.inherits(ka,_e,{__CANCEL__:!0});function _x(e,t,n){const r=n.config.validateStatus;!n.status||!r||r(n.status)?e(n):t(new _e("Request failed with status code "+n.status,[_e.ERR_BAD_REQUEST,_e.ERR_BAD_RESPONSE][Math.floor(n.status/100)-4],n.config,n.request,n))}function yR(e){const t=/^([-+\w]{1,25})(:?\/\/|:)/.exec(e);return t&&t[1]||""}function xR(e,t){e=e||10;const n=new Array(e),r=new Array(e);let o=0,i=0,a;return t=t!==void 0?t:1e3,function(u){const l=Date.now(),c=r[i];a||(a=l),n[o]=u,r[o]=l;let f=i,d=0;for(;f!==o;)d+=n[f++],f=f%e;if(o=(o+1)%e,o===i&&(i=(i+1)%e),l-a<t)return;const h=c&&l-c;return h?Math.round(d*1e3/h):void 0}}function wR(e,t){let n=0;const r=1e3/t;let o=null;return function(){const a=this===!0,s=Date.now();if(a||s-n>r)return o&&(clearTimeout(o),o=null),n=s,e.apply(null,arguments);o||(o=setTimeout(()=>(o=null,n=Date.now(),e.apply(null,arguments)),r-(s-n)))}}const Nl=(e,t,n=3)=>{let r=0;const o=xR(50,250);return wR(i=>{const a=i.loaded,s=i.lengthComputable?i.total:void 0,u=a-r,l=o(u),c=a<=s;r=a;const f={loaded:a,total:s,progress:s?a/s:void 0,bytes:u,rate:l||void 0,estimated:l&&s&&c?(s-a)/l:void 0,event:i,lengthComputable:s!=null};f[t?"download":"upload"]=!0,e(f)},n)},bR=ir.hasStandardBrowserEnv?function(){const t=/(msie|trident)/i.test(navigator.userAgent),n=document.createElement("a");let r;function o(i){let a=i;return t&&(n.setAttribute("href",a),a=n.href),n.setAttribute("href",a),{href:n.href,protocol:n.protocol?n.protocol.replace(/:$/,""):"",host:n.host,search:n.search?n.search.replace(/^\?/,""):"",hash:n.hash?n.hash.replace(/^#/,""):"",hostname:n.hostname,port:n.port,pathname:n.pathname.charAt(0)==="/"?n.pathname:"/"+n.pathname}}return r=o(window.location.href),function(a){const s=H.isString(a)?o(a):a;return s.protocol===r.protocol&&s.host===r.host}}():function(){return function(){return!0}}(),ER=ir.hasStandardBrowserEnv?{write(e,t,n,r,o,i){const a=[e+"="+encodeURIComponent(t)];H.isNumber(n)&&a.push("expires="+new Date(n).toGMTString()),H.isString(r)&&a.push("path="+r),H.isString(o)&&a.push("domain="+o),i===!0&&a.push("secure"),document.cookie=a.join("; ")},read(e){const t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove(e){this.write(e,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function CR(e){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(e)}function _R(e,t){return t?e.replace(/\/?\/$/,"")+"/"+t.replace(/^\/+/,""):e}function Sx(e,t){return e&&!CR(t)?_R(e,t):t}const _g=e=>e instanceof pn?{...e}:e;function ui(e,t){t=t||{};const n={};function r(l,c,f){return H.isPlainObject(l)&&H.isPlainObject(c)?H.merge.call({caseless:f},l,c):H.isPlainObject(c)?H.merge({},c):H.isArray(c)?c.slice():c}function o(l,c,f){if(H.isUndefined(c)){if(!H.isUndefined(l))return r(void 0,l,f)}else return r(l,c,f)}function i(l,c){if(!H.isUndefined(c))return r(void 0,c)}function a(l,c){if(H.isUndefined(c)){if(!H.isUndefined(l))return r(void 0,l)}else return r(void 0,c)}function s(l,c,f){if(f in t)return r(l,c);if(f in e)return r(void 0,l)}const u={url:i,method:i,data:i,baseURL:a,transformRequest:a,transformResponse:a,paramsSerializer:a,timeout:a,timeoutMessage:a,withCredentials:a,withXSRFToken:a,adapter:a,responseType:a,xsrfCookieName:a,xsrfHeaderName:a,onUploadProgress:a,onDownloadProgress:a,decompress:a,maxContentLength:a,maxBodyLength:a,beforeRedirect:a,transport:a,httpAgent:a,httpsAgent:a,cancelToken:a,socketPath:a,responseEncoding:a,validateStatus:s,headers:(l,c)=>o(_g(l),_g(c),!0)};return H.forEach(Object.keys(Object.assign({},e,t)),function(c){const f=u[c]||o,d=f(e[c],t[c],c);H.isUndefined(d)&&f!==s||(n[c]=d)}),n}const Rx=e=>{const t=ui({},e);let{data:n,withXSRFToken:r,xsrfHeaderName:o,xsrfCookieName:i,headers:a,auth:s}=t;t.headers=a=pn.from(a),t.url=wx(Sx(t.baseURL,t.url),e.params,e.paramsSerializer),s&&a.set("Authorization","Basic "+btoa((s.username||"")+":"+(s.password?unescape(encodeURIComponent(s.password)):"")));let u;if(H.isFormData(n)){if(ir.hasStandardBrowserEnv||ir.hasStandardBrowserWebWorkerEnv)a.setContentType(void 0);else if((u=a.getContentType())!==!1){const[l,...c]=u?u.split(";").map(f=>f.trim()).filter(Boolean):[];a.setContentType([l||"multipart/form-data",...c].join("; "))}}if(ir.hasStandardBrowserEnv&&(r&&H.isFunction(r)&&(r=r(t)),r||r!==!1&&bR(t.url))){const l=o&&i&&ER.read(i);l&&a.set(o,l)}return t},SR=typeof XMLHttpRequest<"u",RR=SR&&function(e){return new Promise(function(n,r){const o=Rx(e);let i=o.data;const a=pn.from(o.headers).normalize();let{responseType:s}=o,u;function l(){o.cancelToken&&o.cancelToken.unsubscribe(u),o.signal&&o.signal.removeEventListener("abort",u)}let c=new XMLHttpRequest;c.open(o.method.toUpperCase(),o.url,!0),c.timeout=o.timeout;function f(){if(!c)return;const h=pn.from("getAllResponseHeaders"in c&&c.getAllResponseHeaders()),v={data:!s||s==="text"||s==="json"?c.responseText:c.response,status:c.status,statusText:c.statusText,headers:h,config:e,request:c};_x(function(m){n(m),l()},function(m){r(m),l()},v),c=null}"onloadend"in c?c.onloadend=f:c.onreadystatechange=function(){!c||c.readyState!==4||c.status===0&&!(c.responseURL&&c.responseURL.indexOf("file:")===0)||setTimeout(f)},c.onabort=function(){c&&(r(new _e("Request aborted",_e.ECONNABORTED,o,c)),c=null)},c.onerror=function(){r(new _e("Network Error",_e.ERR_NETWORK,o,c)),c=null},c.ontimeout=function(){let p=o.timeout?"timeout of "+o.timeout+"ms exceeded":"timeout exceeded";const v=o.transitional||bx;o.timeoutErrorMessage&&(p=o.timeoutErrorMessage),r(new _e(p,v.clarifyTimeoutError?_e.ETIMEDOUT:_e.ECONNABORTED,o,c)),c=null},i===void 0&&a.setContentType(null),"setRequestHeader"in c&&H.forEach(a.toJSON(),function(p,v){c.setRequestHeader(v,p)}),H.isUndefined(o.withCredentials)||(c.withCredentials=!!o.withCredentials),s&&s!=="json"&&(c.responseType=o.responseType),typeof o.onDownloadProgress=="function"&&c.addEventListener("progress",Nl(o.onDownloadProgress,!0)),typeof o.onUploadProgress=="function"&&c.upload&&c.upload.addEventListener("progress",Nl(o.onUploadProgress)),(o.cancelToken||o.signal)&&(u=h=>{c&&(r(!h||h.type?new ka(null,e,c):h),c.abort(),c=null)},o.cancelToken&&o.cancelToken.subscribe(u),o.signal&&(o.signal.aborted?u():o.signal.addEventListener("abort",u)));const d=yR(o.url);if(d&&ir.protocols.indexOf(d)===-1){r(new _e("Unsupported protocol "+d+":",_e.ERR_BAD_REQUEST,e));return}c.send(i||null)})},kR=(e,t)=>{let n=new AbortController,r;const o=function(u){if(!r){r=!0,a();const l=u instanceof Error?u:this.reason;n.abort(l instanceof _e?l:new ka(l instanceof Error?l.message:l))}};let i=t&&setTimeout(()=>{o(new _e(`timeout ${t} of ms exceeded`,_e.ETIMEDOUT))},t);const a=()=>{e&&(i&&clearTimeout(i),i=null,e.forEach(u=>{u&&(u.removeEventListener?u.removeEventListener("abort",o):u.unsubscribe(o))}),e=null)};e.forEach(u=>u&&u.addEventListener&&u.addEventListener("abort",o));const{signal:s}=n;return s.unsubscribe=a,[s,()=>{i&&clearTimeout(i),i=null}]},IR=function*(e,t){let n=e.byteLength;if(!t||n<t){yield e;return}let r=0,o;for(;r<n;)o=r+t,yield e.slice(r,o),r=o},DR=async function*(e,t,n){for await(const r of e)yield*IR(ArrayBuffer.isView(r)?r:await n(String(r)),t)},Sg=(e,t,n,r,o)=>{const i=DR(e,t,o);let a=0;return new ReadableStream({type:"bytes",async pull(s){const{done:u,value:l}=await i.next();if(u){s.close(),r();return}let c=l.byteLength;n&&n(a+=c),s.enqueue(new Uint8Array(l))},cancel(s){return r(s),i.return()}},{highWaterMark:2})},Rg=(e,t)=>{const n=e!=null;return r=>setTimeout(()=>t({lengthComputable:n,total:e,loaded:r}))},Rc=typeof fetch=="function"&&typeof Request=="function"&&typeof Response=="function",kx=Rc&&typeof ReadableStream=="function",Yd=Rc&&(typeof TextEncoder=="function"?(e=>t=>e.encode(t))(new TextEncoder):async e=>new Uint8Array(await new Response(e).arrayBuffer())),TR=kx&&(()=>{let e=!1;const t=new Request(ir.origin,{body:new ReadableStream,method:"POST",get duplex(){return e=!0,"half"}}).headers.has("Content-Type");return e&&!t})(),kg=64*1024,Qd=kx&&!!(()=>{try{return H.isReadableStream(new Response("").body)}catch{}})(),Al={stream:Qd&&(e=>e.body)};Rc&&(e=>{["text","arrayBuffer","blob","formData","stream"].forEach(t=>{!Al[t]&&(Al[t]=H.isFunction(e[t])?n=>n[t]():(n,r)=>{throw new _e(`Response type '${t}' is not supported`,_e.ERR_NOT_SUPPORT,r)})})})(new Response);const NR=async e=>{if(e==null)return 0;if(H.isBlob(e))return e.size;if(H.isSpecCompliantForm(e))return(await new Request(e).arrayBuffer()).byteLength;if(H.isArrayBufferView(e))return e.byteLength;if(H.isURLSearchParams(e)&&(e=e+""),H.isString(e))return(await Yd(e)).byteLength},AR=async(e,t)=>{const n=H.toFiniteNumber(e.getContentLength());return n??NR(t)},PR=Rc&&(async e=>{let{url:t,method:n,data:r,signal:o,cancelToken:i,timeout:a,onDownloadProgress:s,onUploadProgress:u,responseType:l,headers:c,withCredentials:f="same-origin",fetchOptions:d}=Rx(e);l=l?(l+"").toLowerCase():"text";let[h,p]=o||i||a?kR([o,i],a):[],v,g;const m=()=>{!v&&setTimeout(()=>{h&&h.unsubscribe()}),v=!0};let y;try{if(u&&TR&&n!=="get"&&n!=="head"&&(y=await AR(c,r))!==0){let b=new Request(t,{method:"POST",body:r,duplex:"half"}),C;H.isFormData(r)&&(C=b.headers.get("content-type"))&&c.setContentType(C),b.body&&(r=Sg(b.body,kg,Rg(y,Nl(u)),null,Yd))}H.isString(f)||(f=f?"cors":"omit"),g=new Request(t,{...d,signal:h,method:n.toUpperCase(),headers:c.normalize().toJSON(),body:r,duplex:"half",withCredentials:f});let x=await fetch(g);const w=Qd&&(l==="stream"||l==="response");if(Qd&&(s||w)){const b={};["status","statusText","headers"].forEach(_=>{b[_]=x[_]});const C=H.toFiniteNumber(x.headers.get("content-length"));x=new Response(Sg(x.body,kg,s&&Rg(C,Nl(s,!0)),w&&m,Yd),b)}l=l||"text";let E=await Al[H.findKey(Al,l)||"text"](x,e);return!w&&m(),p&&p(),await new Promise((b,C)=>{_x(b,C,{data:E,headers:pn.from(x.headers),status:x.status,statusText:x.statusText,config:e,request:g})})}catch(x){throw m(),x&&x.name==="TypeError"&&/fetch/i.test(x.message)?Object.assign(new _e("Network Error",_e.ERR_NETWORK,e,g),{cause:x.cause||x}):_e.from(x,x&&x.code,e,g)}}),Jd={http:YS,xhr:RR,fetch:PR};H.forEach(Jd,(e,t)=>{if(e){try{Object.defineProperty(e,"name",{value:t})}catch{}Object.defineProperty(e,"adapterName",{value:t})}});const Ig=e=>`- ${e}`,FR=e=>H.isFunction(e)||e===null||e===!1,Ix={getAdapter:e=>{e=H.isArray(e)?e:[e];const{length:t}=e;let n,r;const o={};for(let i=0;i<t;i++){n=e[i];let a;if(r=n,!FR(n)&&(r=Jd[(a=String(n)).toLowerCase()],r===void 0))throw new _e(`Unknown adapter '${a}'`);if(r)break;o[a||"#"+i]=r}if(!r){const i=Object.entries(o).map(([s,u])=>`adapter ${s} `+(u===!1?"is not supported by the environment":"is not available in the build"));let a=t?i.length>1?`since :
`+i.map(Ig).join(`
`):" "+Ig(i[0]):"as no adapter specified";throw new _e("There is no suitable adapter to dispatch the request "+a,"ERR_NOT_SUPPORT")}return r},adapters:Jd};function Sf(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new ka(null,e)}function Dg(e){return Sf(e),e.headers=pn.from(e.headers),e.data=_f.call(e,e.transformRequest),["post","put","patch"].indexOf(e.method)!==-1&&e.headers.setContentType("application/x-www-form-urlencoded",!1),Ix.getAdapter(e.adapter||Hs.adapter)(e).then(function(r){return Sf(e),r.data=_f.call(e,e.transformResponse,r),r.headers=pn.from(r.headers),r},function(r){return Cx(r)||(Sf(e),r&&r.response&&(r.response.data=_f.call(e,e.transformResponse,r.response),r.response.headers=pn.from(r.response.headers))),Promise.reject(r)})}const Dx="1.7.2",Ip={};["object","boolean","number","function","string","symbol"].forEach((e,t)=>{Ip[e]=function(r){return typeof r===e||"a"+(t<1?"n ":" ")+e}});const Tg={};Ip.transitional=function(t,n,r){function o(i,a){return"[Axios v"+Dx+"] Transitional option '"+i+"'"+a+(r?". "+r:"")}return(i,a,s)=>{if(t===!1)throw new _e(o(a," has been removed"+(n?" in "+n:"")),_e.ERR_DEPRECATED);return n&&!Tg[a]&&(Tg[a]=!0,console.warn(o(a," has been deprecated since v"+n+" and will be removed in the near future"))),t?t(i,a,s):!0}};function MR(e,t,n){if(typeof e!="object")throw new _e("options must be an object",_e.ERR_BAD_OPTION_VALUE);const r=Object.keys(e);let o=r.length;for(;o-- >0;){const i=r[o],a=t[i];if(a){const s=e[i],u=s===void 0||a(s,i,e);if(u!==!0)throw new _e("option "+i+" must be "+u,_e.ERR_BAD_OPTION_VALUE);continue}if(n!==!0)throw new _e("Unknown option "+i,_e.ERR_BAD_OPTION)}}const Zd={assertOptions:MR,validators:Ip},ro=Zd.validators;class ei{constructor(t){this.defaults=t,this.interceptors={request:new Eg,response:new Eg}}async request(t,n){try{return await this._request(t,n)}catch(r){if(r instanceof Error){let o;Error.captureStackTrace?Error.captureStackTrace(o={}):o=new Error;const i=o.stack?o.stack.replace(/^.+\n/,""):"";try{r.stack?i&&!String(r.stack).endsWith(i.replace(/^.+\n.+\n/,""))&&(r.stack+=`
`+i):r.stack=i}catch{}}throw r}}_request(t,n){typeof t=="string"?(n=n||{},n.url=t):n=t||{},n=ui(this.defaults,n);const{transitional:r,paramsSerializer:o,headers:i}=n;r!==void 0&&Zd.assertOptions(r,{silentJSONParsing:ro.transitional(ro.boolean),forcedJSONParsing:ro.transitional(ro.boolean),clarifyTimeoutError:ro.transitional(ro.boolean)},!1),o!=null&&(H.isFunction(o)?n.paramsSerializer={serialize:o}:Zd.assertOptions(o,{encode:ro.function,serialize:ro.function},!0)),n.method=(n.method||this.defaults.method||"get").toLowerCase();let a=i&&H.merge(i.common,i[n.method]);i&&H.forEach(["delete","get","head","post","put","patch","common"],p=>{delete i[p]}),n.headers=pn.concat(a,i);const s=[];let u=!0;this.interceptors.request.forEach(function(v){typeof v.runWhen=="function"&&v.runWhen(n)===!1||(u=u&&v.synchronous,s.unshift(v.fulfilled,v.rejected))});const l=[];this.interceptors.response.forEach(function(v){l.push(v.fulfilled,v.rejected)});let c,f=0,d;if(!u){const p=[Dg.bind(this),void 0];for(p.unshift.apply(p,s),p.push.apply(p,l),d=p.length,c=Promise.resolve(n);f<d;)c=c.then(p[f++],p[f++]);return c}d=s.length;let h=n;for(f=0;f<d;){const p=s[f++],v=s[f++];try{h=p(h)}catch(g){v.call(this,g);break}}try{c=Dg.call(this,h)}catch(p){return Promise.reject(p)}for(f=0,d=l.length;f<d;)c=c.then(l[f++],l[f++]);return c}getUri(t){t=ui(this.defaults,t);const n=Sx(t.baseURL,t.url);return wx(n,t.params,t.paramsSerializer)}}H.forEach(["delete","get","head","options"],function(t){ei.prototype[t]=function(n,r){return this.request(ui(r||{},{method:t,url:n,data:(r||{}).data}))}});H.forEach(["post","put","patch"],function(t){function n(r){return function(i,a,s){return this.request(ui(s||{},{method:t,headers:r?{"Content-Type":"multipart/form-data"}:{},url:i,data:a}))}}ei.prototype[t]=n(),ei.prototype[t+"Form"]=n(!0)});class Dp{constructor(t){if(typeof t!="function")throw new TypeError("executor must be a function.");let n;this.promise=new Promise(function(i){n=i});const r=this;this.promise.then(o=>{if(!r._listeners)return;let i=r._listeners.length;for(;i-- >0;)r._listeners[i](o);r._listeners=null}),this.promise.then=o=>{let i;const a=new Promise(s=>{r.subscribe(s),i=s}).then(o);return a.cancel=function(){r.unsubscribe(i)},a},t(function(i,a,s){r.reason||(r.reason=new ka(i,a,s),n(r.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(t){if(this.reason){t(this.reason);return}this._listeners?this._listeners.push(t):this._listeners=[t]}unsubscribe(t){if(!this._listeners)return;const n=this._listeners.indexOf(t);n!==-1&&this._listeners.splice(n,1)}static source(){let t;return{token:new Dp(function(o){t=o}),cancel:t}}}function OR(e){return function(n){return e.apply(null,n)}}function LR(e){return H.isObject(e)&&e.isAxiosError===!0}const eh={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(eh).forEach(([e,t])=>{eh[t]=e});function Tx(e){const t=new ei(e),n=ux(ei.prototype.request,t);return H.extend(n,ei.prototype,t,{allOwnKeys:!0}),H.extend(n,t,null,{allOwnKeys:!0}),n.create=function(o){return Tx(ui(e,o))},n}const Xe=Tx(Hs);Xe.Axios=ei;Xe.CanceledError=ka;Xe.CancelToken=Dp;Xe.isCancel=Cx;Xe.VERSION=Dx;Xe.toFormData=Sc;Xe.AxiosError=_e;Xe.Cancel=Xe.CanceledError;Xe.all=function(t){return Promise.all(t)};Xe.spread=OR;Xe.isAxiosError=LR;Xe.mergeConfig=ui;Xe.AxiosHeaders=pn;Xe.formToJSON=e=>Ex(H.isHTMLForm(e)?new FormData(e):e);Xe.getAdapter=Ix.getAdapter;Xe.HttpStatusCode=eh;Xe.default=Xe;function BR(){const[e,t]=X.useState(""),[n,r]=X.useState(""),o=async i=>{i.preventDefault(),navigator.geolocation?navigator.geolocation.getCurrentPosition(async a=>{const s=a.coords.latitude,u=a.coords.longitude;try{const l=await Xe.post("https://sdl-back.vercel.app/mark-attendance",{name:e,rollNumber:n,lat:s,lon:u},{withCredentials:!0});alert(l.data)}catch(l){l.response&&l.response.data?alert(l.response.data):alert("Failed to mark attendance")}},a=>{alert("Failed to get location. Please enable location services.")}):alert("Geolocation is not supported by this browser.")};return Z.jsxs("div",{children:[Z.jsx("h1",{children:"Mark Attendance"}),Z.jsxs("form",{onSubmit:o,children:[Z.jsx("label",{htmlFor:"name",children:"Name:"}),Z.jsx("input",{type:"text",id:"name",name:"name",value:e,onChange:i=>t(i.target.value),required:!0}),Z.jsx("br",{}),Z.jsx("br",{}),Z.jsx("label",{htmlFor:"rollNumber",children:"Roll Number:"}),Z.jsx("input",{type:"text",id:"rollNumber",name:"rollNumber",value:n,onChange:i=>r(i.target.value),required:!0}),Z.jsx("br",{}),Z.jsx("br",{}),Z.jsx("button",{type:"submit",children:"Mark Attendance"})]})]})}var Nx={exports:{}};(function(e,t){(function(r,o){e.exports=o(X)})(o2,function(n){return function(r){var o={};function i(a){if(o[a])return o[a].exports;var s=o[a]={i:a,l:!1,exports:{}};return r[a].call(s.exports,s,s.exports,i),s.l=!0,s.exports}return i.m=r,i.c=o,i.d=function(a,s,u){i.o(a,s)||Object.defineProperty(a,s,{enumerable:!0,get:u})},i.r=function(a){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(a,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(a,"__esModule",{value:!0})},i.t=function(a,s){if(s&1&&(a=i(a)),s&8||s&4&&typeof a=="object"&&a&&a.__esModule)return a;var u=Object.create(null);if(i.r(u),Object.defineProperty(u,"default",{enumerable:!0,value:a}),s&2&&typeof a!="string")for(var l in a)i.d(u,l,(function(c){return a[c]}).bind(null,l));return u},i.n=function(a){var s=a&&a.__esModule?function(){return a.default}:function(){return a};return i.d(s,"a",s),s},i.o=function(a,s){return Object.prototype.hasOwnProperty.call(a,s)},i.p="",i(i.s="./src/react-webcam.tsx")}({"./src/react-webcam.tsx":function(r,o,i){i.r(o);var a=i("react"),s=function(){var d=function(h,p){return d=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(v,g){v.__proto__=g}||function(v,g){for(var m in g)g.hasOwnProperty(m)&&(v[m]=g[m])},d(h,p)};return function(h,p){d(h,p);function v(){this.constructor=h}h.prototype=p===null?Object.create(p):(v.prototype=p.prototype,new v)}}(),u=function(){return u=Object.assign||function(d){for(var h,p=1,v=arguments.length;p<v;p++){h=arguments[p];for(var g in h)Object.prototype.hasOwnProperty.call(h,g)&&(d[g]=h[g])}return d},u.apply(this,arguments)},l=function(d,h){var p={};for(var v in d)Object.prototype.hasOwnProperty.call(d,v)&&h.indexOf(v)<0&&(p[v]=d[v]);if(d!=null&&typeof Object.getOwnPropertySymbols=="function")for(var g=0,v=Object.getOwnPropertySymbols(d);g<v.length;g++)h.indexOf(v[g])<0&&Object.prototype.propertyIsEnumerable.call(d,v[g])&&(p[v[g]]=d[v[g]]);return p};(function(){typeof window>"u"||(navigator.mediaDevices===void 0&&(navigator.mediaDevices={}),navigator.mediaDevices.getUserMedia===void 0&&(navigator.mediaDevices.getUserMedia=function(h){var p=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia;return p?new Promise(function(v,g){p.call(navigator,h,v,g)}):Promise.reject(new Error("getUserMedia is not implemented in this browser"))}))})();function c(){return!!(navigator.mediaDevices&&navigator.mediaDevices.getUserMedia)}var f=function(d){s(h,d);function h(p){var v=d.call(this,p)||this;return v.canvas=null,v.ctx=null,v.requestUserMediaId=0,v.unmounted=!1,v.state={hasUserMedia:!1},v}return h.prototype.componentDidMount=function(){var p=this,v=p.state,g=p.props;if(this.unmounted=!1,!c()){g.onUserMediaError("getUserMedia not supported");return}v.hasUserMedia||this.requestUserMedia(),g.children&&typeof g.children!="function"&&console.warn("children must be a function")},h.prototype.componentDidUpdate=function(p){var v=this.props;if(!c()){v.onUserMediaError("getUserMedia not supported");return}var g=JSON.stringify(p.audioConstraints)!==JSON.stringify(v.audioConstraints),m=JSON.stringify(p.videoConstraints)!==JSON.stringify(v.videoConstraints),y=p.minScreenshotWidth!==v.minScreenshotWidth,x=p.minScreenshotHeight!==v.minScreenshotHeight;(m||y||x)&&(this.canvas=null,this.ctx=null),(g||m)&&(this.stopAndCleanup(),this.requestUserMedia())},h.prototype.componentWillUnmount=function(){this.unmounted=!0,this.stopAndCleanup()},h.stopMediaStream=function(p){p&&(p.getVideoTracks&&p.getAudioTracks?(p.getVideoTracks().map(function(v){p.removeTrack(v),v.stop()}),p.getAudioTracks().map(function(v){p.removeTrack(v),v.stop()})):p.stop())},h.prototype.stopAndCleanup=function(){var p=this.state;p.hasUserMedia&&(h.stopMediaStream(this.stream),p.src&&window.URL.revokeObjectURL(p.src))},h.prototype.getScreenshot=function(p){var v=this,g=v.state,m=v.props;if(!g.hasUserMedia)return null;var y=this.getCanvas(p);return y&&y.toDataURL(m.screenshotFormat,m.screenshotQuality)},h.prototype.getCanvas=function(p){var v=this,g=v.state,m=v.props;if(!this.video||!g.hasUserMedia||!this.video.videoHeight)return null;if(!this.ctx){var y=this.video.videoWidth,x=this.video.videoHeight;if(!this.props.forceScreenshotSourceSize){var w=y/x;y=m.minScreenshotWidth||this.video.clientWidth,x=y/w,m.minScreenshotHeight&&x<m.minScreenshotHeight&&(x=m.minScreenshotHeight,y=x*w)}this.canvas=document.createElement("canvas"),this.canvas.width=(p==null?void 0:p.width)||y,this.canvas.height=(p==null?void 0:p.height)||x,this.ctx=this.canvas.getContext("2d")}var E=this,b=E.ctx,C=E.canvas;return b&&C&&(C.width=(p==null?void 0:p.width)||C.width,C.height=(p==null?void 0:p.height)||C.height,m.mirrored&&(b.translate(C.width,0),b.scale(-1,1)),b.imageSmoothingEnabled=m.imageSmoothing,b.drawImage(this.video,0,0,(p==null?void 0:p.width)||C.width,(p==null?void 0:p.height)||C.height),m.mirrored&&(b.scale(-1,1),b.translate(-C.width,0))),C},h.prototype.requestUserMedia=function(){var p=this,v=this.props,g=function(x,w){var E={video:typeof w<"u"?w:!0};v.audio&&(E.audio=typeof x<"u"?x:!0),p.requestUserMediaId++;var b=p.requestUserMediaId;navigator.mediaDevices.getUserMedia(E).then(function(C){p.unmounted||b!==p.requestUserMediaId?h.stopMediaStream(C):p.handleUserMedia(null,C)}).catch(function(C){p.handleUserMedia(C)})};if("mediaDevices"in navigator)g(v.audioConstraints,v.videoConstraints);else{var m=function(x){return{optional:[{sourceId:x}]}},y=function(x){var w=x.deviceId;return typeof w=="string"?w:Array.isArray(w)&&w.length>0?w[0]:typeof w=="object"&&w.ideal?w.ideal:null};MediaStreamTrack.getSources(function(x){var w=null,E=null;x.forEach(function(_){_.kind==="audio"?w=_.id:_.kind==="video"&&(E=_.id)});var b=y(v.audioConstraints);b&&(w=b);var C=y(v.videoConstraints);C&&(E=C),g(m(w),m(E))})}},h.prototype.handleUserMedia=function(p,v){var g=this.props;if(p||!v){this.setState({hasUserMedia:!1}),g.onUserMediaError(p);return}this.stream=v;try{this.video&&(this.video.srcObject=v),this.setState({hasUserMedia:!0})}catch{this.setState({hasUserMedia:!0,src:window.URL.createObjectURL(v)})}g.onUserMedia(v)},h.prototype.render=function(){var p=this,v=this,g=v.state,m=v.props,y=m.audio;m.forceScreenshotSourceSize;var x=m.disablePictureInPicture;m.onUserMedia,m.onUserMediaError,m.screenshotFormat,m.screenshotQuality,m.minScreenshotWidth,m.minScreenshotHeight,m.audioConstraints,m.videoConstraints,m.imageSmoothing;var w=m.mirrored,E=m.style,b=E===void 0?{}:E,C=m.children,_=l(m,["audio","forceScreenshotSourceSize","disablePictureInPicture","onUserMedia","onUserMediaError","screenshotFormat","screenshotQuality","minScreenshotWidth","minScreenshotHeight","audioConstraints","videoConstraints","imageSmoothing","mirrored","style","children"]),S=w?u(u({},b),{transform:(b.transform||"")+" scaleX(-1)"}):b,R={getScreenshot:this.getScreenshot.bind(this)};return a.createElement(a.Fragment,null,a.createElement("video",u({autoPlay:!0,disablePictureInPicture:x,src:g.src,muted:!y,playsInline:!0,ref:function(D){p.video=D},style:S},_)),C&&C(R))},h.defaultProps={audio:!1,disablePictureInPicture:!1,forceScreenshotSourceSize:!1,imageSmoothing:!0,mirrored:!1,onUserMedia:function(){},onUserMediaError:function(){},screenshotFormat:"image/webp",screenshotQuality:.92},h}(a.Component);o.default=f},react:function(r,o){r.exports=n}}).default})})(Nx);var UR=Nx.exports;const Ax=_h(UR);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var Px=function(e,t){return(Px=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var o in r)r.hasOwnProperty(o)&&(n[o]=r[o])})(e,t)};function lr(e,t){function n(){this.constructor=e}Px(e,t),e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}function se(e,t,n,r){return new(n||(n=Promise))(function(o,i){function a(l){try{u(r.next(l))}catch(c){i(c)}}function s(l){try{u(r.throw(l))}catch(c){i(c)}}function u(l){l.done?o(l.value):new n(function(c){c(l.value)}).then(a,s)}u((r=r.apply(e,[])).next())})}function ue(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},typeof Symbol=="function"&&(i[Symbol.iterator]=function(){return this}),i;function s(u){return function(l){return function(c){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&c[0]?r.return:c[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,c[1])).done)return o;switch(r=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return a.label++,{value:c[1],done:!1};case 5:a.label++,r=c[1],c=[0];continue;case 7:c=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(c[0]===6||c[0]===2)){a=0;continue}if(c[0]===3&&(!o||c[1]>o[0]&&c[1]<o[3])){a.label=c[1];break}if(c[0]===6&&a.label<o[1]){a.label=o[1],o=c;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(c);break}o[2]&&a.ops.pop(),a.trys.pop();continue}c=t.call(e,a)}catch(f){c=[6,f],r=0}finally{n=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([u,l])}}}var WR=function(){function e(t){this.global=t,this.flags={},this.flagRegistry={},this.urlFlags={},this.populateURLFlags()}return e.prototype.setPlatform=function(t,n){this.platform!=null&&console.warn("Platform "+this.platformName+" has already been set. Overwriting the platform with "+n+"."),this.platformName=t,this.platform=n},e.prototype.registerFlag=function(t,n,r){if(this.flagRegistry[t]={evaluationFn:n,setHook:r},this.urlFlags[t]!=null){var o=this.urlFlags[t];console.warn("Setting feature override from URL "+t+": "+o+"."),this.set(t,o)}},e.prototype.get=function(t){return t in this.flags?this.flags[t]:(this.flags[t]=this.evaluateFlag(t),this.flags[t])},e.prototype.getNumber=function(t){return this.get(t)},e.prototype.getBool=function(t){return this.get(t)},e.prototype.getFlags=function(){return this.flags},Object.defineProperty(e.prototype,"features",{get:function(){return this.flags},enumerable:!0,configurable:!0}),e.prototype.set=function(t,n){if(this.flagRegistry[t]==null)throw new Error("Cannot set flag "+t+" as it has not been registered.");this.flags[t]=n,this.flagRegistry[t].setHook!=null&&this.flagRegistry[t].setHook(n)},e.prototype.evaluateFlag=function(t){if(this.flagRegistry[t]==null)throw new Error("Cannot evaluate flag '"+t+"': no evaluation function found.");return this.flagRegistry[t].evaluationFn()},e.prototype.setFlags=function(t){this.flags=Object.assign({},t)},e.prototype.reset=function(){this.flags={},this.urlFlags={},this.populateURLFlags()},e.prototype.populateURLFlags=function(){var t=this;if(this.global!==void 0&&this.global.location!==void 0&&this.global.location.search!==void 0){var n,r,o=(n=this.global.location.search,r={},n.replace(/[?&]([^=?&]+)(?:=([^&]*))?/g,function(i){for(var a=[],s=1;s<arguments.length;s++)a[s-1]=arguments[s];return zR(r,a[0],a[1]),a.join("=")}),r);"tfjsflags"in o&&o.tfjsflags.split(",").forEach(function(i){var a=i.split(":"),s=a[0],u=a[1];t.urlFlags[s]=function(l,c){if((c=c.toLowerCase())==="true"||c==="false")return c==="true";if(""+ +c===c)return+c;throw new Error("Could not parse value flag value "+c+" for flag "+l+".")}(s,u)})}},e}();function zR(e,t,n){e[decodeURIComponent(t)]=decodeURIComponent(n||"")}function G(){return Fx}var Fx=null,Pl=new Map,th=new Map;function Mx(e,t){var n=Lx(e,t);return Pl.get(n)}function jR(e){return th.get(e)}function Ng(e){for(var t=Pl.entries(),n=[];;){var r=t.next(),o=r.done,i=r.value;if(o)break;var a=i[0],s=i[1];a.split("_")[0]===e&&n.push(s)}return n}function Ox(e){var t=e.kernelName,n=e.backendName,r=Lx(t,n);if(Pl.has(r))throw new Error("The kernel '"+t+"' for backend '"+n+"' is already registered");Pl.set(r,e)}function VR(e){var t=e.kernelName;th.has(t)&&console.warn("Overriding the gradient for '"+t+"'"),th.set(t,e)}function Lx(e,t){return t+"_"+e}function nh(e,t,n){return Math.max(e,Math.min(t,n))}function Bx(e){return e%2==0?e:e+1}function $R(e){for(var t=0,n=0;n<e.length;n++)t+=e[n];return t}function I(e,t){if(!e)throw new Error(typeof t=="string"?t:t())}function je(e,t,n){n===void 0&&(n=""),I(Ft(e,t),function(){return n+" Shapes "+e+" and "+t+" must match"})}function Ia(e){I(e!=null,function(){return"The input to the tensor constructor must be a non-null value."})}function ya(e,t,n){if(t===void 0&&(t=[]),n===void 0&&(n=!1),t==null&&(t=[]),Array.isArray(e)||Sr(e)&&!n)for(var r=0;r<e.length;++r)ya(e[r],t,n);else t.push(e);return t}function le(e){if(e.length===0)return 1;for(var t=e[0],n=1;n<e.length;n++)t*=e[n];return t}function Ft(e,t){if(e===t)return!0;if(e==null||t==null||e.length!==t.length)return!1;for(var n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}function mt(e){return e%1==0}function HR(e){if(Math.tanh!=null)return Math.tanh(e);if(e===1/0)return 1;if(e===-1/0)return-1;var t=Math.exp(2*e);return(t-1)/(t+1)}function rh(e){var t=Math.ceil(Math.sqrt(e));return[t,Math.ceil(e/t)]}function na(e,t){return t<=e.length?e:e+" ".repeat(t-e.length)}function Ag(e,t,n){return t===void 0&&(t=function(r){return 0}),new Promise(function(r,o){var i=0,a=function(){if(e())r();else{i++;var s=t(i);n!=null&&i>=n?o():setTimeout(a,s)}};a()})}function GR(e,t){for(var n=1,r=-1,o=0;o<e.length;++o)if(e[o]>=0)n*=e[o];else if(e[o]===-1){if(r!==-1)throw Error("Shapes can only have 1 implicit size. Found -1 at dim "+r+" and dim "+o);r=o}else if(e[o]<0)throw Error("Shapes can not be < 0. Found "+e[o]+" at dim "+o);if(r===-1){if(t>0&&t!==n)throw Error("Size("+t+") must match the product of shape "+e);return e}if(n===0)throw Error("Cannot infer the missing size in ["+e+"] when there are 0 elements");if(t%n!=0)throw Error("The implicit shape can't be a fractional number. Got "+t+" / "+n);var i=e.slice();return i[r]=t/n,i}function Dt(e,t){var n=t.length;return I((e=e==null?t.map(function(r,o){return o}):[].concat(e)).every(function(r){return r>=-n&&r<n}),function(){return"All values in axis param must be in range [-"+n+", "+n+") but got axis "+e}),I(e.every(function(r){return mt(r)}),function(){return"All values in axis param must be integers but got axis "+e}),e.map(function(r){return r<0?n+r:r})}function $o(e,t){for(var n=[],r=[],o=t!=null&&Array.isArray(t)&&t.length===0,i=t==null||o?null:Dt(t,e).sort(),a=0,s=0;s<e.length;++s){if(i!=null){if(i[a]===s&&e[s]!==1)throw new Error("Can't squeeze axis "+s+" since its dim '"+e[s]+"' is not 1");(i[a]==null||i[a]>s)&&e[s]===1&&(n.push(e[s]),r.push(s)),i[a]<=s&&a++}e[s]!==1&&(n.push(e[s]),r.push(s))}return{newShape:n,keptDims:r}}function Ns(e,t){var n=null;if(e==null||e==="float32")n=new Float32Array(t);else if(e==="int32")n=new Int32Array(t);else{if(e!=="bool")throw new Error("Unknown data type "+e);n=new Uint8Array(t)}return n}function Fl(e,t){var n=null;if(e==null||e==="float32")n=new Float32Array(t);else if(e==="int32")n=new Int32Array(t);else if(e==="bool")n=new Uint8Array(t);else{if(e!=="string")throw new Error("Unknown data type "+e);n=new Array(t)}return n}function qR(e,t){for(var n=0;n<e.length;n++){var r=e[n];if(isNaN(r)||!isFinite(r))throw Error("A tensor of type "+t+" being uploaded contains "+r+".")}}function KR(e){return e==="bool"||e==="complex64"||e==="float32"||e==="int32"||e==="string"}function XR(e,t){return t!=="complex64"&&(t!=="float32"||e==="complex64")&&(t!=="int32"||e==="float32"||e==="complex64")&&(t!=="bool"||e!=="bool")}function Sr(e){return e instanceof Float32Array||e instanceof Int32Array||e instanceof Uint8Array}function Ux(e){if(e==="float32"||e==="int32")return 4;if(e==="complex64")return 8;if(e==="bool")return 1;throw new Error("Unknown dtype "+e)}function YR(e){if(e==null)return 0;var t=0;return e.forEach(function(n){return t+=n.length}),t}function Tp(e){return typeof e=="string"||e instanceof String}function QR(e){return typeof e=="boolean"}function JR(e){return typeof e=="number"}function Gs(e){return Array.isArray(e)?Gs(e[0]):e instanceof Float32Array?"float32":e instanceof Int32Array||e instanceof Uint8Array?"int32":JR(e)?"float32":Tp(e)?"string":QR(e)?"bool":"float32"}function oh(e){return!!(e&&e.constructor&&e.call&&e.apply)}function ih(e,t){for(var n=t;n<e;++n)if(e%n==0)return n;return e}function Rr(e){var t=e.length;if(t<2)return[];var n=new Array(t-1);n[t-2]=e[t-1];for(var r=t-3;r>=0;--r)n[r]=n[r+1]*e[r+1];return n}function Wx(e,t,n){if(t==="string")throw new Error("Cannot convert a string[] to a TypedArray");if(Array.isArray(e)&&(e=ya(e)),n&&qR(e,t),function(i,a){return i instanceof Float32Array&&a==="float32"||i instanceof Int32Array&&a==="int32"||i instanceof Uint8Array&&a==="bool"}(e,t))return e;if(t==null||t==="float32"||t==="complex64")return new Float32Array(e);if(t==="int32")return new Int32Array(e);if(t==="bool"){for(var r=new Uint8Array(e.length),o=0;o<r.length;++o)Math.round(e[o])!==0&&(r[o]=1);return r}throw new Error("Unknown data type "+t)}function Pg(e,t){if(e.length===0)return t[0];var n=e.reduce(function(r,o){return r*o});if(n===0)return[];if(n!==t.length)throw new Error("["+e+"] does not match the input size.");return function r(o,i,a){var s=new Array;if(i.length===1)for(var u=i[0],l=0;l<u;l++)s[l]=a[o+l];else{u=i[0];var c=i.slice(1),f=c.reduce(function(d,h){return d*h});for(l=0;l<u;l++)s[l]=r(o+l*f,c,a)}return s}(0,e,t)}function zx(e,t){for(var n=qs(e,t),r=0;r<n.length;r++)n[r]=1;return n}function qs(e,t){if(t==null||t==="float32"||t==="complex64")return new Float32Array(e);if(t==="int32")return new Int32Array(e);if(t==="bool")return new Uint8Array(e);throw new Error("Unknown data type "+t)}function yr(){return G().platform.now()}function jx(e){e.forEach(function(t){I(Number.isInteger(t)&&t>=0,function(){return"Tensor must have a shape comprised of positive integers but got shape ["+e+"]."})})}function ZR(e,t){return t===void 0&&(t="utf-8"),t=t||"utf-8",G().platform.encode(e,t)}function Ml(e,t){return t===void 0&&(t="utf-8"),t=t||"utf-8",G().platform.decode(e,t)}function Fg(e,t,n){if(t===0)return 0;if(t===1)return e[0];for(var r=e[e.length-1],o=0;o<e.length-1;++o)r+=n[o]*e[o];return r}function ek(e,t,n){if(t===0)return[];if(t===1)return[e];for(var r=new Array(t),o=0;o<r.length-1;++o)r[o]=Math.floor(e/n[o]),e-=r[o]*n[o];return r[r.length-1]=e,r}var tk=function(){function e(t,n){this.backendTimer=t,this.logger=n,n==null&&(this.logger=new nk)}return e.prototype.profileKernel=function(t,n,r){var o,i=this,a=this.backendTimer.time(function(){o=r()});return o.forEach(function(s){s.data().then(function(u){(function(l,c,f){if(c!=="float32")return!1;for(var d=0;d<l.length;d++){var h=l[d];if(isNaN(h)||!isFinite(h))return console.warn("Found "+h+" in the result of '"+f+"'"),!0}})(u,s.dtype,t),a.then(function(l){var c="";l.getExtraProfileInfo!=null&&(c=l.getExtraProfileInfo()),i.logger.logKernelProfile(t,s,u,l.kernelMs,n,c)})})}),o},e}(),nk=function(){function e(){}return e.prototype.logKernelProfile=function(t,n,r,o,i,a){var s=typeof o=="number"?na(o+"ms",9):o.error,u=na(t,25),l=n.rank,c=n.size,f=na(n.shape.toString(),14),d="";for(var h in i){var p=i[h].shape||n.shape,v=p.length;d+=h+": "+v+"D "+(v>0?p:"")+" "}console.log("%c"+u+"	%c"+s+"	%c"+l+"D "+f+"	%c"+c+"	%c"+d+"	%c"+a,"font-weight:bold","color:red","color:blue","color: orange","color: green","color: steelblue")},e}(),Mg=20,Va=3,Rf=7;function rk(e,t,n,r){var o=Rr(t),i=function(l,c,f,d){var h=le(c),p=d[d.length-1],v=new Array(p).fill(0),g=c.length,m=f==="complex64"?Ha(l):l;if(g>1)for(var y=0;y<h/p;y++)for(var x=y*p,w=0;w<p;w++)v[w]=Math.max(v[w],$a(m[x+w],0,f).length);return v}(e,t,n,o),a=t.length,s=function l(c,f,d,h,p,v){v===void 0&&(v=!0);var g=d==="complex64"?2:1,m=f[0],y=f.length;if(y===0)return d==="complex64"?[$a(Ha(c)[0],0,d)]:d==="bool"?[Vx(c[0])]:[c[0].toString()];if(y===1){if(m>Mg){var x=Va*g,w=Array.from(c.slice(0,x)),E=Array.from(c.slice((m-Va)*g,m*g));return d==="complex64"&&(w=Ha(w),E=Ha(E)),["["+w.map(function($,q){return $a($,p[q],d)}).join(", ")+", ..., "+E.map(function($,q){return $a($,p[m-Va+q],d)}).join(", ")+"]"]}return["["+(d==="complex64"?Ha(c):Array.from(c)).map(function($,q){return $a($,p[q],d)}).join(", ")+"]"]}var b=f.slice(1),C=h.slice(1),_=h[0]*g,S=[];if(m>Mg){for(var R=0;R<Va;R++){var D=(T=R*_)+_;S.push.apply(S,l(c.slice(T,D),b,d,C,p,!1))}for(S.push("..."),R=m-Va;R<m;R++)D=(T=R*_)+_,S.push.apply(S,l(c.slice(T,D),b,d,C,p,R===m-1))}else for(R=0;R<m;R++){var T;D=(T=R*_)+_,S.push.apply(S,l(c.slice(T,D),b,d,C,p,R===m-1))}var z=y===2?",":"";for(S[0]="["+S[0]+z,R=1;R<S.length-1;R++)S[R]=" "+S[R]+z;var O=`,
`;for(R=2;R<y;R++)O+=`
`;return S[S.length-1]=" "+S[S.length-1]+"]"+(v?"":O),S}(e,t,n,o,i),u=["Tensor"];return r&&(u.push("  dtype: "+n),u.push("  rank: "+a),u.push("  shape: ["+t+"]"),u.push("  values:")),u.push(s.map(function(l){return"    "+l}).join(`
`)),u.join(`
`)}function $a(e,t,n){return na(Array.isArray(e)?parseFloat(e[0].toFixed(Rf))+" + "+parseFloat(e[1].toFixed(Rf))+"j":Tp(e)?"'"+e+"'":n==="bool"?Vx(e):parseFloat(e.toFixed(Rf)).toString(),t)}function Vx(e){return e===0?"false":"true"}function Ha(e){for(var t=[],n=0;n<e.length;n+=2)t.push([e[n],e[n+1]]);return t}var As=function(){function e(t,n,r){var o=this;if(this.dtype=n,this.shape=t.slice(),this.size=le(t),r!=null){var i=r.length;I(i===this.size,function(){return"Length of values '"+i+"' does not match the size inferred by the shape '"+o.size+"'."})}if(n==="complex64")throw new Error("complex64 dtype TensorBuffers are not supported. Please create a TensorBuffer for the real and imaginary parts separately and call tf.complex(real, imag).");this.values=r||Fl(n,this.size),this.strides=Rr(t)}return e.prototype.set=function(t){for(var n=this,r=[],o=1;o<arguments.length;o++)r[o-1]=arguments[o];r.length===0&&(r=[0]),I(r.length===this.rank,function(){return"The number of provided coordinates ("+r.length+") must match the rank ("+n.rank+")"});var i=this.locToIndex(r);this.values[i]=t},e.prototype.get=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];t.length===0&&(t=[0]);for(var r=0,o=0,i=t;o<i.length;o++){var a=i[o];if(a<0||a>=this.shape[r]){var s="Requested out of range element at "+t+".   Buffer shape="+this.shape;throw new Error(s)}r++}for(var u=t[t.length-1],l=0;l<t.length-1;++l)u+=this.strides[l]*t[l];return this.values[u]},e.prototype.locToIndex=function(t){if(this.rank===0)return 0;if(this.rank===1)return t[0];for(var n=t[t.length-1],r=0;r<t.length-1;++r)n+=this.strides[r]*t[r];return n},e.prototype.indexToLoc=function(t){if(this.rank===0)return[];if(this.rank===1)return[t];for(var n=new Array(this.shape.length),r=0;r<n.length-1;++r)n[r]=Math.floor(t/this.strides[r]),t-=n[r]*this.strides[r];return n[n.length-1]=t,n},Object.defineProperty(e.prototype,"rank",{get:function(){return this.shape.length},enumerable:!0,configurable:!0}),e.prototype.toTensor=function(){return wr().makeTensor(this.values,this.shape,this.dtype)},e}(),wr=null,j=null,$x=null,st=function(){function e(t,n,r,o){this.kept=!1,this.isDisposedInternal=!1,this.shape=t.slice(),this.dtype=n||"float32",this.size=le(t),this.strides=Rr(t),this.dataId=r,this.id=o,this.rankType=this.rank<5?this.rank.toString():"higher"}return e.prototype.flatten=function(){return this.throwIfDisposed(),this.as1D()},e.prototype.asScalar=function(){return this.throwIfDisposed(),I(this.size===1,function(){return"The array must have only 1 element."}),this.reshape([])},e.prototype.as1D=function(){return this.throwIfDisposed(),this.reshape([this.size])},e.prototype.as2D=function(t,n){return this.throwIfDisposed(),this.reshape([t,n])},e.prototype.as3D=function(t,n,r){return this.throwIfDisposed(),this.reshape([t,n,r])},e.prototype.as4D=function(t,n,r,o){return this.throwIfDisposed(),this.reshape([t,n,r,o])},e.prototype.as5D=function(t,n,r,o,i){return this.throwIfDisposed(),this.reshape([t,n,r,o,i])},e.prototype.asType=function(t){return this.throwIfDisposed(),j.cast(this,t)},Object.defineProperty(e.prototype,"rank",{get:function(){return this.shape.length},enumerable:!0,configurable:!0}),e.prototype.buffer=function(){return se(this,void 0,void 0,function(){var t;return ue(this,function(n){switch(n.label){case 0:return[4,this.data()];case 1:return t=n.sent(),[2,j.buffer(this.shape,this.dtype,t)]}})})},e.prototype.bufferSync=function(){return j.buffer(this.shape,this.dtype,this.dataSync())},e.prototype.array=function(){return se(this,void 0,void 0,function(){var t;return ue(this,function(n){switch(n.label){case 0:return[4,this.data()];case 1:return t=n.sent(),[2,Pg(this.shape,t)]}})})},e.prototype.arraySync=function(){return Pg(this.shape,this.dataSync())},e.prototype.data=function(){return se(this,void 0,void 0,function(){var t,n;return ue(this,function(r){switch(r.label){case 0:return this.throwIfDisposed(),t=wr().read(this.dataId),this.dtype!=="string"?[3,2]:[4,t];case 1:n=r.sent();try{return[2,n.map(function(o){return Ml(o)})]}catch{throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}r.label=2;case 2:return[2,t]}})})},e.prototype.dataSync=function(){this.throwIfDisposed();var t=wr().readSync(this.dataId);if(this.dtype==="string")try{return t.map(function(n){return Ml(n)})}catch{throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}return t},e.prototype.bytes=function(){return se(this,void 0,void 0,function(){var t;return ue(this,function(n){switch(n.label){case 0:return this.throwIfDisposed(),[4,wr().read(this.dataId)];case 1:return t=n.sent(),this.dtype==="string"?[2,t]:[2,new Uint8Array(t.buffer)]}})})},e.prototype.dispose=function(){this.isDisposed||(wr().disposeTensor(this),this.isDisposedInternal=!0)},Object.defineProperty(e.prototype,"isDisposed",{get:function(){return this.isDisposedInternal},enumerable:!0,configurable:!0}),e.prototype.throwIfDisposed=function(){if(this.isDisposed)throw new Error("Tensor is disposed.")},e.prototype.toFloat=function(){return this.asType("float32")},e.prototype.toInt=function(){return this.asType("int32")},e.prototype.toBool=function(){return this.asType("bool")},e.prototype.print=function(t){return t===void 0&&(t=!1),j.print(this,t)},e.prototype.reshape=function(t){return this.throwIfDisposed(),j.reshape(this,t)},e.prototype.reshapeAs=function(t){return this.throwIfDisposed(),this.reshape(t.shape)},e.prototype.expandDims=function(t){return t===void 0&&(t=0),j.expandDims(this,t)},e.prototype.cumsum=function(t,n,r){return t===void 0&&(t=0),n===void 0&&(n=!1),r===void 0&&(r=!1),j.cumsum(this,t,n,r)},e.prototype.squeeze=function(t){return this.throwIfDisposed(),j.squeeze(this,t)},e.prototype.clone=function(){return this.throwIfDisposed(),j.clone(this)},e.prototype.oneHot=function(t,n,r){return this.throwIfDisposed(),j.oneHot(this,t,n,r)},e.prototype.toString=function(t){return t===void 0&&(t=!1),rk(this.dataSync(),this.shape,this.dtype,t)},e.prototype.tile=function(t){return this.throwIfDisposed(),j.tile(this,t)},e.prototype.gather=function(t,n){return n===void 0&&(n=0),this.throwIfDisposed(),j.gather(this,t,n)},e.prototype.matMul=function(t,n,r){return n===void 0&&(n=!1),r===void 0&&(r=!1),this.throwIfDisposed(),j.matMul(this,t,n,r)},e.prototype.dot=function(t){return this.throwIfDisposed(),j.dot(this,t)},e.prototype.norm=function(t,n,r){return t===void 0&&(t="euclidean"),n===void 0&&(n=null),r===void 0&&(r=!1),this.throwIfDisposed(),j.norm(this,t,n,r)},e.prototype.slice=function(t,n){return this.throwIfDisposed(),j.slice(this,t,n)},e.prototype.reverse=function(t){return this.throwIfDisposed(),j.reverse(this,t)},e.prototype.concat=function(t,n){return n===void 0&&(n=0),this.throwIfDisposed(),t instanceof e&&(t=[t]),j.concat([this].concat(t),n)},e.prototype.split=function(t,n){return n===void 0&&(n=0),this.throwIfDisposed(),j.split(this,t,n)},e.prototype.stack=function(t,n){return n===void 0&&(n=0),j.stack([this,t],n)},e.prototype.unstack=function(t){return t===void 0&&(t=0),j.unstack(this,t)},e.prototype.pad=function(t,n){return n===void 0&&(n=0),j.pad(this,t,n)},e.prototype.batchNormalization=function(t,n,r,o,i){return r===void 0&&(r=.001),$x("tf.batchNormalization() is going away. Use tf.batchNorm() instead, and note the positional argument change of scale, offset, and varianceEpsilon"),this.batchNorm(t,n,i,o,r)},e.prototype.batchNorm=function(t,n,r,o,i){return i===void 0&&(i=.001),this.throwIfDisposed(),j.batchNorm(this,t,n,r,o,i)},e.prototype.all=function(t,n){return t===void 0&&(t=null),n===void 0&&(n=!1),this.throwIfDisposed(),j.all(this,t,n)},e.prototype.any=function(t,n){return t===void 0&&(t=null),n===void 0&&(n=!1),this.throwIfDisposed(),j.any(this,t,n)},e.prototype.logSumExp=function(t,n){return t===void 0&&(t=null),n===void 0&&(n=!1),this.throwIfDisposed(),j.logSumExp(this,t,n)},e.prototype.sum=function(t,n){return t===void 0&&(t=null),n===void 0&&(n=!1),this.throwIfDisposed(),j.sum(this,t,n)},e.prototype.prod=function(t,n){return t===void 0&&(t=null),n===void 0&&(n=!1),this.throwIfDisposed(),j.prod(this,t,n)},e.prototype.mean=function(t,n){return t===void 0&&(t=null),n===void 0&&(n=!1),this.throwIfDisposed(),j.mean(this,t,n)},e.prototype.min=function(t,n){return t===void 0&&(t=null),n===void 0&&(n=!1),this.throwIfDisposed(),j.min(this,t,n)},e.prototype.max=function(t,n){return t===void 0&&(t=null),n===void 0&&(n=!1),this.throwIfDisposed(),j.max(this,t,n)},e.prototype.argMin=function(t){return t===void 0&&(t=null),this.throwIfDisposed(),j.argMin(this,t)},e.prototype.argMax=function(t){return t===void 0&&(t=null),this.throwIfDisposed(),j.argMax(this,t)},e.prototype.cast=function(t){return this.throwIfDisposed(),j.cast(this,t)},e.prototype.add=function(t){return this.throwIfDisposed(),j.add(this,t)},e.prototype.addStrict=function(t){return this.throwIfDisposed(),j.addStrict(this,t)},e.prototype.atan2=function(t){return this.throwIfDisposed(),j.atan2(this,t)},e.prototype.sub=function(t){return this.throwIfDisposed(),j.sub(this,t)},e.prototype.subStrict=function(t){return this.throwIfDisposed(),j.subStrict(this,t)},e.prototype.pow=function(t){return this.throwIfDisposed(),j.pow(this,t)},e.prototype.powStrict=function(t){return this.throwIfDisposed(),j.powStrict(this,t)},e.prototype.mul=function(t){return this.throwIfDisposed(),j.mul(this,t)},e.prototype.mulStrict=function(t){return this.throwIfDisposed(),j.mulStrict(this,t)},e.prototype.div=function(t){return this.throwIfDisposed(),j.div(this,t)},e.prototype.divNoNan=function(t){return this.throwIfDisposed(),j.divNoNan(this,t)},e.prototype.floorDiv=function(t){return this.throwIfDisposed(),j.floorDiv(this,t)},e.prototype.divStrict=function(t){return this.throwIfDisposed(),j.divStrict(this,t)},e.prototype.minimum=function(t){return this.throwIfDisposed(),j.minimum(this,t)},e.prototype.minimumStrict=function(t){return this.throwIfDisposed(),j.minimumStrict(this,t)},e.prototype.maximum=function(t){return this.throwIfDisposed(),j.maximum(this,t)},e.prototype.maximumStrict=function(t){return this.throwIfDisposed(),j.maximumStrict(this,t)},e.prototype.mod=function(t){return this.throwIfDisposed(),j.mod(this,t)},e.prototype.modStrict=function(t){return this.throwIfDisposed(),j.modStrict(this,t)},e.prototype.squaredDifferenceStrict=function(t){return this.throwIfDisposed(),j.squaredDifferenceStrict(this,t)},e.prototype.transpose=function(t){return this.throwIfDisposed(),j.transpose(this,t)},e.prototype.notEqual=function(t){return this.throwIfDisposed(),j.notEqual(this,t)},e.prototype.notEqualStrict=function(t){return this.throwIfDisposed(),j.notEqualStrict(this,t)},e.prototype.less=function(t){return this.throwIfDisposed(),j.less(this,t)},e.prototype.lessStrict=function(t){return this.throwIfDisposed(),j.lessStrict(this,t)},e.prototype.equal=function(t){return this.throwIfDisposed(),j.equal(this,t)},e.prototype.equalStrict=function(t){return this.throwIfDisposed(),j.equalStrict(this,t)},e.prototype.lessEqual=function(t){return this.throwIfDisposed(),j.lessEqual(this,t)},e.prototype.lessEqualStrict=function(t){return this.throwIfDisposed(),j.lessEqualStrict(this,t)},e.prototype.greater=function(t){return this.throwIfDisposed(),j.greater(this,t)},e.prototype.greaterStrict=function(t){return this.throwIfDisposed(),j.greaterStrict(this,t)},e.prototype.greaterEqual=function(t){return this.throwIfDisposed(),j.greaterEqual(this,t)},e.prototype.greaterEqualStrict=function(t){return this.throwIfDisposed(),j.greaterEqualStrict(this,t)},e.prototype.logicalAnd=function(t){return this.throwIfDisposed(),j.logicalAnd(this,t)},e.prototype.logicalOr=function(t){return this.throwIfDisposed(),j.logicalOr(this,t)},e.prototype.logicalNot=function(){return this.throwIfDisposed(),j.logicalNot(this)},e.prototype.logicalXor=function(t){return this.throwIfDisposed(),j.logicalXor(this,t)},e.prototype.where=function(t,n){return this.throwIfDisposed(),j.where(t,this,n)},e.prototype.neg=function(){return this.throwIfDisposed(),j.neg(this)},e.prototype.ceil=function(){return this.throwIfDisposed(),j.ceil(this)},e.prototype.floor=function(){return this.throwIfDisposed(),j.floor(this)},e.prototype.sign=function(){return this.throwIfDisposed(),j.sign(this)},e.prototype.isNaN=function(){return this.throwIfDisposed(),j.isNaN(this)},e.prototype.isInf=function(){return this.throwIfDisposed(),j.isInf(this)},e.prototype.isFinite=function(){return this.throwIfDisposed(),j.isFinite(this)},e.prototype.exp=function(){return this.throwIfDisposed(),j.exp(this)},e.prototype.expm1=function(){return this.throwIfDisposed(),j.expm1(this)},e.prototype.log=function(){return this.throwIfDisposed(),j.log(this)},e.prototype.log1p=function(){return this.throwIfDisposed(),j.log1p(this)},e.prototype.sqrt=function(){return this.throwIfDisposed(),j.sqrt(this)},e.prototype.rsqrt=function(){return this.throwIfDisposed(),j.rsqrt(this)},e.prototype.square=function(){return this.throwIfDisposed(),j.square(this)},e.prototype.reciprocal=function(){return this.throwIfDisposed(),j.reciprocal(this)},e.prototype.abs=function(){return this.throwIfDisposed(),j.abs(this)},e.prototype.clipByValue=function(t,n){return this.throwIfDisposed(),j.clipByValue(this,t,n)},e.prototype.relu=function(){return this.throwIfDisposed(),j.relu(this)},e.prototype.relu6=function(){return this.throwIfDisposed(),j.relu6(this)},e.prototype.elu=function(){return this.throwIfDisposed(),j.elu(this)},e.prototype.selu=function(){return this.throwIfDisposed(),j.selu(this)},e.prototype.leakyRelu=function(t){return t===void 0&&(t=.2),this.throwIfDisposed(),j.leakyRelu(this,t)},e.prototype.prelu=function(t){return this.throwIfDisposed(),j.prelu(this,t)},e.prototype.sigmoid=function(){return this.throwIfDisposed(),j.sigmoid(this)},e.prototype.logSigmoid=function(){return this.throwIfDisposed(),j.logSigmoid(this)},e.prototype.softplus=function(){return this.throwIfDisposed(),j.softplus(this)},e.prototype.zerosLike=function(){return this.throwIfDisposed(),j.zerosLike(this)},e.prototype.onesLike=function(){return this.throwIfDisposed(),j.onesLike(this)},e.prototype.sin=function(){return this.throwIfDisposed(),j.sin(this)},e.prototype.cos=function(){return this.throwIfDisposed(),j.cos(this)},e.prototype.tan=function(){return this.throwIfDisposed(),j.tan(this)},e.prototype.asin=function(){return this.throwIfDisposed(),j.asin(this)},e.prototype.acos=function(){return this.throwIfDisposed(),j.acos(this)},e.prototype.atan=function(){return this.throwIfDisposed(),j.atan(this)},e.prototype.sinh=function(){return this.throwIfDisposed(),j.sinh(this)},e.prototype.cosh=function(){return this.throwIfDisposed(),j.cosh(this)},e.prototype.tanh=function(){return this.throwIfDisposed(),j.tanh(this)},e.prototype.asinh=function(){return this.throwIfDisposed(),j.asinh(this)},e.prototype.acosh=function(){return this.throwIfDisposed(),j.acosh(this)},e.prototype.atanh=function(){return this.throwIfDisposed(),j.atanh(this)},e.prototype.erf=function(){return this.throwIfDisposed(),j.erf(this)},e.prototype.round=function(){return this.throwIfDisposed(),j.round(this)},e.prototype.step=function(t){return t===void 0&&(t=0),this.throwIfDisposed(),j.step(this,t)},e.prototype.softmax=function(t){return t===void 0&&(t=-1),this.throwIfDisposed(),j.softmax(this,t)},e.prototype.logSoftmax=function(t){return t===void 0&&(t=-1),this.throwIfDisposed(),j.logSoftmax(this,t)},e.prototype.resizeBilinear=function(t,n){return n===void 0&&(n=!1),this.throwIfDisposed(),j.image.resizeBilinear(this,t,n)},e.prototype.resizeNearestNeighbor=function(t,n){return n===void 0&&(n=!1),this.throwIfDisposed(),j.image.resizeNearestNeighbor(this,t,n)},e.prototype.conv1d=function(t,n,r,o,i,a){return o===void 0&&(o="NWC"),i===void 0&&(i=1),this.throwIfDisposed(),j.conv1d(this,t,n,r,o,i,a)},e.prototype.conv2d=function(t,n,r,o,i,a){return o===void 0&&(o="NHWC"),i===void 0&&(i=[1,1]),this.throwIfDisposed(),j.conv2d(this,t,n,r,o,i,a)},e.prototype.conv2dTranspose=function(t,n,r,o,i){return this.throwIfDisposed(),j.conv2dTranspose(this,t,n,r,o,i)},e.prototype.depthwiseConv2D=function(t,n,r,o,i,a){return o===void 0&&(o="NHWC"),i===void 0&&(i=[1,1]),this.throwIfDisposed(),j.depthwiseConv2d(this,t,n,r,o,i,a)},e.prototype.separableConv2d=function(t,n,r,o,i,a){return i===void 0&&(i=[1,1]),a===void 0&&(a="NHWC"),this.throwIfDisposed(),j.separableConv2d(this,t,n,r,o,i,a)},e.prototype.avgPool=function(t,n,r,o){return this.throwIfDisposed(),j.avgPool(this,t,n,r,o)},e.prototype.maxPool=function(t,n,r,o){return this.throwIfDisposed(),j.maxPool(this,t,n,r,o)},e.prototype.localResponseNormalization=function(t,n,r,o){return t===void 0&&(t=5),n===void 0&&(n=1),r===void 0&&(r=1),o===void 0&&(o=.5),j.localResponseNormalization(this,t,n,r,o)},e.prototype.pool=function(t,n,r,o,i){return this.throwIfDisposed(),j.pool(this,t,n,r,o,i)},e.prototype.variable=function(t,n,r){return t===void 0&&(t=!0),this.throwIfDisposed(),wr().makeVariable(this,t,n,r)},e.prototype.unsortedSegmentSum=function(t,n){return this.throwIfDisposed(),j.unsortedSegmentSum(this,t,n)},e.prototype.batchToSpaceND=function(t,n){return this.throwIfDisposed(),j.batchToSpaceND(this,t,n)},e.prototype.spaceToBatchND=function(t,n){return this.throwIfDisposed(),j.spaceToBatchND(this,t,n)},e.prototype.topk=function(t,n){return t===void 0&&(t=1),n===void 0&&(n=!0),this.throwIfDisposed(),j.topk(this,t,n)},e.prototype.stridedSlice=function(t,n,r,o,i,a,s,u){return o===void 0&&(o=0),i===void 0&&(i=0),a===void 0&&(a=0),s===void 0&&(s=0),u===void 0&&(u=0),this.throwIfDisposed(),j.stridedSlice(this,t,n,r,o,i,a,s,u)},e.prototype.depthToSpace=function(t,n){return this.throwIfDisposed(),j.depthToSpace(this,t,n)},e.prototype.fft=function(){return this.throwIfDisposed(),j.spectral.fft(this)},e.prototype.ifft=function(){return this.throwIfDisposed(),j.spectral.ifft(this)},e.prototype.rfft=function(){return this.throwIfDisposed(),j.spectral.rfft(this)},e.prototype.irfft=function(){return this.throwIfDisposed(),j.spectral.irfft(this)},e}();Object.defineProperty(st,Symbol.hasInstance,{value:function(e){return!!e&&e.dataId!=null&&e.shape!=null&&e.dtype!=null}});var Og,ah,sh,uh,lh,xa=function(e){function t(n,r,o,i){var a=e.call(this,n.shape,n.dtype,n.dataId,i)||this;return a.trainable=r,a.name=o,a}return lr(t,e),t.prototype.assign=function(n){if(n.dtype!==this.dtype)throw new Error("dtype of the new value ("+n.dtype+") and previous value ("+this.dtype+") must match");if(!Ft(n.shape,this.shape))throw new Error("shape of the new value ("+n.shape+") and previous value ("+this.shape+") must match");wr().disposeTensor(this),this.dataId=n.dataId,wr().incRef(this,null)},t.prototype.dispose=function(){wr().disposeVariable(this),this.isDisposedInternal=!0},t}(st);Object.defineProperty(xa,Symbol.hasInstance,{value:function(e){return e instanceof st&&e.assign!=null&&e.assign instanceof Function}}),function(e){e.R0="R0",e.R1="R1",e.R2="R2",e.R3="R3",e.R4="R4",e.R5="R5",e.R6="R6"}(Og||(Og={})),function(e){e.float32="float32",e.int32="int32",e.bool="int32",e.complex64="complex64"}(ah||(ah={})),function(e){e.float32="float32",e.int32="int32",e.bool="bool",e.complex64="complex64"}(sh||(sh={})),function(e){e.float32="float32",e.int32="float32",e.bool="float32",e.complex64="complex64"}(uh||(uh={})),function(e){e.float32="complex64",e.int32="complex64",e.bool="complex64",e.complex64="complex64"}(lh||(lh={}));var ok={float32:uh,int32:ah,bool:sh,complex64:lh};function Ut(e,t){if(e==="string"||t==="string"){if(e==="string"&&t==="string")return"string";throw new Error("Can not upcast "+e+" with "+t)}return ok[e][t]}function kf(e){return Ut(e,"int32")}function ft(e,t){if(e.dtype===t.dtype)return[e,t];var n=Ut(e.dtype,t.dtype);return[e.cast(n),t.cast(n)]}function ik(e,t){I(e.dtype===t.dtype,function(){return"The dtypes of the first("+e.dtype+") and second("+t.dtype+") input must match"})}function Hx(e){var t=[];return function n(r,o,i){if(r!=null){if(r instanceof st)return void o.push(r);if(a=r,!(!Array.isArray(a)&&typeof a!="object")){var a,s=r;for(var u in s){var l=s[u];i.has(l)||(i.add(l),n(l,o,i))}}}}(e,t,new Set),t}var If,Lg=function(){function e(){this.registeredVariables={},this.nextTapeNodeId=0,this.numBytes=0,this.numTensors=0,this.numStringTensors=0,this.numDataBuffers=0,this.gradientDepth=0,this.kernelDepth=0,this.scopeStack=[],this.numDataMovesStack=[],this.nextScopeId=0,this.tensorInfo=new WeakMap,this.profiling=!1,this.activeProfile={newBytes:0,newTensors:0,peakBytes:0,kernels:[],result:null}}return e.prototype.dispose=function(){for(var t in this.registeredVariables)this.registeredVariables[t].dispose()},e}(),ak=function(){function e(t){this.ENV=t,this.registry={},this.registryFactory={},this.pendingBackendInitId=0,this.state=new Lg}return e.prototype.ready=function(){return se(this,void 0,void 0,function(){var t,n,r;return ue(this,function(o){switch(o.label){case 0:if(this.pendingBackendInit!=null)return[2,this.pendingBackendInit.then(function(){})];if(this.backendInstance!=null)return[2];t=this.getSortedBackends(),n=0,o.label=1;case 1:return n<t.length?(r=t[n],[4,this.initializeBackend(r).success]):[3,5];case 2:return o.sent()?[4,this.setBackend(r)]:[3,4];case 3:return o.sent(),[2];case 4:return n++,[3,1];case 5:throw new Error("Could not initialize any backends, all backend initializations failed.")}})})},Object.defineProperty(e.prototype,"backend",{get:function(){if(this.pendingBackendInit!=null)throw new Error("Backend '"+this.backendName+"' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods");if(this.backendInstance==null){var t=this.initializeBackendsAndReturnBest(),n=t.name;if(t.asyncInit)throw new Error("The highest priority backend '"+n+"' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods");this.setBackend(n)}return this.backendInstance},enumerable:!0,configurable:!0}),e.prototype.backendNames=function(){return Object.keys(this.registryFactory)},e.prototype.findBackend=function(t){return!(t in this.registry)&&(!(t in this.registryFactory)||this.initializeBackend(t).asyncInit)?null:this.registry[t]},e.prototype.findBackendFactory=function(t){return t in this.registryFactory?this.registryFactory[t].factory:null},e.prototype.registerBackend=function(t,n,r){return r===void 0&&(r=1),t in this.registryFactory?(console.warn(t+" backend was already registered. Reusing existing backend factory."),!1):(this.registryFactory[t]={factory:n,priority:r},!0)},e.prototype.setBackend=function(t){return se(this,void 0,void 0,function(){var n,r,o;return ue(this,function(i){switch(i.label){case 0:if(this.registryFactory[t]==null)throw new Error("Backend name '"+t+"' not found in registry");return this.backendName=t,this.registry[t]!=null?[3,4]:(this.backendInstance=null,n=this.initializeBackend(t),r=n.success,n.asyncInit?[4,r]:[3,2]);case 1:return o=i.sent(),[3,3];case 2:o=r,i.label=3;case 3:if(!o)return[2,!1];i.label=4;case 4:return this.backendInstance=this.registry[t],this.setupRegisteredKernels(),this.profiler=new tk(this.backendInstance),[2,!0]}})})},e.prototype.setupRegisteredKernels=function(){var t=this;Ng(this.backendName).forEach(function(n){n.setupFunc!=null&&n.setupFunc(t.backendInstance)})},e.prototype.disposeRegisteredKernels=function(t){var n=this;Ng(t).forEach(function(r){r.disposeFunc!=null&&r.disposeFunc(n.registry[t])})},e.prototype.initializeBackend=function(t){var n=this,r=this.registryFactory[t];if(r==null)throw new Error("Cannot initialize backend "+t+", no registration found.");try{var o=r.factory();if(Promise.resolve(o)===o){var i=++this.pendingBackendInitId,a=o.then(function(s){return!(i<n.pendingBackendInitId)&&(n.registry[t]=s,n.pendingBackendInit=null,!0)}).catch(function(s){return!(i<n.pendingBackendInitId)&&(n.pendingBackendInit=null,console.warn("Initialization of backend "+t+" failed"),console.warn(s.stack||s.message),!1)});return this.pendingBackendInit=a,{success:a,asyncInit:!0}}return this.registry[t]=o,{success:!0,asyncInit:!1}}catch(s){return console.warn("Initialization of backend "+t+" failed"),console.warn(s.stack||s.message),{success:!1,asyncInit:!1}}},e.prototype.removeBackend=function(t){if(!(t in this.registryFactory))throw new Error(t+" backend not found in registry");this.backendName===t&&this.pendingBackendInit!=null&&this.pendingBackendInitId++,t in this.registry&&(this.disposeRegisteredKernels(t),this.registry[t].dispose(),delete this.registry[t]),delete this.registryFactory[t],this.backendName===t&&(this.pendingBackendInit=null,this.backendName=null,this.backendInstance=null)},e.prototype.getSortedBackends=function(){var t=this;if(Object.keys(this.registryFactory).length===0)throw new Error("No backend found in registry.");return Object.keys(this.registryFactory).sort(function(n,r){return t.registryFactory[r].priority-t.registryFactory[n].priority})},e.prototype.initializeBackendsAndReturnBest=function(){for(var t=this.getSortedBackends(),n=0;n<t.length;n++){var r=t[n],o=this.initializeBackend(r),i=o.success,a=o.asyncInit;if(a||i)return{name:r,asyncInit:a}}throw new Error("Could not initialize any backends, all backend initializations failed.")},e.prototype.moveData=function(t,n){var r=this.state.tensorInfo.get(n),o=r.backend,i=this.readSync(n);o.disposeData(n),r.backend=t,t.move(n,i,r.shape,r.dtype),this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack[this.state.numDataMovesStack.length-1]++},e.prototype.tidy=function(t,n){var r,o=this,i=null;if(n==null){if(typeof t!="function")throw new Error("Please provide a function to tidy()");n=t}else{if(typeof t!="string"&&!(t instanceof String))throw new Error("When calling with two arguments, the first argument to tidy() must be a string");if(typeof n!="function")throw new Error("When calling with two arguments, the 2nd argument to tidy() must be a function");i=t}return this.scopedRun(function(){return o.startScope(i)},function(){return o.endScope(r)},function(){return(r=n())instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),r})},e.prototype.scopedRun=function(t,n,r){t();try{var o=r();return n(),o}catch(i){throw n(),i}},e.prototype.nextTensorId=function(){return e.nextTensorId++},e.prototype.nextVariableId=function(){return e.nextVariableId++},e.prototype.clone=function(t){var n=this.makeTensorFromDataId(t.dataId,t.shape,t.dtype),r={x:t};return this.addTapeNode(this.state.activeScope.name,r,[n],function(o){return{x:function(){return o.toFloat()}}},[]),n},e.prototype.runKernel=function(t,n,r,o,i){return this.runKernelFunc(null,n,null,t,r,o,i)},e.prototype.shouldCheckForMemLeaks=function(){return this.ENV.getBool("IS_TEST")},e.prototype.checkKernelForMemLeak=function(t,n,r){var o=this.backend.numDataIds(),i=0;r.forEach(function(u){i+=u.dtype==="complex64"?3:1});var a=this.state.numDataMovesStack[this.state.numDataMovesStack.length-1],s=o-n-i-a;if(s>0)throw new Error("Backend '"+this.backendName+"' has an internal memory leak ("+s+" data ids) after running '"+t+"'")},e.prototype.runKernelFunc=function(t,n,r,o,i,a,s){var u,l=this;a===void 0&&(a=[]),s===void 0&&(s=[]);var c=[],f=this.isTapeOn();o==null&&(o=this.state.activeScope!=null?this.state.activeScope.name:"");var d,h=function(y){f&&(c=y.map(function(x){return l.keep(l.clone(x))}))},p=this.state.numBytes,v=this.state.numTensors;this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack.push(0);var g,m=Mx(o,this.backendName);return d=m!=null?function(){var y=l.backend.numDataIds();g=m.kernelFunc({inputs:n,attrs:i,backend:l.backend});var x=Array.isArray(g)?g:[g];l.shouldCheckForMemLeaks()&&l.checkKernelForMemLeak(o,y,x);var w=x.map(function(b){var C=b.dataId,_=b.shape,S=b.dtype;return l.makeTensorFromDataId(C,_,S)}),E=w.filter(function(b,C){return s[C]});return h((a||[]).slice().concat(E)),w}:function(){var y=l.backend.numDataIds();g=l.tidy(function(){return t(l.backend,h)});var x=Array.isArray(g)?g:[g];return l.shouldCheckForMemLeaks()&&l.checkKernelForMemLeak(o,y,x),x},this.scopedRun(function(){return l.state.kernelDepth++},function(){return l.state.kernelDepth--},function(){u=l.ENV.getBool("DEBUG")?l.profiler.profileKernel(o,n,function(){return d()}):d()}),f&&this.addTapeNode(o,n,u,r,c),this.state.profiling&&this.state.activeProfile.kernels.push({name:o,bytesAdded:this.state.numBytes-p,totalBytesSnapshot:this.state.numBytes,tensorsAdded:this.state.numTensors-v,totalTensorsSnapshot:this.state.numTensors,inputShapes:Object.keys(n).map(function(y){return n[y].shape}),outputShapes:u.map(function(y){return y.shape})}),Array.isArray(g)?u:u[0]},e.prototype.makeTensor=function(t,n,r,o){if(t==null)throw new Error("Values passed to engine.makeTensor() are null");r=r||"float32",o=o||this.backend;var i=t;r==="string"&&Tp(t[0])&&(i=t.map(function(c){return ZR(c)}));var a=o.write(i,n,r),s=new st(n,r,a,this.nextTensorId());if(this.incRef(s,o),r==="string"){var u=this.state.tensorInfo.get(a),l=YR(i);this.state.numBytes+=l-u.bytes,u.bytes=l}return s},e.prototype.makeTensorFromDataId=function(t,n,r,o){var i=new st(n,r=r||"float32",t,this.nextTensorId());return this.incRef(i,o),i},e.prototype.makeVariable=function(t,n,r,o){n===void 0&&(n=!0),r=r||this.nextVariableId().toString(),o!=null&&o!==t.dtype&&(t=t.asType(o));var i=new xa(t,n,r,this.nextTensorId());if(this.state.registeredVariables[i.name]!=null)throw new Error("Variable with name "+i.name+" was already registered");return this.state.registeredVariables[i.name]=i,this.incRef(i,this.backend),i},e.prototype.incRef=function(t,n){var r=this.state.tensorInfo.has(t.dataId)?this.state.tensorInfo.get(t.dataId).refCount:0;if(this.state.numTensors++,t.dtype==="string"&&this.state.numStringTensors++,r===0){this.state.numDataBuffers++;var o=0;t.dtype!=="complex64"&&t.dtype!=="string"&&(o=t.size*Ux(t.dtype)),this.state.tensorInfo.set(t.dataId,{backend:n||this.backend,dtype:t.dtype,shape:t.shape,bytes:o,refCount:0}),this.state.numBytes+=o}this.state.tensorInfo.get(t.dataId).refCount++,t instanceof xa||this.track(t)},e.prototype.disposeTensor=function(t){if(this.state.tensorInfo.has(t.dataId)){this.state.numTensors--,t.dtype==="string"&&this.state.numStringTensors--;var n=this.state.tensorInfo.get(t.dataId);n.refCount<=1?(t.dtype!=="complex64"&&(this.state.numBytes-=n.bytes),this.state.numDataBuffers--,n.backend.disposeData(t.dataId),this.state.tensorInfo.delete(t.dataId)):this.state.tensorInfo.get(t.dataId).refCount--}},e.prototype.disposeVariables=function(){for(var t in this.state.registeredVariables){var n=this.state.registeredVariables[t];this.disposeVariable(n)}},e.prototype.disposeVariable=function(t){this.disposeTensor(t),this.state.registeredVariables[t.name]!=null&&delete this.state.registeredVariables[t.name]},e.prototype.memory=function(){var t=this.backend.memory();return t.numTensors=this.state.numTensors,t.numDataBuffers=this.state.numDataBuffers,t.numBytes=this.state.numBytes,this.state.numStringTensors>0&&(t.unreliable=!0,t.reasons==null&&(t.reasons=[]),t.reasons.push("Memory usage by string tensors is approximate (2 bytes per character)")),t},e.prototype.profile=function(t){return se(this,void 0,void 0,function(){var n,r;return ue(this,function(o){return this.state.profiling=!0,n=this.state.numBytes,r=this.state.numTensors,this.state.activeProfile.kernels=[],this.state.activeProfile.result=t(),this.state.profiling=!1,this.state.activeProfile.peakBytes=Math.max.apply(Math,this.state.activeProfile.kernels.map(function(i){return i.totalBytesSnapshot})),this.state.activeProfile.newBytes=this.state.numBytes-n,this.state.activeProfile.newTensors=this.state.numTensors-r,[2,this.state.activeProfile]})})},e.prototype.isTapeOn=function(){return this.state.gradientDepth>0&&this.state.kernelDepth===0},e.prototype.addTapeNode=function(t,n,r,o,i){var a=this,s={id:this.state.nextTapeNodeId++,kernelName:t,inputs:n,outputs:r,saved:i},u=jR(t);u!=null&&(o=u.gradFunc),o!=null&&(s.gradient=function(l){return l=l.map(function(c,f){if(c==null){var d=r[f],h=qs(d.size,d.dtype);return a.makeTensor(h,d.shape,d.dtype)}return c}),o(l.length>1?l:l[0],i)}),this.state.activeTape.push(s)},e.prototype.keep=function(t){return t.kept=!0,t},e.prototype.startTape=function(){this.state.gradientDepth===0&&(this.state.activeTape=[]),this.state.gradientDepth++},e.prototype.endTape=function(){this.state.gradientDepth--},e.prototype.startScope=function(t){var n={track:[],name:"unnamed scope",id:this.state.nextScopeId++};t&&(n.name=t),this.state.scopeStack.push(n),this.state.activeScope=n},e.prototype.endScope=function(t){for(var n=this,r=Hx(t),o=new Set(r.map(function(u){return u.id})),i=0;i<this.state.activeScope.track.length;i++){var a=this.state.activeScope.track[i];a.kept||o.has(a.id)||a.dispose()}var s=this.state.scopeStack.pop();this.state.activeScope=this.state.scopeStack.length===0?null:this.state.scopeStack[this.state.scopeStack.length-1],r.forEach(function(u){u.kept||u.scopeId!==s.id||n.track(u)})},e.prototype.gradients=function(t,n,r,o){var i=this;if(o===void 0&&(o=!1),I(n.length>0,function(){return"gradients() received an empty list of xs."}),r!=null&&r.dtype!=="float32")throw new Error("dy must have 'float32' dtype, but has '"+r.dtype+"'");var a=this.scopedRun(function(){return i.startTape()},function(){return i.endTape()},function(){return i.tidy("forward",t)});I(a instanceof st,function(){return"The result y returned by f() must be a tensor."});var s=function(u,l,c){for(var f={},d={},h=0;h<l.length;h++)f[l[h].id]=!0;for(h=0;h<u.length;h++){var p=(b=u[h]).inputs;for(var v in p){for(var g=p[v],m=!1,y=0;y<l.length;y++)if(f[g.id]){b.outputs.forEach(function(R){return f[R.id]=!0}),m=!0,d[b.id]=!0;break}if(m)break}}var x={};x[c.id]=!0;var w={};for(h=u.length-1;h>=0;h--)for(p=(b=u[h]).inputs,y=0;y<b.outputs.length;y++)if(x[b.outputs[y].id]){for(var v in p)x[p[v].id]=!0,w[b.id]=!0;break}var E=[];for(h=0;h<u.length;h++){var b;if(d[(b=u[h]).id]&&w[b.id]){var C={};for(var v in b.inputs){var _=b.inputs[v];f[_.id]&&(C[v]=_)}var S=Object.assign({},b);S.inputs=C,S.outputs=b.outputs,E.push(S)}}return E}(this.state.activeTape,n,a);if(!o&&s.length===0&&n.length>0)throw new Error("Cannot compute gradient of y=f(x) with respect to x. Make sure that the f you passed encloses all operations that lead from x to y.");return this.tidy("backward",function(){var u,l,c={};c[a.id]=r??(u=a.shape,l=zx(le(u),"float32"),P.makeTensor(l,u,"float32")),function(d,h,p){for(var v=function(m){var y=h[m],x=[];if(y.outputs.forEach(function(C){var _=d[C.id];_!=null?x.push(_):x.push(null)}),y.gradient==null)throw new Error("Cannot compute gradient: gradient function not found for "+y.kernelName+".");var w=y.gradient(x),E=function(C){if(!(C in w))throw new Error("Cannot backprop through input "+C+". Available gradients found: "+Object.keys(w)+".");var _=p(function(){return w[C]()});if(_.dtype!=="float32")throw new Error("Error in gradient for op "+y.kernelName+". The gradient of input "+C+" must have 'float32' dtype, but has '"+_.dtype+"'");var S=y.inputs[C];if(!Ft(_.shape,S.shape))throw new Error("Error in gradient for op "+y.kernelName+". The gradient of input '"+C+"' has shape '"+_.shape+"', which does not match the shape of the input '"+S.shape+"'");if(d[S.id]==null)d[S.id]=_;else{var R=d[S.id];d[S.id]=R.add(_),R.dispose()}};for(var b in y.inputs)E(b)},g=h.length-1;g>=0;g--)v(g)}(c,s,function(d){return i.tidy(d)});var f=n.map(function(d){return c[d.id]});return i.state.gradientDepth===0&&(i.state.activeTape.forEach(function(d){for(var h=0,p=d.saved;h<p.length;h++)p[h].dispose()}),i.state.activeTape=null),{value:a,grads:f}})},e.prototype.customGrad=function(t){var n=this;return I(oh(t),function(){return"The f passed in customGrad(f) must be a function."}),function(){for(var r,o=[],i=0;i<arguments.length;i++)o[i]=arguments[i];I(o.every(function(s){return s instanceof st}),function(){return"The args passed in customGrad(f)(x1, x2,...) must all be tensors"});var a={};return o.forEach(function(s,u){a[u]=s}),n.runKernelFunc(function(s,u){return I((r=t.apply(void 0,o.concat([u]))).value instanceof st,function(){return"The function f passed in customGrad(f) must return an object where `obj.value` is a tensor"}),I(oh(r.gradFunc),function(){return"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function."}),r.value},a,function(s,u){var l=r.gradFunc(s,u),c=Array.isArray(l)?l:[l];I(c.length===o.length,function(){return"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns the same number of tensors as inputs passed to f(...)."}),I(c.every(function(d){return d instanceof st}),function(){return"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns a list of only tensors."});var f={};return c.forEach(function(d,h){f[h]=function(){return d}}),f})}},e.prototype.readSync=function(t){return this.state.tensorInfo.get(t).backend.readSync(t)},e.prototype.read=function(t){return this.state.tensorInfo.get(t).backend.read(t)},e.prototype.time=function(t){return se(this,void 0,void 0,function(){var n,r;return ue(this,function(o){switch(o.label){case 0:return n=yr(),[4,this.backend.time(t)];case 1:return(r=o.sent()).wallMs=yr()-n,[2,r]}})})},e.prototype.track=function(t){return this.state.activeScope!=null&&(t.scopeId=this.state.activeScope.id,this.state.activeScope.track.push(t)),t},Object.defineProperty(e.prototype,"registeredVariables",{get:function(){return this.state.registeredVariables},enumerable:!0,configurable:!0}),e.prototype.reset=function(){for(var t in this.pendingBackendInitId++,this.state.dispose(),this.ENV.reset(),this.state=new Lg,this.registry)this.disposeRegisteredKernels(t),this.registry[t].dispose(),delete this.registry[t];this.backendName=null,this.backendInstance=null,this.pendingBackendInit=null},e.nextTensorId=0,e.nextVariableId=0,e}(),P=function(){var e=function(){if(If==null){var n=void 0;if(typeof window<"u")n=window;else if(typeof global<"u")n=global;else if(typeof process<"u")n=process;else{if(typeof self>"u")throw new Error("Could not find a global object");n=self}If=n}return If}();if(e._tfengine==null){var t=new WR(e);e._tfengine=new ak(t)}return function(n){Fx=n}(e._tfengine.ENV),wr=function(){return e._tfengine},e._tfengine}();function Gx(){return typeof window<"u"&&window.document!=null||typeof WorkerGlobalScope<"u"}var Fr=G();Fr.registerFlag("DEBUG",function(){return!1},function(e){e&&console.warn("Debugging mode is ON. The output of every math call will be downloaded to CPU and checked for NaNs. This significantly impacts performance.")}),Fr.registerFlag("IS_BROWSER",function(){return Gx()}),Fr.registerFlag("IS_NODE",function(){return typeof process<"u"&&process.versions!==void 0&&process.versions.node!==void 0}),Fr.registerFlag("IS_CHROME",function(){return typeof navigator<"u"&&navigator!=null&&navigator.userAgent!=null&&/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor)}),Fr.registerFlag("PROD",function(){return!1}),Fr.registerFlag("TENSORLIKE_CHECK_SHAPE_CONSISTENCY",function(){return Fr.getBool("DEBUG")}),Fr.registerFlag("DEPRECATION_WARNINGS_ENABLED",function(){return!0}),Fr.registerFlag("IS_TEST",function(){return!1});var Ps,Sn,Cn,zo={},Df={alpha:!1,antialias:!1,premultipliedAlpha:!1,preserveDrawingBuffer:!1,depth:!1,stencil:!1,failIfMajorPerformanceCaveat:!0};function sk(e,t){zo[e]=t}function Dr(e){e in zo||(zo[e]=function(n){if(n!==1&&n!==2)throw new Error("Cannot get WebGL rendering context, WebGL is disabled.");var r=function(o){if(typeof OffscreenCanvas<"u"&&o===2)return new OffscreenCanvas(300,150);if(typeof document<"u")return document.createElement("canvas");throw new Error("Cannot create a canvas in this context")}(n);return r.addEventListener("webglcontextlost",function(o){o.preventDefault(),delete zo[n]},!1),n===1?r.getContext("webgl",Df)||r.getContext("experimental-webgl",Df):r.getContext("webgl2",Df)}(e));var t=zo[e];return t.isContextLost()?(delete zo[e],Dr(e)):(t.disable(t.DEPTH_TEST),t.disable(t.STENCIL_TEST),t.disable(t.BLEND),t.disable(t.DITHER),t.disable(t.POLYGON_OFFSET_FILL),t.disable(t.SAMPLE_COVERAGE),t.enable(t.SCISSOR_TEST),t.enable(t.CULL_FACE),t.cullFace(t.BACK),zo[e])}function kc(e,t){return[t,e]}function ss(e){var t=le(e);return rh(Math.ceil(t/4))}function Ks(e,t){return[Math.max(1,Math.ceil(t/2)),Math.max(1,Math.ceil(e/2))]}function Np(e,t){var n,r,o,i,a,s,u,l,c,f=e;return G().getNumber("WEBGL_VERSION")===2?(n=f.R32F,r=f.R16F,o=f.RGBA16F,i=f.RGBA32F,a=f.RED,s=4,u=1,l=f.HALF_FLOAT,c=f.FLOAT):(n=e.RGBA,r=e.RGBA,o=e.RGBA,i=f.RGBA,a=e.RGBA,s=4,u=4,l=t!=null?t.HALF_FLOAT_OES:null,c=e.FLOAT),{internalFormatFloat:n,internalFormatHalfFloat:r,internalFormatPackedHalfFloat:o,internalFormatPackedFloat:i,textureFormatFloat:a,downloadTextureFormat:e.RGBA,downloadUnpackNumChannels:s,defaultNumChannels:u,textureTypeHalfFloat:l,textureTypeFloat:c}}function ce(e,t,n){var r=n();return t&&function(o){var i=o.getError();if(i!==o.NO_ERROR)throw new Error("WebGL Error: "+fk(o,i))}(e),r}(function(e){e[e.DENSE=0]="DENSE",e[e.SHARED_BATCH=1]="SHARED_BATCH"})(Ps||(Ps={})),function(e){e[e.RENDER=0]="RENDER",e[e.UPLOAD=1]="UPLOAD",e[e.PIXELS=2]="PIXELS",e[e.DOWNLOAD=3]="DOWNLOAD"}(Sn||(Sn={})),function(e){e[e.UNPACKED_FLOAT16=0]="UNPACKED_FLOAT16",e[e.UNPACKED_FLOAT32=1]="UNPACKED_FLOAT32",e[e.PACKED_4X1_UNSIGNED_BYTE=2]="PACKED_4X1_UNSIGNED_BYTE",e[e.PACKED_2X2_FLOAT32=3]="PACKED_2X2_FLOAT32",e[e.PACKED_2X2_FLOAT16=4]="PACKED_2X2_FLOAT16"}(Cn||(Cn={}));var uk=596e-10,lk=65504;function ck(e){return!!(G().getBool("WEBGL_RENDER_FLOAT32_ENABLED")||e===0||uk<Math.abs(e)&&Math.abs(e)<lk)}function fk(e,t){switch(t){case e.NO_ERROR:return"NO_ERROR";case e.INVALID_ENUM:return"INVALID_ENUM";case e.INVALID_VALUE:return"INVALID_VALUE";case e.INVALID_OPERATION:return"INVALID_OPERATION";case e.INVALID_FRAMEBUFFER_OPERATION:return"INVALID_FRAMEBUFFER_OPERATION";case e.OUT_OF_MEMORY:return"OUT_OF_MEMORY";case e.CONTEXT_LOST_WEBGL:return"CONTEXT_LOST_WEBGL";default:return"Unknown error code "+t}}function ku(e,t,n){return Kr(e,t,function(){return e.getExtension(n)},'Extension "'+n+'" not supported on this browser.')}function dk(e,t,n){var r=Kr(e,t,function(){return e.createShader(e.VERTEX_SHADER)},"Unable to create vertex WebGLShader.");if(ce(e,t,function(){return e.shaderSource(r,n)}),ce(e,t,function(){return e.compileShader(r)}),e.getShaderParameter(r,e.COMPILE_STATUS)===!1)throw console.log(e.getShaderInfoLog(r)),new Error("Failed to compile vertex shader.");return r}function hk(e,t,n){var r=Kr(e,t,function(){return e.createShader(e.FRAGMENT_SHADER)},"Unable to create fragment WebGLShader.");if(ce(e,t,function(){return e.shaderSource(r,n)}),ce(e,t,function(){return e.compileShader(r)}),e.getShaderParameter(r,e.COMPILE_STATUS)===!1)throw function(o,i){var a=pk.exec(i);if(a==null)return console.log("Couldn't parse line number in error: "+i),void console.log(o);for(var s=+a[1],u=o.split(`
`),l=u.length.toString().length+2,c=u.map(function(g,m){return na((m+1).toString(),l)+g}),f=0,d=0;d<c.length;d++)f=Math.max(c[d].length,f);var h=c.slice(0,s-1),p=c.slice(s-1,s),v=c.slice(s);console.log(h.join(`
`)),console.log(i.split(`
`)[0]),console.log("%c "+na(p[0],f),"border:1px solid red; background-color:#e3d2d2; color:#a61717"),console.log(v.join(`
`))}(n,e.getShaderInfoLog(r)),new Error("Failed to compile fragment shader.");return r}var Tf,Nf,pk=/ERROR: [0-9]+:([0-9]+):/g;function vk(e,t){return Kr(e,t,function(){return e.createProgram()},"Unable to create WebGLProgram.")}function mk(e,t,n){if(ce(e,t,function(){return e.linkProgram(n)}),e.getProgramParameter(n,e.LINK_STATUS)===!1)throw console.log(e.getProgramInfoLog(n)),new Error("Failed to link vertex and fragment shaders.")}function Af(e,t,n){if(ce(e,t,function(){return e.validateProgram(n)}),e.getProgramParameter(n,e.VALIDATE_STATUS)===!1)throw console.log(e.getProgramInfoLog(n)),new Error("Shader program validation failed.")}function gk(e,t,n){var r=Kr(e,t,function(){return e.createBuffer()},"Unable to create WebGLBuffer");return ce(e,t,function(){return e.bindBuffer(e.ARRAY_BUFFER,r)}),ce(e,t,function(){return e.bufferData(e.ARRAY_BUFFER,n,e.STATIC_DRAW)}),r}function yk(e,t,n){var r=Kr(e,t,function(){return e.createBuffer()},"Unable to create WebGLBuffer");return ce(e,t,function(){return e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,r)}),ce(e,t,function(){return e.bufferData(e.ELEMENT_ARRAY_BUFFER,n,e.STATIC_DRAW)}),r}function xk(e,t){return Kr(e,t,function(){return e.createTexture()},"Unable to create WebGLTexture.")}function wk(e,t){var n=G().getNumber("WEBGL_MAX_TEXTURE_SIZE");if(e<=0||t<=0){var r="["+e+"x"+t+"]";throw new Error("Requested texture size "+r+" is invalid.")}if(e>n||t>n)throw r="["+e+"x"+t+"]",new Error("Requested texture size "+r+" greater than WebGL maximum on this browser / GPU "+("["+n+"x"+n+"]")+".")}function bk(e,t){return Kr(e,t,function(){return e.createFramebuffer()},"Unable to create WebGLFramebuffer.")}function Bg(e,t,n,r,o,i,a,s){var u=e.getAttribLocation(n,r);return u!==-1&&(ce(e,t,function(){return e.bindBuffer(e.ARRAY_BUFFER,o)}),ce(e,t,function(){return e.vertexAttribPointer(u,i,e.FLOAT,!1,a,s)}),ce(e,t,function(){return e.enableVertexAttribArray(u)}),!0)}function Ek(e,t,n,r){kk(e,r),ce(e,t,function(){return e.activeTexture(e.TEXTURE0+r)}),ce(e,t,function(){return e.bindTexture(e.TEXTURE_2D,n)})}function Ck(e,t,n,r){return Kr(e,t,function(){return e.getUniformLocation(n,r)},'uniform "'+r+'" not present in program.')}function _k(e,t,n){return e.getUniformLocation(t,n)}function Sk(e,t,n,r,o,i){ce(e,t,function(){return Ek(e,t,r,i)}),ce(e,t,function(){return e.uniform1i(o,i)})}function Pf(e,t,n,r){ce(e,t,function(){return e.bindFramebuffer(e.FRAMEBUFFER,r)}),ce(e,t,function(){return e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,n,0)})}function Ug(e,t,n){ce(e,t,function(){return e.bindFramebuffer(e.FRAMEBUFFER,n)}),ce(e,t,function(){return e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,null,0)})}function Iu(e){var t=e.checkFramebufferStatus(e.FRAMEBUFFER);if(t!==e.FRAMEBUFFER_COMPLETE)throw new Error("Error binding framebuffer: "+Rk(e,t))}function Rk(e,t){switch(t){case e.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_ATTACHMENT";case e.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT";case e.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:return"FRAMEBUFFER_INCOMPLETE_DIMENSIONS";case e.FRAMEBUFFER_UNSUPPORTED:return"FRAMEBUFFER_UNSUPPORTED";default:return"unknown error "+t}}function Kr(e,t,n,r){var o=ce(e,t,function(){return n()});if(o==null)throw new Error(r);return o}function kk(e,t){var n=e.MAX_COMBINED_TEXTURE_IMAGE_UNITS-1,r=t+e.TEXTURE0;if(r<e.TEXTURE0||r>n)throw new Error("textureUnit must be in "+("[gl.TEXTURE0, gl.TEXTURE"+n+"]")+".")}function Ol(e,t){return t===void 0&&(t=2),le(e.slice(0,e.length-t))}function Ll(e){if(e.length===0)throw Error("Cannot get rows and columns of an empty shape array.");return[e.length>1?e[e.length-2]:1,e[e.length-1]]}function Ff(e){var t=[1,1,1];return e.length===0||e.length===1&&e[0]===1||(t=[Ol(e)].concat(Ll(e))),t}function Ik(e,t){var n;t===void 0&&(t=!1);var r=G().getNumber("WEBGL_MAX_TEXTURE_SIZE");if(t&&(r*=2,(e=e.map(function(l,c){return c>=e.length-2?Bx(e[c]):e[c]})).length===1&&(e=[2,e[0]])),e.length!==2){var o=$o(e);e=o.newShape}var i=le(e);if(e.length<=1&&i<=r)return[1,i];if(e.length===2&&e[0]<=r&&e[1]<=r)return e;if(e.length===3&&e[0]*e[1]<=r&&e[2]<=r)return[e[0]*e[1],e[2]];if(e.length===3&&e[0]<=r&&e[1]*e[2]<=r)return[e[0],e[1]*e[2]];if(e.length===4&&e[0]*e[1]*e[2]<=r&&e[3]<=r)return[e[0]*e[1]*e[2],e[3]];if(e.length===4&&e[0]<=r&&e[1]*e[2]*e[3]<=r)return[e[0],e[1]*e[2]*e[3]];if(t){var a=Ol(e),s=2,u=2;return e.length&&(s=(n=Ll(e))[0],u=n[1]),rh(i=a*(s/2)*(u/2)).map(function(l){return 2*l})}return rh(i)}function Du(e){return e%2==0}function Tu(e,t){if(Ft(e=e.slice(-2),t=t.slice(-2))||!e.length||!t.length||e[0]===0||e[1]===0||t[0]===0||t[1]===0)return!0;if(e.length!==t.length){var n=e.slice(-1)[0],r=t.slice(-1)[0];if(n===r||Du(n)&&Du(r)&&(e[0]===1||t[0]===1))return!0}return e[1]===t[1]&&Du(e[0])&&Du(t[0])}function Dk(e){if(Tf==null){var t=Dr(e);Tf=t.getParameter(t.MAX_TEXTURE_SIZE)}return Tf}function Tk(e){if(Nf==null){var t=Dr(e);Nf=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS)}return Math.min(16,Nf)}function Nk(e){if(e===0)return 0;var t=Dr(e);return jn(t,"EXT_disjoint_timer_query_webgl2")&&e===2?2:jn(t,"EXT_disjoint_timer_query")?1:0}function jn(e,t){return e.getExtension(t)!=null}function Wg(e){try{if(Dr(e)!=null)return!0}catch{return!1}return!1}function Ak(e){if(e===0)return!1;var t=Dr(e);if(e===1){if(!jn(t,"OES_texture_float"))return!1}else if(!jn(t,"EXT_color_buffer_float"))return!1;return ch(t)}function Pk(e){if(e===0)return!1;var t=Dr(e);if(e!==1){if(jn(t,"EXT_color_buffer_float"))return ch(t);if(jn(t,"EXT_color_buffer_half_float")){var n=t.getExtension("EXT_color_buffer_half_float");return function(r,o){var i=Np(r,o),a=r.createTexture();r.bindTexture(r.TEXTURE_2D,a),r.texImage2D(r.TEXTURE_2D,0,i.internalFormatHalfFloat,1,1,0,i.textureFormatFloat,i.textureTypeHalfFloat,null);var s=r.createFramebuffer();r.bindFramebuffer(r.FRAMEBUFFER,s),r.framebufferTexture2D(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0,r.TEXTURE_2D,a,0);var u=r.checkFramebufferStatus(r.FRAMEBUFFER)===r.FRAMEBUFFER_COMPLETE;return r.bindTexture(r.TEXTURE_2D,null),r.bindFramebuffer(r.FRAMEBUFFER,null),r.deleteTexture(a),r.deleteFramebuffer(s),u}(t,n)}return!1}return!!jn(t,"OES_texture_float")&&!!jn(t,"WEBGL_color_buffer_float")&&ch(t)}function ch(e){var t=Np(e),n=e.createTexture();e.bindTexture(e.TEXTURE_2D,n),e.texImage2D(e.TEXTURE_2D,0,t.internalFormatFloat,1,1,0,t.textureFormatFloat,t.textureTypeFloat,null);var r=e.createFramebuffer();e.bindFramebuffer(e.FRAMEBUFFER,r),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,n,0);var o=e.checkFramebufferStatus(e.FRAMEBUFFER)===e.FRAMEBUFFER_COMPLETE;return e.bindTexture(e.TEXTURE_2D,null),e.bindFramebuffer(e.FRAMEBUFFER,null),e.deleteTexture(n),e.deleteFramebuffer(r),o}function Fk(e){return e===2&&Dr(e).fenceSync!=null}var we=G();function qx(e){G().getBool("DEPRECATION_WARNINGS_ENABLED")&&console.warn(e+" You can disable deprecation warnings with tf.disableDeprecationWarnings().")}function oe(e,t){return P.tidy(e,t)}function vn(e){Hx(e).forEach(function(t){return t.dispose()})}function Mk(e){return P.keep(e)}function Bl(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];G().getBool("IS_TEST")||console.warn.apply(console,e)}function Mo(e,t){var n=e;if(Sr(e))return t==="string"?[]:[e.length];if(!Array.isArray(e))return[];for(var r=[];Array.isArray(n)||Sr(n)&&t!=="string";)r.push(n.length),n=n[0];return Array.isArray(e)&&G().getBool("TENSORLIKE_CHECK_SHAPE_CONSISTENCY")&&function o(i,a,s){if(s=s||[],!Array.isArray(i)&&!Sr(i))return void I(a.length===0,function(){return"Element arr["+s.join("][")+"] is a primitive, but should be an array/TypedArray of "+a[0]+" elements"});I(a.length>0,function(){return"Element arr["+s.join("][")+"] should be a primitive, but is an array of "+i.length+" elements"}),I(i.length===a[0],function(){return"Element arr["+s.join("][")+"] should have "+a[0]+" elements, but has "+i.length+" elements"});for(var u=a.slice(1),l=0;l<i.length;++l)o(i[l],u,s.concat(l))}(e,r,[]),r}function zg(e,t,n,r){if(e!=null&&(e!=="numeric"&&e!==t||e==="numeric"&&t==="string"))throw new Error("Argument '"+n+"' passed to '"+r+"' must be "+e+" tensor, but got "+t+" tensor")}function k(e,t,n,r){if(r===void 0&&(r="numeric"),e instanceof st)return zg(r,e.dtype,t,n),e;var o=Gs(e);if(o!=="string"&&["bool","int32","float32"].indexOf(r)>=0&&(o=r),zg(r,o,t,n),e==null||!Sr(e)&&!Array.isArray(e)&&typeof e!="number"&&typeof e!="boolean"&&typeof e!="string"){var i=e==null?"null":e.constructor.name;throw new Error("Argument '"+t+"' passed to '"+n+"' must be a Tensor or TensorLike, but got '"+i+"'")}var a=Mo(e,o);Sr(e)||Array.isArray(e)||(e=[e]);var s=o!=="string"?Wx(e,o,G().getBool("DEBUG")):ya(e,[],!0);return P.makeTensor(s,a,o)}function Ul(e,t,n,r){if(r===void 0&&(r="numeric"),!Array.isArray(e))throw new Error("Argument "+t+" passed to "+n+" must be a `Tensor[]` or `TensorLike[]`");return e.map(function(o,i){return k(o,t+"["+i+"]",n)},r)}function Kx(e,t){for(var n=0;n<e.length;++n)if(e[e.length-n-1]!==t-1-n)return!1;return!0}function Ok(e,t,n){for(var r=e.length+t.length,o=[],i=0,a=0,s=0;s<r;s++)n.indexOf(s)===-1?o.push(e[i++]):o.push(t[a++]);return o}function Gt(e,t){for(var n=[],r=e.length,o=0;o<r;o++)t.indexOf(o)===-1&&n.push(e[o]);return[n,t.map(function(i){return e[i]})]}function mn(e,t){return Ok(e,t.map(function(n){return 1}),t)}function En(e,t,n){I(Kx(t,n),function(){return e+" supports only inner-most axes for now. Got axes "+t+" and rank-"+n+" input."})}function Tr(e,t){if(Kx(e,t))return null;for(var n=[],r=0;r<t;++r)e.indexOf(r)===-1&&n.push(r);return e.forEach(function(o){return n.push(o)}),n}function Ap(e){return e.map(function(t,n){return[n,t]}).sort(function(t,n){return t[1]-n[1]}).map(function(t){return t[0]})}function Nr(e,t){for(var n=[],r=t-e;r<t;++r)n.push(r);return n}function Lk(e,t){var n=e[0].length;e.forEach(function(o,i){I(o.length===n,function(){return"Error in concat"+n+"D: rank of tensors["+i+"] must be the same as the rank of the rest ("+n+")"})}),I(t>=0&&t<n,function(){return"Error in concat"+n+"D: axis must be between 0 and "+(n-1)+"."});var r=e[0];e.forEach(function(o,i){for(var a=0;a<n;a++)I(a===t||o[a]===r[a],function(){return"Error in concat"+n+"D: Shape of tensors["+i+"] ("+o+") does not match the shape of the rest ("+r+") along the non-concatenated axis "+i+"."})})}function wa(e,t){for(var n=e[0].slice(),r=1;r<e.length;r++)n[t]+=e[r][t];return n}function N(e){var t=Object.keys(e);if(t.length!==1)throw new Error("Please provide an object with a single key (operation name) mapping to a function. Got an object with "+t.length+" keys.");var n=t[0],r=e[n];n.endsWith("_")&&(n=n.substring(0,n.length-1));var o=function(){for(var i=[],a=0;a<arguments.length;a++)i[a]=arguments[a];P.startScope(n);try{var s=r.apply(void 0,i);return s instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),P.endScope(s),s}catch(u){throw P.endScope(null),u}};return Object.defineProperty(o,"name",{value:n,configurable:!0}),o}we.registerFlag("HAS_WEBGL",function(){return we.getNumber("WEBGL_VERSION")>0}),we.registerFlag("WEBGL_VERSION",function(){return Wg(2)?2:Wg(1)?1:0}),we.registerFlag("WEBGL_BUFFER_SUPPORTED",function(){return we.get("WEBGL_VERSION")===2}),we.registerFlag("WEBGL_CPU_FORWARD",function(){return!0}),we.registerFlag("WEBGL_FORCE_F16_TEXTURES",function(){return!1}),we.registerFlag("WEBGL_PACK",function(){return we.getBool("HAS_WEBGL")}),we.registerFlag("WEBGL_PACK_NORMALIZATION",function(){return we.getBool("WEBGL_PACK")}),we.registerFlag("WEBGL_PACK_CLIP",function(){return we.getBool("WEBGL_PACK")}),we.registerFlag("WEBGL_PACK_DEPTHWISECONV",function(){return!1}),we.registerFlag("WEBGL_PACK_BINARY_OPERATIONS",function(){return we.getBool("WEBGL_PACK")}),we.registerFlag("WEBGL_PACK_UNARY_OPERATIONS",function(){return we.getBool("WEBGL_PACK")}),we.registerFlag("WEBGL_PACK_ARRAY_OPERATIONS",function(){return we.getBool("WEBGL_PACK")}),we.registerFlag("WEBGL_PACK_IMAGE_OPERATIONS",function(){return we.getBool("WEBGL_PACK")}),we.registerFlag("WEBGL_PACK_REDUCE",function(){return we.getBool("WEBGL_PACK")}),we.registerFlag("WEBGL_LAZILY_UNPACK",function(){return we.getBool("WEBGL_PACK")}),we.registerFlag("WEBGL_CONV_IM2COL",function(){return we.getBool("WEBGL_PACK")}),we.registerFlag("WEBGL_MAX_TEXTURE_SIZE",function(){return Dk(we.getNumber("WEBGL_VERSION"))}),we.registerFlag("WEBGL_MAX_TEXTURES_IN_SHADER",function(){return Tk(we.getNumber("WEBGL_VERSION"))}),we.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION",function(){var e=we.getNumber("WEBGL_VERSION");return e===0?0:Nk(e)}),we.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE",function(){return we.getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0&&(e=navigator.userAgent||navigator.vendor||window.opera,!(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(e)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(e.substr(0,4))));var e}),we.registerFlag("WEBGL_RENDER_FLOAT32_CAPABLE",function(){return Ak(we.getNumber("WEBGL_VERSION"))}),we.registerFlag("WEBGL_RENDER_FLOAT32_ENABLED",function(){return!we.getBool("WEBGL_FORCE_F16_TEXTURES")&&we.getBool("WEBGL_RENDER_FLOAT32_CAPABLE")}),we.registerFlag("WEBGL_DOWNLOAD_FLOAT_ENABLED",function(){return Pk(we.getNumber("WEBGL_VERSION"))}),we.registerFlag("WEBGL_FENCE_API_ENABLED",function(){return Fk(we.getNumber("WEBGL_VERSION"))}),we.registerFlag("WEBGL_SIZE_UPLOAD_UNIFORM",function(){return we.getBool("WEBGL_RENDER_FLOAT32_ENABLED")?4:0}),$x=qx;var Bt=N({complex_:function(e,t){var n=k(e,"real","complex"),r=k(t,"imag","complex");return je(n.shape,r.shape,"real and imag shapes, "+n.shape+" and "+r.shape+", must match in call to tf.complex()."),P.runKernelFunc(function(o){return o.complex(n,r)},{$real:n,$imag:r})}}),Wn=N({real_:function(e){var t=k(e,"input","real");return P.runKernelFunc(function(n){return n.real(t)},{$input:t})}}),br=N({imag_:function(e){var t=k(e,"input","imag");return P.runKernelFunc(function(n){return n.imag(t)},{$input:t})}});function Wt(e,t,n){return Oo(e,t,Mo(e,n),n)}function Oo(e,t,n,r){if(r==null&&(r=Gs(e)),r==="complex64")throw new Error("Cannot construct a complex64 tensor directly. Please use tf.complex(real, imag).");if(!Sr(e)&&!Array.isArray(e)&&typeof e!="number"&&typeof e!="boolean"&&typeof e!="string")throw new Error("values passed to tensor(values) must be a number/boolean/string or an array of numbers/booleans/strings, or a TypedArray");if(t!=null){jx(t);var o=le(t),i=le(n);I(o===i,function(){return"Based on the provided shape, ["+t+"], the tensor should have "+o+" values but has "+i});for(var a=0;a<n.length;++a){var s=n[a],u=a!==n.length-1||s!==le(t.slice(a));I(n[a]===t[a]||!u,function(){return"Error creating a new Tensor. Inferred shape ("+n+") does not match the provided shape ("+t+"). "})}}return Sr(e)||Array.isArray(e)||(e=[e]),t=t||n,e=r!=="string"?Wx(e,r,G().getBool("DEBUG")):ya(e,[],!0),P.makeTensor(e,t,r)}function ne(e,t){if((Sr(e)&&t!=="string"||Array.isArray(e))&&t!=="complex64")throw new Error("Error creating a new Scalar: value must be a primitive (number|boolean|string)");if(t==="string"&&Sr(e)&&!(e instanceof Uint8Array))throw new Error("When making a scalar from encoded string, the value must be `Uint8Array`.");return Oo(e,[],[],t)}function wt(e,t){Ia(e);var n=Mo(e,t);if(n.length!==1)throw new Error("tensor1d() requires values to be a flat/TypedArray");return Oo(e,null,n,t)}function _o(e,t,n){if(Ia(e),t!=null&&t.length!==2)throw new Error("tensor2d() requires shape to have two numbers");var r=Mo(e,n);if(r.length!==2&&r.length!==1)throw new Error("tensor2d() requires values to be number[][] or flat/TypedArray");if(r.length===1&&t==null)throw new Error("tensor2d() requires shape to be provided when `values` are a flat/TypedArray");return Oo(e,t,r,n)}function Pp(e,t,n){if(Ia(e),t!=null&&t.length!==3)throw new Error("tensor3d() requires shape to have three numbers");var r=Mo(e,n);if(r.length!==3&&r.length!==1)throw new Error("tensor3d() requires values to be number[][][] or flat/TypedArray");if(r.length===1&&t==null)throw new Error("tensor3d() requires shape to be provided when `values` are a flat array");return Oo(e,t,r,n)}function un(e,t,n){if(Ia(e),t!=null&&t.length!==4)throw new Error("tensor4d() requires shape to have four numbers");var r=Mo(e,n);if(r.length!==4&&r.length!==1)throw new Error("tensor4d() requires values to be number[][][][] or flat/TypedArray");if(r.length===1&&t==null)throw new Error("tensor4d() requires shape to be provided when `values` are a flat array");return Oo(e,t,r,n)}function Bk(e,t,n){if(Ia(e),t!=null&&t.length!==5)throw new Error("tensor5d() requires shape to have five numbers");var r=Mo(e,n);if(r.length!==5&&r.length!==1)throw new Error("tensor5d() requires values to be number[][][][][] or flat/TypedArray");if(r.length===1&&t==null)throw new Error("tensor5d() requires shape to be provided when `values` are a flat array");return Oo(e,t,r,n)}function Uk(e,t,n){if(Ia(e),t!=null&&t.length!==6)throw new Error("tensor6d() requires shape to have six numbers");var r=Mo(e,n);if(r.length!==6&&r.length!==1)throw new Error("tensor6d() requires values to be number[][][][][][] or flat/TypedArray");if(r.length===1&&t==null)throw new Error("tensor6d() requires shape to be provided when `values` are a flat array");return Oo(e,t=t||r,r,n)}function Wk(e,t,n,r){return t===void 0&&(t=!0),P.makeVariable(e,t,n,r)}function Da(e,t){if(t===void 0&&(t="float32"),t==="complex64"){var n=Da(e,"float32"),r=et(e,"float32");return Bt(n,r)}var o=zx(le(e),t);return P.makeTensor(o,e,t)}function et(e,t){if(t===void 0&&(t="float32"),t==="complex64"){var n=et(e,"float32"),r=et(e,"float32");return Bt(n,r)}var o=qs(le(e),t);return P.makeTensor(o,e,t)}function kr(e,t,n){return P.runKernelFunc(function(r){return r.fill(e,t,n)},{})}function zk(e,t,n){if(n<=0)throw new Error("The number of values should be positive.");return P.runKernelFunc(function(r){return r.linspace(e,t,n)},{})}function Wl(e,t,n,r){if(n===void 0&&(n=1),r===void 0&&(r="float32"),n===0)throw new Error("Cannot have a step of zero");if(e===t||e<t&&n<0||t<e&&n>1)return et([0],r);var o=qs(Math.abs(Math.ceil((t-e)/n)),r);t<e&&n===1&&(n=-1),o[0]=e;for(var i=1;i<o.length;i++)o[i]=o[i-1]+n;return wt(o,r)}var Xx=N({onesLike_:function(e){var t=k(e,"x","onesLike");if(t.dtype==="complex64"){var n=Xx(Wn(t)),r=Le(br(t));return Bt(n,r)}return P.runKernelFunc(function(o){return o.onesLike(t)},{$x:t},function(o,i){return{$x:function(){return Le(o)}}})}}),Le=N({zerosLike_:function(e){var t=k(e,"x","zerosLike");return P.runKernelFunc(function(n){return n.zerosLike(t)},{$x:t},function(n,r){return{$x:function(){return Le(n)}}})}}),St=N({concat_:function(e,t){t===void 0&&(t=0),I(e.length>=1,function(){return"Pass at least one tensor to concat"});var n=Ul(e,"tensors","concat");n[0].dtype==="complex64"&&n.forEach(function(s){if(s.dtype!=="complex64")throw new Error(`Cannot concatenate complex64 tensors with a tensor
          with dtype `+s.dtype+". ")}),t=Dt(t,n[0].shape)[0];var r=wa(n.map(function(s){return s.shape}),t);if(le(r)===0)return Wt([],r);if((n=n.filter(function(s){return s.size>0})).length===1)return n[0];var o=n.map(function(s){return s.shape});Lk(o,t);var i=n,a={axis:t};return P.runKernelFunc(function(s){return s.concat(n,t)},i,function(s){var u=o.map(function(l){return l[t]});return Fp(s,u,t).map(function(l){return function(){return l}})},"Concat",a)}}),jk=N({concat1d_:function(e){return St(e,0)}}),Vk=N({concat2d_:function(e,t){return St(e,t)}}),$k=N({concat3d_:function(e,t){return St(e,t)}}),Hk=N({concat4d_:function(e,t){return St(e,t)}}),Fp=N({split_:function(e,t,n){n===void 0&&(n=0);var r,o=k(e,"x","split");return n=Dt(n,o.shape)[0],typeof t=="number"?(I(o.shape[n]%t==0,function(){return"Number of splits must evenly divide the axis."}),r=new Array(t).fill(o.shape[n]/t)):(I(o.shape[n]===t.reduce(function(i,a){return i+a}),function(){return"The sum of sizes must match the size of the axis dimension."}),r=t),P.runKernelFunc(function(i){return i.split(o,r,n)},{$x:o},function(i){return{$x:function(){return St(i,n)}}})}});function vi(e,t){return e(t={exports:{}},t.exports),t.exports}var Gk=vi(function(e){(function(t,n,r){function o(s){var u,l=this,c=(u=4022871197,function(f){f=f.toString();for(var d=0;d<f.length;d++){var h=.02519603282416938*(u+=f.charCodeAt(d));h-=u=h>>>0,u=(h*=u)>>>0,u+=4294967296*(h-=u)}return 23283064365386963e-26*(u>>>0)});l.next=function(){var f=2091639*l.s0+23283064365386963e-26*l.c;return l.s0=l.s1,l.s1=l.s2,l.s2=f-(l.c=0|f)},l.c=1,l.s0=c(" "),l.s1=c(" "),l.s2=c(" "),l.s0-=c(s),l.s0<0&&(l.s0+=1),l.s1-=c(s),l.s1<0&&(l.s1+=1),l.s2-=c(s),l.s2<0&&(l.s2+=1),c=null}function i(s,u){return u.c=s.c,u.s0=s.s0,u.s1=s.s1,u.s2=s.s2,u}function a(s,u){var l=new o(s),c=u&&u.state,f=l.next;return f.int32=function(){return 4294967296*l.next()|0},f.double=function(){return f()+11102230246251565e-32*(2097152*f()|0)},f.quick=f,c&&(typeof c=="object"&&i(c,l),f.state=function(){return i(l,{})}),f}n&&n.exports?n.exports=a:this.alea=a})(0,e)}),qk=vi(function(e){(function(t,n,r){function o(s){var u=this,l="";u.x=0,u.y=0,u.z=0,u.w=0,u.next=function(){var f=u.x^u.x<<11;return u.x=u.y,u.y=u.z,u.z=u.w,u.w^=u.w>>>19^f^f>>>8},s===(0|s)?u.x=s:l+=s;for(var c=0;c<l.length+64;c++)u.x^=0|l.charCodeAt(c),u.next()}function i(s,u){return u.x=s.x,u.y=s.y,u.z=s.z,u.w=s.w,u}function a(s,u){var l=new o(s),c=u&&u.state,f=function(){return(l.next()>>>0)/4294967296};return f.double=function(){do var d=((l.next()>>>11)+(l.next()>>>0)/4294967296)/2097152;while(d===0);return d},f.int32=l.next,f.quick=f,c&&(typeof c=="object"&&i(c,l),f.state=function(){return i(l,{})}),f}n&&n.exports?n.exports=a:this.xor128=a})(0,e)}),Kk=vi(function(e){(function(t,n,r){function o(s){var u=this,l="";u.next=function(){var f=u.x^u.x>>>2;return u.x=u.y,u.y=u.z,u.z=u.w,u.w=u.v,(u.d=u.d+362437|0)+(u.v=u.v^u.v<<4^f^f<<1)|0},u.x=0,u.y=0,u.z=0,u.w=0,u.v=0,s===(0|s)?u.x=s:l+=s;for(var c=0;c<l.length+64;c++)u.x^=0|l.charCodeAt(c),c==l.length&&(u.d=u.x<<10^u.x>>>4),u.next()}function i(s,u){return u.x=s.x,u.y=s.y,u.z=s.z,u.w=s.w,u.v=s.v,u.d=s.d,u}function a(s,u){var l=new o(s),c=u&&u.state,f=function(){return(l.next()>>>0)/4294967296};return f.double=function(){do var d=((l.next()>>>11)+(l.next()>>>0)/4294967296)/2097152;while(d===0);return d},f.int32=l.next,f.quick=f,c&&(typeof c=="object"&&i(c,l),f.state=function(){return i(l,{})}),f}n&&n.exports?n.exports=a:this.xorwow=a})(0,e)}),Xk=vi(function(e){(function(t,n,r){function o(s){var u=this;u.next=function(){var l,c,f=u.x,d=u.i;return l=f[d],c=(l^=l>>>7)^l<<24,c^=(l=f[d+1&7])^l>>>10,c^=(l=f[d+3&7])^l>>>3,c^=(l=f[d+4&7])^l<<7,l=f[d+7&7],c^=(l^=l<<13)^l<<9,f[d]=c,u.i=d+1&7,c},function(l,c){var f,d=[];if(c===(0|c))d[0]=c;else for(c=""+c,f=0;f<c.length;++f)d[7&f]=d[7&f]<<15^c.charCodeAt(f)+d[f+1&7]<<13;for(;d.length<8;)d.push(0);for(f=0;f<8&&d[f]===0;++f);for(f==8?d[7]=-1:d[f],l.x=d,l.i=0,f=256;f>0;--f)l.next()}(u,s)}function i(s,u){return u.x=s.x.slice(),u.i=s.i,u}function a(s,u){s==null&&(s=+new Date);var l=new o(s),c=u&&u.state,f=function(){return(l.next()>>>0)/4294967296};return f.double=function(){do var d=((l.next()>>>11)+(l.next()>>>0)/4294967296)/2097152;while(d===0);return d},f.int32=l.next,f.quick=f,c&&(c.x&&i(c,l),f.state=function(){return i(l,{})}),f}n&&n.exports?n.exports=a:this.xorshift7=a})(0,e)}),Yk=vi(function(e){(function(t,n,r){function o(s){var u=this;u.next=function(){var l,c,f=u.w,d=u.X,h=u.i;return u.w=f=f+1640531527|0,c=d[h+34&127],l=d[h=h+1&127],c^=c<<13,l^=l<<17,c^=c>>>15,l^=l>>>12,c=d[h]=c^l,u.i=h,c+(f^f>>>16)|0},function(l,c){var f,d,h,p,v,g=[],m=128;for(c===(0|c)?(d=c,c=null):(c+="\0",d=0,m=Math.max(m,c.length)),h=0,p=-32;p<m;++p)c&&(d^=c.charCodeAt((p+32)%c.length)),p===0&&(v=d),d^=d<<10,d^=d>>>15,d^=d<<4,d^=d>>>13,p>=0&&(v=v+1640531527|0,h=(f=g[127&p]^=d+v)==0?h+1:0);for(h>=128&&(g[127&(c&&c.length||0)]=-1),h=127,p=512;p>0;--p)d=g[h+34&127],f=g[h=h+1&127],d^=d<<13,f^=f<<17,d^=d>>>15,f^=f>>>12,g[h]=d^f;l.w=v,l.X=g,l.i=h}(u,s)}function i(s,u){return u.i=s.i,u.w=s.w,u.X=s.X.slice(),u}function a(s,u){s==null&&(s=+new Date);var l=new o(s),c=u&&u.state,f=function(){return(l.next()>>>0)/4294967296};return f.double=function(){do var d=((l.next()>>>11)+(l.next()>>>0)/4294967296)/2097152;while(d===0);return d},f.int32=l.next,f.quick=f,c&&(c.X&&i(c,l),f.state=function(){return i(l,{})}),f}n&&n.exports?n.exports=a:this.xor4096=a})(0,e)}),Qk=vi(function(e){(function(t,n,r){function o(s){var u=this,l="";u.next=function(){var f=u.b,d=u.c,h=u.d,p=u.a;return f=f<<25^f>>>7^d,d=d-h|0,h=h<<24^h>>>8^p,p=p-f|0,u.b=f=f<<20^f>>>12^d,u.c=d=d-h|0,u.d=h<<16^d>>>16^p,u.a=p-f|0},u.a=0,u.b=0,u.c=-1640531527,u.d=1367130551,s===Math.floor(s)?(u.a=s/4294967296|0,u.b=0|s):l+=s;for(var c=0;c<l.length+20;c++)u.b^=0|l.charCodeAt(c),u.next()}function i(s,u){return u.a=s.a,u.b=s.b,u.c=s.c,u.d=s.d,u}function a(s,u){var l=new o(s),c=u&&u.state,f=function(){return(l.next()>>>0)/4294967296};return f.double=function(){do var d=((l.next()>>>11)+(l.next()>>>0)/4294967296)/2097152;while(d===0);return d},f.int32=l.next,f.quick=f,c&&(typeof c=="object"&&i(c,l),f.state=function(){return i(l,{})}),f}n&&n.exports?n.exports=a:this.tychei=a})(0,e)}),jo=vi(function(e){(function(t,n){var r,o=this,i=256,a=6,s="random",u=n.pow(i,a),l=n.pow(2,52),c=2*l,f=i-1;function d(m,y,x){var w=[],E=v(function _(S,R){var D,T=[],z=typeof S;if(R&&z=="object")for(D in S)try{T.push(_(S[D],R-1))}catch{}return T.length?T:z=="string"?S:S+"\0"}((y=y==1?{entropy:!0}:y||{}).entropy?[m,g(t)]:m??function(){try{var _;return r&&(_=r.randomBytes)?_=_(i):(_=new Uint8Array(i),(o.crypto||o.msCrypto).getRandomValues(_)),g(_)}catch{var S=o.navigator,R=S&&S.plugins;return[+new Date,o,R,o.screen,g(t)]}}(),3),w),b=new h(w),C=function(){for(var _=b.g(a),S=u,R=0;_<l;)_=(_+R)*i,S*=i,R=b.g(1);for(;_>=c;)_/=2,S/=2,R>>>=1;return(_+R)/S};return C.int32=function(){return 0|b.g(4)},C.quick=function(){return b.g(4)/4294967296},C.double=C,v(g(b.S),t),(y.pass||x||function(_,S,R,D){return D&&(D.S&&p(D,b),_.state=function(){return p(b,{})}),R?(n[s]=_,S):_})(C,E,"global"in y?y.global:this==n,y.state)}function h(m){var y,x=m.length,w=this,E=0,b=w.i=w.j=0,C=w.S=[];for(x||(m=[x++]);E<i;)C[E]=E++;for(E=0;E<i;E++)C[E]=C[b=f&b+m[E%x]+(y=C[E])],C[b]=y;(w.g=function(_){for(var S,R=0,D=w.i,T=w.j,z=w.S;_--;)S=z[D=f&D+1],R=R*i+z[f&(z[D]=z[T=f&T+S])+(z[T]=S)];return w.i=D,w.j=T,R})(i)}function p(m,y){return y.i=m.i,y.j=m.j,y.S=m.S.slice(),y}function v(m,y){for(var x,w=m+"",E=0;E<w.length;)y[f&E]=f&(x^=19*y[f&E])+w.charCodeAt(E++);return g(y)}function g(m){return String.fromCharCode.apply(0,m)}if(n["seed"+s]=d,v(n.random(),t),e.exports){e.exports=d;try{r=require("crypto")}catch{}}})([],Math)});jo.alea=Gk,jo.xor128=qk,jo.xorwow=Kk,jo.xorshift7=Xk,jo.xor4096=Yk,jo.tychei=Qk;var Ic=jo.alea,Mp=function(){function e(t,n,r,o,i){this.mean=t,this.stdDev=n,this.dtype=r,this.nextVal=NaN,this.truncated=o,this.truncated&&(this.upper=this.mean+2*this.stdDev,this.lower=this.mean-2*this.stdDev);var a=i||Math.random();this.random=Ic(a.toString())}return e.prototype.nextValue=function(){if(!isNaN(this.nextVal)){var t=this.nextVal;return this.nextVal=NaN,t}for(var n,r,o=!1;!o;){var i=void 0,a=void 0,s=void 0;do s=(i=2*this.random()-1)*i+(a=2*this.random()-1)*a;while(s>=1||s===0);var u=Math.sqrt(-2*Math.log(s)/s);n=this.mean+this.stdDev*i*u,r=this.mean+this.stdDev*a*u,this.truncated&&!this.isValidTruncated(n)||(o=!0)}return this.truncated&&!this.isValidTruncated(r)||(this.nextVal=this.convertValue(r)),this.convertValue(n)},e.prototype.convertValue=function(t){return this.dtype==null||this.dtype==="float32"?t:Math.round(t)},e.prototype.isValidTruncated=function(t){return t<=this.upper&&t>=this.lower},e}(),Jk=function(){function e(t,n,r,o){this.alpha=t,this.beta=1/n,this.dtype=r;var i=o||Math.random();this.randu=Ic(i.toString()),this.randn=new Mp(0,1,r,!1,this.randu()),this.d=t<1?t+2/3:t-1/3,this.c=1/Math.sqrt(9*this.d)}return e.prototype.nextValue=function(){for(var t,n,r,o,i,a;;){do o=this.randn.nextValue(),a=1+this.c*o;while(a<=0);if(a*=a*a,n=1-.331*(t=o*o)*t,r=.5*t+this.d*(1-a+Math.log(a)),(i=this.randu())<n||Math.log(i)<r)break}return a=1/this.beta*this.d*a,this.alpha<1&&(a*=Math.pow(this.randu(),1/this.alpha)),this.convertValue(a)},e.prototype.convertValue=function(t){return this.dtype==="float32"?t:Math.round(t)},e}(),Zk=function(){function e(t,n,r,o){var i=this;if(t===void 0&&(t=0),n===void 0&&(n=1),this.canReturnFloat=function(){return i.dtype==null||i.dtype==="float32"},this.min=t,this.range=n-t,this.dtype=r,o==null&&(o=Math.random()),typeof o=="number"&&(o=o.toString()),!this.canReturnFloat()&&this.range<=1)throw new Error("The difference between "+t+" - "+n+" <= 1 and dtype is not float");this.random=Ic(o)}return e.prototype.convertValue=function(t){return this.canReturnFloat()?t:Math.round(t)},e.prototype.nextValue=function(){return this.convertValue(this.min+this.range*this.random())},e}();function Ce(e,t,n){return t===void 0&&(t="float32"),t=t||"float32",jx(e),new As(e,t,n)}function eI(e,t){t===void 0&&(t=!1),console.log(e.toString(t))}var Yx=N({batchToSpaceND_:function(e,t,n){var r=k(e,"x","batchToSpaceND"),o=t.reduce(function(i,a){return i*a});return I(r.rank>=1+t.length,function(){return"input rank is "+r.rank+" but should be > than blockShape.length "+t.length}),I(n.length===t.length,function(){return"crops.length is "+n.length+" but should be equal to blockShape.length  "+t.length}),I(r.shape[0]%o==0,function(){return"input tensor batch is "+r.shape[0]+" but is not divisible by the product of the elements of blockShape "+t.join(" * ")+" === "+o}),P.runKernelFunc(function(i){return i.batchToSpaceND(r,t,n)},{$x:r},function(i){return{$x:function(){return i.spaceToBatchND(t,n)}}})}}),tI=N({broadcastTo_:function(e,t){var n=k(e,"broadcastTo","x"),r=n.shape;if(t.some(function(u){return!(u>0)||u%1!=0}))throw new Error("broadcastTo(): Invalid broadcast shape ["+t+"].");if(t.length<n.rank)throw new Error("broadcastTo(): shape.length="+t.length+" < input.rank="+n.rank+".");if(t.length>n.rank){for(var o=n.shape.slice();o.length<t.length;)o.unshift(1);n=n.reshape(o)}for(var i=Array.from(t),a=t.length-1;a>=0;a--)if(n.shape[a]===t[a])i[a]=1;else if(n.shape[a]!==1)throw new Error("broadcastTo(): ["+r+"] cannot be broadcast to ["+t+"].");var s=i.map(function(u,l){return u>1?l:-1}).filter(function(u){return u>=0});return s.length===0?n.clone():P.runKernelFunc(function(u){return u.tile(n,i)},{input:n},function(u){return{input:function(){return u.sum(s,!0)}}})}}),nI=N({cast_:function(e,t){var n=k(e,"x","cast");if(!KR(t))throw new Error("Failed to cast to unknown dtype "+t);if(t==="string"&&n.dtype!=="string"||t!=="string"&&n.dtype==="string")throw new Error("Only strings can be casted to strings");var r={dtype:t};return P.runKernelFunc(function(o){return o.cast(n,t)},{x:n},function(o){return{x:function(){return o.clone()}}},"Cast",r)}}),rI=N({clone_:function(e){var t=k(e,"x","clone",null);return P.runKernelFunc(function(){return P.makeTensorFromDataId(t.dataId,t.shape,t.dtype)},{$x:t},function(n){return{$x:function(){return n.toFloat()}}})}}),oI=N({cumsum_:function(e,t,n,r){t===void 0&&(t=0),n===void 0&&(n=!1),r===void 0&&(r=!1);var o=k(e,"x","cumsum"),i=Tr([t|=0],o.rank),a=o;i!=null&&(a=o.transpose(i));var s=Nr(1,o.rank)[0],u=P.runKernelFunc(function(l){return l.cumsum(a,s,n,r)},{permutedX:a},function(l){return{permutedX:function(){return l.cumsum(t,n,!r)}}});return i!=null&&(u=u.transpose(i)),u}}),iI=N({depthToSpace_:function(e,t,n){n===void 0&&(n="NHWC");var r=k(e,"x","depthToSpace"),o=n==="NHWC"?r.shape[1]:r.shape[2],i=n==="NHWC"?r.shape[2]:r.shape[3],a=n==="NHWC"?r.shape[3]:r.shape[1];return I(o*t>=0,function(){return`Negative dimension size caused by overflow when multiplying
      `+o+" and "+t+`  for depthToSpace with input shape
      `+r.shape}),I(i*t>=0,function(){return`Negative dimension size caused by overflow when multiplying
      `+i+" and "+t+` for depthToSpace with input shape
          `+r.shape}),I(a%(t*t)==0,function(){return"Dimension size must be evenly divisible by "+t*t+" but is "+a+" for depthToSpace with input shape "+r.shape}),P.runKernelFunc(function(s){return s.depthToSpace(r,t,n)},{$x:r})}}),Un=N({expandDims_:function(e,t){t===void 0&&(t=0);var n=k(e,"x","expandDims",null);I(t<=n.rank,function(){return"Axis must be <= rank of the tensor"});var r=n.shape.slice();return t<0&&(I(-(n.rank+1)<=t,function(){return"Axis must be in the interval ["+-(n.rank+1)+", "+n.rank+"]"}),t=n.rank+t+1),r.splice(t,0,1),nr(n,r)}}),Qx=N({eye_:function(e,t,n,r){r===void 0&&(r="float32"),t==null&&(t=e);for(var o=Ce([e,t],r),i=e<=t?e:t,a=0;a<i;++a)o.set(1,a,a);var s=o.toTensor().as2D(e,t);if(n==null)return s;if(n.length===1)return ra(Un(s,0),[n[0],1,1]);if(n.length===2)return ra(Un(Un(s,0),0),[n[0],n[1],1,1]);if(n.length===3)return ra(Un(Un(Un(s,0),0),0),[n[0],n[1],n[2],1,1]);throw new Error("eye() currently supports only 1D and 2D batchShapes, but received "+n.length+"D.")}}),aI=N({multinomial_:function(e,t,n,r){r===void 0&&(r=!1);var o=k(e,"logits","multinomial"),i=o.size,a=o.rank;if(i<2)throw new Error("Error in multinomial: you need at least 2 outcomes, but got "+i+".");if(a>2)throw new Error("Rank of probabilities must be 1 or 2, but is "+a);n=n||Math.random();var s=a===1?o.as2D(1,-1):o,u=P.runKernelFunc(function(l){return l.multinomial(s,r,t,n)},{logits2D:s});return a===1?u.as1D():u}}),fh=N({oneHot_:function(e,t,n,r){if(n===void 0&&(n=1),r===void 0&&(r=0),t<2)throw new Error("Error in oneHot: depth must be >=2, but it is "+t);var o=k(e,"indices","oneHot","int32"),i=o.shape.concat([t]);return o=o.flatten(),P.runKernelFunc(function(a){return a.oneHot(o,t,n,r)},{$indices:o},function(a){return{$indices:function(){return et(o.shape,"float32")}}}).reshape(i)}}),mi=N({pad_:function(e,t,n){n===void 0&&(n=0);var r=k(e,"x","pad");if(r.rank===0)throw new Error("pad(scalar) is not defined. Pass non-scalar to pad");var o={paddings:t,constantValue:n};return P.runKernelFunc(function(i){return i.pad(r,t,n)},{x:r},function(i){var a=t.map(function(s){return s[0]});return{x:function(){return i.slice(a,r.shape)}}},"PadV2",o)}}),sI=N({pad1d_:function(e,t,n){return n===void 0&&(n=0),I(t.length===2,function(){return"Invalid number of paddings. Must be length of 2."}),mi(e,[t],n)}}),uI=N({pad2d_:function(e,t,n){return n===void 0&&(n=0),I(t.length===2&&t[0].length===2&&t[1].length===2,function(){return"Invalid number of paddings. Must be length of 2 each."}),mi(e,t,n)}}),lI=N({pad3d_:function(e,t,n){return n===void 0&&(n=0),I(t.length===3&&t[0].length===2&&t[1].length===2&&t[2].length===2,function(){return"Invalid number of paddings. Must be length of 2 each."}),mi(e,t,n)}}),cI=N({pad4d_:function(e,t,n){return n===void 0&&(n=0),I(t.length===4&&t[0].length===2&&t[1].length===2&&t[2].length===2&&t[3].length===2,function(){return"Invalid number of paddings. Must be length of 2 each."}),mi(e,t,n)}}),fI=N({rand_:function(e,t,n){var r=le(e),o=null;if(n==null||n==="float32")o=new Float32Array(r);else if(n==="int32")o=new Int32Array(r);else{if(n!=="bool")throw new Error("Unknown data type "+n);o=new Uint8Array(r)}for(var i=0;i<r;i++)o[i]=t();return P.makeTensor(o,e,n)}}),dI=N({randomNormal_:function(e,t,n,r,o){if(t===void 0&&(t=0),n===void 0&&(n=1),r!=null&&r==="bool")throw new Error("Unsupported data type "+r);for(var i=new Mp(t,n,r,!1,o),a=Ce(e,r),s=0;s<a.values.length;s++)a.values[s]=i.nextValue();return a.toTensor()}}),hI=N({randomGamma_:function(e,t,n,r,o){if(n===void 0&&(n=1),r===void 0&&(r="float32"),n==null&&(n=1),r==null&&(r="float32"),r!=="float32"&&r!=="int32")throw new Error("Unsupported data type "+r);for(var i=new Jk(t,n,r,o),a=Ce(e,r),s=0;s<a.values.length;s++)a.values[s]=i.nextValue();return a.toTensor()}}),Jx=N({randomUniform_:function(e,t,n,r,o){t===void 0&&(t=0),n===void 0&&(n=1),r===void 0&&(r="float32");for(var i=Ce(e,r),a=new Zk(t,n,null,o),s=0;s<i.values.length;s++)i.values[s]=a.nextValue();return i.toTensor()}}),nr=N({reshape_:function(e,t){var n=k(e,"x","reshape",null);t=GR(t,n.size),I(n.size===le(t),function(){return"new shape and old shape must have the same number of elements."});var r={shape:t};return P.runKernelFunc(function(o){return o.reshape(n,t)},{x:n},function(o){return{x:function(){return o.reshape(n.shape)}}},"Reshape",r)}}),Zx=N({spaceToBatchND_:function(e,t,n){var r=k(e,"x","spaceToBatchND");return I(r.rank>=1+t.length,function(){return"input rank "+r.rank+" should be > than [blockShape] "+t.length}),I(n.length===t.length,function(){return"paddings.shape[0] "+n.length+" must be equal to [blockShape] "+t.length}),I(r.shape.reduce(function(o,i,a){return a>0&&a<=t.length?o&&(i+n[a-1][0]+n[a-1][1])%t[a-1]==0:o},!0),function(){return"input spatial dimensions "+r.shape.slice(1)+" with paddings "+n.toString()+" must be divisible by blockShapes "+t.toString()}),P.runKernelFunc(function(o){return o.spaceToBatchND(r,t,n)},{$x:r},function(o){return{$x:function(){return o.batchToSpaceND(t,n)}}})}}),ew=N({squeeze_:function(e,t){var n=k(e,"x","squeeze");return nr(n,$o(n.shape,t).newShape)}}),Dn=N({stack_:function(e,t){t===void 0&&(t=0);var n=Ul(e,"tensors","stack");if(I(n.length>=1,function(){return"Pass at least one tensor to tf.stack"}),n.length===1)return n[0].expandDims(t);var r=n[0].rank,o=n[0].shape,i=n[0].dtype;I(t<=r,function(){return"Axis must be <= rank of the tensor"}),n.forEach(function(s){je(o,s.shape,"All tensors passed to stack must have matching shapes")}),n.forEach(function(s){I(i===s.dtype,function(){return"All tensors passed to stack must have matching dtypes"})});var a=n.map(function(s){return s.expandDims(t)});return St(a,t)}}),ra=N({tile_:function(e,t){var n=k(e,"x","tile",null);I(n.rank===t.length,function(){return"Error in transpose: rank of input "+n.rank+" must match length of reps "+t+"."});var r=[n],o={reps:t};return P.runKernelFunc(function(i,a){var s=i.tile(n,t);return a([n]),s},{x:n},function(i,a){var s=a[0];return{x:function(){var u=Le(s);if(s.rank===1)for(var l=0;l<t[0];++l)u=u.add(i.slice([l*s.shape[0]],[s.shape[0]]));else if(s.rank===2)for(l=0;l<t[0];++l)for(var c=0;c<t[1];++c)u=u.add(i.slice([l*s.shape[0],c*s.shape[1]],[s.shape[0],s.shape[1]]));else if(s.rank===3)for(l=0;l<t[0];++l)for(c=0;c<t[1];++c)for(var f=0;f<t[2];++f)u=u.add(i.slice([l*s.shape[0],c*s.shape[1],f*s.shape[2]],[s.shape[0],s.shape[1],s.shape[2]]));else{if(s.rank!==4)throw new Error("Gradient for tile operation is not implemented for rank-"+s.rank+" tensors yet.");for(l=0;l<t[0];++l)for(c=0;c<t[1];++c)for(f=0;f<t[2];++f)for(var d=0;d<t[3];++d)u=u.add(i.slice([l*s.shape[0],c*s.shape[1],f*s.shape[2],d*s.shape[3]],[s.shape[0],s.shape[1],s.shape[2],s.shape[3]]))}return u}}},"Tile",o,r)}}),pI=N({truncatedNormal_:function(e,t,n,r,o){if(t===void 0&&(t=0),n===void 0&&(n=1),r!=null&&r==="bool")throw new Error("Unsupported data type "+r);for(var i=new Mp(t,n,r,!0,o),a=Ce(e,r),s=0;s<a.values.length;s++)a.values[s]=i.nextValue();return a.toTensor()}}),Rt=N({unstack_:function(e,t){t===void 0&&(t=0),t=t||0;var n=k(e,"x","unstack");I(t>=-n.shape.length&&t<n.shape.length,function(){return"Axis = "+t+" is not in [-"+n.shape.length+", "+n.shape.length+")"}),t<0&&(t+=n.shape.length);var r={axis:t};return P.runKernelFunc(function(o){return o.unstack(n,t)},{x:n},function(o){return{x:function(){return Dn(o,t)}}},"Unpack",r)}}),vI=function(e,t){return se(this,void 0,void 0,function(){var n,r,o,i,a,s,u,l,c,f;return ue(this,function(d){switch(d.label){case 0:return n=k(e,"x","setdiff1d"),r=k(t,"y","setdiff1d"),I(n.dtype===r.dtype,function(){return"x and y should have the same dtype, but got x ("+n.dtype+") and y ("+r.dtype+")."}),I(n.rank===1,function(){return"x should be 1D tensor, but got x ("+n.shape+")."}),I(r.rank===1,function(){return"y should be 1D tensor, but got y ("+r.shape+")."}),[4,n.data()];case 1:return o=d.sent(),[4,r.data()];case 2:for(i=d.sent(),a=new Set(i),s=0,c=0;c<o.length;c++)a.has(o[c])||s++;for(u=new As([s],n.dtype),l=new As([s],"int32"),c=0,f=0;c<o.length;c++)a.has(o[c])||(u.values[f]=o[c],l.values[f]=c,f++);return[2,[u.toTensor(),l.toTensor()]]}})})};function zl(e,t,n,r){r===void 0&&(r=!0);var o=[];if(r)(o=o.concat(t.slice(0))).push(e[0]/n),o=o.concat(e.slice(1));else{o=o.concat(e[0]);for(var i=t.length,a=0;a<i;++a)o=o.concat([e[a+1]/t[a],t[a]]);o=o.concat(e.slice(i+1))}return o}function jl(e,t,n){n===void 0&&(n=!0);var r=[];if(n){r.push(t);for(var o=t+1;o<e;++o)o<=2*t?(r.push(o),r.push(o-(t+1))):r.push(o)}else{var i=[],a=[];for(o=1;o<e;++o)o>=2*t+1||o%2==1?a.push(o):i.push(o);r.push.apply(r,i),r.push(0),r.push.apply(r,a)}return r}function Vl(e,t,n,r){r===void 0&&(r=!0);var o=[];r?o.push(e[0]/n):o.push(e[0]*n);for(var i=1;i<e.length;++i)i<=t.length?r?o.push(t[i-1]*e[i]):o.push(e[i]/t[i-1]):o.push(e[i]);return o}function tw(e,t){for(var n=[0],r=0;r<t;++r)n.push(e[r][0]);return n}function nw(e,t,n){for(var r=e.slice(0,1),o=0;o<n;++o)r.push(e[o+1]-t[o][0]-t[o][1]);return r}function rw(e,t){if(e.rank<1)throw new Error("tf.gatherND() expects the input to be rank 1 or higher, but the rank was "+e.rank+".");if(t.rank<1)throw new Error("tf.gatherND() expects the indices to be rank 1 or higher, but the rank was "+t.rank+".");if(t.dtype!=="int32")throw new Error("tf.gatherND() expects the indices to be int32 type, but the dtype was "+t.dtype+".");if(t.shape[t.rank-1]>e.rank)throw new Error("index innermost dimension length must be <= tensor rank; saw: "+t.shape[t.rank-1]+" vs. "+e.rank);if(e.size===0)throw new Error("Requested more than 0 entries, but input is empty. Input shape: "+e.shape+".");for(var n=t.shape,r=n[n.length-1],o=1,i=0;i<n.length-1;++i)o*=n[i];var a=e.shape,s=n.slice();s.pop();var u=1;for(i=r;i<e.rank;++i)u*=a[i],s.push(a[i]);var l=Rr(e.shape).map(function(c){return c/u}).concat([1]).slice(0,r);return[s,o,u,l]}var ow=30;function Mf(e){return e<=ow?e:ih(e,Math.floor(Math.sqrt(e)))}function mI(e,t,n){var r=t.rank>1?t.shape[t.rank-1]:1,o=t.rank>1?t.rank-1:1,i="Must have updates.shape = indices.shape[:batchDim] + shape[sliceDim:], got updates.shape: "+n.shape+", indices.shape: "+t.shape+", shape: "+e+", sliceDim: "+r+", and batchDim: "+o+".";if(n.rank<o)throw new Error(i+" update.rank < "+o+". ");if(e.length<r+(n.rank-o))throw new Error(i+" Output shape length < "+(r+(n.rank-o)));if(n.rank!==o+e.length-r)throw new Error(i+" update.rank != "+(o+e.length-r));for(var a=0;a<o;++a)if(n.shape[a]!==t.shape[a])throw new Error(i+" updates.shape["+a+"] ("+n.shape[a]+") != indices.shape["+a+"] ("+t.shape[a]+").");for(a=0;a<n.rank-o;++a)if(n.shape[a+o]!==e[a+r])throw new Error(i+" updates.shape["+(a+o)+"] ("+n.shape[a+o]+") != shape["+(a+o)+"] ("+e[a+o]+")")}function gI(e,t,n){if(t.rank<1)throw new Error("tf.scatterND() expects the indices to be rank 1 or higher, but the rank was "+t.rank+".");if(e.rank<1)throw new Error("tf.scatterND() expects the updates to be rank 1 or higher, but the rank was "+e.rank+".");if(t.dtype!=="int32")throw new Error("The dtype of 'indices' should be int32, but got dtype: "+t.dtype);if(n.length<1)throw new Error("Output rank must be greater or equal to 1, but got shape: "+n);if(n.length===0){if(t.size===0)throw new Error("Indices specified for empty output. indices shape: "+t.shape);if(e.size===0)throw new Error("Updates specified for empty output. updates shape: "+e.shape)}mI(n,t,e)}function $l(e,t,n){for(var r=t.shape.length,o=r>1?t.shape[r-1]:1,i=n.length,a=1,s=o;s<i;++s)a*=n[s];var u=o<1?1:o;return{sliceRank:o,numUpdates:le(t.shape)/u,sliceSize:a,strides:Rr(n.slice(0,o)).concat([1]),outputSize:le(n)}}function yI(e,t,n){I(e.rank===t.length,function(){return"Error in slice"+e.rank+"D: Length of begin "+t+" must match the rank of the array ("+e.rank+")."}),I(e.rank===n.length,function(){return"Error in slice"+e.rank+"D: Length of size "+n+" must match the rank of the array ("+e.rank+")."});for(var r=function(i){I(t[i]+n[i]<=e.shape[i],function(){return"Error in slice"+e.rank+"D: begin["+i+"] + size["+i+"] ("+(t[i]+n[i])+") would overflow input.shape["+i+"] ("+e.shape[i]+")"})},o=0;o<e.rank;++o)r(o)}function jg(e){for(var t=[],n=0;e>0;)1&e&&t.push(n),e/=2,n++;return t}function Op(e,t,n){for(var r=[],o=0;o<e.length;o++)r[o]=Math.ceil((t[o]-e[o])/n[o]);return r}function xI(e,t,n,r,o){var i=t[o],a=n[o]||1;(e&1<<o||i==null)&&(i=a>0?Number.MIN_SAFE_INTEGER:Number.MAX_SAFE_INTEGER);var s=r[o];return i<0&&(i+=s),i=nh(0,i,s-1)}function wI(e,t,n,r,o){var i=t[o],a=n[o]||1;(e&1<<o||i==null)&&(i=a>0?Number.MAX_SAFE_INTEGER:Number.MIN_SAFE_INTEGER);var s=r[o];return i<0&&(i+=s),i=a>0?nh(0,i,s):nh(-1,i,s-1)}function iw(e,t,n){for(var r=n.length,o=0;o<n.length;o++)if(n[o]>1){r=o;break}for(o=r+1;o<n.length;o++)if(t[o]>0||n[o]!==e[o])return!1;return!0}function aw(e,t){for(var n=e.length>0?e[e.length-1]:1,r=0;r<e.length-1;r++)n+=e[r]*t[r];return n}function bI(e,t){I(oh(e),function(){return"The f passed in variableGrads(f) must be a function"}),I(t==null||Array.isArray(t)&&t.every(function(c){return c instanceof xa}),function(){return"The varList passed in variableGrads(f, varList) must be an array of variables"});var n=t!=null;if(!n)for(var r in t=[],P.registeredVariables)t.push(P.registeredVariables[r]);var o=n?t.filter(function(c){return!c.trainable}):null,i=t.length;I((t=t.filter(function(c){return c.trainable})).length>0,function(){return"variableGrads() expects at least one of the input variables to be trainable, but none of the "+i+" variables is trainable."});var a=P.gradients(e,t,null,!0),s=a.value,u=a.grads;I(u.some(function(c){return c!=null}),function(){return"Cannot find a connection between any variable and the result of the loss function y=f(x). Please make sure the operations that use variables are inside the function f passed to minimize()."}),I(s.rank===0,function(){return"The f passed in variableGrads(f) must return a scalar, but it returned a rank-"+s.rank+" tensor"});var l={};return t.forEach(function(c,f){u[f]!=null&&(l[c.name]=u[f])}),o!=null&&o.forEach(function(c){return l[c.name]=null}),{value:s,grads:l}}function Dc(e){return P.customGrad(e)}var Xr=N({softmax_:function(e,t){t===void 0&&(t=-1);var n=k(e,"logits","softmax","float32");if(t===-1&&(t=n.rank-1),t!==n.rank-1)throw Error("Softmax along a non-last dimension is not yet supported. Logits was rank "+n.rank+" and dim was "+t);return P.runKernelFunc(function(r,o){var i=r.softmax(n,t);return o([i]),i},{logits:n},function(r,o){var i=o[0],a=r.mul(i);return{logits:function(){return a.sub(a.sum([t],!0).mul(i))}}},"Softmax",{dim:t},[],[!0])}}),EI=N({logSoftmax_:function(e,t){t===void 0&&(t=-1);var n=k(e,"logits","logSoftmax");if(t===-1&&(t=n.rank-1),t!==n.rank-1)throw Error("Log Softmax along a non-last dimension is not yet supported. Logits was rank "+n.rank+" and axis was "+t);return Dc(function(r,o){var i=r.max(t,!0),a=r.sub(i),s=a.toFloat().sub(a.exp().sum(t,!0).log());return o([s]),{value:s,gradFunc:function(u,l){var c=l[0].exp();return u.sub(u.sum(t,!0).mul(c))}}})(n)}}),sw=function(){function e(t,n){this.backend=t,this.dataMover=n,this.data=new WeakMap,this.dataIdsCount=0}return e.prototype.get=function(t){return this.data.has(t)||this.dataMover.moveData(this.backend,t),this.data.get(t)},e.prototype.set=function(t,n){this.dataIdsCount++,this.data.set(t,n)},e.prototype.has=function(t){return this.data.has(t)},e.prototype.delete=function(t){return this.dataIdsCount--,this.data.delete(t)},e.prototype.numDataIds=function(){return this.dataIdsCount},e}(),uw=function(){function e(){}return e.prototype.time=function(t){return B("time")},e.prototype.read=function(t){return B("read")},e.prototype.readSync=function(t){return B("readSync")},e.prototype.numDataIds=function(){return B("numDataIds")},e.prototype.disposeData=function(t){return B("disposeData")},e.prototype.write=function(t,n,r){return B("write")},e.prototype.move=function(t,n,r,o){return B("move")},e.prototype.memory=function(){return B("memory")},e.prototype.floatPrecision=function(){return B("floatPrecision")},e.prototype.epsilon=function(){return this.floatPrecision()===32?1e-7:1e-4},e.prototype.batchMatMul=function(t,n,r,o){return B("batchMatMul")},e.prototype.fusedBatchMatMul=function(t){return t.a,t.b,t.transposeA,t.transposeB,t.bias,t.activation,t.preluActivationWeights,B("fusedBatchMatMul")},e.prototype.slice=function(t,n,r){return B("slice")},e.prototype.stridedSlice=function(t,n,r,o){return B("stridedSlice")},e.prototype.unstack=function(t,n){return B("unstack")},e.prototype.reverse=function(t,n){return B("reverse")},e.prototype.concat=function(t,n){return B("concat")},e.prototype.neg=function(t){return B("neg")},e.prototype.add=function(t,n){return B("add")},e.prototype.addN=function(t){return B("addN")},e.prototype.subtract=function(t,n){return B("subtract")},e.prototype.multiply=function(t,n){return B("multiply")},e.prototype.realDivide=function(t,n){return B("realDivide")},e.prototype.floorDiv=function(t,n){return B("floorDiv")},e.prototype.sum=function(t,n){return B("sum")},e.prototype.prod=function(t,n){return B("prod")},e.prototype.unsortedSegmentSum=function(t,n,r){return B("unsortedSegmentSum")},e.prototype.argMin=function(t,n){return B("argMin")},e.prototype.argMax=function(t,n){return B("argMax")},e.prototype.equal=function(t,n){return B("equal")},e.prototype.notEqual=function(t,n){return B("notEqual")},e.prototype.less=function(t,n){return B("less")},e.prototype.lessEqual=function(t,n){return B("lessEqual")},e.prototype.greater=function(t,n){return B("greater")},e.prototype.greaterEqual=function(t,n){return B("greaterEqual")},e.prototype.logicalNot=function(t){return B("logicalNot")},e.prototype.logicalAnd=function(t,n){return B("logicalAnd")},e.prototype.logicalOr=function(t,n){return B("logicalOr")},e.prototype.where=function(t){return B("where")},e.prototype.select=function(t,n,r){return B("select")},e.prototype.topk=function(t,n,r){return B("topk")},e.prototype.min=function(t,n){return B("min")},e.prototype.minimum=function(t,n){return B("minimum")},e.prototype.mod=function(t,n){return B("mod")},e.prototype.max=function(t,n){return B("max")},e.prototype.maximum=function(t,n){return B("maximum")},e.prototype.all=function(t,n){return B("all")},e.prototype.any=function(t,n){return B("any")},e.prototype.squaredDifference=function(t,n){return B("squaredDifference")},e.prototype.ceil=function(t){return B("ceil")},e.prototype.floor=function(t){return B("floor")},e.prototype.round=function(t){return B("round")},e.prototype.sign=function(t){return B("sign")},e.prototype.isNaN=function(t){return B("isNaN")},e.prototype.isInf=function(t){return B("isInf")},e.prototype.isFinite=function(t){return B("isFinite")},e.prototype.pow=function(t,n){return B("pow")},e.prototype.exp=function(t){return B("exp")},e.prototype.expm1=function(t){return B("expm1")},e.prototype.softmax=function(t,n){return B("softmax")},e.prototype.log=function(t){return B("log")},e.prototype.log1p=function(t){return B("log1p")},e.prototype.sqrt=function(t){return B("sqrt")},e.prototype.rsqrt=function(t){return B("rsqrt")},e.prototype.square=function(t){return B("square")},e.prototype.reciprocal=function(t){return B("reciprocal")},e.prototype.relu=function(t){return B("relu")},e.prototype.relu6=function(t){return B("relu6")},e.prototype.prelu=function(t,n){return B("prelu")},e.prototype.elu=function(t){return B("elu")},e.prototype.eluDer=function(t,n){return B("eluDer")},e.prototype.selu=function(t){return B("selu")},e.prototype.int=function(t){return B("int")},e.prototype.clip=function(t,n,r){return B("clip")},e.prototype.abs=function(t){return B("abs")},e.prototype.complexAbs=function(t){return B("complexAbs")},e.prototype.sigmoid=function(t){return B("sigmoid")},e.prototype.softplus=function(t){return B("softplus")},e.prototype.sin=function(t){return B("sin")},e.prototype.cos=function(t){return B("cos")},e.prototype.tan=function(t){return B("tan")},e.prototype.asin=function(t){return B("asin")},e.prototype.acos=function(t){return B("acos")},e.prototype.atan=function(t){return B("atan")},e.prototype.atan2=function(t,n){return B("atan2")},e.prototype.sinh=function(t){return B("sinh")},e.prototype.cosh=function(t){return B("cosh")},e.prototype.tanh=function(t){return B("tanh")},e.prototype.asinh=function(t){return B("asinh")},e.prototype.acosh=function(t){return B("acosh")},e.prototype.atanh=function(t){return B("atanh")},e.prototype.erf=function(t){return B("erf")},e.prototype.step=function(t,n){return B("step")},e.prototype.fusedConv2d=function(t){return t.input,t.filter,t.convInfo,t.bias,t.activation,t.preluActivationWeights,B("fusedConv2d")},e.prototype.conv2d=function(t,n,r){return B("conv2d")},e.prototype.conv2dDerInput=function(t,n,r){return B("conv2dDerInput")},e.prototype.conv2dDerFilter=function(t,n,r){return B("conv2dDerFilter")},e.prototype.fusedDepthwiseConv2D=function(t){return t.input,t.filter,t.convInfo,t.bias,t.activation,t.preluActivationWeights,B("fusedDepthwiseConv2D")},e.prototype.depthwiseConv2D=function(t,n,r){return B("depthwiseConv2D")},e.prototype.depthwiseConv2DDerInput=function(t,n,r){return B("depthwiseConv2DDerInput")},e.prototype.depthwiseConv2DDerFilter=function(t,n,r){return B("depthwiseConv2DDerFilter")},e.prototype.conv3d=function(t,n,r){return B("conv3d")},e.prototype.conv3dDerInput=function(t,n,r){return B("conv3dDerInput")},e.prototype.conv3dDerFilter=function(t,n,r){return B("conv3dDerFilter")},e.prototype.maxPool=function(t,n){return B("maxPool")},e.prototype.maxPoolBackprop=function(t,n,r,o){return B("maxPoolBackprop")},e.prototype.avgPool=function(t,n){return B("avgPool")},e.prototype.avgPoolBackprop=function(t,n,r){return B("avgPoolBackprop")},e.prototype.avgPool3d=function(t,n){return B("avgPool3d")},e.prototype.avgPool3dBackprop=function(t,n,r){return B("avgPool3dBackprop")},e.prototype.maxPool3d=function(t,n){return B("maxPool3d")},e.prototype.maxPool3dBackprop=function(t,n,r,o){return B("maxPool3dBackprop")},e.prototype.reshape=function(t,n){return B("reshape")},e.prototype.cast=function(t,n){return B("cast")},e.prototype.tile=function(t,n){return B("tile")},e.prototype.pad=function(t,n,r){return B("pad")},e.prototype.transpose=function(t,n){return B("transpose")},e.prototype.gather=function(t,n,r){return B("gather")},e.prototype.gatherND=function(t,n){return B("gatherND")},e.prototype.scatterND=function(t,n,r){return B("scatterND")},e.prototype.batchToSpaceND=function(t,n,r){return B("batchToSpaceND")},e.prototype.spaceToBatchND=function(t,n,r){return B("spaceToBatchND")},e.prototype.resizeBilinear=function(t,n,r,o){return B("resizeBilinear")},e.prototype.resizeBilinearBackprop=function(t,n,r){return B("resizeBilinearBackprop")},e.prototype.resizeNearestNeighbor=function(t,n,r,o){return B("resizeNearestNeighbor")},e.prototype.resizeNearestNeighborBackprop=function(t,n,r){return B("resizeNearestNeighborBackprop")},e.prototype.batchNormalization=function(t,n,r,o,i,a){return B("batchNormalization")},e.prototype.localResponseNormalization4D=function(t,n,r,o,i){return B("localResponseNormalization4D")},e.prototype.LRNGrad=function(t,n,r,o,i,a,s){return B("LRNGrad")},e.prototype.multinomial=function(t,n,r,o){return B("multinomial")},e.prototype.oneHot=function(t,n,r,o){return B("oneHot")},e.prototype.cumsum=function(t,n,r,o){return B("cumsum")},e.prototype.nonMaxSuppression=function(t,n,r,o,i){return B("nonMaxSuppression")},e.prototype.fft=function(t){return B("fft")},e.prototype.ifft=function(t){return B("ifft")},e.prototype.complex=function(t,n){return B("complex")},e.prototype.real=function(t){return B("real")},e.prototype.imag=function(t){return B("imag")},e.prototype.cropAndResize=function(t,n,r,o,i,a){return B("cropAndResize")},e.prototype.depthToSpace=function(t,n,r){return B("depthToSpace")},e.prototype.split=function(t,n,r){return B("split")},e.prototype.sparseToDense=function(t,n,r,o){return B("sparseToDense")},e.prototype.diag=function(t){return B("diag")},e.prototype.fill=function(t,n,r){return B("fill")},e.prototype.onesLike=function(t){return B("onesLike")},e.prototype.zerosLike=function(t){return B("zerosLike")},e.prototype.linspace=function(t,n,r){return B("linspace")},e.prototype.dispose=function(){return B("dispose")},e}();function B(e){throw new Error("'"+e+"' not yet implemented or not found in the registry. Did you forget to import the kernel?")}function po(e,t){for(var n=e.length,r=[],o=0;o<n;o++){var i=n-1-o,a=e[i]||1;(t[t.length-1-o]||1)>1&&a===1&&r.unshift(i)}return r}function kt(e,t){for(var n=[],r=0;r<t.length;r++){var o=e[e.length-r-1],i=t.length-r-1,a=t[i];(o==null||o===1&&a>1)&&n.unshift(i)}return n}function Fe(e,t){for(var n=[],r=Math.max(e.length,t.length),o=0;o<r;o++){var i=e[e.length-o-1];i==null&&(i=1);var a=t[t.length-o-1];if(a==null&&(a=1),i===1)n.unshift(a);else if(a===1)n.unshift(i);else{if(i!==a)throw Error("Operands could not be broadcast together with shapes "+e+" and "+t+".");n.unshift(i)}}return n}function Fs(e,t,n,r,o,i,a){a===void 0&&(a="channelsLast");var s,u=ql(t),l=u[0],c=u[1];if(a==="channelsLast")s=[l,c,e[3],e[3]];else{if(a!=="channelsFirst")throw new Error("Unknown dataFormat "+a);s=[l,c,e[1],e[1]]}return gi(e,s,n,r,o,i,!1,a)}function Hl(e,t,n,r,o,i,a){a===void 0&&(a="NDHWC");var s,u,l=dh(t),c=l[0],f=l[1],d=l[2];if(a==="NDHWC")u="channelsLast",s=[c,f,d,e[4],e[4]];else{if(a!=="NCDHW")throw new Error("Unknown dataFormat "+a);u="channelsFirst",s=[c,f,d,e[1],e[1]]}return Gl(e,s,n,r,o,!1,u,i)}function gi(e,t,n,r,o,i,a,s){a===void 0&&(a=!1),s===void 0&&(s="channelsLast");var u=[-1,-1,-1,-1],l=u[0],c=u[1],f=u[2],d=u[3];if(s==="channelsLast")l=e[0],c=e[1],f=e[2],d=e[3];else{if(s!=="channelsFirst")throw new Error("Unknown dataFormat "+s);l=e[0],d=e[1],c=e[2],f=e[3]}var h,p=t[0],v=t[1],g=t[3],m=ql(n),y=m[0],x=m[1],w=ql(r),E=w[0],b=w[1],C=oa(p,E),_=oa(v,b),S=function(O,$,q,V,F,L,U,Q){var ee,ae,he;if(typeof O=="number"){ee={top:O,bottom:O,left:O,right:O,type:O===0?"VALID":"NUMBER"};var ye=function(Pe,Ee,Te,Qe,Je){Qe==null&&(Qe=lw(Pe,Ee,Te));var Ue=Pe[0],Pn=Pe[1],Fn=us((Ue-Ee+2*Qe)/Te+1,Je);I(mt(Fn),function(){return"The output # of rows ("+Fn+") must be an integer. Change the stride and/or zero pad parameters"});var Vt=us((Pn-Ee+2*Qe)/Te+1,Je);return I(mt(Vt),function(){return"The output # of columns ("+Vt+") must be an integer. Change the stride and/or zero pad parameters"}),[Fn,Vt]}([$,q],L,V,O,Q);ae=ye[0],he=ye[1]}else if(O==="same"){ae=Math.ceil($/V),he=Math.ceil(q/F);var ve=Math.max(0,(ae-1)*V+L-$),Se=Math.max(0,(he-1)*F+U-q),De=Math.floor(ve/2),Oe=ve-De,ot=Math.floor(Se/2);ee={top:De,bottom:Oe,left:ot,right:Se-ot,type:"SAME"}}else{if(O!=="valid")throw Error("Unknown padding parameter: "+O);ee={top:0,bottom:0,left:0,right:0,type:"VALID"},ae=Math.ceil(($-L+1)/V),he=Math.ceil((q-U+1)/F)}return{padInfo:ee,outHeight:ae,outWidth:he}}(o,c,f,y,x,C,_,i),R=S.padInfo,D=S.outHeight,T=S.outWidth,z=a?g*d:g;return s==="channelsFirst"?h=[l,z,D,T]:s==="channelsLast"&&(h=[l,D,T,z]),{batchSize:l,dataFormat:s,inHeight:c,inWidth:f,inChannels:d,outHeight:D,outWidth:T,outChannels:z,padInfo:R,strideHeight:y,strideWidth:x,filterHeight:p,filterWidth:v,effectiveFilterHeight:C,effectiveFilterWidth:_,dilationHeight:E,dilationWidth:b,inShape:e,outShape:h,filterShape:t}}function Gl(e,t,n,r,o,i,a,s){i===void 0&&(i=!1),a===void 0&&(a="channelsLast");var u=[-1,-1,-1,-1,-1],l=u[0],c=u[1],f=u[2],d=u[3],h=u[4];if(a==="channelsLast")l=e[0],c=e[1],f=e[2],d=e[3],h=e[4];else{if(a!=="channelsFirst")throw new Error("Unknown dataFormat "+a);l=e[0],h=e[1],c=e[2],f=e[3],d=e[4]}var p,v=t[0],g=t[1],m=t[2],y=t[4],x=dh(n),w=x[0],E=x[1],b=x[2],C=dh(r),_=C[0],S=C[1],R=C[2],D=oa(v,_),T=oa(g,S),z=oa(m,R),O=function(U,Q,ee,ae,he,ye,ve,Se,De,Oe,ot){var Pe,Ee,Te,Qe;if(typeof U=="number"){Pe={top:U,bottom:U,left:U,right:U,front:U,back:U,type:U===0?"VALID":"NUMBER"};var Je=function(Mn,en,wi,dr,bt,yn){bt==null&&(bt=lw(Mn,en,dr));var nu=Mn[0],bi=Mn[1],Vc=Mn[2],On=us((nu-en+2*bt)/dr+1,yn);I(mt(On),function(){return"The output # of depths ("+On+") must be an integer. Change the stride and/or zero pad parameters"});var Ei=us((bi-en+2*bt)/dr+1,yn);I(mt(Ei),function(){return"The output # of rows ("+Ei+") must be an integer. Change the stride and/or zero pad parameters"});var Ci=us((Vc-en+2*bt)/dr+1,yn);return I(mt(Ci),function(){return"The output # of columns ("+Ci+") must be an integer. Change the stride and/or zero pad parameters"}),[On,Ei,Ci,wi]}([Q,ee,ae,1],Se,1,he,U,ot);Ee=Je[0],Te=Je[1],Qe=Je[2]}else if(U==="same"){Ee=Math.ceil(Q/he),Te=Math.ceil(ee/ye),Qe=Math.ceil(ae/ve);var Ue=(Ee-1)*he+Se-Q,Pn=(Te-1)*ye+De-ee,Fn=(Qe-1)*ve+Oe-ae,Vt=Math.floor(Ue/2),eo=Ue-Vt,Kn=Math.floor(Pn/2),fr=Pn-Kn,Xn=Math.floor(Fn/2);Pe={top:Kn,bottom:fr,left:Xn,right:Fn-Xn,front:Vt,back:eo,type:"SAME"}}else{if(U!=="valid")throw Error("Unknown padding parameter: "+U);Pe={top:0,bottom:0,left:0,right:0,front:0,back:0,type:"VALID"},Ee=Math.ceil((Q-Se+1)/he),Te=Math.ceil((ee-De+1)/ye),Qe=Math.ceil((ae-Oe+1)/ve)}return{padInfo:Pe,outDepth:Ee,outHeight:Te,outWidth:Qe}}(o,c,f,d,w,E,b,D,T,z,s),$=O.padInfo,q=O.outDepth,V=O.outHeight,F=O.outWidth,L=i?y*h:y;return a==="channelsFirst"?p=[l,L,q,V,F]:a==="channelsLast"&&(p=[l,q,V,F,L]),{batchSize:l,dataFormat:a,inDepth:c,inHeight:f,inWidth:d,inChannels:h,outDepth:q,outHeight:V,outWidth:F,outChannels:L,padInfo:$,strideDepth:w,strideHeight:E,strideWidth:b,filterDepth:v,filterHeight:g,filterWidth:m,effectiveFilterDepth:D,effectiveFilterHeight:T,effectiveFilterWidth:z,dilationDepth:_,dilationHeight:S,dilationWidth:R,inShape:e,outShape:p,filterShape:t}}function lw(e,t,n,r){r===void 0&&(r=1);var o=oa(t,r);return Math.floor((e[0]*(n-1)-n+o)/2)}function ql(e){return typeof e=="number"?[e,e,e]:e.length===2?[e[0],e[1],1]:e}function dh(e){return typeof e=="number"?[e,e,e]:e}function oa(e,t){return t<=1?e:e+(e-1)*(t-1)}function us(e,t){if(!t)return e;switch(t){case"round":return Math.round(e);case"ceil":return Math.ceil(e);case"floor":return Math.floor(e);default:throw new Error("Unknown roundingMode "+t)}}function ba(e){var t=ql(e),n=t[0],r=t[1],o=t[2];return n===1&&r===1&&o===1}function gn(e,t){return ba(e)||ba(t)}function Lp(e){if(e==="NHWC")return"channelsLast";if(e==="NCHW")return"channelsFirst";throw new Error("Unknown dataFormat "+e)}function cw(e,t,n){if(t==="complex64"){if(e.dtype==="complex64")return e.clone();var r=et(e.shape),o=e.toFloat(),i=n.complex(o,r);return r.dispose(),o.dispose(),i}if(!XR(e.dtype,t))return P.makeTensorFromDataId(e.dataId,e.shape,t);if(e.dtype==="complex64"){var a=n.real(e);return i=a.cast(t),a.dispose(),i}if(t==="int32")return n.int(e);if(t==="bool"){var s=ne(0,e.dtype);return i=n.notEqual(e,s),s.dispose(),i}throw new Error("Error in Cast: failed to cast "+e.dtype+" to "+t)}function hh(e,t){return P.makeTensorFromDataId(e.dataId,t,e.dtype)}function fw(e,t,n){var r=(t-e)/(n-1),o=qs(n,"float32");o[0]=e;for(var i=1;i<o.length;i++)o[i]=o[i-1]+r;return wt(o,"float32")}function ph(e,t){if(e.length!==t.length)throw new Error("Cannot merge real and imag arrays of different lengths. real:"+e.length+", imag: "+t.length+".");for(var n=new Float32Array(2*e.length),r=0;r<n.length;r+=2)n[r]=e[r/2],n[r+1]=t[r/2];return n}function Vg(e,t){return{real:e[2*t],imag:e[2*t+1]}}function CI(e,t,n,r){e[2*r]=t,e[2*r+1]=n}function _I(e,t,n){var r=(n?2:-2)*Math.PI*(e/t);return{real:Math.cos(r),imag:Math.sin(r)}}function SI(e,t,n){var r=function(i,a,s){return function(u,l,c){for(var f=0,d=u.length,h=0,p=!1;f<d;){var v=c(l,u[h=f+(d-f>>>1)]);v>0?f=h+1:(d=h,p=!v)}return p?f:-f-1}(i,a,s||RI)}(e,t,n),o=r<0?-(r+1):r;e.splice(o,0,t)}function RI(e,t){return e>t?1:e<t?-1:0}function Bp(e,t,n,r,o){return dw(e,t,n,r,o,0).selectedIndices}function Up(e,t,n,r,o,i){var a=dw(e,t,n,r,o,i);return a.numValidOutputs.dispose(),{selectedIndices:a.selectedIndices,selectedScores:a.selectedScores}}function dw(e,t,n,r,o,i,a,s){s===void 0&&(s=!1);for(var u=Array.from(t).map(function(w,E){return{score:w,boxIndex:E,suppressBeginIndex:0}}).filter(function(w){return w.score>o}).sort($g),l=i>0?-.5/i:0,c=[],f=[];c.length<n&&u.length>0;){var d=u.pop(),h=d.score,p=d.boxIndex,v=d.suppressBeginIndex;if(h<o)break;for(var g=!1,m=c.length-1;m>=v;--m){var y=kI(e,p,c[m]);if(y>=r){g=!0;break}if(d.score=d.score*II(r,l,y),d.score<=o)break}d.suppressBeginIndex=c.length,g||(d.score===h?(c.push(p),f.push(d.score)):d.score>o&&SI(u,d,$g))}var x=c.length;return s&&(c.fill(0,x),f.fill(0,x)),{selectedIndices:wt(c,"int32"),selectedScores:wt(f,"float32"),numValidOutputs:ne(x,"int32")}}function kI(e,t,n){var r=e.subarray(4*t,4*t+4),o=e.subarray(4*n,4*n+4),i=Math.min(r[0],r[2]),a=Math.min(r[1],r[3]),s=Math.max(r[0],r[2]),u=Math.max(r[1],r[3]),l=Math.min(o[0],o[2]),c=Math.min(o[1],o[3]),f=Math.max(o[0],o[2]),d=Math.max(o[1],o[3]),h=(s-i)*(u-a),p=(f-l)*(d-c);if(h<=0||p<=0)return 0;var v=Math.max(i,l),g=Math.max(a,c),m=Math.min(s,f),y=Math.min(u,d),x=Math.max(m-v,0)*Math.max(y-g,0);return x/(h+p-x)}function II(e,t,n){var r=Math.exp(t*n*n);return n<=e?r:0}function $g(e,t){return e.score-t.score||e.score===t.score&&t.boxIndex-e.boxIndex}function hw(e,t,n){var r=new Array(e.rank).fill(0),o=e.shape.slice();return t.map(function(i){o[n]=i;var a=e.slice(r,o);return r[n]+=i,a})}function pw(e,t){for(var n=new Array(e.rank),r=0;r<n.length;r++)n[r]=e.shape[r]*t[r];var o=Ce(n,e.dtype);for(r=0;r<o.values.length;++r){for(var i=o.indexToLoc(r),a=new Array(e.rank),s=0;s<a.length;s++)a[s]=i[s]%e.shape[s];var u=e.locToIndex(a);o.values[r]=e.values[u]}return o.toTensor()}function vw(e,t,n,r,o){for(var i=t[t.length-1],a=[e.length/i,i],s=a[0],u=a[1],l=Ns(n,s*r),c=Ns("int32",s*r),f=0;f<s;f++){for(var d=f*u,h=e.subarray(d,d+u),p=[],v=0;v<h.length;v++)p.push({value:h[v],index:v});p.sort(function(w,E){return E.value-w.value});var g=f*r,m=l.subarray(g,g+r),y=c.subarray(g,g+r);for(v=0;v<r;v++)m[v]=p[v].value,y[v]=p[v].index}var x=t.slice();return x[x.length-1]=r,[Wt(l,x,n),Wt(c,x,"int32")]}function Wp(e,t){for(var n=[],r=0;r<t.length;r++)t[r]&&n.push(r);var o=Ce(e,"int32"),i=Ce([n.length,e.length],"int32");for(r=0;r<n.length;r++){var a=o.indexToLoc(n[r]),s=r*e.length;i.values.set(a,s)}return i.toTensor()}var DI=function(e,t){this.outputShape=[],this.outputShape=e,this.variableNames=t.map(function(o,i){return"T"+i});var n=[];this.variableNames.forEach(function(o){n.push("float v"+o+" = get"+o+"AtOutCoords();")});var r=this.variableNames.map(function(o){return"v"+o}).join(" + ");this.userCode=`
      void main() {
        `+n.join(`
        `)+`

        float result = `+r+`;
        setOutput(result);
      }
    `},TI=function(e,t){this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.variableNames=t.map(function(o,i){return"T"+i});var n=[];this.variableNames.forEach(function(o){n.push("vec4 v"+o+" = get"+o+"AtOutCoords();")});var r=this.variableNames.map(function(o){return"v"+o}).join(" + ");this.userCode=`
      void main() {
        `+n.join(`
        `)+`

        vec4 result = `+r+`;
        setOutput(result);
      }
    `},NI=function(e,t,n){this.variableNames=["A"];var r=e.windowSize,o=e.batchSize,i=e.inSize,a=Math.ceil(i/r);n||this.variableNames.push("bestIndicesA"),this.outputShape=[o,a];var s=t==="max"?">":"<",u=n?"inOffset + i;":"round(getBestIndicesA(batch, inOffset + i));";this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * `+r+`;

        int bestIndex = inOffset;
        float bestValue = getA(batch, bestIndex);

        for (int i = 0; i < `+r+`; i++) {
          int inIdx = `+u+`;
          float candidate = getA(batch, inIdx);
          if (candidate `+s+` bestValue) {
            bestValue = candidate;
            bestIndex = inIdx;
          }
        }
        setOutput(float(bestIndex));
      }
    `};function mw(e,t){return["x","y","z","w","u","v"].slice(0,t).map(function(n){return e+"."+n})}function ln(e,t){return t===1?[e]:mw(e,t)}function Xt(){var e,t,n,r,o,i,a,s,u,l;return G().getNumber("WEBGL_VERSION")===2?(e="#version 300 es",t="in",n="out",r="in",o="texture",i="outputColor",a="out vec4 outputColor;",s=`
      bool isnan_custom(float val) {
        return (val > 0.0 || val < 0.0) ? false : val != 0.0;
      }

      bvec4 isnan_custom(vec4 val) {
        return bvec4(isnan_custom(val.x),
          isnan_custom(val.y), isnan_custom(val.z), isnan_custom(val.w));
      }

      #define isnan(value) isnan_custom(value)
    `,u="",l=`
      #define round(value) newRound(value)
      int newRound(float value) {
        return int(floor(value + 0.5));
      }

      ivec4 newRound(vec4 value) {
        return ivec4(floor(value + vec4(0.5)));
      }
    `):(e="",t="attribute",n="varying",r="varying",o="texture2D",i="gl_FragColor",a="",s=`
      #define isnan(value) isnan_custom(value)
      bool isnan_custom(float val) {
        return (val > 0. || val < 1. || val == 0.) ? false : true;
      }
      bvec4 isnan_custom(vec4 val) {
        return bvec4(isnan(val.x), isnan(val.y), isnan(val.z), isnan(val.w));
      }
    `,u=`
      uniform float INFINITY;

      bool isinf(float val) {
        return abs(val) == INFINITY;
      }
      bvec4 isinf(vec4 val) {
        return equal(abs(val), vec4(INFINITY));
      }
    `,l=`
      int round(float value) {
        return int(floor(value + 0.5));
      }

      ivec4 round(vec4 value) {
        return ivec4(floor(value + vec4(0.5)));
      }
    `),{version:e,attribute:t,varyingVs:n,varyingFs:r,texture2D:o,output:i,defineOutput:a,defineSpecialNaN:s,defineSpecialInf:u,defineRound:l}}function Yo(e,t,n){n===void 0&&(n="index");var r=Rr(t);return r.map(function(o,i){return"int "+e[i]+" = "+n+" / "+o+"; "+(i===r.length-1?"int "+e[i+1]+" = "+n+" - "+e[i]+" * "+o:"index -= "+e[i]+" * "+o)+";"}).join("")}function zp(e){var t=Rr(e).map(function(n){return n.toString()});return`
  int getFlatIndex(ivec3 coords) {
    return coords.x * `+t[0]+" + coords.y * "+t[1]+` + coords.z;
  }
`}var gw=`
  const float FLOAT_MAX = 1.70141184e38;
  const float FLOAT_MIN = 1.17549435e-38;

  lowp vec4 encode_float(highp float v) {
    if (isnan(v)) {
      return vec4(255, 255, 255, 255);
    }

    highp float av = abs(v);

    if(av < FLOAT_MIN) {
      return vec4(0.0, 0.0, 0.0, 0.0);
    } else if(v > FLOAT_MAX) {
      return vec4(0.0, 0.0, 128.0, 127.0) / 255.0;
    } else if(v < -FLOAT_MAX) {
      return vec4(0.0, 0.0,  128.0, 255.0) / 255.0;
    }

    highp vec4 c = vec4(0,0,0,0);

    highp float e = floor(log2(av));
    highp float m = exp2(fract(log2(av))) - 1.0;

    c[2] = floor(128.0 * m);
    m -= c[2] / 128.0;
    c[1] = floor(32768.0 * m);
    m -= c[1] / 32768.0;
    c[0] = floor(8388608.0 * m);

    highp float ebias = e + 127.0;
    c[3] = floor(ebias / 2.0);
    ebias -= c[3] * 2.0;
    c[2] += floor(ebias) * 128.0;

    c[3] += 128.0 * step(0.0, -v);

    return c / 255.0;
  }
`;function AI(e,t,n,r){var o=[];e.forEach(function(h){var p=le(h.shapeInfo.logicalShape);h.shapeInfo.isUniform?o.push("uniform float "+h.name+(p>1?"["+p+"]":"")+";"):(o.push("uniform sampler2D "+h.name+";"),o.push("uniform int offset"+h.name+";"))});var i,a,s=o.join(`
`),u=e.map(function(h){return function(p,v,g){g===void 0&&(g=!1);var m="";m+=g?yw(p):Pi(p);var y=p.shapeInfo.logicalShape,x=v.logicalShape;return y.length<=x.length&&(m+=g?function(w,E){var b,C=w.name,_=C.charAt(0).toUpperCase()+C.slice(1),S="get"+_+"AtOutCoords",R=w.shapeInfo.logicalShape.length,D=E.logicalShape.length,T=po(w.shapeInfo.logicalShape,E.logicalShape),z=Ye(D),O=D-R,$=["x","y","z","w","u","v"];b=R===0?"":D<2&&T.length>=1?"coords = 0;":T.map(function(ee){return"coords."+$[ee+O]+" = 0;"}).join(`
`);var q="";q=D<2&&R>0?"coords":w.shapeInfo.logicalShape.map(function(ee,ae){return"coords."+$[ae+O]}).join(", ");var V="return outputValue;",F=le(w.shapeInfo.logicalShape)===1,L=le(E.logicalShape)===1;if(R!==1||F||L){if(F&&!L)V=D===1?`
        return vec4(outputValue.x, outputValue.x, 0., 0.);
      `:`
        return vec4(outputValue.x);
      `;else if(T.length){var U=R-2,Q=R-1;T.indexOf(U)>-1&&T.indexOf(Q)>-1?V="return vec4(outputValue.x);":T.indexOf(U)>-1?V="return vec4(outputValue.x, outputValue.y, outputValue.x, outputValue.y);":T.indexOf(Q)>-1&&(V="return vec4(outputValue.xx, outputValue.zz);")}}else V=`
      return vec4(outputValue.xy, outputValue.xy);
    `;return`
    vec4 `+S+`() {
      `+z+` coords = getOutputCoords();
      `+b+`
      vec4 outputValue = get`+_+"("+q+`);
      `+V+`
    }
  `}(p,v):function(w,E){var b=w.name,C=b.charAt(0).toUpperCase()+b.slice(1),_="get"+C+"AtOutCoords",S=E.texShape,R=w.shapeInfo.texShape,D=w.shapeInfo.logicalShape.length,T=E.logicalShape.length;if(!w.shapeInfo.isUniform&&D===T&&w.shapeInfo.flatOffset==null&&Ft(R,S))return`
      float `+_+`() {
        return sampleTexture(`+b+`, resultUV);
      }
    `;var z,O=Ye(T),$=po(w.shapeInfo.logicalShape,E.logicalShape),q=T-D,V=["x","y","z","w","u","v"];z=D===0?"":T<2&&$.length>=1?"coords = 0;":$.map(function(L){return"coords."+V[L+q]+" = 0;"}).join(`
`);var F="";return F=T<2&&D>0?"coords":w.shapeInfo.logicalShape.map(function(L,U){return"coords."+V[U+q]}).join(", "),`
    float `+_+`() {
      `+O+` coords = getOutputCoords();
      `+z+`
      return get`+C+"("+F+`);
    }
  `}(p,v)),m}(h,t,r)}).join(`
`),l=t.texShape,c=Xt(),f=function(h){return`
    float sampleTexture(sampler2D textureSampler, vec2 uv) {
      return `+h.texture2D+`(textureSampler, uv).r;
    }
  `}(c),d=function(h){return h.version+`
    precision highp float;
    precision highp int;
    precision highp sampler2D;
    `+h.varyingFs+` vec2 resultUV;
    `+h.defineOutput+`
    const vec2 halfCR = vec2(0.5, 0.5);

    struct ivec5
    {
      int x;
      int y;
      int z;
      int w;
      int u;
    };

    struct ivec6
    {
      int x;
      int y;
      int z;
      int w;
      int u;
      int v;
    };

    uniform float NAN;
    `+h.defineSpecialNaN+`
    `+h.defineSpecialInf+`
    `+h.defineRound+`

    int imod(int x, int y) {
      return x - y * (x / y);
    }

    int idiv(int a, int b, float sign) {
      int res = a / b;
      int mod = imod(a, b);
      if (sign < 0. && mod != 0) {
        res -= 1;
      }
      return res;
    }

    //Based on the work of Dave Hoskins
    //https://www.shadertoy.com/view/4djSRW
    #define HASHSCALE1 443.8975
    float random(float seed){
      vec2 p = resultUV * seed;
      vec3 p3  = fract(vec3(p.xyx) * HASHSCALE1);
      p3 += dot(p3, p3.yzx + 19.19);
      return fract((p3.x + p3.y) * p3.z);
    }

    `+PI+`
    `+FI+`
    `+MI+`
  `}(c);return t.isPacked?(i=function(h,p){switch(h.length){case 0:return`
    int getOutputCoords() {
      return 0;
    }
  `;case 1:return function(w,E){var b=[Math.ceil(E[0]/2),Math.ceil(E[1]/2)];return b[0]===1?`
      int getOutputCoords() {
        return 2 * int(resultUV.x * `+b[1]+`.0);
      }
    `:b[1]===1?`
      int getOutputCoords() {
        return 2 * int(resultUV.y * `+b[0]+`.0);
      }
    `:`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+b[0]+", "+b[1]+`));
      return 2 * (resTexRC.x * `+b[1]+` + resTexRC.y);
    }
  `}(0,p);case 2:return function(w,E){var b=[Math.ceil(E[0]/2),Math.ceil(E[1]/2)];if(Ft(w,E))return`
      ivec2 getOutputCoords() {
        return 2 * ivec2(resultUV.yx * vec2(`+b[0]+", "+b[1]+`));
      }
    `;var C=Math.ceil(w[1]/2);return`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+b[0]+", "+b[1]+`));

      int index = resTexRC.x * `+b[1]+` + resTexRC.y;
      int r = 2 * (index / `+C+`);
      int c = imod(index, `+C+`) * 2;

      return ivec2(r, c);
    }
  `}(h,p);case 3:return v=h,g=p,m=[Math.ceil(g[0]/2),Math.ceil(g[1]/2)],y=Math.ceil(v[2]/2),x=y*Math.ceil(v[1]/2),`
    ivec3 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+m[0]+", "+m[1]+`));
      int index = resTexRC.x * `+m[1]+` + resTexRC.y;

      int b = index / `+x+`;
      index -= b * `+x+`;

      int r = 2 * (index / `+y+`);
      int c = imod(index, `+y+`) * 2;

      return ivec3(b, r, c);
    }
  `;default:return function(w,E){for(var b=[Math.ceil(E[0]/2),Math.ceil(E[1]/2)],C=Math.ceil(w[w.length-1]/2),_=C*Math.ceil(w[w.length-2]/2),S=_,R="",D="b, r, c",T=2;T<w.length-1;T++)S*=w[w.length-T-1],R=`
      int b`+T+" = index / "+S+`;
      index -= b`+T+" * "+S+`;
    `+R,D="b"+T+", "+D;return`
    ivec`+w.length+` getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+b[0]+", "+b[1]+`));
      int index = resTexRC.x * `+b[1]+` + resTexRC.y;

      `+R+`

      int b = index / `+_+`;
      index -= b * `+_+`;

      int r = 2 * (index / `+C+`);
      int c = imod(index, `+C+`) * 2;

      return ivec`+w.length+"("+D+`);
    }
  `}(h,p)}var v,g,m,y,x}(t.logicalShape,l),a=function(h){return`
    void setOutput(vec4 val) {
      `+h.output+` = val;
    }
  `}(c)):(i=function(h,p){switch(h.length){case 0:return`
    int getOutputCoords() {
      return 0;
    }
  `;case 1:return function(m,y){return y[0]===1?`
      int getOutputCoords() {
        return int(resultUV.x * `+y[1]+`.0);
      }
    `:y[1]===1?`
      int getOutputCoords() {
        return int(resultUV.y * `+y[0]+`.0);
      }
    `:`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+y[0]+", "+y[1]+`));
      return resTexRC.x * `+y[1]+` + resTexRC.y;
    }
  `}(0,p);case 2:return function(m,y){return Ft(m,y)?`
      ivec2 getOutputCoords() {
        return ivec2(resultUV.yx * vec2(`+y[0]+", "+y[1]+`));
      }
    `:m[1]===1?`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(`+y[0]+", "+y[1]+`));
        int index = resTexRC.x * `+y[1]+` + resTexRC.y;
        return ivec2(index, 0);
      }
    `:m[0]===1?`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(`+y[0]+", "+y[1]+`));
        int index = resTexRC.x * `+y[1]+` + resTexRC.y;
        return ivec2(0, index);
      }
    `:`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+y[0]+", "+y[1]+`));
      int index = resTexRC.x * `+y[1]+` + resTexRC.y;
      int r = index / `+m[1]+`;
      int c = index - r * `+m[1]+`;
      return ivec2(r, c);
    }
  `}(h,p);case 3:return v=p,g=Yo(["r","c","d"],h),`
    ivec3 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(`+v[0]+", "+v[1]+`));
      int index = resTexRC.x * `+v[1]+` + resTexRC.y;
      `+g+`
      return ivec3(r, c, d);
    }
  `;case 4:return function(m,y){var x=Yo(["r","c","d","d2"],m);return`
    ivec4 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(`+y[0]+", "+y[1]+`));
      int index = resTexRC.x * `+y[1]+` + resTexRC.y;
      `+x+`
      return ivec4(r, c, d, d2);
    }
  `}(h,p);case 5:return function(m,y){var x=Yo(["r","c","d","d2","d3"],m);return`
    ivec5 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx * vec2(`+y[0]+`,
                             `+y[1]+`));

      int index = resTexRC.x * `+y[1]+` + resTexRC.y;

      `+x+`

      ivec5 outShape = ivec5(r, c, d, d2, d3);
      return outShape;
    }
  `}(h,p);case 6:return function(m,y){var x=Yo(["r","c","d","d2","d3","d4"],m);return`
    ivec6 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(`+y[0]+", "+y[1]+`));
      int index = resTexRC.x * `+y[1]+` + resTexRC.y;

      `+x+`

      ivec6 result = ivec6(r, c, d, d2, d3, d4);
      return result;
    }
  `}(h,p);default:throw new Error(h.length+"-D output sampling is not yet supported")}var v,g}(t.logicalShape,l),a=function(h){return`
    void setOutput(float val) {
      `+h.output+` = vec4(val, 0, 0, 0);
    }
  `}(c)),r&&(d+=OI),[d,f,a,s,i,u,n].join(`
`)}function Pi(e){var t=e.shapeInfo.logicalShape;switch(t.length){case 0:return function(n){var r=n.name,o="get"+r.charAt(0).toUpperCase()+r.slice(1);if(n.shapeInfo.isUniform)return"float "+o+"() {return "+r+";}";var i=n.shapeInfo.texShape,a=i[0],s=i[1];if(a===1&&s===1)return`
      float `+o+`() {
        return sampleTexture(`+r+`, halfCR);
      }
    `;var u=n.shapeInfo.texShape,l=u[0],c=u[1],f=Bo(r);return`
    float `+o+`() {
      vec2 uv = uvFromFlat(`+l+", "+c+", "+f+`);
      return sampleTexture(`+r+`, uv);
    }
  `}(e);case 1:return function(n){var r=n.name,o="get"+r.charAt(0).toUpperCase()+r.slice(1);if(n.shapeInfo.isUniform)return`
      float `+o+`(int index) {
        `+Di(n)+`
      }
    `;var i=n.shapeInfo.texShape,a=i[0],s=i[1];if(s===1&&a===1)return`
      float `+o+`(int index) {
        return sampleTexture(`+r+`, halfCR);
      }
    `;var u=Bo(r);return s===1?`
      float `+o+`(int index) {
        vec2 uv = vec2(0.5, (float(index + `+u+") + 0.5) / "+a+`.0);
        return sampleTexture(`+r+`, uv);
      }
    `:a===1?`
      float `+o+`(int index) {
        vec2 uv = vec2((float(index + `+u+") + 0.5) / "+s+`.0, 0.5);
        return sampleTexture(`+r+`, uv);
      }
    `:`
    float `+o+`(int index) {
      vec2 uv = uvFromFlat(`+a+", "+s+", index + "+u+`);
      return sampleTexture(`+r+`, uv);
    }
  `}(e);case 2:return function(n){var r=n.shapeInfo.logicalShape,o=n.name,i="get"+o.charAt(0).toUpperCase()+o.slice(1),a=n.shapeInfo.texShape;if(a!=null&&Ft(r,a)){var s=a[0],u=a[1];return`
    float `+i+`(int row, int col) {
      vec2 uv = (vec2(col, row) + halfCR) / vec2(`+u+".0, "+s+`.0);
      return sampleTexture(`+o+`, uv);
    }
  `}var l=$o(r),c=l.newShape,f=l.keptDims,d=c;if(d.length<r.length){var h=Fi(n,d);return`
      `+Pi(h)+`
      float `+i+`(int row, int col) {
        return `+i+"("+Mi(["row","col"],f)+`);
      }
    `}if(n.shapeInfo.isUniform)return`
      float `+i+`(int row, int col) {
        int index = round(dot(vec2(row, col), vec2(`+r[1]+`, 1)));
        `+Di(n)+`
      }
    `;var p=a[0],v=a[1],g=Bo(o);return v===1?`
    float `+i+`(int row, int col) {
      float index = dot(vec3(row, col, `+g+"), vec3("+r[1]+`, 1, 1));
      vec2 uv = vec2(0.5, (index + 0.5) / `+p+`.0);
      return sampleTexture(`+o+`, uv);
    }
  `:p===1?`
    float `+i+`(int row, int col) {
      float index = dot(vec3(row, col, `+g+"), vec3("+r[1]+`, 1, 1));
      vec2 uv = vec2((index + 0.5) / `+v+`.0, 0.5);
      return sampleTexture(`+o+`, uv);
    }
  `:`
  float `+i+`(int row, int col) {
    // Explicitly use integer operations as dot() only works on floats.
    int index = row * `+r[1]+" + col + "+g+`;
    vec2 uv = uvFromFlat(`+p+", "+v+`, index);
    return sampleTexture(`+o+`, uv);
  }
`}(e);case 3:return function(n){var r=n.shapeInfo.logicalShape,o=n.name,i="get"+o.charAt(0).toUpperCase()+o.slice(1),a=r[1]*r[2],s=r[2],u=$o(r),l=u.newShape,c=u.keptDims,f=l;if(f.length<r.length){var d=Fi(n,f);return`
        `+Pi(d)+`
        float `+i+`(int row, int col, int depth) {
          return `+i+"("+Mi(["row","col","depth"],c)+`);
        }
      `}if(n.shapeInfo.isUniform)return`
      float `+i+`(int row, int col, int depth) {
        int index = round(dot(vec3(row, col, depth),
                          vec3(`+a+", "+s+`, 1)));
        `+Di(n)+`
      }
    `;var h=n.shapeInfo.texShape,p=h[0],v=h[1],g=n.shapeInfo.flatOffset;if(v===a&&g==null)return`
        float `+i+`(int row, int col, int depth) {
          float texR = float(row);
          float texC = dot(vec2(col, depth), vec2(`+s+`, 1));
          vec2 uv = (vec2(texC, texR) + halfCR) /
                     vec2(`+v+".0, "+p+`.0);
          return sampleTexture(`+o+`, uv);
        }
      `;if(v===s&&g==null)return`
    float `+i+`(int row, int col, int depth) {
      float texR = dot(vec2(row, col), vec2(`+r[1]+`, 1));
      float texC = float(depth);
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(`+v+".0, "+p+`.0);
      return sampleTexture(`+o+`, uv);
    }
  `;var m=Bo(o);return`
      float `+i+`(int row, int col, int depth) {
        // Explicitly use integer operations as dot() only works on floats.
        int index = row * `+a+" + col * "+s+" + depth + "+m+`;
        vec2 uv = uvFromFlat(`+p+", "+v+`, index);
        return sampleTexture(`+o+`, uv);
      }
  `}(e);case 4:return function(n){var r=n.shapeInfo.logicalShape,o=n.name,i="get"+o.charAt(0).toUpperCase()+o.slice(1),a=r[3],s=r[2]*a,u=r[1]*s,l=$o(r),c=l.newShape,f=l.keptDims;if(c.length<r.length){var d=Fi(n,c);return`
      `+Pi(d)+`
      float `+i+`(int row, int col, int depth, int depth2) {
        return `+i+"("+Mi(["row","col","depth","depth2"],f)+`);
      }
    `}if(n.shapeInfo.isUniform)return`
      float `+i+`(int row, int col, int depth, int depth2) {
        int index = round(dot(vec4(row, col, depth, depth2),
                          vec4(`+u+", "+s+", "+a+`, 1)));
        `+Di(n)+`
      }
    `;var h=n.shapeInfo.flatOffset,p=n.shapeInfo.texShape,v=p[0],g=p[1];if(g===u&&h==null)return`
      float `+i+`(int row, int col, int depth, int depth2) {
        float texR = float(row);
        float texC =
            dot(vec3(col, depth, depth2),
                vec3(`+s+", "+a+`, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(`+g+".0, "+v+`.0);
        return sampleTexture(`+o+`, uv);
      }
    `;if(g===a&&h==null)return`
      float `+i+`(int row, int col, int depth, int depth2) {
        float texR = dot(vec3(row, col, depth),
                         vec3(`+r[1]*r[2]+", "+r[2]+`, 1));
        float texC = float(depth2);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(`+g+".0, "+v+`.0);
        return sampleTexture(`+o+`, uv);
      }
    `;var m=Bo(o);return`
    float `+i+`(int row, int col, int depth, int depth2) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * `+u+" + col * "+s+` +
          depth * `+a+` + depth2;
      vec2 uv = uvFromFlat(`+v+", "+g+", index + "+m+`);
      return sampleTexture(`+o+`, uv);
    }
  `}(e);case 5:return function(n){var r=n.shapeInfo.logicalShape,o=n.name,i="get"+o.charAt(0).toUpperCase()+o.slice(1),a=r[4],s=r[3]*a,u=r[2]*s,l=r[1]*u,c=$o(r),f=c.newShape,d=c.keptDims;if(f.length<r.length){var h=Fi(n,f);return`
      `+Pi(h)+`
      float `+i+`(int row, int col, int depth, int depth2, int depth3) {
        return `+i+"("+Mi(["row","col","depth","depth2","depth3"],d)+`);
      }
    `}if(n.shapeInfo.isUniform)return`
      float `+i+`(int row, int col, int depth, int depth2, int depth3) {
        float index = dot(
          vec4(row, col, depth, depth2),
          vec4(`+l+", "+u+", "+s+", "+a+`)) +
          depth3;
        `+Di(n)+`
      }
    `;var p=n.shapeInfo.flatOffset,v=n.shapeInfo.texShape,g=v[0],m=v[1];if(m===l&&p==null)return`
      float `+i+`(int row, int col, int depth, int depth2, int depth3) {
        int texR = row;
        float texC = dot(vec4(col, depth, depth2, depth3),
                         vec4(`+u+", "+s+", "+a+`, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(`+m+".0, "+g+`.0);
        return sampleTexture(`+o+`, uv);
      }
    `;if(m===a&&p==null)return`
      float `+i+`(int row, int col, int depth, int depth2, int depth3) {
        float texR = dot(
          vec4(row, col, depth, depth2),
          vec4(`+r[1]*r[2]*r[3]+`,
               `+r[2]*r[3]+", "+r[3]+`, 1));
        int texC = depth3;
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(`+m+".0, "+g+`.0);
        return sampleTexture(`+o+`, uv);
      }
    `;var y=Bo(o);return`
    float `+i+`(int row, int col, int depth, int depth2, int depth3) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * `+l+" + col * "+u+" + depth * "+s+` +
          depth2 * `+a+" + depth3 + "+y+`;
      vec2 uv = uvFromFlat(`+g+", "+m+`, index);
      return sampleTexture(`+o+`, uv);
    }
  `}(e);case 6:return function(n){var r=n.shapeInfo.logicalShape,o=n.name,i="get"+o.charAt(0).toUpperCase()+o.slice(1),a=$o(r),s=a.newShape,u=a.keptDims;if(s.length<r.length){var l=Fi(n,s);return`
      `+Pi(l)+`
      float `+i+`(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        return `+i+"("+Mi(["row","col","depth","depth2","depth3","depth4"],u)+`);
      }
    `}var c=r[5],f=r[4]*c,d=r[3]*f,h=r[2]*d,p=r[1]*h;if(n.shapeInfo.isUniform)return`
      float `+i+`(int row, int col, int depth,
                  int depth2, int depth3, int depth4) {
        int index = round(dot(
          vec4(row, col, depth, depth2),
          vec4(`+p+", "+h+", "+d+", "+f+`)) +
          dot(
            vec2(depth3, depth4),
            vec2(`+c+`, 1)));
        `+Di(n)+`
      }
    `;var v=n.shapeInfo.flatOffset,g=n.shapeInfo.texShape,m=g[0],y=g[1];if(y===p&&v==null)return`
      float `+i+`(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        int texR = row;
        float texC = dot(vec4(col, depth, depth2, depth3),
          vec4(`+h+", "+d+", "+f+", "+c+`)) +
               float(depth4);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(`+y+".0, "+m+`.0);
        return sampleTexture(`+o+`, uv);
      }
    `;if(y===c&&v==null)return`
      float `+i+`(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        float texR = dot(vec4(row, col, depth, depth2),
          vec4(`+r[1]*r[2]*r[3]*r[4]+`,
               `+r[2]*r[3]*r[4]+`,
               `+r[3]*r[4]+`,
               `+r[4]+`)) + float(depth3);
        int texC = depth4;
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(`+y+".0, "+m+`.0);
        return sampleTexture(`+o+`, uv);
      }
    `;var x=Bo(o);return`
    float `+i+`(int row, int col, int depth,
                  int depth2, int depth3, int depth4) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * `+p+" + col * "+h+" + depth * "+d+` +
          depth2 * `+f+" + depth3 * "+c+" + depth4 + "+x+`;
      vec2 uv = uvFromFlat(`+m+", "+y+`, index);
      return sampleTexture(`+o+`, uv);
    }
  `}(e);default:throw new Error(t.length+"-D input sampling is not yet supported")}}function yw(e){var t,n,r;switch(e.shapeInfo.logicalShape.length){case 0:return t=e.name,n="get"+t.charAt(0).toUpperCase()+t.slice(1),r=Xt(),`
    vec4 `+n+`() {
      return `+r.texture2D+"("+t+`, halfCR);
    }
  `;case 1:return function(o){var i=o.name,a="get"+i.charAt(0).toUpperCase()+i.slice(1),s=o.shapeInfo.texShape,u=[Math.ceil(s[0]/2),Math.ceil(s[1]/2)],l=Xt();return`
    vec4 `+a+`(int index) {
      vec2 uv = packedUVfrom1D(
        `+u[0]+", "+u[1]+`, index);
      return `+l.texture2D+"("+i+`, uv);
    }
  `}(e);case 2:return function(o){var i=o.shapeInfo.logicalShape,a=o.name,s="get"+a.charAt(0).toUpperCase()+a.slice(1),u=o.shapeInfo.texShape,l=u[0],c=u[1],f=Xt();if(u!=null&&Ft(i,u))return`
      vec4 `+s+`(int row, int col) {
        vec2 uv = (vec2(col, row) + halfCR) / vec2(`+c+".0, "+l+`.0);

        return `+f.texture2D+"("+a+`, uv);
      }
    `;var d=[Math.ceil(u[0]/2),Math.ceil(u[1]/2)],h=Math.ceil(i[1]/2);return`
    vec4 `+s+`(int row, int col) {
      vec2 uv = packedUVfrom2D(`+h+", "+d[0]+", "+d[1]+`, row, col);
      return `+f.texture2D+"("+a+`, uv);
    }
  `}(e);case 3:return function(o){var i=o.shapeInfo.logicalShape,a=o.name,s="get"+a.charAt(0).toUpperCase()+a.slice(1),u=o.shapeInfo.texShape,l=[Math.ceil(u[0]/2),Math.ceil(u[1]/2)];if(i[0]===1){var c=i.slice(1),f=Fi(o,c);return`
        `+yw(f)+`
        vec4 `+s+`(int b, int row, int col) {
          return `+s+"("+Mi(["b","row","col"],[1,2])+`);
        }
      `}var d=l[0],h=l[1],p=Math.ceil(i[2]/2),v=p*Math.ceil(i[1]/2),g=Xt();return`
    vec4 `+s+`(int b, int row, int col) {
      vec2 uv = packedUVfrom3D(
        `+d+", "+h+", "+v+", "+p+`, b, row, col);
      return `+g.texture2D+"("+a+`, uv);
    }
  `}(e);default:return function(o){for(var i=o.shapeInfo.logicalShape,a=i.length,s=o.name,u="get"+s.charAt(0).toUpperCase()+s.slice(1),l=o.shapeInfo.texShape,c=[Math.ceil(l[0]/2),Math.ceil(l[1]/2)],f=c[0],d=c[1],h=Math.ceil(i[a-1]/2),p=h*Math.ceil(i[a-2]/2),v="int b, int row, int col",g="b * "+p+" + (row / 2) * "+h+" + (col / 2)",m=2;m<a-1;m++)v="int b"+m+", "+v,p*=i[a-m-1],g="b"+m+" * "+p+" + "+g;var y=Xt();return`
    vec4 `+u+"("+v+`) {
      int index = `+g+`;
      int texR = index / `+d+`;
      int texC = index - texR * `+d+`;
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(`+d+", "+f+`);
      return `+y.texture2D+"("+s+`, uv);
    }
  `}(e)}}var PI=`
vec2 uvFromFlat(int texNumR, int texNumC, int index) {
  int texR = index / texNumC;
  int texC = index - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
vec2 packedUVfrom1D(int texNumR, int texNumC, int index) {
  int texelIndex = index / 2;
  int texR = texelIndex / texNumC;
  int texC = texelIndex - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,FI=`
vec2 packedUVfrom2D(int texelsInLogicalRow, int texNumR,
  int texNumC, int row, int col) {
  int texelIndex = (row / 2) * texelsInLogicalRow + (col / 2);
  int texR = texelIndex / texNumC;
  int texC = texelIndex - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,MI=`
vec2 packedUVfrom3D(int texNumR, int texNumC,
    int texelsInBatch, int texelsInLogicalRow, int b,
    int row, int col) {
  int index = b * texelsInBatch + (row / 2) * texelsInLogicalRow + (col / 2);
  int texR = index / texNumC;
  int texC = index - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,OI=`
  float getChannel(vec4 frag, vec2 innerDims) {
    vec2 modCoord = mod(innerDims, 2.);
    return modCoord.x == 0. ?
      (modCoord.y == 0. ? frag.r : frag.g) :
      (modCoord.y == 0. ? frag.b : frag.a);
  }
  float getChannel(vec4 frag, int dim) {
    float modCoord = mod(float(dim), 2.);
    return modCoord == 0. ? frag.r : frag.g;
  }
`;function Bo(e){return"offset"+e}function Di(e){var t=e.name,n=le(e.shapeInfo.logicalShape);return n<2?"return "+t+";":`
    for (int i = 0; i < `+n+`; i++) {
      if (i == index) {
        return `+t+`[i];
      }
    }
  `}function Ye(e){if(e<=1)return"int";if(e===2)return"ivec2";if(e===3)return"ivec3";if(e===4)return"ivec4";if(e===5)return"ivec5";if(e===6)return"ivec6";throw Error("GPU for rank "+e+" is not yet supported")}function Fi(e,t){var n=JSON.parse(JSON.stringify(e));return n.shapeInfo.logicalShape=t,n}function Mi(e,t){return t.map(function(n){return e[n]}).join(", ")}var LI=function(e,t,n,r){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,I(e.length>2,function(){return"Packed arg"+(n.charAt(0).toUpperCase()+n.slice(1))+" supports only inputs with rank above 2."});var o=e[e.length-1],i=Math.ceil(o/t);this.outputShape=e.slice(0,-1),i>1&&this.outputShape.push(i),r||this.variableNames.push("bestIndicesA");var a,s,u=this.outputShape,l=u.length,c=Ye(l),f=ln("coords",l);if(i===1){var d=Ye(s=l+1);a=`
        `+d+" sourceLocR = "+d+"("+f.join()+`, 0);
        ++`+f[l-1]+`;
        `+d+" sourceLocG = "+d+"("+f.join()+`, 0);
        ++`+f[l-2]+`;
        `+d+" sourceLocA = "+d+"("+f.join()+`, 0);
        --`+f[l-1]+`;
        `+d+" sourceLocB = "+d+"("+f.join()+`, 0);
        --`+f[l-2]+";"}else s=l,a=`
        `+c+` sourceLocR = coords;
        ++`+f[l-1]+`;
        `+c+` sourceLocG = coords;
        ++`+f[l-2]+`;
        `+c+` sourceLocA = coords;
        --`+f[l-1]+`;
        `+c+` sourceLocB = coords;
        --`+f[l-2]+";";var h=["x","y","z","w","u","v"].slice(0,s),p="."+h[s-1],v=h.map(function(_){return"int "+_}),g=ln("sourceLocR",s-1).concat("inIdx.r"),m=ln("sourceLocG",s-1).concat("inIdx.g"),y=ln("sourceLocB",s-1).concat("inIdx.b"),x=ln("sourceLocA",s-1).concat("inIdx.a"),w=n==="max"?"greaterThan":"lessThan",E=r?"":`
          inIdx = round(vec4(getBestIndicesAChannel(`+g.join()+`),
                             getBestIndicesAChannel(`+m.join()+`),
                             getBestIndicesAChannel(`+y.join()+`),
                             getBestIndicesAChannel(`+x.join()+")));",b=`vec4(
            getAChannel(`+g.join()+`),
            hasNextCol ? getAChannel(`+m.join()+`) : 0.,
            hasNextRow ? getAChannel(`+y.join()+`) : 0.,
            hasNextRow && hasNextCol ? getAChannel(`+x.join()+") : 0.)",C=r?"":`
      float getBestIndicesAChannel(`+v.join()+`) {
        return getChannel(getBestIndicesA(`+h.join()+`),
                                          vec2(`+h.slice(-2).join()+`));
      }`;this.userCode=`
      float getAChannel(`+v.join()+`) {
        return getChannel(getA(`+h.join()+`),
                               vec2(`+h.slice(-2).join()+`));
      }
      `+C+`
      void main() {
        `+c+` coords = getOutputCoords();
        bool hasNextCol = `+f[l-1]+" < "+(u[l-1]-1)+`;
        bool hasNextRow = `+f[l-2]+" < "+(u[l-2]-1)+`;
        `+a+`
        ivec4 srcIdx = ivec4(sourceLocR`+p+", sourceLocG"+p+`,
          sourceLocB`+p+", sourceLocA"+p+") * "+t+`;
        ivec4 inIdx = srcIdx;
        vec4 bestIndex = vec4(inIdx);
        vec4 bestValue = `+b+`;

        for (int i = 0; i < `+t+`; i++) {
          inIdx = srcIdx;
          `+E+`
          vec4 candidate = `+b+`;
          bvec4 nan = isnan(candidate);
          bvec4 replace = bvec4(
            vec4(`+w+`(candidate, bestValue)) * (vec4(1.0) - vec4(nan)));

          bestValue = vec4(replace.x  ? candidate.x : bestValue.x,
                           replace.y  ? candidate.y : bestValue.y,
                           replace.z  ? candidate.z : bestValue.z,
                           replace.w  ? candidate.w : bestValue.w);
          bestIndex = mix(bestIndex, vec4(inIdx), vec4(replace));
          srcIdx++;
        }
        setOutput(bestIndex);
      }
    `},BI=function(e){this.variableNames=["dy"],this.outputShape=e.inShape;var t=e.filterHeight,n=e.filterWidth,r=e.strideHeight,o=e.strideWidth,i=e.dilationHeight,a=e.dilationWidth,s=e.effectiveFilterHeight,u=e.effectiveFilterWidth,l=s-1-e.padInfo.top,c=u-1-e.padInfo.left,f=1/(t*n);this.userCode=`
      const ivec2 pads = ivec2(`+l+", "+c+`);
      const float avgMultiplier = float(`+f+`);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];

        ivec2 dyRCCorner = coords.yz - pads;
        int dyRCorner = dyRCCorner.x;
        int dyCCorner = dyRCCorner.y;

        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < `+s+`;
            wR += `+i+`) {
          float dyR = float(dyRCorner + wR) / `+r+`.0;

          if (dyR < 0.0 || dyR >= `+e.outHeight+`.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          for (int wC = 0; wC < `+u+`;
            wC+= `+a+`) {
            float dyC = float(dyCCorner + wC) / `+o+`.0;

            if (dyC < 0.0 || dyC >= `+e.outWidth+`.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            float dyValue = getDy(b, idyR, idyC, d);

            dotProd += dyValue * avgMultiplier;
          }
        }
        setOutput(dotProd);
      }
    `},UI=function(e){this.variableNames=["dy"],this.outputShape=e.inShape;var t=e.filterDepth,n=e.filterHeight,r=e.filterWidth,o=e.strideDepth,i=e.strideHeight,a=e.strideWidth,s=e.dilationDepth,u=e.dilationHeight,l=e.dilationWidth,c=e.effectiveFilterDepth,f=e.effectiveFilterHeight,d=e.effectiveFilterWidth,h=c-1-e.padInfo.front,p=f-1-e.padInfo.top,v=d-1-e.padInfo.left,g=1/(t*n*r);this.userCode=`
      const ivec3 pads = ivec3(`+h+", "+p+", "+v+`);
      const float avgMultiplier = float(`+g+`);

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyDCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        // Convolve dy(?, ?, ?, d) with pos mask(:, :, :, ch) to get
        // dx(xD, xR, xC, ch).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int wD = 0; wD < `+c+`;
            wD += `+s+`) {
          float dyD = float(dyDCorner + wD) / `+o+`.0;

          if (dyD < 0.0 || dyD >= `+e.outDepth+`.0 || fract(dyD) > 0.0) {
            continue;
          }
          int idyD = int(dyD);

          for (int wR = 0; wR < `+f+`;
              wR += `+u+`) {
            float dyR = float(dyRCorner + wR) / `+i+`.0;

            if (dyR < 0.0 || dyR >= `+e.outHeight+`.0 ||
                fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            for (int wC = 0; wC < `+d+`;
                wC += `+l+`) {
              float dyC = float(dyCCorner + wC) / `+a+`.0;

              if (dyC < 0.0 || dyC >= `+e.outWidth+`.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              float dyValue = getDy(batch, idyD, idyR, idyC, ch);

              dotProd += dyValue * avgMultiplier;
            }
          }
        }
        setOutput(dotProd);
      }
    `},WI=function(e,t,n,r,o,i){this.outputShape=[],this.variableNames=["x","mean","variance"],Fe(e,t),Fe(e,n);var a="0.0";r!=null&&(Fe(e,r),this.variableNames.push("offset"),a="getOffsetAtOutCoords()");var s="1.0";o!=null&&(Fe(e,o),this.variableNames.push("scale"),s="getScaleAtOutCoords()"),this.outputShape=e,this.userCode=`
      void main() {
        float x = getXAtOutCoords();
        float mean = getMeanAtOutCoords();
        float variance = getVarianceAtOutCoords();
        float offset = `+a+`;
        float scale = `+s+`;
        float inv = scale * inversesqrt(variance + float(`+i+`));
        setOutput(dot(vec3(x, -mean, offset), vec3(inv, inv, 1)));
      }
    `},zI=function(e,t,n,r,o,i){this.packedInputs=!0,this.packedOutput=!0,this.variableNames=["x","mean","variance"],Fe(e,t),Fe(e,n);var a="vec4(0.0)";r!=null&&(Fe(e,r),this.variableNames.push("offset"),a="getOffsetAtOutCoords()");var s="vec4(1.0)";o!=null&&(Fe(e,o),this.variableNames.push("scale"),s="getScaleAtOutCoords()"),this.outputShape=e,this.userCode=`
      void main() {
        vec4 offset = `+a+`;
        vec4 scale = `+s+`;

        vec4 x = getXAtOutCoords();
        vec4 mean = getMeanAtOutCoords();
        vec4 variance = getVarianceAtOutCoords();

        vec4 inv = scale * inversesqrt(variance + vec4(`+i+`));

        setOutput((x - mean) * inv + offset);
      }
    `},jI="return areal * breal - aimag * bimag;",VI="return areal * bimag + aimag * breal;",Hg=function(e,t,n){this.variableNames=["AReal","AImag","BReal","BImag"],this.outputShape=Fe(t,n),this.userCode=`
      float binaryOpComplex(
          float areal, float aimag, float breal, float bimag) {
        `+e+`
      }

      void main() {
        float areal = getARealAtOutCoords();
        float aimag = getAImagAtOutCoords();
        float breal = getBRealAtOutCoords();
        float bimag = getBImagAtOutCoords();
        setOutput(binaryOpComplex(areal, aimag, breal, bimag));
      }
    `},Of="return a + b;",Lf="return a - b;",Gg="return a * b;",xw="return (a < 0.) ? b * a : a;",ht=function(e,t,n){this.variableNames=["A","B"],this.outputShape=Fe(t,n),this.userCode=`
      float binaryOperation(float a, float b) {
        `+e+`
      }

      void main() {
        float a = getAAtOutCoords();
        float b = getBAtOutCoords();
        setOutput(binaryOperation(a, b));
      }
    `},ww=`
  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));
  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);
`,Mr=function(e,t,n,r){r===void 0&&(r=!1),this.variableNames=["A","B"],this.supportsBroadcasting=!0,this.packedInputs=!0,this.packedOutput=!0,this.outputShape=Fe(t,n);var o=this.outputShape.length,i="";if(r)if(o===0||le(this.outputShape)===1)i=`
          result.y = 0.;
          result.z = 0.;
          result.w = 0.;
        `;else if(i=`
          `+Ye(o)+` coords = getOutputCoords();
        `,o===1)i+=`
            result.y = (coords + 1) >= `+this.outputShape[0]+` ? 0. : result.y;
            result.z = 0.;
            result.w = 0.;
          `;else{var a=ln("coords",o);i+=`
            bool nextRowOutOfBounds =
              (`+a[o-2]+" + 1) >= "+this.outputShape[o-2]+`;
            bool nextColOutOfBounds =
              (`+a[o-1]+" + 1) >= "+this.outputShape[o-1]+`;
            result.y = nextColOutOfBounds ? 0. : result.y;
            result.z = nextRowOutOfBounds ? 0. : result.z;
            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;
          `}this.userCode=`
      vec4 binaryOperation(vec4 a, vec4 b) {
        `+e+`
      }

      void main() {
        vec4 a = getAAtOutCoords();
        vec4 b = getBAtOutCoords();

        vec4 result = binaryOperation(a, b);
        `+i+`

        setOutput(result);
      }
    `},$I=function(){function e(t){this.variableNames=["A"],this.outputShape=t,this.userCode=`
      uniform float minVal;
      uniform float maxVal;

      void main() {
        float value = getAAtOutCoords();
        if (isnan(value)) {
          setOutput(value);
          return;
        }

        setOutput(clamp(value, minVal, maxVal));
      }
    `}return e.prototype.getCustomSetupFunc=function(t,n){var r=this;return function(o,i){r.minLoc==null&&(r.minLoc=o.getUniformLocationNoThrow(i,"minVal"),r.maxLoc=o.getUniformLocationNoThrow(i,"maxVal")),o.gl.uniform1f(r.minLoc,t),o.gl.uniform1f(r.maxLoc,n)}},e}(),HI=function(){function e(t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t,this.userCode=`
      uniform float minVal;
      uniform float maxVal;

      void main() {
        vec4 value = getAAtOutCoords();

        if (any(isnan(value))) {
          setOutput(value);
          return;
        }

        setOutput(clamp(value, vec4(minVal), vec4(maxVal)));
      }
    `}return e.prototype.getCustomSetupFunc=function(t,n){var r=this;return function(o,i){r.minLoc==null&&(r.minLoc=o.getUniformLocationNoThrow(i,"minVal"),r.maxLoc=o.getUniformLocationNoThrow(i,"maxVal")),o.gl.uniform1f(r.minLoc,t),o.gl.uniform1f(r.maxLoc,n)}},e}(),GI=function(e){this.variableNames=["real","imag"],this.outputShape=e,this.userCode=`
      void main() {
        float re = abs(getRealAtOutCoords());
        float im = abs(getImagAtOutCoords());
        float mx = max(re, im);

        // sadly the length function in glsl is not underflow-safe
        // (at least not on Intel GPUs). So the safe solution is
        // to ensure underflow-safety in all cases.
        setOutput(
          mx == 0.0 ? 0.0 : mx * length(vec2(1, min(re, im)/mx))
        );
      }
    `},qI=function(e){this.outputShape=[],this.outputShape=wa(e,1),this.variableNames=e.map(function(s,u){return"T"+u});var t=new Array(e.length-1);t[0]=e[0][1];for(var n=1;n<t.length;n++)t[n]=t[n-1]+e[n][1];var r=["if (yC < "+t[0]+") setOutput(getT0(yR, yC));"];for(n=1;n<t.length;n++){var o=t[n-1];r.push("else if (yC < "+t[n]+") setOutput(getT"+n+"(yR, yC-"+o+"));")}var i=t.length,a=t[t.length-1];r.push("else setOutput(getT"+i+"(yR, yC-"+a+"));"),this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int yR = coords.x;
        int yC = coords.y;

        `+r.join(`
        `)+`
      }
    `},KI=function(e,t){this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[],this.outputShape=wa(e,t);var n=this.outputShape,r=n.length,o=Ye(r),i=ln("coords",r),a=["x","y","z","w","u","v"].slice(0,r);this.variableNames=e.map(function(g,m){return"T"+m});var s=new Array(e.length-1);s[0]=e[0][t];for(var u=1;u<s.length;u++)s[u]=s[u-1]+e[u][t];var l=a[t],c=a.slice(-2),f=a.join(),d="if ("+l+" < "+s[0]+`) {
        return getChannel(
            getT0(`+f+"), vec2("+c.join()+`));
        }`;for(u=1;u<s.length;u++){var h=s[u-1];d+=`
        if (`+l+" < "+s[u]+"  && "+l+" >= "+s[u-1]+`) {
          return getChannel(
            getT`+u+"("+Nu(a,l,h)+`),
            vec2(`+Nu(c,l,h)+`));
        }`}var p=s.length,v=s[s.length-1];d+=`
        return getChannel(
          getT`+p+"("+Nu(a,l,v)+`),
          vec2(`+Nu(c,l,v)+"));",this.userCode=`
      float getValue(`+a.map(function(g){return"int "+g})+`) {
        `+d+`
      }

      void main() {
        `+o+` coords = getOutputCoords();
        vec4 result = vec4(getValue(`+i+`), 0., 0., 0.);

        `+i[r-1]+" = "+i[r-1]+` + 1;
        if (`+i[r-1]+" < "+n[r-1]+`) {
          result.g = getValue(`+i+`);
        }

        `+i[r-2]+" = "+i[r-2]+` + 1;
        if (`+i[r-2]+" < "+n[r-2]+`) {
          result.a = getValue(`+i+`);
        }

        `+i[r-1]+" = "+i[r-1]+` - 1;
        if (`+i[r-2]+" < "+n[r-2]+` &&
            `+i[r-1]+" < "+n[r-1]+`) {
          result.b = getValue(`+i+`);
        }
        setOutput(result);
      }
    `};function Nu(e,t,n){var r=e.indexOf(t);return e.map(function(o,i){return i===r?o+" - "+n:o}).join()}var XI=function(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;var t=e.strideHeight,n=e.strideWidth,r=e.padInfo.top,o=e.padInfo.left,i=e.dataFormat==="channelsLast";this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int wR = coords.x;
        int wC = coords.y;
        int d1 = coords.z;
        int d2 = coords.w;

        // Convolve x(?, ?, d1) with dy(:, :, d2) to get dw(wR, wC, d1, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int b = 0; b < `+e.batchSize+`; b++) {
          for (int yR = 0; yR < `+e.outHeight+`; yR++) {
            int xR = wR + yR * `+t+" - "+r+`;

            if (xR < 0 || xR >= `+e.inHeight+`) {
              continue;
            }

            for (int yC = 0; yC < `+e.outWidth+`; yC++) {
              int xC = wC + yC * `+n+" - "+o+`;

              if (xC < 0 || xC >= `+e.inWidth+`) {
                continue;
              }

              if (`+i+`) {
                float dyValue = getDy(b, yR, yC, d2);
                float xValue = getX(b, xR, xC, d1);
                dotProd += (xValue * dyValue);
              } else {
                float dyValue = getDy(b, d2, yR, yC);
                float xValue = getX(b, d1, xR, xC);
                dotProd += (xValue * dyValue);
              }

            }
          }
        }
        setOutput(dotProd);
      }
    `},YI=function(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;var t=e.filterHeight,n=e.filterWidth,r=e.strideHeight,o=e.strideWidth,i=e.dataFormat==="channelsLast",a=t-1-e.padInfo.top,s=n-1-e.padInfo.left,u=i?1:2,l=i?2:3,c=i?3:1;this.userCode=`
      const ivec2 pads = ivec2(`+a+", "+s+`);

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[`+c+`];

        ivec2 dyCorner = ivec2(coords[`+u+"], coords["+l+`]) - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        // Convolve dy(?, ?, d2) with w(:, :, d1, d2) to compute dx(xR, xC, d1).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < `+t+`; wR++) {
          float dyR = float(dyRCorner + wR) / `+r+`.0;

          if (dyR < 0.0 || dyR >= `+e.outHeight+`.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          int wRPerm = `+t+` - 1 - wR;

          for (int wC = 0; wC < `+n+`; wC++) {
            float dyC = float(dyCCorner + wC) / `+o+`.0;

            if (dyC < 0.0 || dyC >= `+e.outWidth+`.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            int wCPerm = `+n+` - 1 - wC;

            for (int d2 = 0; d2 < `+e.outChannels+`; d2++) {

              if (`+i+`) {
                float xValue = getDy(batch, idyR, idyC, d2);
                float wValue = getW(wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              } else {
                float xValue = getDy(batch, d2, idyR, idyC);
                float wValue = getW(wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              }

            }
          }
        }
        setOutput(dotProd);
      }
    `},QI=function(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;var t=e.strideDepth,n=e.strideHeight,r=e.strideWidth,o=e.padInfo.front,i=e.padInfo.top,a=e.padInfo.left;this.userCode=`
      void main() {
        ivec5 coords = getOutputCoords();
        int wF = coords.x;
        int wR = coords.y;
        int wC = coords.z;
        int d1 = coords.w;
        int d2 = coords.u;

        float dotProd = 0.0;

        for (int b = 0; b < `+e.batchSize+`; b++) {
          for (int yF = 0; yF < `+e.outDepth+`; yF++) {
            int xF = wF + yF * `+t+" - "+o+`;

            if (xF < 0 || xF >= `+e.inDepth+`) {
              continue;
            }

            for (int yR = 0; yR < `+e.outHeight+`; yR++) {
              int xR = wR + yR * `+n+" - "+i+`;

              if (xR < 0 || xR >= `+e.inHeight+`) {
                continue;
              }

              for (int yC = 0; yC < `+e.outWidth+`; yC++) {
                int xC = wC + yC * `+r+" - "+a+`;

                if (xC < 0 || xC >= `+e.inWidth+`) {
                  continue;
                }

                float dyValue = getDy(b, yF, yR, yC, d2);
                float xValue = getX(b, xF, xR, xC, d1);
                dotProd += (xValue * dyValue);
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `},JI=function(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;var t=e.filterDepth,n=e.filterHeight,r=e.filterWidth,o=e.strideDepth,i=e.strideHeight,a=e.strideWidth,s=t-1-e.padInfo.front,u=n-1-e.padInfo.top,l=r-1-e.padInfo.left;this.userCode=`
      const ivec3 pads = ivec3(`+s+", "+u+", "+l+`);

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int d1 = coords.u;


        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyFCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        float dotProd = 0.0;
        for (int wF = 0; wF < `+t+`; wF++) {
          float dyF = float(dyFCorner + wF) / `+o+`.0;

          if (dyF < 0.0 || dyF >= `+e.outDepth+`.0 || fract(dyF) > 0.0) {
            continue;
          }
          int idyF = int(dyF);

          int wFPerm = `+t+` - 1 - wF;

          for (int wR = 0; wR < `+n+`; wR++) {
            float dyR = float(dyRCorner + wR) / `+i+`.0;

            if (dyR < 0.0 || dyR >= `+e.outHeight+`.0 ||
              fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            int wRPerm = `+n+` - 1 - wR;

            for (int wC = 0; wC < `+r+`; wC++) {
              float dyC = float(dyCCorner + wC) / `+a+`.0;

              if (dyC < 0.0 || dyC >= `+e.outWidth+`.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              int wCPerm = `+r+` - 1 - wC;

              for (int d2 = 0; d2 < `+e.outChannels+`; d2++) {
                float xValue = getDy(batch, idyF, idyR, idyC, d2);
                float wValue = getW(wFPerm, wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `},ZI=function(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;var t=e.strideHeight,n=e.strideWidth,r=e.padInfo.top,o=e.padInfo.left,i=e.outChannels/e.inChannels;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int wR = coords.x;
        int wC = coords.y;
        int d1 = coords.z;
        int dm = coords.w;
        int d2 = d1 * `+i+` + dm;

        float dotProd = 0.0;

        // TO DO: Vec4 over the batch size
        for (int b = 0; b < `+e.batchSize+`; b++) {
          for (int yR = 0; yR < `+e.outHeight+`; yR++) {
            int xR = wR + yR * `+t+" - "+r+`;

            if (xR < 0 || xR >= `+e.inHeight+`) {
              continue;
            }

            for (int yC = 0; yC < `+e.outWidth+`; yC++) {
              int xC = wC + yC * `+n+" - "+o+`;

              if (xC < 0 || xC >= `+e.inWidth+`) {
                continue;
              }

              float dyValue = getDy(b, yR, yC, d2);
              float xValue = getX(b, xR, xC, d1);
              dotProd += (xValue * dyValue);
            }
          }
        }
        setOutput(dotProd);
      }
    `},eD=function(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;var t=e.filterHeight,n=e.filterWidth,r=e.strideHeight,o=e.strideWidth,i=t-1-e.padInfo.top,a=n-1-e.padInfo.left,s=e.outChannels/e.inChannels;this.userCode=`
      const ivec2 pads = ivec2(`+i+", "+a+`);

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[3];
        ivec2 dyCorner = coords.yz - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        float dotProd = 0.0;

        for (int wR = 0; wR < `+t+`; wR++) {
          float dyR = float(dyRCorner + wR) / `+r+`.0;

          if (dyR < 0.0 || dyR >= `+e.outHeight+`.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          int wRPerm = `+t+` - 1 - wR;

          for (int wC = 0; wC < `+n+`; wC++) {
            float dyC = float(dyCCorner + wC) / `+o+`.0;

            if (dyC < 0.0 || dyC >= `+e.outWidth+`.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            int wCPerm = `+n+` - 1 - wC;

            // TO DO: Vec4 over the channelMul
            for (int dm = 0; dm < `+s+`; dm++) {
              int d2 = d1 * `+s+` + dm;
              float xValue = getDy(batch, idyR, idyC, d2);
              float wValue = getW(wRPerm, wCPerm, d1, dm);
              dotProd += xValue * wValue;
            }
          }
        }
        setOutput(dotProd);
      }
    `},qg=function(e,t,n,r){t===void 0&&(t=!1),n===void 0&&(n=null),r===void 0&&(r=!1),this.variableNames=["x","W"],this.outputShape=e.outShape;var o=e.padInfo.top,i=e.padInfo.left,a=e.strideHeight,s=e.strideWidth,u=e.dilationHeight,l=e.dilationWidth,c=e.filterHeight,f=e.filterWidth,d=4*Math.floor(e.inChannels/4),h=e.inChannels%4,p=e.dataFormat==="channelsLast",v=p?1:2,g=p?2:3,m=p?3:1,y="",x="";n&&(y=r?`float activation(float a) {
          float b = getPreluActivationWeightsAtOutCoords();
          `+n+`
        }`:`
          float activation(float x) {
            `+n+`
          }
        `,x="result = activation(result);");var w=t?"result += getBiasAtOutCoords();":"";t&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),this.userCode=`
      `+y+`

      const ivec2 strides = ivec2(`+a+", "+s+`);
      const ivec2 pads = ivec2(`+o+", "+i+`);

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d2 = coords[`+m+`];

        ivec2 xRCCorner =
            ivec2(coords[`+v+"], coords["+g+`]) * strides - pads;
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // Convolve x(?, ?, d1) with w(:, :, d1, d2) to get y(yR, yC, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < `+c+`; wR++) {
          int xR = xRCorner + wR * `+u+`;

          if (xR < 0 || xR >= `+e.inHeight+`) {
            continue;
          }

          for (int wC = 0; wC < `+f+`; wC++) {
            int xC = xCCorner + wC * `+l+`;

            if (xC < 0 || xC >= `+e.inWidth+`) {
              continue;
            }

            for (int d1 = 0; d1 < `+d+`; d1 += 4) {
              vec4 wValues = vec4(
                getW(wR, wC, d1, d2),
                getW(wR, wC, d1 + 1, d2),
                getW(wR, wC, d1 + 2, d2),
                getW(wR, wC, d1 + 3, d2)
              );

              if (`+p+`) {
                vec4 xValues = vec4(
                  getX(batch, xR, xC, d1),
                  getX(batch, xR, xC, d1 + 1),
                  getX(batch, xR, xC, d1 + 2),
                  getX(batch, xR, xC, d1 + 3)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec4 xValues = vec4(
                  getX(batch, d1, xR, xC),
                  getX(batch, d1 + 1, xR, xC),
                  getX(batch, d1 + 2, xR, xC),
                  getX(batch, d1 + 3, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }
            }

            if (`+(h===1)+`) {

              if (`+p+`) {
                dotProd +=
                    getX(batch, xR, xC, `+d+`) *
                    getW(wR, wC, `+d+`, d2);
              } else {
                dotProd +=
                    getX(batch, `+d+`, xR, xC) *
                    getW(wR, wC, `+d+`, d2);
              }

            } else if (`+(h===2)+`) {
              vec2 wValues = vec2(
                getW(wR, wC, `+d+`, d2),
                getW(wR, wC, `+d+` + 1, d2)
              );

              if (`+p+`) {
                vec2 xValues = vec2(
                  getX(batch, xR, xC, `+d+`),
                  getX(batch, xR, xC, `+d+` + 1)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec2 xValues = vec2(
                  getX(batch, `+d+`, xR, xC),
                  getX(batch, `+d+` + 1, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }

            } else if (`+(h===3)+`) {
              vec3 wValues = vec3(
                getW(wR, wC, `+d+`, d2),
                getW(wR, wC, `+d+` + 1, d2),
                getW(wR, wC, `+d+` + 2, d2)
              );

              if (`+p+`) {
                vec3 xValues = vec3(
                  getX(batch, xR, xC, `+d+`),
                  getX(batch, xR, xC, `+d+` + 1),
                  getX(batch, xR, xC, `+d+` + 2)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec3 xValues = vec3(
                  getX(batch, `+d+`, xR, xC),
                  getX(batch, `+d+` + 1, xR, xC),
                  getX(batch, `+d+` + 2, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }

            }
          }
        }

        float result = dotProd;
        `+w+`
        `+x+`
        setOutput(result);
      }
    `},tD=function(e){this.variableNames=["x","W"],this.outputShape=e.outShape;var t=e.padInfo.front,n=e.padInfo.top,r=e.padInfo.left,o=e.strideDepth,i=e.strideHeight,a=e.strideWidth,s=e.dilationDepth,u=e.dilationHeight,l=e.dilationWidth,c=e.filterDepth,f=e.filterHeight,d=e.filterWidth,h=4*Math.floor(e.inChannels/4),p=e.inChannels%4;this.userCode=`
      const ivec3 strides = ivec3(`+o+", "+i+", "+a+`);
      const ivec3 pads = ivec3(`+t+", "+n+", "+r+`);

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int d2 = coords.u;

        ivec3 xFRCCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
        int xFCorner = xFRCCorner.x;
        int xRCorner = xFRCCorner.y;
        int xCCorner = xFRCCorner.z;

        // Convolve x(?, ?, ?, d1) with w(:, :, :, d1, d2) to get
        // y(yF, yR, yC, d2). ? = to be determined. : = across all
        // values in that axis.
        float dotProd = 0.0;
        for (int wF = 0; wF < `+c+`; wF++) {
          int xF = xFCorner + wF * `+s+`;

          if (xF < 0 || xF >= `+e.inDepth+`) {
            continue;
          }

          for (int wR = 0; wR < `+f+`; wR++) {
            int xR = xRCorner + wR * `+u+`;

            if (xR < 0 || xR >= `+e.inHeight+`) {
              continue;
            }

            for (int wC = 0; wC < `+d+`; wC++) {
              int xC = xCCorner + wC * `+l+`;

              if (xC < 0 || xC >= `+e.inWidth+`) {
                continue;
              }

              for (int d1 = 0; d1 < `+h+`; d1 += 4) {
                vec4 xValues = vec4(
                  getX(batch, xF, xR, xC, d1),
                  getX(batch, xF, xR, xC, d1 + 1),
                  getX(batch, xF, xR, xC, d1 + 2),
                  getX(batch, xF, xR, xC, d1 + 3)
                );
                vec4 wValues = vec4(
                  getW(wF, wR, wC, d1, d2),
                  getW(wF, wR, wC, d1 + 1, d2),
                  getW(wF, wR, wC, d1 + 2, d2),
                  getW(wF, wR, wC, d1 + 3, d2)
                );

                dotProd += dot(xValues, wValues);
              }

              if (`+(p===1)+`) {
                dotProd +=
                  getX(batch, xF, xR, xC, `+h+`) *
                  getW(wF, wR, wC, `+h+`, d2);
              } else if (`+(p===2)+`) {
                vec2 xValues = vec2(
                  getX(batch, xF, xR, xC, `+h+`),
                  getX(batch, xF, xR, xC, `+h+` + 1)
                );
                vec2 wValues = vec2(
                  getW(wF, wR, wC, `+h+`, d2),
                  getW(wF, wR, wC, `+h+` + 1, d2)
                );
                dotProd += dot(xValues, wValues);
              } else if (`+(p===3)+`) {
                vec3 xValues = vec3(
                  getX(batch, xF, xR, xC, `+h+`),
                  getX(batch, xF, xR, xC, `+h+` + 1),
                  getX(batch, xF, xR, xC, `+h+` + 2)
                );
                vec3 wValues = vec3(
                  getW(wF, wR, wC, `+h+`, d2),
                  getW(wF, wR, wC, `+h+` + 1, d2),
                  getW(wF, wR, wC, `+h+` + 2, d2)
                );
                dotProd += dot(xValues, wValues);
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `},Kg=function(e,t,n,r){t===void 0&&(t=!1),n===void 0&&(n=null),r===void 0&&(r=!1),this.variableNames=["x","W"],this.outputShape=e.outShape;var o=e.inHeight,i=e.inWidth,a=e.padInfo.top,s=e.padInfo.left,u=e.strideHeight,l=e.strideWidth,c=e.dilationHeight,f=e.dilationWidth,d=e.filterHeight,h=e.filterWidth,p=e.outChannels/e.inChannels,v="",g="";n&&(v=r?`float activation(float a) {
          float b = getPreluActivationWeightsAtOutCoords();
          `+n+`
        }`:`
          float activation(float x) {
            `+n+`
          }
        `,g="result = activation(result);");var m=t?"result += getBiasAtOutCoords();":"";t&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),this.userCode=`
      `+v+`

      const ivec2 strides = ivec2(`+u+", "+l+`);
      const ivec2 pads = ivec2(`+a+", "+s+`);

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        ivec2 xRCCorner = coords.yz * strides - pads;
        int d2 = coords.w;
        int d1 = d2 / `+p+`;
        int q = d2 - d1 * `+p+`;

        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // Convolve x(?, ?, d1) with w(:, :, d1, q) to get y(yR, yC, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        // TO DO(dsmilkov): Flatten the two for loops and vec4 the operations.
        for (int wR = 0; wR < `+d+`; wR++) {
          int xR = xRCorner + wR * `+c+`;

          if (xR < 0 || xR >= `+o+`) {
            continue;
          }

          for (int wC = 0; wC < `+h+`; wC++) {
            int xC = xCCorner + wC * `+f+`;

            if (xC < 0 || xC >= `+i+`) {
              continue;
            }

            float xVal = getX(batch, xR, xC, d1);
            float wVal = getW(wR, wC, d1, q);
            dotProd += xVal * wVal;
          }
        }

        float result = dotProd;
        `+m+`
        `+g+`
        setOutput(result);
      }
    `},Xg=function(e,t,n,r){t===void 0&&(t=!1),n===void 0&&(n=null),r===void 0&&(r=!1),this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e.outShape;for(var o=e.inHeight,i=e.inWidth,a=e.padInfo.top,s=e.padInfo.left,u=e.strideHeight,l=e.strideWidth,c=e.dilationHeight,f=e.dilationWidth,d=e.filterHeight,h=e.filterWidth,p=h,v="int xR; int xC; int xCOffset;",g=0;g<d;g++)for(var m=0;m<h;m++)v+=`
          vec4 xTexelR`+g+"C"+2*m+` = vec4(0.);
          vec4 wR`+g+"C"+m+` = vec4(0.);
          vec4 xR`+g+"C"+m+" = vec4(0.);";for(g=0;g<d;g++)for(var y=0;y<p;y++){if(v+=`
          xR = xRCorner + `+g*c+`;
          xC = xCCorner + `+(m=2*y)*f+`;
        `,l===1){if(m<h&&(v+=s%2==1?`
                xCOffset = xC + 1;
                if(xR >= 0 && xR < `+o+" && xCOffset >= 0 && xCOffset < "+i+`) {
                  xTexelR`+g+"C"+m+` = getX(batch, xR, xCOffset, d1);

                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if(xCOffset + 1 >= `+i+`) {
                    xTexelR`+g+"C"+m+`.zw = vec2(0.);
                  }
                } else {
                  xTexelR`+g+"C"+m+` = vec4(0.);
                }

                xCOffset = xC + 1 - 2;
                if(xR >= 0 && xR < `+o+" && xCOffset >= 0 && xCOffset < "+i+`) {
                  vec4 previous = getX(batch, xR, xCOffset, d1);

                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if(xCOffset + 1 >= `+i+`) {
                    previous.zw = vec2(0.);
                  }

                  xR`+g+"C"+m+" = vec4(previous.zw, xTexelR"+g+"C"+m+`.xy);
                } else {
                  xR`+g+"C"+m+" = vec4(0, 0, xTexelR"+g+"C"+m+`.xy);
                }
              `:`
                if(xR >= 0 && xR < `+o+" && xC >= 0 && xC < "+i+`) {
                  xTexelR`+g+"C"+m+` = getX(batch, xR, xC, d1);
                } else {
                  xTexelR`+g+"C"+m+` = vec4(0.);
                }

                xR`+g+"C"+m+" = xTexelR"+g+"C"+m+`;
              `,m+1<h)){var x=s%2==0?Bx(f):f;f%2==0&&s%2==1||f%2!=0&&s%2!=1?(v+=`
                  xCOffset = xC + `+s%2+" + "+x+`;

                  if(xR >= 0 && xR < `+o+` &&
                    xCOffset >= 0 && xCOffset < `+i+`) {
                    xTexelR`+g+"C"+(m+2)+` = getX(batch, xR, xCOffset, d1);
                  }
                `,f>1&&(v+=`
                    xCOffset -= 2;
                    if(xR >= 0 && xR < `+o+` &&
                      xCOffset >= 0 && xCOffset < `+i+`) {
                      xTexelR`+g+"C"+m+` = getX(batch, xR, xCOffset, d1);
                    } else {
                      xTexelR`+g+"C"+m+` = vec4(0.);
                    }
                  `),v+=`
                  xR`+g+"C"+(m+1)+` = vec4(
                    xTexelR`+g+"C"+m+".zw, xTexelR"+g+"C"+(m+2)+`.xy);
                `):v+=`
                  xCOffset = xC + `+x+`;

                  if(xR >= 0 && xR < `+o+` &&
                    xCOffset >= 0 && xCOffset < `+i+`) {
                    xTexelR`+g+"C"+(m+2)+` = getX(batch, xR, xCOffset, d1);
                  }

                  xR`+g+"C"+(m+1)+" = xTexelR"+g+"C"+(m+2)+`;
                `}}else m<h&&(v+=`
              if(xR >= 0 && xR < `+o+`) {
            `,s%2==1?(v+=`
                xCOffset = xC + 1 - `+l+`;
                if(xCOffset >= 0 && xCOffset < `+i+`) {
                  xTexelR`+g+"C"+m+` = getX(batch, xR, xCOffset, d1);
                } else {
                  xTexelR`+g+"C"+m+` = vec4(0.);
                }

                if(xC + 1 >= 0 && xC + 1 < `+i+`) {
                  xTexelR`+g+"C"+(m+2)+` = getX(batch, xR, xC + 1, d1);
                } else {
                  xTexelR`+g+"C"+(m+2)+` = vec4(0.);
                }

                xR`+g+"C"+m+` = vec4(
                  xTexelR`+g+"C"+m+".zw, xTexelR"+g+"C"+(m+2)+`.zw);
              `,m+1<h&&(v+=`
                  vec4 final = vec4(0.);
                  xCOffset = xC + 1 + `+l+`;
                  if(xCOffset >= 0 && xCOffset < `+i+`) {
                    final = getX(batch, xR, xCOffset, d1);
                  }
                  xR`+g+"C"+(m+1)+" = vec4(xTexelR"+g+"C"+(m+2)+`.xy, final.xy);
                `)):(v+=`
                if(xC >= 0 && xC < `+i+`) {
                  xTexelR`+g+"C"+m+` = getX(batch, xR, xC, d1);
                } else {
                  xTexelR`+g+"C"+m+` = vec4(0.);
                }

                xCOffset = xC + `+l+`;
                if(xCOffset >= 0 && xCOffset < `+i+`) {
                  xTexelR`+g+"C"+(m+2)+` = getX(batch, xR, xCOffset, d1);
                } else {
                  xTexelR`+g+"C"+(m+2)+` = vec4(0.);
                }

                xR`+g+"C"+m+` = vec4(
                  xTexelR`+g+"C"+m+".xy, xTexelR"+g+"C"+(m+2)+`.xy);
              `,m+1<h&&(v+=`
                  xR`+g+"C"+(m+1)+` = vec4(
                    xTexelR`+g+"C"+m+".zw, xTexelR"+g+"C"+(m+2)+`.zw);
                `)),v+="}");m<h&&(v+=`
            vec4 wTexelR`+g+"C"+m+" = getW("+g+", "+m+`, d1, q);
            wR`+g+"C"+m+" = vec4(wTexelR"+g+"C"+m+".xz, wTexelR"+g+"C"+m+`.xz);
          `,m+1<h&&(v+=`
              vec4 wTexelR`+g+"C"+(m+1)+" = getW("+g+", "+(m+1)+`, d1, q);
              wR`+g+"C"+(m+1)+` =
                vec4(wTexelR`+g+"C"+(m+1)+".xz, wTexelR"+g+"C"+(m+1)+".xz);"))}for(g=0;g<d;g++)for(m=0;m<h;m++)v+="dotProd += xR"+g+"C"+m+" * wR"+g+"C"+m+";";var w="",E="";n&&(w=r?`vec4 activation(vec4 a) {
          vec4 b = getPreluActivationWeightsAtOutCoords();
          `+n+`
        }`:`vec4 activation(vec4 x) {
          `+n+`
        }`,E="result = activation(result);");var b=t?"result += getBiasAtOutCoords();":"";t&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),this.userCode=`
      `+w+`

      const ivec2 strides = ivec2(`+u+", "+l+`);
      const ivec2 pads = ivec2(`+a+", "+s+`);

      void main() {

        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        ivec2 xRCCorner = coords.yz * strides - pads;
        int d2 = coords.w;
        int d1 = d2;
        int q = 0;
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        vec4 dotProd = vec4(0.);

        `+v+`

        vec4 result = dotProd;
        `+b+`
        `+E+`
        setOutput(result);
      }
    `},nD=function(e,t,n,r,o){this.variableNames=["Image","Boxes","BoxInd"],this.outputShape=[];var i=e[0],a=e[1],s=e[2],u=e[3],l=t[0],c=n[0],f=n[1];this.outputShape=[l,c,f,u];var d=r==="bilinear"?1:0,h=[a-1+".0",s-1+".0"],p=h[0],v=h[1],g=c>1?[""+(a-1)/(c-1),"(y2-y1) * height_ratio","y1*"+p+" + float(y)*(height_scale)"]:["0.0","0.0","0.5 * (y1+y2) * "+p],m=g[0],y=g[1],x=g[2],w=f>1?[""+(s-1)/(f-1),"(x2-x1) * width_ratio","x1*"+v+" + float(x)*(width_scale)"]:["0.0","0.0","0.5 * (x1+x2) * "+v],E=w[0],b=w[1],C=w[2];this.userCode=`
      const float height_ratio = float(`+m+`);
      const float width_ratio = float(`+E+`);
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int y = coords[1];
        int x = coords[2];
        int d = coords[3];

        // get box vals
        float y1 = getBoxes(b,0);
        float x1 = getBoxes(b,1);
        float y2 = getBoxes(b,2);
        float x2 = getBoxes(b,3);

        // get image in batch index
        int bInd = round(getBoxInd(b));
        if(bInd < 0 || bInd >= `+i+`) {
          return;
        }

        float height_scale = `+y+`;
        float width_scale = `+b+`;

        float in_y = `+x+`;
        if( in_y < 0.0 || in_y > `+p+` ) {
          setOutput(float(`+o+`));
          return;
        }
        float in_x = `+C+`;
        if( in_x < 0.0 || in_x > `+v+` ) {
          setOutput(float(`+o+`));
          return;
        }

        vec2 sourceFracIndexCR = vec2(in_x,in_y);
        if(`+d+` == 1) {
          // Compute the four integer indices.
          ivec2 sourceFloorCR = ivec2(sourceFracIndexCR);
          ivec2 sourceCeilCR = ivec2(ceil(sourceFracIndexCR));

          float topLeft = getImage(b, sourceFloorCR.y, sourceFloorCR.x, d);
          float bottomLeft = getImage(b, sourceCeilCR.y, sourceFloorCR.x, d);
          float topRight = getImage(b, sourceFloorCR.y, sourceCeilCR.x, d);
          float bottomRight = getImage(b, sourceCeilCR.y, sourceCeilCR.x, d);

          vec2 fracCR = sourceFracIndexCR - vec2(sourceFloorCR);

          float top = topLeft + (topRight - topLeft) * fracCR.x;
          float bottom = bottomLeft + (bottomRight - bottomLeft) * fracCR.x;
          float newValue = top + (bottom - top) * fracCR.y;
          setOutput(newValue);
        } else {
          // Compute the coordinators of nearest neighbor point.
          ivec2 sourceNearestCR = ivec2(floor(
            sourceFracIndexCR + vec2(0.5,0.5)));
          float newValue = getImage(b, sourceNearestCR.y, sourceNearestCR.x, d);
          setOutput(newValue);
        }
      }
    `},rD=function(e,t,n){this.variableNames=["x"],this.outputShape=e;var r=e.length,o=e[e.length-1],i=n?"<":">";this.userCode=`
      int getIndex(int i) {
        `+(n?"return "+o+" -i - 1;":"return i;")+`
      }

      void main() {
        `+Ye(r)+` coords = getOutputCoords();
        int end = `+Yg(r,"coords")+`;
        float val = 0.0;
        for (int i = `+o+` - 1; i >= 0; i -= 1) {
          int idx = getIndex(i);
          if (idx `+i+` end) {
            continue;
          }
          if (idx == end && `+t+`) {
            continue;
          }
          `+Yg(r,"coords")+` = idx;
          val += getX(`+function(a,s){if(a===1)return""+s;if(a===2)return s+".x, "+s+".y";if(a===3)return s+".x, "+s+".y, "+s+".z";if(a===4)return s+".x, "+s+".y, "+s+".z, "+s+".w";throw Error("Cumulative sum for rank "+a+" is not yet supported")}(r,"coords")+`);
        }
        setOutput(val);
      }
    `};function Yg(e,t){if(e===1)return""+t;if(e===2)return t+".y";if(e===3)return t+".z";if(e===4)return t+".w";throw Error("Cumulative sum for rank "+e+" is not yet supported")}var oD=function(e){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outPackingScheme=Ps.DENSE;var t=ss(e),n=Xt();this.outputShape=e,this.userCode=`
      ivec3 outCoordsFromFlatIndex(int index) {
        `+Yo(["r","c","d"],e)+`
        return ivec3(r, c, d);
      }

      void main() {
        ivec2 resTexRC = ivec2(resultUV.yx *
          vec2(`+t[0]+", "+t[1]+`));
        int index = 4 * (resTexRC.x * `+t[1]+` + resTexRC.y);

        vec4 result = vec4(0.);

        for (int i=0; i<4; i++) {
          int flatIndex = index + i;
          ivec3 rc = outCoordsFromFlatIndex(flatIndex);
          result[i] = getA(rc.x, rc.y, rc.z);
        }

        `+n.output+` = result;
      }
    `},iD=function(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outPackingScheme=Ps.DENSE;var t=ss(e),n=Xt();this.outputShape=e,this.userCode=`
      ivec3 outCoordsFromFlatIndex(int index) {
        `+Yo(["r","c","d"],e)+`
        return ivec3(r, c, d);
      }

      void main() {
        ivec2 resTexRC = ivec2(resultUV.yx *
          vec2(`+t[0]+", "+t[1]+`));
        int index = 4 * (resTexRC.x * `+t[1]+` + resTexRC.y);

        vec4 result = vec4(0.);

        for (int i=0; i<4; i++) {
          int flatIndex = index + i;
          ivec3 rc = outCoordsFromFlatIndex(flatIndex);
          result[i] = getChannel(getA(rc.x, rc.y, rc.z), vec2(rc.y, rc.z));
        }

        `+n.output+` = result;
      }
    `},aD=function(){function e(t,n,r){this.variableNames=["x"],this.outputShape=[],this.outputShape=t,this.blockSize=n,this.dataFormat=r,this.userCode=`
    void main() {
      ivec4 coords = getOutputCoords();
      int b = coords[0];
      int h = `+this.getHeightCoordString()+`;
      int w = `+this.getWidthCoordString()+`;
      int d = `+this.getDepthCoordString()+`;

      int in_h = h / `+n+`;
      int offset_h = imod(h, `+n+`);
      int in_w = w / `+n+`;
      int offset_w = imod(w, `+n+`);
      int offset_d = (offset_h * `+n+` + offset_w) *
        `+this.getOutputDepthSize()+`;
      int in_d = d + offset_d;

      float result = `+this.getInputSamplingString()+`;
      setOutput(result);
    }
  `}return e.prototype.getHeightCoordString=function(){return this.dataFormat==="NHWC"?"coords[1]":"coords[2]"},e.prototype.getWidthCoordString=function(){return this.dataFormat==="NHWC"?"coords[2]":"coords[3]"},e.prototype.getDepthCoordString=function(){return this.dataFormat==="NHWC"?"coords[3]":"coords[1]"},e.prototype.getOutputDepthSize=function(){return this.dataFormat==="NHWC"?this.outputShape[3]:this.outputShape[1]},e.prototype.getInputSamplingString=function(){return this.dataFormat==="NHWC"?"getX(b, in_h, in_w, in_d)":"getX(b, in_d, in_h, in_w)"},e}(),sD=function(e){this.variableNames=["X"],this.outputShape=[e,e],this.userCode=`
      void main() {
          ivec2 coords = getOutputCoords();
          float val = coords[0] == coords[1] ? getX(coords[0]) : 0.0;
          setOutput(val);
      }
    `},uD=function(e){this.variableNames=["A"],this.outTexUsage=Sn.DOWNLOAD;var t=Xt();this.outputShape=e,this.userCode=`
      `+gw+`

      void main() {
        float x = getAAtOutCoords();
        `+t.output+` = encode_float(x);
      }
    `},lD=function(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outTexUsage=Sn.DOWNLOAD;var t=Xt();this.outputShape=e,this.userCode=`
      `+gw+`

      void main() {
        ivec3 coords = getOutputCoords();
        float x = getChannel(getAAtOutCoords(), vec2(coords.y, coords.z));
        `+t.output+` = encode_float(x);
      }
    `},cD=function(e,t,n){n===void 0&&(n=!1),this.variableNames=["A"];var r=Xt(),o=t[0],i=t[1];this.outputShape=e;var a="result";n&&(a="floor(result * 255. + 0.5)"),this.userCode=`
      `+zp(e)+`

      void main() {
        ivec3 coords = getOutputCoords();

        int flatIndex = getFlatIndex(coords);
        int offset = imod(flatIndex, 4);

        flatIndex = idiv(flatIndex, 4, 1.);
        
        int r = flatIndex / `+i+`;
        int c = imod(flatIndex, `+i+`);
        vec2 uv = (vec2(c, r) + halfCR) / vec2(`+i+".0, "+o+`.0);
        vec4 values = `+r.texture2D+`(A, uv);

        float result;

        if(offset == 0) {
          result = values[0];
        } else if(offset == 1) {
          result = values[1];
        } else if(offset == 2) {
          result = values[2];
        } else {
          result = values[3];
        }

        `+r.output+" = vec4("+a+`, 0., 0., 0.);
      }
    `},fD=function(e,t,n){n===void 0&&(n=!1),this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0;var r=Xt(),o=t[0],i=t[1];this.outputShape=e;var a="",s="result";n&&(s="floor(result * 255. + 0.5)");for(var u=0;u<=1;u++)for(var l=0;l<=1;l++){var c=2*u+l;a+=`
          localCoords = coords;
          if(localCoords[2] + `+l+" < "+e[2]+`) {
            localCoords[2] += `+l+`;
            if(localCoords[1] + `+u+" < "+e[1]+`) {
              localCoords[1] += `+u+`;

              flatIndex = getFlatIndex(localCoords);
              offset = imod(flatIndex, 4);

              flatIndex = idiv(flatIndex, 4, 1.);

              r = flatIndex / `+i+`;
              c = imod(flatIndex, `+i+`);
              uv = (vec2(c, r) + halfCR) / vec2(`+i+".0, "+o+`.0);
              values = `+r.texture2D+`(A, uv);

              if(offset == 0) {
                result[`+c+`] = values[0];
              } else if(offset == 1) {
                result[`+c+`] = values[1];
              } else if(offset == 2) {
                result[`+c+`] = values[2];
              } else {
                result[`+c+`] = values[3];
              }
            }
          }
        `}this.userCode=`
      `+zp(e)+`

      void main() {
        ivec3 coords = getOutputCoords();

        vec4 result = vec4(0.);
        int flatIndex, r, c, offset;
        ivec3 localCoords;
        vec2 uv;
        vec4 values;

        `+a+`

        `+r.output+" = "+s+`;
      }
    `},dD="return real * expR - imag * expI;",hD="return real * expI + imag * expR;",Qg=function(e,t,n){this.variableNames=["real","imag"];var r=t[1];this.outputShape=t;var o=n?"2.0 * "+Math.PI:"-2.0 * "+Math.PI,i=n?r+".0":"1.0";this.userCode=`
      const float exponentMultiplier = `+o+`;

      float unaryOpComplex(float real, float expR, float imag, float expI) {
        `+e+`
      }

      float mulMatDFT(int batch, int index) {
        float indexRatio = float(index) / float(`+r+`);
        float exponentMultiplierTimesIndexRatio =
            exponentMultiplier * indexRatio;

        float result = 0.0;

        for (int i = 0; i < `+r+`; i++) {
          // x = (-2|2 * PI / N) * index * i;
          float x = exponentMultiplierTimesIndexRatio * float(i);
          float expR = cos(x);
          float expI = sin(x);
          float real = getReal(batch, i);
          float imag = getImag(batch, i);

          result +=
              unaryOpComplex(real, expR, imag, expI) / `+i+`;
        }

        return result;
      }

      void main() {
        ivec2 coords = getOutputCoords();
        setOutput(mulMatDFT(coords[0], coords[1]));
      }
    `},pD=function(){function e(t,n){this.outputShape=[],this.variableNames=["x"],this.outputShape=t,this.userCode=`
      uniform float value;
      void main() {
        // Input can be obtained from uniform value.
        setOutput(value);
      }
    `}return e.prototype.getCustomSetupFunc=function(t){var n=this;return function(r,o){n.valueLoc==null&&(n.valueLoc=r.getUniformLocationNoThrow(o,"value")),r.gl.uniform1f(n.valueLoc,t)}},e}(),vD=function(e,t,n){this.variableNames=["A","indices"];var r=e.slice();r[n]=t,this.outputShape=r,this.rank=r.length;var o=Ye(this.rank),i=function(a,s){var u=a.length;if(u>4)throw Error("Gather for rank "+u+" is not yet supported");if(u===1)return"int(getIndices(resRC))";for(var l=["resRC.x","resRC.y","resRC.z","resRC.w"],c=[],f=0;f<a.length;f++)f===s?c.push("int(getIndices("+l[f]+"))"):c.push(""+l[f]);return c.join()}(e,n);this.userCode=`
      void main() {
        `+o+` resRC = getOutputCoords();
        setOutput(getA(`+i+`));
      }
    `},mD=function(e,t,n){this.sliceDim=e,this.strides=t,this.variableNames=["x","indices"],this.outputShape=n;var r=Ye(t.length),o=Ye(n.length),i=this.sliceDim>1?"strides[j]":"strides";this.userCode=`
        `+r+" strides = "+r+"("+this.strides+`);
         void main() {
          `+o+` coords = getOutputCoords();
          int flattenIndex = 0;
          for (int j = 0; j < `+this.sliceDim+`; j++) {
            int index = round(getIndices(coords[0], j));
            flattenIndex += index * `+i+`;
          }
          setOutput(getX(flattenIndex, coords[1]));
        }
      `};function gD(e,t){var n=Xt();return dk(e,t,n.version+`
    precision highp float;
    `+n.attribute+` vec3 clipSpacePos;
    `+n.attribute+` vec2 uv;
    `+n.varyingVs+` vec2 resultUV;

    void main() {
      gl_Position = vec4(clipSpacePos, 1);
      resultUV = uv;
    }`)}function yD(e,t){return gk(e,t,new Float32Array([-1,1,0,0,1,-1,-1,0,0,0,1,1,0,1,1,1,-1,0,1,0]))}function xD(e,t){return yk(e,t,new Uint16Array([0,1,2,2,1,3]))}function Xs(e,t,n,r,o,i,a){wk(n,r);var s=xk(e,t),u=e.TEXTURE_2D;return ce(e,t,function(){return e.bindTexture(u,s)}),ce(e,t,function(){return e.texParameteri(u,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE)}),ce(e,t,function(){return e.texParameteri(u,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE)}),ce(e,t,function(){return e.texParameteri(u,e.TEXTURE_MIN_FILTER,e.NEAREST)}),ce(e,t,function(){return e.texParameteri(u,e.TEXTURE_MAG_FILTER,e.NEAREST)}),ce(e,t,function(){return e.texImage2D(u,0,o,n,r,0,i,a,null)}),ce(e,t,function(){return e.bindTexture(e.TEXTURE_2D,null)}),s}function wD(e,t,n,r,o){var i=kc(n,r);return Xs(e,t,i[0],i[1],o.internalFormatFloat,o.textureFormatFloat,e.FLOAT)}function bD(e,t,n,r,o){var i=kc(n,r);return Xs(e,t,i[0],i[1],o.internalFormatHalfFloat,o.textureFormatFloat,o.textureTypeHalfFloat)}function ED(e,t,n,r,o){var i=kc(n,r);return Xs(e,t,i[0],i[1],e.RGBA,e.RGBA,e.UNSIGNED_BYTE)}function CD(e,t,n,r,o){var i=Ks(n,r);return Xs(e,t,i[0],i[1],o.internalFormatPackedFloat,e.RGBA,e.FLOAT)}function _D(e,t,n,r,o){var i=Ks(n,r);return Xs(e,t,i[0],i[1],o.internalFormatPackedHalfFloat,e.RGBA,o.textureTypeHalfFloat)}function SD(e,t,n,r){return ce(e,t,function(){return e.bindBuffer(e.ARRAY_BUFFER,r)}),Bg(e,t,n,"clipSpacePos",r,3,20,0)&&Bg(e,t,n,"uv",r,2,20,12)}function RD(e,t,n,r,o,i,a){var s,u,l;ce(e,t,function(){return e.bindTexture(e.TEXTURE_2D,n)}),i instanceof Uint8Array?(s=new Uint8Array(r*o*4),u=e.UNSIGNED_BYTE,l=e.RGBA):(s=new Float32Array(r*o*4),u=e.FLOAT,l=a.internalFormatPackedFloat),s.set(i),ce(e,t,function(){return e.texImage2D(e.TEXTURE_2D,0,l,r,o,0,e.RGBA,u,s)}),ce(e,t,function(){return e.bindTexture(e.TEXTURE_2D,null)})}function kD(e,t,n,r){ce(e,t,function(){return e.bindTexture(e.TEXTURE_2D,n)}),r.data instanceof Uint8Array?ce(e,t,function(){return e.texImage2D(e.TEXTURE_2D,0,e.RGBA,r.width,r.height,0,e.RGBA,e.UNSIGNED_BYTE,r.data)}):ce(e,t,function(){return e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,r)}),ce(e,t,function(){return e.bindTexture(e.TEXTURE_2D,null)})}function ID(e,t,n,r,o){var i=e.createBuffer();ce(e,t,function(){return e.bindBuffer(e.PIXEL_PACK_BUFFER,i)});var a=16*n*r;return ce(e,t,function(){return e.bufferData(e.PIXEL_PACK_BUFFER,a,e.STREAM_READ)}),ce(e,t,function(){return e.readPixels(0,0,r,n,e.RGBA,e.FLOAT,0)}),ce(e,t,function(){return e.bindBuffer(e.PIXEL_PACK_BUFFER,null)}),i}function DD(e,t,n){var r=e,o=new Float32Array(n);return r.bindBuffer(r.PIXEL_PACK_BUFFER,t),r.getBufferSubData(r.PIXEL_PACK_BUFFER,0,o),r.bindBuffer(r.PIXEL_PACK_BUFFER,null),o}function TD(e,t,n,r,o){var i=kc(n,r),a=i[0],s=i[1],u=new Uint8Array(n*r*4);return ce(e,t,function(){return e.readPixels(0,0,a,s,o.downloadTextureFormat,e.UNSIGNED_BYTE,u)}),new Float32Array(u.buffer)}function ND(e,t,n,r,o,i,a,s){var u=e,l=new Float32Array(function(c,f){var d=Ks(c,f);return d[0]*d[1]*4}(i,a));return u.bindBuffer(u.PIXEL_PACK_BUFFER,t),u.getBufferSubData(u.PIXEL_PACK_BUFFER,0,l),u.bindBuffer(u.PIXEL_PACK_BUFFER,null),l}function AD(e,t,n,r){var o=new Float32Array(n*r*4);return ce(e,t,function(){return e.readPixels(0,0,r,n,e.RGBA,e.FLOAT,o)}),o}var PD=function(){function e(t){this.outputTexture=null,this.program=null,this.disposed=!1,this.vertexAttrsAreBound=!1,this.itemsToPoll=[];var n=G().getNumber("WEBGL_VERSION");t!=null?(this.gl=t,sk(n,t)):this.gl=Dr(n);var r="WEBGL_color_buffer_float";if(G().getNumber("WEBGL_VERSION")===1){if(this.textureFloatExtension=ku(this.gl,this.debug,"OES_texture_float"),jn(this.gl,"OES_texture_half_float"))this.textureHalfFloatExtension=ku(this.gl,this.debug,"OES_texture_half_float");else if(G().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support half float textures, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.");if(this.colorBufferFloatExtension=this.gl.getExtension(r),jn(this.gl,"EXT_color_buffer_half_float"))this.colorBufferHalfFloatExtension=ku(this.gl,this.debug,"EXT_color_buffer_half_float");else if(G().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support color renderable half floats, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.")}else if(r="EXT_color_buffer_float",jn(this.gl,r))this.colorBufferFloatExtension=this.gl.getExtension(r);else{if(!jn(this.gl,"EXT_color_buffer_half_float"))throw new Error("GL context does not support color renderable floats");this.colorBufferHalfFloatExtension=this.gl.getExtension("EXT_color_buffer_half_float")}this.vertexBuffer=yD(this.gl,this.debug),this.indexBuffer=xD(this.gl,this.debug),this.framebuffer=bk(this.gl,this.debug),this.textureConfig=Np(this.gl,this.textureHalfFloatExtension)}return Object.defineProperty(e.prototype,"debug",{get:function(){return G().getBool("DEBUG")},enumerable:!0,configurable:!0}),e.prototype.dispose=function(){var t=this;if(!this.disposed){this.program!=null&&console.warn("Disposing a GPGPUContext that still has a bound WebGLProgram. This is probably a resource leak, delete the program with GPGPUContext.deleteProgram before disposing."),this.outputTexture!=null&&console.warn("Disposing a GPGPUContext that still has a bound output matrix texture.  This is probably a resource leak, delete the output matrix texture with GPGPUContext.deleteMatrixTexture before disposing.");var n=this.gl;ce(n,this.debug,function(){return n.finish()}),ce(n,this.debug,function(){return n.bindFramebuffer(n.FRAMEBUFFER,null)}),ce(n,this.debug,function(){return n.deleteFramebuffer(t.framebuffer)}),ce(n,this.debug,function(){return n.bindBuffer(n.ARRAY_BUFFER,null)}),ce(n,this.debug,function(){return n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,null)}),ce(n,this.debug,function(){return n.deleteBuffer(t.indexBuffer)}),this.disposed=!0}},e.prototype.createFloat32MatrixTexture=function(t,n){return this.throwIfDisposed(),wD(this.gl,this.debug,t,n,this.textureConfig)},e.prototype.createFloat16MatrixTexture=function(t,n){return this.throwIfDisposed(),bD(this.gl,this.debug,t,n,this.textureConfig)},e.prototype.createUnsignedBytesMatrixTexture=function(t,n){return this.throwIfDisposed(),ED(this.gl,this.debug,t,n,this.textureConfig)},e.prototype.uploadPixelDataToTexture=function(t,n){this.throwIfDisposed(),kD(this.gl,this.debug,t,n)},e.prototype.uploadDenseMatrixToTexture=function(t,n,r,o){this.throwIfDisposed(),RD(this.gl,this.debug,t,n,r,o,this.textureConfig)},e.prototype.createFloat16PackedMatrixTexture=function(t,n){return this.throwIfDisposed(),_D(this.gl,this.debug,t,n,this.textureConfig)},e.prototype.createPackedMatrixTexture=function(t,n){return this.throwIfDisposed(),CD(this.gl,this.debug,t,n,this.textureConfig)},e.prototype.deleteMatrixTexture=function(t){var n=this;this.throwIfDisposed(),this.outputTexture===t&&(Ug(this.gl,this.debug,this.framebuffer),this.outputTexture=null),ce(this.gl,this.debug,function(){return n.gl.deleteTexture(t)})},e.prototype.downloadByteEncodedFloatMatrixFromOutputTexture=function(t,n,r){var o=this;return this.downloadMatrixDriver(t,function(){return TD(o.gl,o.debug,n,r,o.textureConfig)})},e.prototype.downloadPackedMatrixFromBuffer=function(t,n,r,o,i,a){return ND(this.gl,t,0,0,0,i,a,this.textureConfig)},e.prototype.downloadFloat32MatrixFromBuffer=function(t,n){return DD(this.gl,t,n)},e.prototype.createBufferFromTexture=function(t,n,r){this.bindTextureToFrameBuffer(t);var o=ID(this.gl,this.debug,n,r,this.textureConfig);return this.unbindTextureToFrameBuffer(),o},e.prototype.createAndWaitForFence=function(){var t=this.createFence(this.gl);return this.pollFence(t)},e.prototype.createFence=function(t){var n,r,o=this;if(G().getBool("WEBGL_FENCE_API_ENABLED")){var i=t,a=i.fenceSync(i.SYNC_GPU_COMMANDS_COMPLETE,0);t.flush(),r=function(){var s=i.clientWaitSync(a,0,0);return s===i.ALREADY_SIGNALED||s===i.CONDITION_SATISFIED},n=a}else G().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0?(n=this.beginQuery(),this.endQuery(),r=function(){return o.isQueryAvailable(n,G().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))}):r=function(){return!0};return{query:n,isFencePassed:r}},e.prototype.downloadMatrixFromPackedTexture=function(t,n,r){var o=this;return this.downloadMatrixDriver(t,function(){return AD(o.gl,o.debug,n,r)})},e.prototype.createProgram=function(t){this.throwIfDisposed();var n=this.gl,r=hk(n,this.debug,t),o=gD(n,this.debug),i=vk(n,this.debug);return ce(n,this.debug,function(){return n.attachShader(i,o)}),ce(n,this.debug,function(){return n.attachShader(i,r)}),mk(n,this.debug,i),this.debug&&Af(n,this.debug,i),this.vertexAttrsAreBound||(this.setProgram(i),this.vertexAttrsAreBound=SD(n,this.debug,this.program,this.vertexBuffer)),i},e.prototype.deleteProgram=function(t){var n=this;this.throwIfDisposed(),t===this.program&&(this.program=null),t!=null&&ce(this.gl,this.debug,function(){return n.gl.deleteProgram(t)})},e.prototype.setProgram=function(t){var n=this;this.throwIfDisposed(),this.program=t,this.program!=null&&this.debug&&Af(this.gl,this.debug,this.program),ce(this.gl,this.debug,function(){return n.gl.useProgram(t)})},e.prototype.getUniformLocation=function(t,n,r){return r===void 0&&(r=!0),this.throwIfDisposed(),r?Ck(this.gl,this.debug,t,n):_k(this.gl,t,n)},e.prototype.getAttributeLocation=function(t,n){var r=this;return this.throwIfDisposed(),ce(this.gl,this.debug,function(){return r.gl.getAttribLocation(t,n)})},e.prototype.getUniformLocationNoThrow=function(t,n){return this.throwIfDisposed(),this.gl.getUniformLocation(t,n)},e.prototype.setInputMatrixTexture=function(t,n,r){this.throwIfDisposed(),this.throwIfNoProgram(),Sk(this.gl,this.debug,this.program,t,n,r)},e.prototype.setOutputMatrixTexture=function(t,n,r){this.setOutputMatrixTextureDriver(t,r,n)},e.prototype.setOutputPackedMatrixTexture=function(t,n,r){this.throwIfDisposed();var o=Ks(n,r),i=o[0],a=o[1];this.setOutputMatrixTextureDriver(t,i,a)},e.prototype.setOutputMatrixWriteRegion=function(t,n,r,o){this.setOutputMatrixWriteRegionDriver(r,t,o,n)},e.prototype.setOutputPackedMatrixWriteRegion=function(t,n,r,o){throw new Error("setOutputPackedMatrixWriteRegion not implemented.")},e.prototype.debugValidate=function(){this.program!=null&&Af(this.gl,this.debug,this.program),Iu(this.gl)},e.prototype.executeProgram=function(){this.throwIfDisposed(),this.throwIfNoProgram();var t=this.gl;this.debug&&this.debugValidate(),ce(t,this.debug,function(){return t.drawElements(t.TRIANGLES,6,t.UNSIGNED_SHORT,0)})},e.prototype.blockUntilAllProgramsCompleted=function(){var t=this;this.throwIfDisposed(),ce(this.gl,this.debug,function(){return t.gl.finish()})},e.prototype.getQueryTimerExtension=function(){return this.disjointQueryTimerExtension==null&&(this.disjointQueryTimerExtension=ku(this.gl,this.debug,G().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2?"EXT_disjoint_timer_query_webgl2":"EXT_disjoint_timer_query")),this.disjointQueryTimerExtension},e.prototype.getQueryTimerExtensionWebGL2=function(){return this.getQueryTimerExtension()},e.prototype.getQueryTimerExtensionWebGL1=function(){return this.getQueryTimerExtension()},e.prototype.beginQuery=function(){if(G().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2){var t=this.gl,n=this.getQueryTimerExtensionWebGL2(),r=t.createQuery();return t.beginQuery(n.TIME_ELAPSED_EXT,r),r}var o=this.getQueryTimerExtensionWebGL1(),i=o.createQueryEXT();return o.beginQueryEXT(o.TIME_ELAPSED_EXT,i),i},e.prototype.endQuery=function(){if(G().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")!==2){var t=this.getQueryTimerExtensionWebGL1();t.endQueryEXT(t.TIME_ELAPSED_EXT)}else{var n=this.gl,r=this.getQueryTimerExtensionWebGL2();n.endQuery(r.TIME_ELAPSED_EXT)}},e.prototype.waitForQueryAndGetTime=function(t){return se(this,void 0,void 0,function(){var n=this;return ue(this,function(r){switch(r.label){case 0:return[4,Ag(function(){return n.disposed||n.isQueryAvailable(t,G().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))})];case 1:return r.sent(),[2,this.getQueryTime(t,G().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))]}})})},e.prototype.getQueryTime=function(t,n){if(n===0)return null;if(n===2){var r=this.gl;return r.getQueryParameter(t,r.QUERY_RESULT)/1e6}var o=this.getQueryTimerExtensionWebGL1();return o.getQueryObjectEXT(t,o.QUERY_RESULT_EXT)/1e6},e.prototype.isQueryAvailable=function(t,n){if(n===0)return!0;if(n===2){var r=this.gl,o=this.getQueryTimerExtensionWebGL2(),i=r.getQueryParameter(t,r.QUERY_RESULT_AVAILABLE);return this.disjoint==null&&(this.disjoint=this.gl.getParameter(o.GPU_DISJOINT_EXT)),i&&!this.disjoint}return i=(o=this.getQueryTimerExtensionWebGL1()).getQueryObjectEXT(t,o.QUERY_RESULT_AVAILABLE_EXT),this.disjoint==null&&(this.disjoint=this.gl.getParameter(o.GPU_DISJOINT_EXT)),i&&!this.disjoint},e.prototype.pollFence=function(t){var n=this;return new Promise(function(r){n.addItemToPoll(function(){return t.isFencePassed()},function(){return r()})})},e.prototype.pollItems=function(){for(var t=function(r){for(var o=0;o<r.length&&r[o]();++o);return o-1}(this.itemsToPoll.map(function(r){return r.isDoneFn})),n=0;n<=t;++n)(0,this.itemsToPoll[n].resolveFn)();this.itemsToPoll=this.itemsToPoll.slice(t+1)},e.prototype.addItemToPoll=function(t,n){var r=this;this.itemsToPoll.push({isDoneFn:t,resolveFn:n}),this.itemsToPoll.length>1||Ag(function(){return r.pollItems(),r.itemsToPoll.length===0})},e.prototype.bindTextureToFrameBuffer=function(t){this.throwIfDisposed(),Pf(this.gl,this.debug,t,this.framebuffer),this.debug&&Iu(this.gl)},e.prototype.unbindTextureToFrameBuffer=function(){this.outputTexture!=null?(Pf(this.gl,this.debug,this.outputTexture,this.framebuffer),this.debug&&Iu(this.gl)):Ug(this.gl,this.debug,this.framebuffer)},e.prototype.downloadMatrixDriver=function(t,n){this.bindTextureToFrameBuffer(t);var r=n();return this.unbindTextureToFrameBuffer(),r},e.prototype.setOutputMatrixTextureDriver=function(t,n,r){this.throwIfDisposed();var o=this.gl;Pf(o,this.debug,t,this.framebuffer),this.debug&&Iu(o),this.outputTexture=t,ce(o,this.debug,function(){return o.viewport(0,0,n,r)}),ce(o,this.debug,function(){return o.scissor(0,0,n,r)})},e.prototype.setOutputMatrixWriteRegionDriver=function(t,n,r,o){var i=this;this.throwIfDisposed(),ce(this.gl,this.debug,function(){return i.gl.scissor(t,n,r,o)})},e.prototype.throwIfDisposed=function(){if(this.disposed)throw new Error("Attempted to use disposed GPGPUContext.")},e.prototype.throwIfNoProgram=function(){if(this.program==null)throw new Error("No GPU program is currently set.")},e}();function Jg(e,t){if(e.length!==t.length)throw Error("Binary was compiled with "+e.length+" inputs, but was executed with "+t.length+" inputs");e.forEach(function(n,r){var o=n.logicalShape,i=t[r],a=i.shape;if(!Ft(o,a))throw Error("Binary was compiled with different shapes than the current args. Shapes "+o+" and "+a+" must match");if(!n.isUniform||!i.isUniform){var s=n.texShape,u=i.isUniform?null:i.texData.texShape;if(!Ft(s,u))throw Error("Binary was compiled with different texture shapes than the current args. Shape "+s+" and "+u+" must match")}})}var FD=function(e,t,n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e;for(var r=n.filterWidth,o=n.inChannels,i=n.strideWidth,a=n.strideHeight,s=n.padInfo,u=n.outWidth,l=n.dilationWidth,c=n.dilationHeight,f=n.dataFormat,d=s.left,h=s.top,p=o*r,v=Xt(),g=f==="channelsLast",m=g?0:1,y=g?1:2,x="",w=0;w<=1;w++)for(var E=0;E<=1;E++)x+=`
          blockIndex = rc.y + `+E+`;
          pos = rc.x + `+w+`;

          if(blockIndex < `+e[1]+" && pos < "+e[0]+`) {
            offsetY = int(blockIndex / (`+u+")) * "+a+" - "+h+`;
            d0 = offsetY + `+c+" * (pos / "+p+`);

            if(d0 < `+t[m]+` && d0 >= 0) {

              offsetX = int(mod(float(blockIndex), `+u+".) * "+i+". - "+d+`.);
              d1 = offsetX + `+l+" * (int(mod(float(pos), "+p+".) / "+o+`.));

              if(d1 < `+t[y]+` && d1 >= 0) {

                ch = int(mod(float(pos), `+o+`.));

                if (`+g+`) {
                  innerDims = vec2(d1, ch);
                  result[`+(2*w+E)+`] = getChannel(
                    getA(d0, int(innerDims.x),
                    int(innerDims.y)), innerDims);
                } else {
                  innerDims = vec2(d0, d1);
                  result[`+(2*w+E)+`] = getChannel(
                    getA(ch, int(innerDims.x),
                    int(innerDims.y)), innerDims);
                }
              }
            }
          }
        `;this.userCode=`
      void main() {
        ivec2 rc = getOutputCoords();

        vec4 result = vec4(0);

        int blockIndex, pos, offsetY, d0, offsetX, d1, ch;
        vec2 innerDims;

        `+x+`

        `+v.output+` = result;
      }
    `},MD=function(e,t,n,r,o){this.variableNames=["x"],this.outputShape=[];var i,a=t,s=e[3]-1;this.outputShape=e;var u="float("+n+") + float("+r+") * sum";i=o===.5?"inversesqrt("+u+")":o===1?"1.0/("+u+")":"exp(log("+u+") * float(-"+o+"));",this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int r = coords[1];
        int c = coords[2];
        int d = coords[3];
        float x = getX(b, r, c, d);
        float sum = 0.0;
        for (int j = -`+a+"; j <= "+a+`; j++) {
          int idx = d + j;
          if (idx >= 0 && idx <=  `+s+`) {
            float z = getX(b, r, c, idx);
            sum += z * z;
          }
        }
        float val = x * `+i+`;
        setOutput(val);
      }
    `},OD=function(e,t,n,r,o){this.variableNames=["inputImage","outputImage","dy"],this.outputShape=[],this.outputShape=e,this.depth=e[3],this.depthRadius=t,this.bias=n,this.alpha=r,this.beta=o,this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int r = coords[1];
        int c = coords[2];

        float result = 0.0;
        for (int d = 0; d < `+this.depth+`; ++d) {
          int depthBegin = int(max(0.0, float(d - `+t+`)));
          int depthEnd = int(min(float(`+this.depth+`),
              float(d + `+t+` + 1)));

          const int MIN_DEPTH_BEGIN = 0;
          const int MAX_DEPTH_END = `+this.depth+`;

          float norm = 0.0;
          for (int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k) {
            if (k < depthBegin){
              continue;
            }
            else if (k >= depthBegin && k < depthEnd) {
              norm += getInputImage(b, r, c, k) * getInputImage(b, r, c, k);
            }
            else {
              break;
            }
          }

          norm = float(`+r+") * norm + float("+n+`);

          for(int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k){
            if (k < depthBegin){
              continue;
            }
            else if (k >= depthBegin && k < depthEnd){
              float dyi = -2.0 * float(`+r+`)
                * float(`+o+`)
                * getInputImage(b ,r ,c, k) * getOutputImage(b, r, c, d)
                / norm;
              if (k == d) {
                dyi += pow(norm, -1.0 * `+o+`);
              }
              if (k == coords[3]) {
                dyi *= getDy(b, r, c, d);
                result += dyi;
              }
            }
            else {
              break;
            }
          }
      }
      setOutput(result);
      }
    `},LD=function(e,t,n,r,o){this.variableNames=["x"],this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0;var i,a=t,s=e[3]-1;this.outputShape=e;var u="float("+n+") + float("+r+") * sum";i=o===.5?"inversesqrt("+u+")":o===1?"1.0/("+u+")":"exp(log("+u+") * float(-"+o+"));",this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords.x;
        int r = coords.y;
        int c = coords.z;
        int d = coords.w;

        bool hasNextCol = d < `+this.outputShape[3]+`;
        bool hasNextRow = c < `+this.outputShape[2]+`;

        vec4 sum = vec4(0.);
        vec4 xFragAtOutputCoords = getX(b, r, c, d);

        vec4 xAtOutputCoords = vec4(
          getChannel(xFragAtOutputCoords, vec2(c, d)),
          hasNextCol ?
            getChannel(xFragAtOutputCoords, vec2(c, d + 1)) : 0.0,
          hasNextRow ?
            getChannel(xFragAtOutputCoords , vec2(c + 1, d)) : 0.0,
          (hasNextRow && hasNextCol) ?
            getChannel(xFragAtOutputCoords, vec2(c + 1, d + 1)) : 0.0
        );

        int firstChannel = d - `+a+`;
        vec2 cache = vec2(0.);
        if(firstChannel >= 0){
          vec4 firstChannelFrag = getX(b, r, c, firstChannel);
          cache.x = getChannel(firstChannelFrag, vec2(c, firstChannel));
            if(hasNextRow){
              cache.y = getChannel(firstChannelFrag, vec2(c + 1, firstChannel));
            }
        }

        ivec2 depth = ivec2(d, d + 1);
        for (int j = - `+a+"; j <= "+a+`; j++) {
          ivec2 idx = depth + j;
          bvec2 aboveLowerBound = greaterThanEqual(idx, ivec2(0));
          bvec2 belowUpperBound = lessThanEqual(idx, ivec2(`+s+`));

          bool depthInRange = aboveLowerBound.x && belowUpperBound.x;
          bool depthPlusOneInRange = aboveLowerBound.y && belowUpperBound.y;

          if(depthInRange || depthPlusOneInRange){
            vec4 z = vec4(0.);
            vec4 xFragAtCurrentDepth;
            z.xz = cache.xy;
            if(depthPlusOneInRange && hasNextCol){
              xFragAtCurrentDepth = idx.y != d ?
                getX(b, r, c, idx.y) : xFragAtOutputCoords;
              z.y = getChannel(xFragAtCurrentDepth, vec2(c, idx.y));
              if(hasNextRow){
                z.w = getChannel(xFragAtCurrentDepth, vec2(c + 1, idx.y));
              }
            }
            cache.xy = z.yw;
            sum += z * z;
          }
        }
        vec4 result = xAtOutputCoords * `+i+`;
        setOutput(result);
      }
    `},BD=function(e){this.variableNames=["dy","maxPos"],this.outputShape=e.inShape;var t=e.strideHeight,n=e.strideWidth,r=e.dilationHeight,o=e.effectiveFilterHeight,i=e.effectiveFilterWidth,a=o-1-e.padInfo.top,s=i-1-e.padInfo.left,u=o*i-1;this.userCode=`
      const ivec2 pads = ivec2(`+a+", "+s+`);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];

        ivec2 dyRCCorner = coords.yz - pads;
        int dyRCorner = dyRCCorner.x;
        int dyCCorner = dyRCCorner.y;

        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < `+o+`;
          wR += `+r+`) {
          float dyR = float(dyRCorner + wR) / `+t+`.0;

          if (dyR < 0.0 || dyR >= `+e.outHeight+`.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          for (int wC = 0; wC < `+i+`; wC++) {
            float dyC = float(dyCCorner + wC) / `+n+`.0;

            if (dyC < 0.0 || dyC >= `+e.outWidth+`.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            float dyValue = getDy(b, idyR, idyC, d);
            int maxPosValue = `+u+` - int(getMaxPos(b, idyR, idyC, d));

            // Get the current value, check it against the value from the
            // position matrix.
            int curPosValue = wR * `+i+` + wC;
            float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);

            dotProd += dyValue * mask;
          }
        }
        setOutput(dotProd);
      }
    `},UD=function(e){this.variableNames=["dy","maxPos"],this.outputShape=e.inShape;var t=e.strideDepth,n=e.strideHeight,r=e.strideWidth,o=e.dilationDepth,i=e.dilationHeight,a=e.dilationWidth,s=e.effectiveFilterDepth,u=e.effectiveFilterHeight,l=e.effectiveFilterWidth,c=s-1-e.padInfo.front,f=u-1-e.padInfo.top,d=l-1-e.padInfo.left,h=s*u*l-1;this.userCode=`
      const ivec3 pads = ivec3(`+c+", "+f+", "+d+`);

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyDCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        // Convolve dy(?, ?, ?, ch) with pos mask(:, :, :, d) to get
        // dx(xD, xR, xC, ch).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int wD = 0; wD < `+s+`;
           wD += `+o+`) {
          float dyD = float(dyDCorner + wD) / `+t+`.0;

          if (dyD < 0.0 || dyD >= `+e.outDepth+`.0 || fract(dyD) > 0.0) {
            continue;
          }
          int idyD = int(dyD);

          for (int wR = 0; wR < `+u+`;
              wR += `+i+`) {
            float dyR = float(dyRCorner + wR) / `+n+`.0;

            if (dyR < 0.0 || dyR >= `+e.outHeight+`.0 ||
                fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            for (int wC = 0; wC < `+l+`;
                wC += `+a+`) {
              float dyC = float(dyCCorner + wC) / `+r+`.0;

              if (dyC < 0.0 || dyC >= `+e.outWidth+`.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              float dyValue = getDy(batch, idyD, idyR, idyC, ch);
              int maxPosValue = `+h+` -
                  int(getMaxPos(batch, idyD, idyR, idyC, ch));

              // Get the current value, check it against the value from the
              // position matrix.
              int curPosValue =
                  wD * `+u+" * "+l+` +
                  wR * `+l+` + wC;
              float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);

              dotProd += dyValue * mask;
            }
          }
        }
        setOutput(dotProd);
      }
    `},Bf=function(e,t,n,r,o,i,a){n===void 0&&(n=!1),r===void 0&&(r=!1),o===void 0&&(o=!1),i===void 0&&(i=null),a===void 0&&(a=!1),this.variableNames=["matrixA","matrixB"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t;var s=n?e[1]:e[2],u=Math.ceil(s/2),l=n?"i * 2, rc.y":"rc.y, i * 2",c=r?"rc.z, i * 2":"i * 2, rc.z",f=n?["a.xxyy","a.zzww"]:["a.xxzz","a.yyww"],d=r?["b.xzxz","b.ywyw"]:["b.xyxy","b.zwzw"],h="",p="";i&&(h=a?`vec4 activation(vec4 a) {
          vec4 b = getPreluActivationWeightsAtOutCoords();
          `+i+`
        }`:`vec4 activation(vec4 x) {
          `+i+`
        }`,p="result = activation(result);");var v=o?"result += getBiasAtOutCoords();":"";o&&this.variableNames.push("bias"),a&&this.variableNames.push("preluActivationWeights"),this.userCode=`
      `+h+`

      const float sharedDimension = `+u+`.0;

      vec4 dot2x2ARowBCol(ivec3 rc) {
        vec4 result = vec4(0);
        for (int i = 0; i < `+u+`; i++) {
          vec4 a = getMatrixA(rc.x, `+l+`);
          vec4 b = getMatrixB(rc.x, `+c+`);

          // These swizzled products need to be separately added.
          // See: https://github.com/tensorflow/tfjs/issues/1735
          result += (`+f[0]+" * "+d[0]+`);
          result += (`+f[1]+" * "+d[1]+`);
        }
        return result;
      }

      void main() {
        ivec3 rc = getOutputCoords();
        vec4 result = dot2x2ARowBCol(rc);

        `+v+`

        `+p+`

        setOutput(result);
      }
    `},WD=function(){function e(t,n,r){this.variableNames=["probs"],this.outputShape=[t,r],this.userCode=`
      uniform float seed;

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];

        float r = random(seed);
        float cdf = 0.0;

        for (int i = 0; i < `+(n-1)+`; i++) {
          cdf += getProbs(batch, i);

          if (r < cdf) {
            setOutput(float(i));
            return;
          }
        }

        // If no other event happened, last event happened.
        setOutput(float(`+(n-1)+`));
      }
    `}return e.prototype.getCustomSetupFunc=function(t){var n=this;return function(r,o){n.seedLoc==null&&(n.seedLoc=r.getUniformLocation(o,"seed")),r.gl.uniform1f(n.seedLoc,t)}},e}(),zD=function(e,t,n,r){this.variableNames=["indices"],this.outputShape=[e,t],this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int index = round(getIndices(coords.x));
        setOutput(mix(float(`+r+"), float("+n+`),
                      float(index == coords.y)));
      }
    `},jD=function(e){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outputShape=e;var t=e.length;if(t===0)this.userCode=`
        void main() {
          setOutput(vec4(getA(), 0., 0., 0.));
        }
      `;else{var n=ln("rc",t),r=Ye(t),o=function(s,u,l){if(s===1)return"rc > "+u[0];for(var c="",f=s-2;f<s;f++)c+=l[f]+" >= "+u[f],f<s-1&&(c+="||");return c}(t,e,n),i=function(s,u,l,c){if(s===1)return"";var f=c.slice(-2);return`
    int r = `+f[0]+`;
    int c = `+f[1]+`;
    int rp1 = r + 1;
    int cp1 = c + 1;

    bool cEdge = cp1 >= `+u+`;
    bool rEdge = rp1 >= `+l+`;
  `}(t,e[e.length-1],e[e.length-2],n),a=function(s,u){var l=s.length,c=function(f,d){for(var h=[],p=0;p<=1;p++)for(var v=0;v<=1;v++){for(var g=(p===0?"r":"rp1")+", "+(v===0?"c":"cp1"),m=2;m<f;m++)g=d[d.length-1-m]+","+g;h.push(g)}return h}(l,u);return l===1?`getA(rc),
            rc + 1 >= `+s[0]+` ? 0. : getA(rc + 1),
            0, 0`:"getA("+c[0]+`),
          cEdge ? 0. : getA(`+c[1]+`),
          rEdge ? 0. : getA(`+c[2]+`),
          rEdge || cEdge ? 0. : getA(`+c[3]+")"}(e,n);this.userCode=`
        void main() {
          `+r+` rc = getOutputCoords();

          if(`+o+`) {
            setOutput(vec4(0));
          } else {
            `+i+`

            setOutput(vec4(`+a+`));
          }
        }
      `}},VD=function(e,t,n){this.variableNames=["x"],this.outputShape=t.map(function(u,l){return u[0]+e[l]+u[1]});var r=e.length,o=Ye(r),i=t.map(function(u){return u[0]}).join(","),a=t.map(function(u,l){return u[0]+e[l]}).join(","),s=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,r);this.userCode=r!==1?`
      `+o+" start = "+o+"("+i+`);
      `+o+" end = "+o+"("+a+`);

      void main() {
        `+o+` outC = getOutputCoords();
        if (any(lessThan(outC, start)) || any(greaterThanEqual(outC, end))) {
          setOutput(float(`+n+`));
        } else {
          `+o+` coords = outC - start;
          setOutput(getX(`+s+`));
        }
      }
    `:`
        int start = `+i+`;
        int end = `+a+`;

        void main() {
          int outC = getOutputCoords();
          if (outC < start || outC >= end) {
            setOutput(float(`+n+`));
          } else {
            setOutput(getX(outC - start));
          }
        }
      `},$D=function(e,t,n){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t.map(function(g,m){return g[0]+e[m]+g[1]});for(var r=e.length,o=Ye(r),i=t.map(function(g){return g[0]}).join(","),a=t.map(function(g,m){return g[0]+e[m]}).join(","),s=ln("rc",r),u=ln("source",r),l=s[r-1]+" < "+this.outputShape[r-1],c=r===1?"source":"vec2("+u.slice(-2).join()+")",f=[o+" rc = outputLoc;",s[r-1]+` += 1;
       if(`+l+`) {
      `,r===1?"":`}
       rc = outputLoc;
       `+s[r-2]+` += 1;
       if(`+s[r-2]+" < "+this.outputShape[r-2]+") {",r===1?"":"  "+s[r-1]+` += 1;
         if(`+l+") {"],d=r===1?"rc < start || rc >= end":"any(lessThan(rc, start)) || any(greaterThanEqual(rc, end))",h="",p=0,v=r===1?2:4;p<v;p++)h+=`
        `+f[p]+`
        if (`+d+`) {
          result[`+p+"] = float("+n+`);
        } else {
          `+o+` source = rc - start;
          result[`+p+"] = getChannel(getX("+u.join()+"), "+c+`);
        }
      `;h+=r===1?"} ":"}}",this.userCode=`
      const `+o+" start = "+o+"("+i+`);
      const `+o+" end = "+o+"("+a+`);

      void main() {
        `+o+` outputLoc = getOutputCoords();
        vec4 result = vec4(0.);
        `+h+`
        setOutput(result);
      }
    `},Uf=function(e,t,n){if(this.variableNames=["x"],t==="avg"&&n)throw new Error("Cannot compute positions for average pool.");var r=e.filterWidth,o=e.strideHeight,i=e.strideWidth,a=e.dilationHeight,s=e.dilationWidth,u=e.effectiveFilterHeight,l=e.effectiveFilterWidth,c=e.padInfo.top,f=e.padInfo.left;this.outputShape=e.outShape;var d=t==="avg",h="0.0";if(d||(h="-1.0 / 1e-20"),n)this.userCode=`
        const ivec2 strides = ivec2(`+o+", "+i+`);
        const ivec2 pads = ivec2(`+c+", "+f+`);

        void main() {
          ivec4 coords = getOutputCoords();
          int batch = coords[0];
          int d = coords[3];

          ivec2 xRCCorner = coords.yz * strides - pads;
          int xRCorner = xRCCorner.x;
          int xCCorner = xRCCorner.y;

          // max/min x(?, ?, d) to get y(yR, yC, d).
          // ? = to be determined
          float minMaxValue = 0.0;
          float minMaxValueFound = 0.0;
          int minMaxPosition = 0;
          float avgValue = 0.0;

          for (int wR = 0; wR < `+u+`;
              wR += `+a+`) {
            int xR = xRCorner + wR;

            if (xR < 0 || xR >= `+e.inHeight+`) {
              continue;
            }

            for (int wC = 0; wC < `+l+`;
                wC += `+s+`) {
              int xC = xCCorner + wC;

              if (xC < 0 || xC >= `+e.inWidth+`) {
                continue;
              }

              float value = getX(batch, xR, xC, d);

              // If a min / max value has already been found, use it. If not,
              // use the current value.
              float currMinMaxValue = mix(
                  value, minMaxValue, minMaxValueFound);
              if (value >= currMinMaxValue) {
                minMaxValue = value;
                minMaxValueFound = 1.0;
                minMaxPosition = wR * `+l+` + wC;
              }
            }
          }
          setOutput(float(minMaxPosition));
        }
      `;else{var p=t+"("+t+"("+t+"(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";t==="avg"&&(p="avgValue / count");var v=4*Math.floor(r/4),g=r%4,m=`
      if (`+d+`) {
        avgValue += dot(values, ones);
      } else {
        minMaxValue = max(values, minMaxValue);
      }
    `;this.userCode=`
      const ivec2 strides = ivec2(`+o+", "+i+`);
      const ivec2 pads = ivec2(`+c+", "+f+`);
      const float initializationValue = `+h+`;
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float count = 0.0;

      float getValue(int batch, int xR, int xC, int d) {
        if (xC < 0 || xC >= `+e.inWidth+`) {
          return initializationValue;
        }
        count += 1.0;
        return getX(batch, xR, xC, d);
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d = coords[3];

        ivec2 xRCCorner = coords.yz * strides - pads;
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // max/min x(?, ?, d) to get y(yR, yC, d).
        // ? = to be determined
        vec4 minMaxValue = vec4(`+h+`);
        float avgValue = 0.0;
        count = 0.0;

        for (int wR = 0; wR < `+u+`;
            wR += `+a+`) {
          int xR = xRCorner + wR;

          if (xR < 0 || xR >= `+e.inHeight+`) {
            continue;
          }

          for (int wC = 0; wC < `+v+`; wC += 4) {
            int xC = xCCorner + wC * `+s+`;

            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + `+s+`, d),
              getValue(batch, xR, xC + 2 * `+s+`, d),
              getValue(batch, xR, xC + 3 * `+s+`, d)
            );

            `+m+`
          }

          int xC = xCCorner + `+v+`;
          if (`+(g===1)+`) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              initializationValue,
              initializationValue,
              initializationValue
            );

            `+m+`
          } else if (`+(g===2)+`) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + `+s+`, d),
              initializationValue,
              initializationValue
            );

            `+m+`
          } else if (`+(g===3)+`) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + `+s+`, d),
              getValue(batch, xR, xC + 2 * `+s+`, d),
              initializationValue
            );

            `+m+`
          }
        }
        setOutput(`+p+`);
      }
    `}},Wf=function(e,t,n){if(this.variableNames=["x"],t==="avg"&&n)throw new Error("Cannot compute positions for average pool.");var r=e.filterWidth,o=e.strideDepth,i=e.strideHeight,a=e.strideWidth,s=e.dilationDepth,u=e.dilationHeight,l=e.dilationWidth,c=e.effectiveFilterDepth,f=e.effectiveFilterHeight,d=e.effectiveFilterWidth,h=e.padInfo.front,p=e.padInfo.top,v=e.padInfo.left;this.outputShape=e.outShape;var g=t==="avg",m="0.0";if(g||(m="-1.0 / 1e-20"),n)this.userCode=`
        const ivec3 strides =
            ivec3(`+o+", "+i+", "+a+`);
        const ivec3 pads = ivec3(`+h+", "+p+", "+v+`);

        void main() {
          ivec5 coords = getOutputCoords();
          int batch = coords.x;
          int ch = coords.u;

          ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
          int xDCorner = xCorner.x;
          int xRCorner = xCorner.y;
          int xCCorner = xCorner.z;

          // max/min x(?, ?, ?, ch) to get y(yD, yR, yC, ch).
          // ? = to be determined
          float minMaxValue = 0.0;
          float minMaxValueFound = 0.0;
          int minMaxPosition = 0;

          for (int wD = 0; wD < `+c+`;
              wD += `+s+`) {
            int xD = xDCorner + wD;

            if (xD < 0 || xD >= `+e.inDepth+`) {
              continue;
            }

            for (int wR = 0; wR < `+f+`;
                wR += `+u+`) {
              int xR = xRCorner + wR;

              if (xR < 0 || xR >= `+e.inHeight+`) {
                continue;
              }

              for (int wC = 0; wC < `+d+`;
                  wC += `+l+`) {
                int xC = xCCorner + wC;

                if (xC < 0 || xC >= `+e.inWidth+`) {
                  continue;
                }

                float value = getX(batch, xD, xR, xC, ch);

                // If a min / max value has already been found, use it. If not,
                // use the current value.
                float currMinMaxValue = mix(
                    value, minMaxValue, minMaxValueFound);
                if (value >= currMinMaxValue) {
                  minMaxValue = value;
                  minMaxValueFound = 1.0;
                  minMaxPosition =
                      wD * `+f+" * "+d+` +
                      wR * `+d+` + wC;;
                }
              }
            }
          }
          setOutput(float(minMaxPosition));
        }
      `;else{var y=t+"("+t+"("+t+"(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";t==="avg"&&(y="avgValue / count");var x=4*Math.floor(r/4),w=r%4,E=`
      if (`+g+`) {
        avgValue += dot(values, ones);
      } else {
        minMaxValue = max(values, minMaxValue);
      }
    `;this.userCode=`
      const ivec3 strides =
        ivec3(`+o+", "+i+", "+a+`);
      const ivec3 pads = ivec3(`+h+", "+p+", "+v+`);
      const float initializationValue = `+m+`;
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float count = 0.0;

      float getValue(int batch, int xD, int xR, int xC, int ch) {
        if (xC < 0 || xC >= `+e.inWidth+`) {
          return initializationValue;
        }
        count += 1.0;
        return getX(batch, xD, xR, xC, ch);
      }

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
        int xDCorner = xCorner.x;
        int xRCorner = xCorner.y;
        int xCCorner = xCorner.z;

        // max/min x(?, ?, ?, d) to get y(yD, yR, yC, ch).
        // ? = to be determined
        vec4 minMaxValue = vec4(`+m+`);
        float avgValue = 0.0;
        count = 0.0;

        for (int wD = 0; wD < `+c+`;
            wD += `+s+`) {
          int xD = xDCorner + wD;

          if (xD < 0 || xD >= `+e.inDepth+`) {
            continue;
          }

          for (int wR = 0; wR < `+f+`;
            wR += `+u+`) {
            int xR = xRCorner + wR;

            if (xR < 0 || xR >= `+e.inHeight+`) {
              continue;
            }

            for (int wC = 0; wC < `+x+`; wC += 4) {
              int xC = xCCorner + wC * `+l+`;

              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + `+l+`, ch),
                getValue(batch, xD, xR, xC + 2 * `+l+`, ch),
                getValue(batch, xD, xR, xC + 3 * `+l+`, ch)
              );

              `+E+`
            }

            int xC = xCCorner + `+x+`;
            if (`+(w===1)+`) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                initializationValue,
                initializationValue,
                initializationValue
              );

              `+E+`
            } else if (`+(w===2)+`) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + `+l+`, ch),
                initializationValue,
                initializationValue
              );

              `+E+`
            } else if (`+(w===3)+`) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + `+l+`, ch),
                getValue(batch, xD, xR, xC + 2 * `+l+`, ch),
                initializationValue
              );

              `+E+`
            }
          }
          setOutput(`+y+`);
        }
      }
    `}},HD=function(e,t){this.variableNames=["x"];var n=e.windowSize,r=e.batchSize,o=e.inSize,i=Math.ceil(o/n);this.outputShape=[r,i];var a="0.0",s="";t==="prod"?a="1.0":t==="min"?(a="1.0 / 1e-20",s="min"):t==="max"&&(a="-1.0 / 1e-20",s="max");var u=t+"("+t+"("+t+"(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";t==="sum"?u="sumValue":t==="prod"?u="prodValue":t==="all"?u="allValue":t==="any"&&(u="anyValue");var l=4*Math.floor(n/4),c=n%4,f=`
      if (`+(t==="sum")+`) {
        sumValue += dot(values, ones);
      } else if (`+(t==="prod")+`) {
        vec2 tmp = vec2(values[0], values[1]) * vec2(values[2], values[3]);
        prodValue *= tmp[0] * tmp[1];
      } else {
        minMaxValue = `+s+`(values, minMaxValue);
      }
    `,d="vec4";t==="all"?(a="1.0",f=`
        bool reducedAllValue = all(values);
        float floatedReducedAllValue = float(reducedAllValue);
        allValue = float(allValue >= 1.0 && floatedReducedAllValue >= 1.0);
      `,d="bvec4"):t==="any"&&(a="0.0",f=`
        bool reducedAnyValue = any(values);
        float floatedReducedAnyValue = float(reducedAnyValue);
        anyValue = float(anyValue >= 1.0 || floatedReducedAnyValue >= 1.0);
      `,d="bvec4");var h="";o%n>0&&(h=`
        if (inIdx < 0 || inIdx >= `+o+`) {
          return initializationValue;
        }
      `),this.userCode=`
      const float initializationValue = `+a+`;
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float getValue(int batch, int inIdx) {
        `+h+`
        return getX(batch, inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * `+n+`;

        vec4 minMaxValue = vec4(`+a+`);
        float prodValue = 1.0;
        float sumValue = 0.0;
        float allValue = 1.0;
        float anyValue = 0.0;

        for (int i = 0; i < `+l+`; i += 4) {
          int inIdx = inOffset + i;
          `+d+" values = "+d+`(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          `+f+`
        }

        int inIdx = inOffset + `+l+`;
        if (`+(c===1)+`) {
          `+d+" values = "+d+`(
            getValue(batch, inIdx),
            initializationValue,
            initializationValue,
            initializationValue
          );

          `+f+`
        } else if (`+(c===2)+`) {
          `+d+" values = "+d+`(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            initializationValue,
            initializationValue
          );

          `+f+`
        } else if (`+(c===3)+`) {
          `+d+" values = "+d+`(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            initializationValue
          );

          `+f+`
        }
        setOutput(`+u+`);
      }
    `},GD=function(e,t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e;for(var n="",r=0;r<4;r++){var o="thisRC = rc;";r%2==1&&(o+="thisRC.z += 1;"),r>1&&(o+="thisRC.y += 1;"),n+=`
        `+o+`
        `+(r>0?"if(thisRC.y < rows && thisRC.z < cols){":"")+`
          int flatIndex = getFlatIndex(thisRC);

          ivec3 inputRC = inputCoordsFromReshapedOutCoords(flatIndex);
          vec2 inputRCInnerDims = vec2(float(inputRC.y),float(inputRC.z));

          result[`+r+`] =
            getChannel(getA(inputRC.x, inputRC.y, inputRC.z), inputRCInnerDims);
        `+(r>0?"}":"")+`
      `}this.userCode=`
      
    ivec3 inputCoordsFromReshapedOutCoords(int index) {
      `+Yo(["r","c","d"],t)+`
      return ivec3(r, c, d);
    }
  
      `+zp(e)+`

      void main() {
        ivec3 rc = getOutputCoords();

        vec4 result = vec4(0.);

        ivec3 thisRC;
        int rows = `+e[1]+`;
        int cols = `+e[2]+`;

        `+n+`

        setOutput(result);
      }
    `},qD=function(e,t,n){this.variableNames=["dy"],this.outputShape=[],this.outputShape=t.shape;var r=t.shape,o=r[1],i=r[2],a=e.shape,s=a[1],u=a[2],l=[n&&s>1?o-1:o,n&&u>1?i-1:i],c=[n&&s>1?s-1:s,n&&u>1?u-1:u],f=l[0]/c[0],d=l[1]/c[1],h=1/f,p=1/d,v=2*Math.ceil(h)+2,g=2*Math.ceil(p)+2;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        int r = coords[1];
        int c = coords[2];

        float accumulator = 0.0;

        const float heightScale = float(`+f+`);
        const float widthScale = float(`+d+`);

        const float invHeightScale = float(`+h+`);
        const float invWidthScale = float(`+p+`);

        const int winHeight = int(`+v+`);
        const int winWidth = int(`+g+`);

        // Compute bounds for where in dy we will look
        float startRLerp = floor(float(r) * invHeightScale);
        int startDyR = int(startRLerp - float(winHeight / 2));

        float startCLerp = floor(float(c) * invWidthScale);
        int startDyC = int(startCLerp - float(winWidth / 2));

        // Loop over dy
        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {
          int dyR = dyROffset + startDyR;

          // Guard against the window exceeding the bounds of dy
          if (dyR < 0 || dyR >= `+s+`) {
            continue;
          }

          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {
            int dyC = dyCOffset + startDyC;

            // Guard against the window exceeding the bounds of dy
            if (dyC < 0 || dyC >= `+u+`) {
              continue;
            }

            float dxR = float(dyR) * heightScale;
            int topDxRIndex = int(floor(dxR));
            int bottomDxRIndex = int(min(ceil(dxR), `+(o-1)+`.0));
            float dxRLerp = dxR - float(topDxRIndex);
            float inverseDxRLerp = 1.0 - dxRLerp;

            float dxC = float(dyC) * widthScale;
            int leftDxCIndex = int(floor(dxC));
            int rightDxCIndex = int(min(ceil(dxC), `+(i-1)+`.0));
            float dxCLerp = dxC - float(leftDxCIndex);
            float inverseDxCLerp = 1.0 - dxCLerp;

            if (r == topDxRIndex && c == leftDxCIndex) {
              // topLeft
              accumulator +=
                getDy(b, dyR, dyC, d) * inverseDxRLerp * inverseDxCLerp;
            }

            if (r == topDxRIndex && c == rightDxCIndex) {
              // topRight
              accumulator += getDy(b, dyR, dyC, d) * inverseDxRLerp * dxCLerp;
            }

            if (r == bottomDxRIndex && c == leftDxCIndex) {
              // bottomLeft
              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * inverseDxCLerp;
            }

            if (r == bottomDxRIndex && c == rightDxCIndex) {
              // bottomRight
              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * dxCLerp;
            }
          }
        }
        // End loop over dy

        setOutput(accumulator);
      }
    `},KD=function(e,t,n,r){this.variableNames=["A"],this.outputShape=[];var o=e[0],i=e[1],a=e[2],s=e[3];this.outputShape=[o,t,n,s];var u=[r&&t>1?i-1:i,r&&n>1?a-1:a],l=[r&&t>1?t-1:t,r&&n>1?n-1:n];this.userCode=`
      const vec2 effectiveInputOverOutputRatioRC = vec2(
          `+u[0]/l[0]+`,
          `+u[1]/l[1]+`);
      const vec2 inputShapeRC = vec2(`+i+".0, "+a+`.0);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        ivec2 yRC = coords.yz;

        // Fractional source index.
        vec2 sourceFracIndexRC = vec2(yRC) * effectiveInputOverOutputRatioRC;

        // Compute the four integer indices.
        ivec2 sourceFloorRC = ivec2(sourceFracIndexRC);
        ivec2 sourceCeilRC = ivec2(
          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));

        float topLeft = getA(b, sourceFloorRC.x, sourceFloorRC.y, d);
        float bottomLeft = getA(b, sourceCeilRC.x, sourceFloorRC.y, d);
        float topRight = getA(b, sourceFloorRC.x, sourceCeilRC.y, d);
        float bottomRight = getA(b, sourceCeilRC.x, sourceCeilRC.y, d);

        vec2 fracRC = sourceFracIndexRC - vec2(sourceFloorRC);

        float top = topLeft + (topRight - topLeft) * fracRC.y;
        float bottom = bottomLeft + (bottomRight - bottomLeft) * fracRC.y;
        float newValue = top + (bottom - top) * fracRC.x;

        setOutput(newValue);
      }
    `},XD=function(e,t,n,r){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];var o=e[0],i=e[1],a=e[2],s=e[3];this.outputShape=[o,t,n,s];var u=[r&&t>1?i-1:i,r&&n>1?a-1:a],l=[r&&t>1?t-1:t,r&&n>1?n-1:n];this.userCode=`
      const vec3 effectiveInputOverOutputRatioRC = vec3(
          `+u[0]/l[0]+`,
          `+u[1]/l[1]+`,
          `+u[1]/l[1]+`);
      const vec3 inputShapeRC = vec3(`+i+".0, "+a+`.0,
                                     `+a+`.0);

      float getAValue(int b, int r, int c, int d) {
        return getChannel(getA(b, r, c, d), vec2(c, d));
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        // Calculate values for next column in yRC.z.
        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);

        // Fractional source index.
        vec3 sourceFracIndexRC = vec3(yRC) * effectiveInputOverOutputRatioRC;

        // Compute the four integer indices.
        ivec3 sourceFloorRC = ivec3(sourceFracIndexRC);
        ivec3 sourceCeilRC = ivec3(
          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));

        // Should we calculate next column and row elements in 2x2 packed cell.
        bool hasNextCol = d < `+(s-1)+`;
        bool hasNextRow = coords.z < `+(n-1)+`;

        // In parallel, construct four corners for all four components in
        // packed 2x2 cell.
        vec4 topLeft = vec4(
          getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d),
          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d + 1) : 0.0);

        vec4 bottomLeft = vec4(
          getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d),
          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d + 1) : 0.0);

        vec4 topRight = vec4(
          getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d),
          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d + 1) : 0.0);

        vec4 bottomRight = vec4(
          getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d),
          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d + 1) : 0.0);

        vec3 fracRC = sourceFracIndexRC - vec3(sourceFloorRC);

        vec4 top = mix(topLeft, topRight, fracRC.yyzz);
        vec4 bottom = mix(bottomLeft, bottomRight, fracRC.yyzz);
        vec4 newValue = mix(top, bottom, fracRC.x);

        setOutput(newValue);
      }
    `},YD=function(e,t,n){this.variableNames=["dy"],this.outputShape=[],this.outputShape=t.shape;var r=t.shape,o=r[1],i=r[2],a=e.shape,s=a[1],u=a[2],l=[n&&s>1?o-1:o,n&&u>1?i-1:i],c=[n&&s>1?s-1:s,n&&u>1?u-1:u],f=l[0]/c[0],d=l[1]/c[1],h=1/f,p=1/d,v=2*Math.ceil(h)+2,g=2*Math.ceil(p)+2;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        int r = coords[1];
        int c = coords[2];

        float accumulator = 0.0;

        const float heightScale = float(`+f+`);
        const float widthScale = float(`+d+`);

        const float invHeightScale = float(`+h+`);
        const float invWidthScale = float(`+p+`);

        const int winHeight = int(`+v+`);
        const int winWidth = int(`+g+`);

        // Compute bounds for where in dy we will look
        float startRLerp = floor(float(r) * invHeightScale);
        int startDyR = int(floor(startRLerp - float(winHeight / 2)));

        float startCLerp = floor(float(c) * invWidthScale);
        int startDyC = int(floor(startCLerp - float(winWidth / 2)));

        // Loop over dy
        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {
          int dyR = dyROffset + startDyR;

          // Guard against the window exceeding the bounds of dy
          if (dyR < 0 || dyR >= `+s+`) {
            continue;
          }

          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {
            int dyC = dyCOffset + startDyC;

            // Guard against the window exceeding the bounds of dy
            if (dyC < 0 || dyC >= `+u+`) {
              continue;
            }

            float sourceFracRow =
              float(`+l[0]+`) *
                (float(dyR) / float(`+c[0]+`));

            float sourceFracCol =
                float(`+l[1]+`) *
                  (float(dyC) / float(`+c[1]+`));

            int sourceNearestRow = int(min(
                float(int(`+o+`) - 1),
                `+n+` ? float(round(sourceFracRow)) :
                                  float(floor(sourceFracRow))));

            int sourceNearestCol = int(min(
                float(int(`+i+`) - 1),
                `+n+` ? float(round(sourceFracCol)) :
                                  float(floor(sourceFracCol))));

            if (r == sourceNearestRow && c == sourceNearestCol) {
              accumulator += getDy(b, dyR, dyC, d);
            }
          }
        }
        // End loop over dy

        setOutput(accumulator);
      }
    `},QD=function(e,t,n,r){this.variableNames=["A"],this.outputShape=[];var o=e[0],i=e[1],a=e[2],s=e[3];this.outputShape=[o,t,n,s];var u=[r&&t>1?i-1:i,r&&n>1?a-1:a],l=[r&&t>1?t-1:t,r&&n>1?n-1:n],c=r?"0.5":"0.0";this.userCode=`
      const vec2 effectiveInputOverOutputRatioRC = vec2(
          `+u[0]/l[0]+`,
          `+u[1]/l[1]+`);
      const vec2 inputShapeRC = vec2(`+i+".0, "+a+`.0);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        ivec2 yRC = coords.yz;

        // Fractional source index.
        vec2 sourceFracIndexRC = vec2(yRC) * effectiveInputOverOutputRatioRC;

        // Compute the coordinators of nearest neighbor point.
        ivec2 sourceNearestRC = ivec2(
          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + `+c+`)));

        float newValue = getA(b, sourceNearestRC.x, sourceNearestRC.y, d);

        setOutput(newValue);
      }
    `},JD=function(e,t){this.variableNames=["x"];var n=e.length;if(n>4)throw new Error("WebGL backend: Reverse of rank-"+n+" tensor is not yet supported");if(this.outputShape=e,n!==1){var r=e.map(function(i,a){return function(s){return t.indexOf(s)!==-1&&e[s]!==1?e[s]+" - coords["+s+"] - 1":"coords["+s+"]"}(a)}).join(","),o=Ye(n);this.userCode=`
      void main() {
        `+o+` coords = getOutputCoords();
        setOutput(getX(`+r+`));
      }
    `}else this.userCode=`
        void main() {
          int coord = getOutputCoords();
          setOutput(getX(`+e[0]+` - coord - 1));
        }
      `},ZD=function(e,t){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0;var n=e.length;if(n>4)throw new Error("WebGL backend: Reverse of rank-"+n+" tensor is not yet supported");this.outputShape=e;var r=ln("rc",n),o=r[n-1]+" + 1 < "+this.outputShape[n-1],i=r[n-2]+" + 1 < "+this.outputShape[n-2],a=Ye(n);function s(u){var l=e.map(function(c,f){return function(d,h){return t.indexOf(d)!==-1&&e[d]!==1?e[d]+" - "+h[d]+" - 1":""+h[d]}(f,u)});return"getChannel(getX("+l.join(",")+"), vec2("+l.slice(-2).join(",")+"))"}this.userCode=n===1?`
        void main(){
          int rc = getOutputCoords();
          vec4 result = vec4(0.);
          result.r = getChannel(getX(`+e[0]+` - rc - 1),
            `+e[0]+` - rc - 1);
          if(`+o+`){
              result.g = getChannel(getX(`+e[0]+` - (rc  + 1) - 1),
                `+e[0]+` - (rc  + 1) - 1);
          }
          setOutput(result);
        }
      `:`
        void main() {
          `+a+` rc = getOutputCoords();
          vec4 result = vec4(0.);
          result.r = `+function(u){return s(u)}(r.slice())+`;
          if(`+o+`){
            result.g = `+function(u){return u[n-1]="("+u[n-1]+" + 1)",s(u)}(r.slice())+`;
          }
          if(`+i+`) {
            result.b = `+function(u){return u[n-2]="("+u[n-2]+" + 1)",s(u)}(r.slice())+`;
            if(`+o+`) {
              result.a = `+function(u){return u[n-1]="("+u[n-1]+" + 1)",u[n-2]="("+u[n-2]+" + 1)",s(u)}(r.slice())+`;
            }
          }
          setOutput(result);
        }
    `},Zg=function(e,t,n,r,o,i,a){this.variableNames=["updates","indices","defaultValue"],this.outputShape=i;var s=Ye(o.length),u=Ye(i.length),l="";n===1?l="i":n===2&&(l="i, j");var c="getIndices("+l+")",f="";r===1?f="i":r===2&&(f="i, coords[1]");var d="getUpdates("+f+")",h=t>1?"strides[j]":"strides";this.userCode=`
        `+s+" strides = "+s+"("+o+`);

        void main() {
          `+u+` coords = getOutputCoords();
          float sum = 0.0;
          bool found = false;
          for (int i = 0; i < `+e+`; i++) {
            int flattenedIndex = 0;
            for (int j = 0; j < `+t+`; j++) {
              int index = round(`+c+`);
              flattenedIndex += index * `+h+`;
            }
            if (flattenedIndex == coords[0]) {
              sum += `+d+`;
              found = true;
            }
          }
          setOutput(mix(getDefaultValue(), sum, float(found)));
        }
      `},eT=function(e,t){this.variableNames=["x","segmentIds"];var n=e.windowSize,r=e.batchSize,o=e.inSize,i=e.numSegments,a=i*Math.ceil(o/n);this.outputShape=[r,a];var s=4*Math.floor(n/4),u=n%4,l=`
        sumValue += dot(values, segFilter);
    `,c="";o%n>0&&(c=`
        if (inIdx < 0 || inIdx >= `+o+`) {
          return initializationValue;
        }
      `);var f="";o%n>0&&(f=`
        if (inIdx < 0 || inIdx >= `+o+`) {
          return -1.0;
        }
      `),this.userCode=`
      const float initializationValue = 0.0;

      float getValue(int batch, int inIdx) {
        `+c+`
        return getX(batch, inIdx);
      }

      float getSegmentIdAtIndex(int inIdx) {
        `+f+`
        return getSegmentIds(inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = int(floor(float(outIdx) / float(
          `+i+")) * float("+n+`));
        int currentSeg = int(mod(float(outIdx), float(`+i+`)));

        float sumValue = 0.0;

        for (int i = 0; i < `+s+`; i += 4) {
          int inIdx = inOffset + i;
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 3)) == currentSeg ? 1 : 0
          );

          `+l+`
        }

        int inIdx = inOffset + `+s+`;
        if (`+(u===1)+`) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            initializationValue,
            initializationValue,
            initializationValue
          );

          int inIdxSeg = int(getSegmentIdAtIndex(inIdx));

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            0,
            0,
            0
          );

          `+l+`
        } else if (`+(u===2)+`) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            initializationValue,
            initializationValue
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
              0,
              0
          );

          `+l+`
        } else if (`+(u===3)+`) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            initializationValue
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,
            0
          );

          `+l+`
        }
        setOutput(sumValue);
      }
    `},tT=function(e,t,n){var r,o;if(this.variableNames=["c","a","b"],this.outputShape=t,n>4)throw Error("Where for rank "+n+" is not yet supported");if(n===1)o="resRC",r="resRC";else{for(var i=["resRC.x","resRC.y","resRC.z","resRC.w"],a=[],s=[],u=0;u<t.length;u++)s.push(""+i[u]),u<e&&a.push(""+i[u]);r=a.join(),o=s.join()}var l=Ye(n);this.userCode=`
      void main() {
        `+l+` resRC = getOutputCoords();
        float cVal = getC(`+r+`);
        if (cVal >= 1.0) {
          setOutput(getA(`+o+`));
        } else {
          setOutput(getB(`+o+`));
        }
      }
    `},nT=function(){function e(t){this.variableNames=["source"],this.outputShape=t,this.rank=t.length;var n,r=Ye(this.rank),o="uniform int start["+this.rank+"];",i=function(a){if(a===1)return"sourceLoc";if(a<=6)return zf.slice(0,a).map(function(s){return"sourceLoc."+s}).join(",");throw Error("Slicing for rank "+a+" is not yet supported")}(this.rank);n=`
        `+r+` sourceLoc;
        `+r+` coords = getOutputCoords();
        `+t.map(function(a,s){return"sourceLoc."+zf[s]+" = start["+s+"] + coords."+zf[s]+";"}).join(`
`)+`
      `,this.userCode=`
      `+o+`
      void main() {
        `+n+`
        setOutput(getSource(`+i+`));
      }
    `}return e.prototype.getCustomSetupFunc=function(t){var n=this;if(t.length!==this.rank)throw Error("The rank ("+this.rank+") of the program must match the length of start ("+t.length+")");return function(r,o){n.startLoc==null&&(n.startLoc=r.getUniformLocationNoThrow(o,"start"),n.startLoc==null)||r.gl.uniform1iv(n.startLoc,t)}},e}(),zf=["x","y","z","w","u","v"],rT=function(){function e(t){this.variableNames=["source"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t,this.rank=t.length;var n=Ye(this.rank),r=ln("coords",this.rank),o=ln("sourceLoc",this.rank),i=this.rank===1?"sourceLoc":"vec2("+o.slice(-2).join()+")",a="getChannel(getSource("+o.join()+"), "+i+")",s=`
      result.x = `+a+`;
      if (++`+r[this.rank-1]+" < "+t[this.rank-1]+`) {
        ++`+o[this.rank-1]+`;
        result.y = `+a+`;
        --`+o[this.rank-1]+`;
      }
    `,u=this.rank===1?"":`
      --`+r[this.rank-1]+`;
      if (++`+r[this.rank-2]+" < "+t[this.rank-2]+`) {
        ++`+o[this.rank-2]+`;
        result.z = `+a+`;
        if (++`+r[this.rank-1]+" < "+t[this.rank-1]+`) {
          ++`+o[this.rank-1]+`;
          result.w = `+a+`;
        }
      }
    `,l=this.rank<=4?`sourceLoc = coords +
            `+n+"("+t.map(function(c,f){return"start["+f+"]"}).join()+");":t.map(function(c,f){return o[f]+" = "+r[f]+" + start["+f+"];"}).join(`
`);this.userCode=`
      uniform int start[`+this.rank+`];
      void main() {
        `+n+` coords = getOutputCoords();
        `+n+` sourceLoc;
        `+l+`
        vec4 result = vec4(0.);
        `+s+`
        `+u+`
        setOutput(result);
      }
    `}return e.prototype.getCustomSetupFunc=function(t){var n=this;if(t.length!==this.rank)throw Error("The rank ("+this.rank+") of the program must match the length of start ("+t.length+")");return function(r,o){n.startLoc==null&&(n.startLoc=r.getUniformLocationNoThrow(o,"start"),n.startLoc==null)||r.gl.uniform1iv(n.startLoc,t)}},e}(),oT=function(e,t,n){this.variableNames=["x"],this.outputShape=n;var r=n.length,o=Ye(n.length),i=Ye(n.length),a="";if(r===1)a="coords * strides + begin";else{var s=0;a=n.map(function(u,l){return s++,n.length===1?"coords * strides["+l+"] + begin["+l+"]":"coords["+(s-1)+"] * strides["+l+"] + begin["+l+"]"}).join(",")}this.userCode=`
      `+o+" begin = "+o+"("+e+`);
      `+o+" strides = "+o+"("+t+`);

      void main() {
        `+i+` coords = getOutputCoords();
        setOutput(getX(`+a+`));
      }
    `},iT=function(){function e(t){this.gpgpu=t,this.numUsedTextures=0,this.numFreeTextures=0,this.freeTextures={},this.logEnabled=!1,this.usedTextures={}}return e.prototype.acquireTexture=function(t,n,r){var o,i=ey(n,r),a=ty(t,i,r);if(a in this.freeTextures||(this.freeTextures[a]=[]),a in this.usedTextures||(this.usedTextures[a]=[]),this.freeTextures[a].length>0){this.numFreeTextures--,this.numUsedTextures++,this.log();var s=this.freeTextures[a].shift();return this.usedTextures[a].push(s),s}return this.numUsedTextures++,this.log(),i===Cn.PACKED_2X2_FLOAT32?o=this.gpgpu.createPackedMatrixTexture(t[0],t[1]):i===Cn.PACKED_2X2_FLOAT16?o=this.gpgpu.createFloat16PackedMatrixTexture(t[0],t[1]):i===Cn.UNPACKED_FLOAT32?o=this.gpgpu.createFloat32MatrixTexture(t[0],t[1]):i===Cn.UNPACKED_FLOAT16?o=this.gpgpu.createFloat16MatrixTexture(t[0],t[1]):i===Cn.PACKED_4X1_UNSIGNED_BYTE&&(o=this.gpgpu.createUnsignedBytesMatrixTexture(t[0],t[1])),this.usedTextures[a].push(o),o},e.prototype.releaseTexture=function(t,n,r,o){if(this.freeTextures!=null){var i=ty(n,ey(r,o),o);i in this.freeTextures||(this.freeTextures[i]=[]),this.freeTextures[i].push(t),this.numFreeTextures++,this.numUsedTextures--;var a=this.usedTextures[i],s=a.indexOf(t);if(s<0)throw new Error("Cannot release a texture that was never provided by this texture manager");a.splice(s,1),this.log()}},e.prototype.log=function(){if(this.logEnabled){var t=this.numFreeTextures+this.numUsedTextures;console.log("Free/Used",this.numFreeTextures+" / "+this.numUsedTextures,"("+t+")")}},e.prototype.getNumUsedTextures=function(){return this.numUsedTextures},e.prototype.getNumFreeTextures=function(){return this.numFreeTextures},e.prototype.dispose=function(){var t=this;if(this.freeTextures!=null){for(var n in this.freeTextures)this.freeTextures[n].forEach(function(r){t.gpgpu.deleteMatrixTexture(r)});for(var n in this.usedTextures)this.usedTextures[n].forEach(function(o){t.gpgpu.deleteMatrixTexture(o)});this.freeTextures=null,this.usedTextures=null,this.numUsedTextures=0,this.numFreeTextures=0}},e}();function ey(e,t){if(e===Sn.UPLOAD)return Cn.PACKED_2X2_FLOAT32;if(e===Sn.RENDER||e==null)return function(n){return G().getBool("WEBGL_RENDER_FLOAT32_ENABLED")?n?Cn.PACKED_2X2_FLOAT32:Cn.UNPACKED_FLOAT32:n?Cn.PACKED_2X2_FLOAT16:Cn.UNPACKED_FLOAT16}(t);if(e===Sn.DOWNLOAD||e===Sn.PIXELS)return Cn.PACKED_4X1_UNSIGNED_BYTE;throw new Error("Unknown logical texture type "+e)}function ty(e,t,n){return e[0]+"_"+e[1]+"_"+t+"_"+n}var aT=function(e,t){this.variableNames=["A"];for(var n=new Array(e.length),r=0;r<n.length;r++)n[r]=e[r]*t[r];this.outputShape=n,this.rank=n.length;var o=Ye(this.rank),i=function(a){var s=a.length;if(s>5)throw Error("Tile for rank "+s+" is not yet supported");if(s===1)return"imod(resRC, "+a[0]+")";for(var u=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u"],l=[],c=0;c<a.length;c++)l.push("imod("+u[c]+", "+a[c]+")");return l.join()}(e);this.userCode=`
      void main() {
        `+o+` resRC = getOutputCoords();
        setOutput(getA(`+i+`));
      }
    `},sT=function(e,t){this.variableNames=["A"];for(var n=new Array(e.length),r=0;r<n.length;r++)n[r]=e[t[r]];this.outputShape=n,this.rank=n.length;var o=Ye(this.rank),i=function(a){var s=a.length;if(s>6)throw Error("Transpose for rank "+s+" is not yet supported");for(var u=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u","resRC.v"],l=new Array(s),c=0;c<a.length;c++)l[a[c]]=u[c];return l.join()}(t);this.userCode=`
    void main() {
      `+o+` resRC = getOutputCoords();
      setOutput(getA(`+i+`));
    }
    `},uT=function(e,t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0;for(var n=new Array(e.length),r=0;r<n.length;r++)n[r]=e[t[r]];if(this.outputShape=n,this.rank=n.length,this.rank>6)throw Error("Packed transpose for rank "+this.rank+" is not yet supported.");var o=Ye(this.rank),i=mw("rc",this.rank),a=new Array(this.rank);for(r=0;r<t.length;r++)a[t[r]]=i[r];var s="vec2("+a.slice(-2).join()+")",u="++"+i[this.rank-1]+" < "+n[this.rank-1],l="getChannel(getA("+a.join()+"), "+s+")";this.userCode=`
    void main() {
      `+o+` rc = getOutputCoords();
      vec4 result = vec4(0.);
      result[0] = `+l+`;
      if(`+u+`) {
        result[1] = `+l+`;
      }
      --`+i[this.rank-1]+`;
      if(++`+i[this.rank-2]+" < "+n[this.rank-2]+`) {
        result[2] = `+l+`;
        if(`+u+`) {
          result[3] = `+l+`;
        }
      }
      setOutput(result);
    }
    `},jp=1.7580993408473768,Vp=1.0507009873554805,ke=function(e,t){this.variableNames=["A"],this.outputShape=e,this.userCode=`
      float unaryOperation(float x) {
        `+t+`
      }

      void main() {
        float x = getAAtOutCoords();
        float y = unaryOperation(x);

        setOutput(y);
      }
    `},cr="if (isnan(x)) return x;",lT="return x;",ny="return abs(x);",bw=cr+`
  return (x < 0.0) ? 0.0 : x;
`,Ew=cr+`
  return (x < 0.0) ? 0.0 : min(6.0, x);
`,Cw="return (x >= 0.0) ? x : (exp(x) - 1.0);",cT=`
  // Stable and Attracting Fixed Point (0, 1) for Normalized Weights.
  // see: https://arxiv.org/abs/1706.02515
  float scaleAlpha = `+jp+`;
  float scale = `+Vp+`;
  return (x >= 0.0) ? scale * x : scaleAlpha * (exp(x) - 1.0);
`,ry="return -x;",oy="return ceil(x);",iy="return floor(x);",ay="return exp(x);",sy="return exp(x) - 1.0;",fT=cr+`
  return sin(x);
`,dT=cr+`
  return cos(x);
`,hT=cr+`
  if (abs(x) > 1.) {
    return NAN;
  }
  return asin(x);
`,pT=cr+`
  if (abs(x) > 1.) {
    return NAN;
  }
  return acos(x);
`,vT=cr+`
  return atan(x);
`,mT=cr+"return log(x + sqrt(x * x + 1.0));",gT=cr+`
  if (x < 1.0) return NAN;
  return log(x + sqrt(x * x - 1.0));`,yT=cr+`
  if ((x < -1.0) || (x > 1.0)) return NAN;
  return (log(1.0 + x) - log(1.0 - x)) / 2.0;`,Au="return x;",xT="return x;",_w=`
  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,Sw=`
  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,Rw=`
  vec4 result;

  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);
  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);
  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);
  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);

  return result;
`,Ga=function(e,t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.userCode=`
      vec4 unaryOperation(vec4 x) {
        `+t+`
      }

      void main() {
        vec4 x = getAAtOutCoords();
        vec4 y = unaryOperation(x);

        setOutput(y);
      }
    `},wT=function(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outputShape=e;var t=e.length,n=ln("rc",t),r=Ye(t),o=function(s,u){if(s===1)return"rc";for(var l="",c=0;c<s;c++)l+=u[c],c<s-1&&(l+=",");return l}(t,n),i=n.slice(-2),a=t<=1?"rc":"vec2("+i.join(",")+")";this.userCode=`
      void main() {
        `+r+` rc = getOutputCoords();
        vec4 packedInput = getA(`+o+`);

        setOutput(getChannel(packedInput, `+a+`));
      }
    `},Pu={};function Fu(e,t){if(t===void 0&&(t=!1),e==="linear")return t?xT:lT;if(e==="relu")return t?_w:bw;if(e==="elu")return t?Rw:Cw;if(e==="relu6")return t?Sw:Ew;if(e==="prelu")return t?ww:xw;throw new Error("Activation "+e+" has not been implemented for the WebGL backend.")}var bT=600,ET=function(e){function t(n){var r,o=e.call(this)||this;if(o.pendingRead=new WeakMap,o.pendingDisposal=new WeakSet,o.dataRefCount=new WeakMap,o.numBytesInGPU=0,o.uploadWaitMs=0,o.downloadWaitMs=0,o.warnedAboutMemory=!1,o.pendingDeletes=0,o.disposed=!1,!G().getBool("HAS_WEBGL"))throw new Error("WebGL is not supported on this device");if(n==null){var i=Dr(G().getNumber("WEBGL_VERSION"));o.binaryCache=((r=G().getNumber("WEBGL_VERSION"))in Pu||(Pu[r]={}),Pu[r]),o.gpgpu=new PD(i),o.canvas=i.canvas,o.gpgpuCreatedLocally=!0}else o.gpgpu=n,o.binaryCache={},o.gpgpuCreatedLocally=!1,o.canvas=n.gl.canvas;return o.textureManager=new iT(o.gpgpu),o.numMBBeforeWarning=G().global.screen==null?1024:G().global.screen.height*G().global.screen.width*window.devicePixelRatio*bT/1024/1024,o.texData=new sw(o,P),o}return lr(t,e),t.prototype.numDataIds=function(){return this.texData.numDataIds()+(this.cpuBackend?this.cpuBackend.numDataIds():0)-this.pendingDeletes},t.prototype.write=function(n,r,o){if(G().getBool("DEBUG")&&this.checkNumericalProblems(n),o==="complex64"&&n!=null)throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");var i={};return this.texData.set(i,{shape:r,dtype:o,values:n,usage:Sn.UPLOAD}),i},t.prototype.move=function(n,r,o,i){if(G().getBool("DEBUG")&&this.checkNumericalProblems(r),i==="complex64")throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");this.texData.set(n,{shape:o,dtype:i,values:r,usage:Sn.UPLOAD})},t.prototype.readSync=function(n){var r=this.texData.get(n),o=r.values,i=r.dtype,a=r.complexTensors,s=r.slice,u=r.shape,l=r.isPacked;if(s!=null){var c=void 0;c=l?new Ga(u,Au):new ke(u,Au);var f=this.runWebGLProgram(c,[{dataId:n,shape:u,dtype:i}],i),d=this.readSync(f.dataId);return this.disposeData(f.dataId),d}if(o!=null)return this.convertAndCacheOnCPU(n);if(i==="string")return o;var h,p,v=this.activeTimers!=null;return v&&(h=yr()),i==="complex64"?p=ph(a.real.dataSync(),a.imag.dataSync()):p=this.getValuesFromTexture(n),v&&(this.downloadWaitMs+=yr()-h),this.convertAndCacheOnCPU(n,p)},t.prototype.read=function(n){return se(this,void 0,void 0,function(){var r,o,i,a,s,u,l,c,f,d,h,p,v,g,m,y,x,w,E,b,C,_;return ue(this,function(S){switch(S.label){case 0:if(this.pendingRead.has(n))return r=this.pendingRead.get(n),[2,new Promise(function(R){return r.push(R)})];if(o=this.texData.get(n),i=o.values,a=o.shape,s=o.slice,u=o.dtype,l=o.complexTensors,c=o.isPacked,s!=null)return f=void 0,f=c?new Ga(a,Au):new ke(a,Au),d=this.runWebGLProgram(f,[{dataId:n,shape:a,dtype:u}],u),h=this.read(d.dataId),this.disposeData(d.dataId),[2,h];if(i!=null)return[2,this.convertAndCacheOnCPU(n)];if(!G().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")&&G().getNumber("WEBGL_VERSION")===2)throw new Error("tensor.data() with WEBGL_DOWNLOAD_FLOAT_ENABLED=false and WEBGL_VERSION=2 not yet supported.");return p=null,u!=="complex64"&&G().get("WEBGL_BUFFER_SUPPORTED")&&(v=this.decode(n),g=this.texData.get(v.dataId),p=(_=this.gpgpu).createBufferFromTexture.apply(_,[g.texture].concat(ss(a)))),this.pendingRead.set(n,[]),u==="complex64"?[3,2]:[4,this.gpgpu.createAndWaitForFence()];case 1:S.sent(),S.label=2;case 2:return u!=="complex64"?[3,4]:[4,Promise.all([l.real.data(),l.imag.data()])];case 3:return y=S.sent(),x=y[0],w=y[1],m=ph(x,w),[3,5];case 4:p==null?m=this.getValuesFromTexture(n):(E=le(a),m=this.gpgpu.downloadFloat32MatrixFromBuffer(p,E)),S.label=5;case 5:return v!=null&&this.disposeData(v.dataId),b=this.convertAndCacheOnCPU(n,m),C=this.pendingRead.get(n),this.pendingRead.delete(n),C.forEach(function(R){return R(b)}),this.pendingDisposal.has(n)&&(this.pendingDisposal.delete(n),this.disposeData(n),this.pendingDeletes--),[2,b]}})})},t.prototype.checkNumericalProblems=function(n){if(n!=null)for(var r=0;r<n.length;r++){var o=n[r];if(!ck(o))throw G().getBool("WEBGL_RENDER_FLOAT32_CAPABLE")?Error("The value "+o+" cannot be represented with your current settings. Consider enabling float32 rendering: 'tf.env().set('WEBGL_RENDER_FLOAT32_ENABLED', true);'"):Error("The value "+o+" cannot be represented on this device.")}},t.prototype.getValuesFromTexture=function(n){var r,o=this.texData.get(n),i=o.shape,a=o.dtype,s=o.isPacked,u=le(i);if(G().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")){var l=this.decode(n),c=this.texData.get(l.dataId),f=(r=this.gpgpu).downloadMatrixFromPackedTexture.apply(r,[c.texture].concat(ss(i))).subarray(0,u);return this.disposeData(l.dataId),f}var d=G().getBool("WEBGL_PACK")&&s===!0,h=d?Ff(i):i,p=d?new lD(h):new uD(h),v=this.runWebGLProgram(p,[{shape:h,dtype:a,dataId:n}],"float32"),g=this.texData.get(v.dataId),m=this.gpgpu.downloadByteEncodedFloatMatrixFromOutputTexture(g.texture,g.texShape[0],g.texShape[1]).subarray(0,u);return this.disposeData(v.dataId),m},t.prototype.time=function(n){return se(this,void 0,void 0,function(){var r,o,i,a,s,u,l;return ue(this,function(c){switch(c.label){case 0:return r=this.activeTimers,o=[],i=!1,this.programTimersStack==null?(this.programTimersStack=o,i=!0):this.activeTimers.push(o),this.activeTimers=o,n(),a=ya(this.activeTimers.map(function(f){return f.query})).filter(function(f){return f!=null}),s=ya(this.activeTimers.map(function(f){return f.name})).filter(function(f){return f!=null}),this.activeTimers=r,i&&(this.programTimersStack=null),u={uploadWaitMs:this.uploadWaitMs,downloadWaitMs:this.downloadWaitMs,kernelMs:null,wallMs:null},G().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?[4,Promise.all(a)]:[3,2];case 1:return l=c.sent(),u.kernelMs=$R(l),u.getExtraProfileInfo=function(){return l.map(function(f,d){return{name:s[d],ms:f}}).map(function(f){return f.name+": "+f.ms}).join(", ")},[3,3];case 2:u.kernelMs={error:"WebGL query timers are not supported in this environment."},c.label=3;case 3:return this.uploadWaitMs=0,this.downloadWaitMs=0,[2,u]}})})},t.prototype.memory=function(){return{unreliable:!1,numBytesInGPU:this.numBytesInGPU}},t.prototype.startTimer=function(){return G().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?this.gpgpu.beginQuery():{startMs:yr(),endMs:null}},t.prototype.endTimer=function(n){return G().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?(this.gpgpu.endQuery(),n):(n.endMs=yr(),n)},t.prototype.getQueryTime=function(n){return se(this,void 0,void 0,function(){var r;return ue(this,function(o){return G().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?[2,this.gpgpu.waitForQueryAndGetTime(n)]:[2,(r=n).endMs-r.startMs]})})},t.prototype.disposeData=function(n){if(!this.pendingDisposal.has(n)){if(this.pendingRead.has(n))return this.pendingDisposal.add(n),void this.pendingDeletes++;if(this.texData.has(n)){this.releaseGPUData(n);var r=this.texData.get(n).complexTensors;r!=null&&(r.real.dispose(),r.imag.dispose()),this.texData.delete(n)}}},t.prototype.releaseGPUData=function(n){var r=this.texData.get(n),o=r.texture,i=r.dtype,a=r.texShape,s=r.usage,u=r.isPacked,l=r.slice,c=l&&l.origDataId||n,f=this.dataRefCount.get(c);f>1?this.dataRefCount.set(c,f-1):(this.dataRefCount.delete(c),o!=null&&(this.numBytesInGPU-=this.computeBytes(a,i),this.textureManager.releaseTexture(o,a,s,u)));var d=this.texData.get(n);d.texture=null,d.texShape=null,d.isPacked=!1,d.slice=null},t.prototype.getTexture=function(n){return this.uploadToGPU(n),this.texData.get(n).texture},t.prototype.getDataInfo=function(n){return this.texData.get(n)},t.prototype.getCPUBackend=function(){return G().getBool("WEBGL_CPU_FORWARD")?(this.cpuBackend==null&&(this.cpuBackend=P.findBackend("cpu")),this.cpuBackend):null},t.prototype.shouldExecuteOnCPU=function(n,r){var o=this;return r===void 0&&(r=128),this.getCPUBackend()!=null&&n.every(function(i){return o.texData.get(i.dataId).texture==null&&i.size<r})},t.prototype.getGPGPUContext=function(){return this.gpgpu},t.prototype.complex=function(n,r){var o=this.makeOutput(n.shape,"complex64");return this.texData.get(o.dataId).complexTensors={real:P.keep(n.clone()),imag:P.keep(r.clone())},o},t.prototype.real=function(n){return this.texData.get(n.dataId).complexTensors.real.clone()},t.prototype.imag=function(n){return this.texData.get(n.dataId).complexTensors.imag.clone()},t.prototype.slice=function(n,r,o){if(this.shouldExecuteOnCPU([n]))return this.cpuBackend.slice(n,r,o);if(le(o)===0)return Wt([],o,n.dtype);var i=this.texData.get(n.dataId).isPacked,a=iw(n.shape,r,o);if(i||!a){var s=G().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new rT(o):new nT(o),u=s.getCustomSetupFunc(r);return this.compileAndRun(s,[n],null,u)}return this.uploadToGPU(n.dataId),this.shallowSlice(n,r,o)},t.prototype.shallowSlice=function(n,r,o){var i=this.texData.get(n.dataId),a=this.makeOutput(o,n.dtype),s=this.texData.get(a.dataId);Object.assign(s,i),s.shape=o,s.dtype=n.dtype;var u=aw(r,n.strides);i.slice&&(u+=i.slice.flatOffset),s.slice={flatOffset:u,origDataId:i.slice&&i.slice.origDataId||n.dataId};var l=this.dataRefCount.get(s.slice.origDataId)||1;return this.dataRefCount.set(s.slice.origDataId,l+1),a},t.prototype.stridedSlice=function(n,r,o,i){if(this.shouldExecuteOnCPU([n]))return this.cpuBackend.stridedSlice(n,r,o,i);var a=Op(r,o,i);if(a.some(function(u){return u===0}))return Wt([],a);var s=new oT(r,i,a);return this.compileAndRun(s,[n])},t.prototype.reverse=function(n,r){var o=G().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new ZD(n.shape,r):new JD(n.shape,r);return this.compileAndRun(o,[n])},t.prototype.concat=function(n,r){if(n[0].dtype==="complex64"){var o=n.map(function(h){return Wn(h)}),i=n.map(function(h){return br(h)});return Bt(this.concat(o,r),this.concat(i,r))}if(this.shouldExecuteOnCPU(n))return this.cpuBackend.concat(n,r);if(n.length===1)return n[0];if(n.length>G().getNumber("WEBGL_MAX_TEXTURES_IN_SHADER")){var a=Math.floor(n.length/2),s=this.concat(n.slice(0,a),r),u=this.concat(n.slice(a),r);return this.concat([s,u],r)}if(G().getBool("WEBGL_PACK_ARRAY_OPERATIONS")&&n[0].rank>1){var l=new KI(n.map(function(h){return h.shape}),r);return this.compileAndRun(l,n)}var c=wa(n.map(function(h){return h.shape}),r),f=n.map(function(h){return h.as2D(-1,le(h.shape.slice(r)))}),d=new qI(f.map(function(h){return h.shape}));return this.compileAndRun(d,f).reshape(c)},t.prototype.neg=function(n){if(this.shouldExecuteOnCPU([n]))return this.cpuBackend.neg(n);if(G().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(n,ry,n.dtype);var r=new ke(n.shape,ry);return this.compileAndRun(r,[n])},t.prototype.batchMatMul=function(n,r,o,i){var a=o?n.shape[2]:n.shape[1],s=i?r.shape[1]:r.shape[2],u=o?n.shape[1]:n.shape[2],l=n.shape[0];if((a===1||s===1)&&u>1e3){o&&(n=n.transpose([0,2,1])),i&&(r=r.transpose([0,2,1]));var c=s===1?n:n.as3D(l,u,1),f=s===1?2:1,d=s===1?r.as3D(l,1,u):r;return this.multiply(c,d).sum(f,!0)}var h=Ut(n.dtype,r.dtype),p=new Bf(n.shape,[l,a,s],o,i);return this.compileAndRun(p,[n,r],h)},t.prototype.fusedBatchMatMul=function(n){var r=n.a,o=n.b,i=n.transposeA,a=n.transposeB,s=n.bias,u=n.activation,l=n.preluActivationWeights,c=i?r.shape[2]:r.shape[1],f=a?o.shape[1]:o.shape[2],d=r.shape[0],h=Ut(r.dtype,o.dtype),p=s!=null,v=l!=null,g=u?Fu(u,!0):null,m=new Bf(r.shape,[d,c,f],i,a,p,g,v),y=[r,o];return s&&y.push(s),l&&y.push(l),this.compileAndRun(m,y,h)},t.prototype.multiply=function(n,r){if(n.dtype==="complex64"){var o=this.texData.get(n.dataId),i=this.texData.get(r.dataId),a=new Hg(jI,n.shape,r.shape),s=new Hg(VI,n.shape,r.shape),u=[this.makeComplexComponentTensorInfo(n,o.complexTensors.real),this.makeComplexComponentTensorInfo(n,o.complexTensors.imag),this.makeComplexComponentTensorInfo(r,i.complexTensors.real),this.makeComplexComponentTensorInfo(r,i.complexTensors.imag)],l=this.compileAndRun(a,u),c=this.compileAndRun(s,u),f=this.complex(l,c);return l.dispose(),c.dispose(),f}if(this.shouldExecuteOnCPU([n,r]))return this.cpuBackend.multiply(n,r);if(G().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(n,r,Gg,n.dtype);var d=new ht(Gg,n.shape,r.shape);return this.compileAndRun(d,[n,r],n.dtype)},t.prototype.batchNormalization=function(n,r,o,i,a,s){var u=[n,r,o],l=null;s!=null&&(l=s.shape,u.push(s));var c=null;if(a!=null&&(c=a.shape,u.push(a)),G().getBool("WEBGL_PACK_NORMALIZATION")){var f=new zI(n.shape,r.shape,o.shape,l,c,i);return this.compileAndRun(f,u)}var d=new WI(n.shape,r.shape,o.shape,l,c,i);return this.compileAndRun(d,u)},t.prototype.localResponseNormalization4D=function(n,r,o,i,a){var s=G().getBool("WEBGL_PACK_NORMALIZATION")?new LD(n.shape,r,o,i,a):new MD(n.shape,r,o,i,a);return this.compileAndRun(s,[n])},t.prototype.LRNGrad=function(n,r,o,i,a,s,u){var l=new OD(r.shape,i,a,s,u);return this.compileAndRun(l,[r,o,n])},t.prototype.tile=function(n,r){if(n.dtype==="string"){var o=this.readSync(n.dataId).map(function(a){return Ml(a)});return pw(Ce(n.shape,n.dtype,o),r)}var i=new aT(n.shape,r);return this.compileAndRun(i,[n])},t.prototype.pad=function(n,r,o){var i=G().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new $D(n.shape,r,o):new VD(n.shape,r,o);return this.compileAndRun(i,[n])},t.prototype.transpose=function(n,r){if(this.shouldExecuteOnCPU([n]))return this.cpuBackend.transpose(n,r);var o=G().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new uT(n.shape,r):new sT(n.shape,r);return this.compileAndRun(o,[n])},t.prototype.gather=function(n,r,o){if(this.shouldExecuteOnCPU([n,r]))return this.cpuBackend.gather(n,r,o);var i=new vD(n.shape,r.size,o);return this.compileAndRun(i,[n,r])},t.prototype.batchToSpaceND=function(n,r,o){I(n.rank<=4,function(){return"batchToSpaceND for rank > 4 with a WebGL backend not implemented yet"});var i=r.reduce(function(f,d){return f*d}),a=zl(n.shape,r,i),s=jl(a.length,r.length),u=Vl(n.shape,r,i),l=tw(o,r.length),c=nw(u,o,r.length);return n.reshape(a).transpose(s).reshape(u).slice(l,c)},t.prototype.spaceToBatchND=function(n,r,o){I(n.rank<=4,function(){return"spaceToBatchND for rank > 4 with a WebGL backend not implemented yet"});var i=r.reduce(function(d,h){return d*h}),a=[[0,0]];a.push.apply(a,o);for(var s=1+r.length;s<n.shape.length;++s)a.push([0,0]);var u=n.pad(a),l=zl(u.shape,r,i,!1),c=jl(l.length,r.length,!1),f=Vl(u.shape,r,i,!1);return u.reshape(l).transpose(c).reshape(f)},t.prototype.reduce=function(n,r,o){var i=n.shape[0],a=n.shape[1],s=Mf(a),u=new HD({windowSize:s,inSize:a,batchSize:i},r),l=this.compileAndRun(u,[n],o);return l.shape[1]===1?l:this.reduce(l,r,o)},t.prototype.argReduce=function(n,r,o){o===void 0&&(o=null);var i=n.shape[0],a=n.shape[1];o!=null&&(i=o.shape[0],a=o.shape[1]);var s=Mf(a),u=new NI({windowSize:s,inSize:a,batchSize:i},r,o==null),l=[n];o!=null&&l.push(o);var c=this.compileAndRun(u,l,"int32");return c.shape[1]===1?c:this.argReduce(n,r,c)},t.prototype.argReducePacked=function(n,r,o){o===void 0&&(o=null);var i=o!=null?o.shape:n.shape,a=Mf(i[i.length-1]),s=new LI(i,a,r,o==null),u=o==null?[n]:[n,o],l=this.compileAndRun(s,u,"int32");return l.rank===n.rank?this.argReducePacked(n,r,l):l},t.prototype.sum=function(n,r){En("sum",r,n.rank);var o=Gt(n.shape,r),i=o[0],a=le(o[1]),s=n.as2D(-1,a),u=kf(n.dtype);return this.reduce(s,"sum",u).reshape(i)},t.prototype.prod=function(n,r){if(this.shouldExecuteOnCPU([n]))return this.cpuBackend.prod(n,r);var o=Gt(n.shape,r),i=o[0],a=le(o[1]),s=n.as2D(-1,a),u=kf(n.dtype);return this.reduce(s,"prod",u).reshape(i)},t.prototype.unsortedSegmentSum=function(n,r,o){var i=0,a=Tr([i],n.rank),s=n;a!=null&&(s=n.transpose(a),i=Nr(1,n.rank)[0]);var u=function(h,p,v){for(var g=[],m=h.length,y=0;y<m;y++)y!==p?g.push(h[y]):g.push(v);return g}(s.shape,i,o),l=le([s.shape[i]]),c=s.as2D(-1,l),f=kf(n.dtype),d=this.segOpCompute(c,"unsortedSegmentSum",r,f,o).reshape(u);return a!=null&&(d=d.transpose(Ap(a))),d},t.prototype.segOpCompute=function(n,r,o,i,a){var s=n.shape[0],u=n.shape[1],l=function(d,h){var p,v=!1;for(d<=ow?(p=d,v=!0):p=ih(d,Math.floor(Math.sqrt(d)));!v;)p>h||p===d?v=!0:p=ih(d,p+1);return p}(u,a),c=new eT({windowSize:l,inSize:u,batchSize:s,numSegments:a}),f=this.compileAndRun(c,[n,o],i);return f.shape[1]===a?f:(o=Wl(0,a).tile([u/l]),this.segOpCompute(f,r,o,i,a))},t.prototype.argMinMaxReduce=function(n,r,o){var i=[r];if(En("arg"+o.charAt(0).toUpperCase()+o.slice(1),i,n.rank),!G().getBool("WEBGL_PACK_REDUCE")||n.rank<=2){var a=Gt(n.shape,i),s=a[0],u=le(a[1]),l=n.as2D(-1,u);return this.argReduce(l,o).reshape(s)}return this.argReducePacked(n,o)},t.prototype.argMin=function(n,r){return this.argMinMaxReduce(n,r,"min")},t.prototype.argMax=function(n,r){return this.argMinMaxReduce(n,r,"max")},t.prototype.cumsum=function(n,r,o,i){if(r!==n.rank-1)throw new Error("WebGL cumsum shader expects an inner-most axis="+(n.rank-1)+" but got axis="+r);var a=new rD(n.shape,o,i);return this.compileAndRun(a,[n])},t.prototype.equal=function(n,r){if(G().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(n,r,`
  return vec4(equal(a, b));
`,"bool");var o=new ht("return float(a == b);",n.shape,r.shape);return this.compileAndRun(o,[n,r],"bool")},t.prototype.notEqual=function(n,r){if(G().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(n,r,`
  return vec4(notEqual(a, b));
`,"bool");var o=new ht("return float(a != b);",n.shape,r.shape);return this.compileAndRun(o,[n,r],"bool")},t.prototype.less=function(n,r){if(this.shouldExecuteOnCPU([n,r]))return this.cpuBackend.less(n,r);if(G().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(n,r,`
  return vec4(lessThan(a, b));
`,"bool");var o=new ht("return float(a < b);",n.shape,r.shape);return this.compileAndRun(o,[n,r],"bool")},t.prototype.lessEqual=function(n,r){if(G().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(n,r,`
  return vec4(lessThanEqual(a, b));
`,"bool");var o=new ht("return float(a <= b);",n.shape,r.shape);return this.compileAndRun(o,[n,r],"bool")},t.prototype.greater=function(n,r){if(this.shouldExecuteOnCPU([n,r]))return this.cpuBackend.greater(n,r);if(G().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(n,r,`
  return vec4(greaterThan(a, b));
`,"bool");var o=new ht("return float(a > b);",n.shape,r.shape);return this.compileAndRun(o,[n,r],"bool")},t.prototype.greaterEqual=function(n,r){if(G().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(n,r,`
  return vec4(greaterThanEqual(a, b));
`,"bool");var o=new ht("return float(a >= b);",n.shape,r.shape);return this.compileAndRun(o,[n,r],"bool")},t.prototype.logicalNot=function(n){var r=new ke(n.shape,"return float(!(x >= 1.0));");return this.compileAndRun(r,[n])},t.prototype.logicalAnd=function(n,r){if(G().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(n,r,`
  return vec4(
    vec4(greaterThanEqual(a, vec4(1.0))) *
    vec4(greaterThanEqual(b, vec4(1.0))));
`,"bool");var o=new ht("return float(a >= 1.0 && b >= 1.0);",n.shape,r.shape);return this.compileAndRun(o,[n,r],"bool")},t.prototype.logicalOr=function(n,r){if(G().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(n,r,`
  return min(
    vec4(greaterThanEqual(a, vec4(1.0))) +
    vec4(greaterThanEqual(b, vec4(1.0))),
    vec4(1.0));
`,"bool");var o=new ht("return float(a >= 1.0 || b >= 1.0);",n.shape,r.shape);return this.compileAndRun(o,[n,r],"bool")},t.prototype.select=function(n,r,o){var i=new tT(n.rank,r.shape,r.rank);return this.compileAndRun(i,[n,r,o],Ut(r.dtype,o.dtype))},t.prototype.where=function(n){Bl("tf.where() in webgl locks the UI thread. Call tf.whereAsync() instead");var r=n.dataSync();return Wp(n.shape,r)},t.prototype.topk=function(n,r,o){return vw(n.dataSync(),n.shape,n.dtype,r)},t.prototype.min=function(n,r){En("min",r,n.rank);var o=Gt(n.shape,r),i=o[0],a=le(o[1]),s=n.as2D(-1,a);return this.reduce(s,"min",s.dtype).reshape(i)},t.prototype.minimum=function(n,r){if(this.shouldExecuteOnCPU([n,r]))return this.cpuBackend.minimum(n,r);var o=G().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Mr(`
  vec4 result = vec4(min(a, b));
  vec4 isNaN = min(vec4(isnan(a)) + vec4(isnan(b)), vec4(1.0));
  
  result.r = isNaN.r > 0. ? NAN : result.r;
  result.g = isNaN.g > 0. ? NAN : result.g;
  result.b = isNaN.b > 0. ? NAN : result.b;
  result.a = isNaN.a > 0. ? NAN : result.a;

  return result;
`,n.shape,r.shape):new ht(`
  if (isnan(a)) return a;
  if (isnan(b)) return b;

  return min(a, b);
`,n.shape,r.shape);return this.compileAndRun(o,[n,r])},t.prototype.mod=function(n,r){var o=G().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Mr(`
  vec4 result = mod(a, b);
  vec4 isNaN = vec4(equal(b, vec4(0.0)));
  
  result.r = isNaN.r > 0. ? NAN : result.r;
  result.g = isNaN.g > 0. ? NAN : result.g;
  result.b = isNaN.b > 0. ? NAN : result.b;
  result.a = isNaN.a > 0. ? NAN : result.a;

  return result;
`,n.shape,r.shape):new ht(`if (b == 0.0) return NAN;
  return mod(a, b);`,n.shape,r.shape);return this.compileAndRun(o,[n,r])},t.prototype.max=function(n,r){if(this.shouldExecuteOnCPU([n]))return this.cpuBackend.max(n,r);En("max",r,n.rank);var o=Gt(n.shape,r),i=o[0],a=le(o[1]),s=n.as2D(-1,a);return this.reduce(s,"max",s.dtype).reshape(i)},t.prototype.maximum=function(n,r){if(this.shouldExecuteOnCPU([n,r]))return this.cpuBackend.maximum(n,r);var o=G().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Mr(`
  vec4 result = vec4(max(a, b));
  vec4 isNaN = min(vec4(isnan(a)) + vec4(isnan(b)), vec4(1.0));
  
  result.r = isNaN.r > 0. ? NAN : result.r;
  result.g = isNaN.g > 0. ? NAN : result.g;
  result.b = isNaN.b > 0. ? NAN : result.b;
  result.a = isNaN.a > 0. ? NAN : result.a;

  return result;
`,n.shape,r.shape):new ht(`
  if (isnan(a)) return a;
  if (isnan(b)) return b;

  return max(a, b);
`,n.shape,r.shape);return this.compileAndRun(o,[n,r])},t.prototype.all=function(n,r){En("all",r,n.rank);var o=Gt(n.shape,r),i=o[0],a=le(o[1]),s=n.as2D(-1,a);return this.reduce(s,"all",s.dtype).reshape(i)},t.prototype.any=function(n,r){En("any",r,n.rank);var o=Gt(n.shape,r),i=o[0],a=le(o[1]),s=n.as2D(-1,a);return this.reduce(s,"any",s.dtype).reshape(i)},t.prototype.realDivide=function(n,r){if(G().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(n,r,`
  // vec4 one = vec4(equal(a, b));
  // return one + (vec4(1.0) - one) * a / b;
  vec4 result = a / b;
  if(a.x == b.x) {
    result.x = 1.;
  }
  if(a.y == b.y) {
    result.y = 1.;
  }
  if(a.z == b.z) {
    result.z = 1.;
  }
  if(a.w == b.w) {
    result.w = 1.;
  }

  return result;
`,"float32",!0);var o=new ht(`
if (a == b) {
  return 1.0;
};
return a / b;`,n.shape,r.shape);return this.compileAndRun(o,[n,r],"float32")},t.prototype.floorDiv=function(n,r){if(G().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(n,r,`
  ivec4 ia = round(a);
  ivec4 ib = round(b);
  bvec4 cond = notEqual(ib, ivec4(0));
  ivec4 result = ivec4(0);
  vec4 s = sign(a) * sign(b);

  // Windows (D3D) wants guaranteed non-zero int division at compile-time.
  if (cond[0]) {
    result[0] = idiv(ia[0], ib[0], s[0]);
  }
  if (cond[1]) {
    result[1] = idiv(ia[1], ib[1], s[1]);
  }
  if (cond[2]) {
    result[2] = idiv(ia[2], ib[2], s[2]);
  }
  if (cond[3]) {
    result[3] = idiv(ia[3], ib[3], s[3]);
  }
  return vec4(result);
`,"int32");var o=new ht(`
  float s = sign(a) * sign(b);
  int ia = round(a);
  int ib = round(b);
  if (ib != 0) {
    // Windows (D3D) wants guaranteed non-zero int division at compile-time.
    return float(idiv(ia, ib, s));
  } else {
    return NAN;
  }
`,n.shape,r.shape);return this.compileAndRun(o,[n,r],"int32")},t.prototype.add=function(n,r){if(n.dtype==="complex64"&&r.dtype==="complex64")return this.complexSeparableBinaryOp(n,r,Of);if(this.shouldExecuteOnCPU([n,r]))return this.cpuBackend.add(n,r);var o=Ut(n.dtype,r.dtype);if(G().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(n,r,Of,o);var i=new ht(Of,n.shape,r.shape);return this.compileAndRun(i,[n,r],o)},t.prototype.packedUnaryOp=function(n,r,o){var i=new Ga(n.shape,r);return this.compileAndRun(i,[n],o)},t.prototype.packedBinaryOp=function(n,r,o,i,a){a===void 0&&(a=!1);var s=new Mr(o,n.shape,r.shape,a);return this.compileAndRun(s,[n,r],i)},t.prototype.complexSeparableBinaryOp=function(n,r,o){var i=this,a=this.texData.get(n.dataId),s=this.texData.get(r.dataId),u=[[a.complexTensors.real,s.complexTensors.real],[a.complexTensors.imag,s.complexTensors.imag]].map(function(d){var h=d[0],p=d[1],v=i.makeComplexComponentTensorInfo(n,h),g=i.makeComplexComponentTensorInfo(r,p),m=new ht(o,n.shape,r.shape);return i.compileAndRun(m,[v,g],Ut(h.dtype,p.dtype))}),l=u[0],c=u[1],f=this.complex(l,c);return l.dispose(),c.dispose(),f},t.prototype.makeComplexComponentTensorInfo=function(n,r){return{dataId:r.dataId,dtype:r.dtype,shape:n.shape}},t.prototype.addN=function(n){if(n.length===1)return n[0];if(n.length>G().get("WEBGL_MAX_TEXTURES_IN_SHADER")){var r=Math.floor(n.length/2),o=this.addN(n.slice(0,r)),i=this.addN(n.slice(r));return this.addN([o,i])}var a=n.map(function(l){return l.dtype}).reduce(function(l,c){return Ut(l,c)}),s=n.map(function(l){return l.shape}),u=G().getBool("WEBGL_PACK")?new TI(n[0].shape,s):new DI(n[0].shape,s);return this.compileAndRun(u,n,a)},t.prototype.subtract=function(n,r){if(n.dtype==="complex64"&&r.dtype==="complex64")return this.complexSeparableBinaryOp(n,r,Lf);if(this.shouldExecuteOnCPU([n,r]))return this.cpuBackend.subtract(n,r);var o=Ut(n.dtype,r.dtype);if(G().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(n,r,Lf,n.dtype);var i=new ht(Lf,n.shape,r.shape);return this.compileAndRun(i,[n,r],o)},t.prototype.pow=function(n,r){var o=G().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Mr(`
  // isModRound1 has 1 for components with round(mod(b, 2.0)) == 1, 0 otherwise.
  vec4 isModRound1 = vec4(equal(round(mod(b, 2.0)), ivec4(1)));
  vec4 multiplier = sign(a) * isModRound1 + (vec4(1.0) - isModRound1);
  vec4 result = multiplier * pow(abs(a), b);

  // Ensure that a^0 = 1, including 0^0 = 1 as this correspond to TF and JS
  bvec4 isExpZero = equal(b, vec4(0.0));
  result.r = isExpZero.r ? 1.0 : result.r;
  result.g = isExpZero.g ? 1.0 : result.g;
  result.b = isExpZero.b ? 1.0 : result.b;
  result.a = isExpZero.a ? 1.0 : result.a;

  vec4 isNaN = vec4(lessThan(a, vec4(0.0))) * vec4(lessThan(floor(b), b));
  
  result.r = isNaN.r > 0. ? NAN : result.r;
  result.g = isNaN.g > 0. ? NAN : result.g;
  result.b = isNaN.b > 0. ? NAN : result.b;
  result.a = isNaN.a > 0. ? NAN : result.a;

  return result;
`,n.shape,r.shape):new ht(`
if(a < 0.0 && floor(b) < b){
  return NAN;
}
if (b == 0.0) {
  return 1.0;
}
return (round(mod(b, 2.0)) != 1) ?
    pow(abs(a), b) : sign(a) * pow(abs(a), b);
`,n.shape,r.shape),i=Ut(n.dtype,r.dtype);return this.compileAndRun(o,[n,r],i)},t.prototype.ceil=function(n){if(this.shouldExecuteOnCPU([n]))return this.cpuBackend.ceil(n);if(G().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(n,oy,n.dtype);var r=new ke(n.shape,oy);return this.compileAndRun(r,[n])},t.prototype.floor=function(n){if(this.shouldExecuteOnCPU([n]))return this.cpuBackend.floor(n);if(G().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(n,iy,n.dtype);var r=new ke(n.shape,iy);return this.compileAndRun(r,[n])},t.prototype.sign=function(n){var r=new ke(n.shape,`
  if (isnan(x)) { return 0.0; }
  return sign(x);
`);return this.compileAndRun(r,[n])},t.prototype.isNaN=function(n){var r=new ke(n.shape,"return float(isnan(x));");return this.compileAndRun(r,[n],"bool")},t.prototype.isInf=function(n){var r=new ke(n.shape,"return float(isinf(x));");return this.compileAndRun(r,[n],"bool")},t.prototype.isFinite=function(n){var r=new ke(n.shape,"return float(!isnan(x) && !isinf(x));");return this.compileAndRun(r,[n],"bool")},t.prototype.round=function(n){var r=new ke(n.shape,`
  // OpenGL ES does not support round function.
  // The algorithm is based on banker's rounding.
  float base = floor(x);
  if ((x - base) < 0.5) {
    return floor(x);
  } else if ((x - base) > 0.5) {
    return ceil(x);
  } else {
    if (mod(base, 2.0) == 0.0) {
      return base;
    } else {
      return base + 1.0;
    }
  }
`);return this.compileAndRun(r,[n])},t.prototype.exp=function(n){if(this.shouldExecuteOnCPU([n]))return this.cpuBackend.exp(n);if(G().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(n,ay,n.dtype);var r=new ke(n.shape,ay);return this.compileAndRun(r,[n])},t.prototype.expm1=function(n){if(this.shouldExecuteOnCPU([n]))return this.cpuBackend.expm1(n);if(G().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(n,sy,n.dtype);var r=new ke(n.shape,sy);return this.compileAndRun(r,[n])},t.prototype.softmax=function(n,r){var o=Dt([r],n.shape),i=this.max(n,o),a=mn(i.shape,o),s=this.subtract(n,i.reshape(a)),u=this.exp(s),l=this.sum(u,o).reshape(a);return this.realDivide(u,l)},t.prototype.log=function(n){if(this.shouldExecuteOnCPU([n]))return this.cpuBackend.log(n);if(G().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(n,`
  vec4 result = log(x);
  vec4 isNaN = vec4(lessThan(x, vec4(0.0)));
  result.r = isNaN.r == 1.0 ? NAN : result.r;
  result.g = isNaN.g == 1.0 ? NAN : result.g;
  result.b = isNaN.b == 1.0 ? NAN : result.b;
  result.a = isNaN.a == 1.0 ? NAN : result.a;

  return result;
`,n.dtype);var r=new ke(n.shape,`if (x < 0.0) return NAN;
  return log(x);`);return this.compileAndRun(r,[n])},t.prototype.log1p=function(n){var r=new ke(n.shape,"return log(1.0 + x);");return this.compileAndRun(r,[n])},t.prototype.sqrt=function(n){var r=new ke(n.shape,"return sqrt(x);");return this.compileAndRun(r,[n])},t.prototype.rsqrt=function(n){if(this.shouldExecuteOnCPU([n]))return this.cpuBackend.rsqrt(n);var r=new ke(n.shape,"return inversesqrt(x);");return this.compileAndRun(r,[n])},t.prototype.reciprocal=function(n){var r=new ke(n.shape,"return 1.0 / x;");return this.compileAndRun(r,[n])},t.prototype.relu=function(n){var r;return r=G().getBool("WEBGL_PACK")?new Ga(n.shape,_w):new ke(n.shape,bw),this.compileAndRun(r,[n])},t.prototype.relu6=function(n){var r;return r=G().getBool("WEBGL_PACK")?new Ga(n.shape,Sw):new ke(n.shape,Ew),this.compileAndRun(r,[n])},t.prototype.prelu=function(n,r){var o=G().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Mr(ww,n.shape,r.shape):new ht(xw,n.shape,r.shape);return this.compileAndRun(o,[n,r])},t.prototype.elu=function(n){if(G().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(n,Rw,n.dtype);var r=new ke(n.shape,Cw);return this.compileAndRun(r,[n])},t.prototype.eluDer=function(n,r){var o=G().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Mr(`
  vec4 bGTEZero = vec4(greaterThanEqual(b, vec4(0.)));
  return (bGTEZero * a) + ((vec4(1.0) - bGTEZero) * (a * (b + vec4(1.0))));
`,n.shape,r.shape):new ht("return (b >= 1.0) ? a : a * (b + 1.0);",n.shape,r.shape);return this.compileAndRun(o,[n,r])},t.prototype.selu=function(n){var r=new ke(n.shape,cT);return this.compileAndRun(r,[n])},t.prototype.int=function(n){var r=new ke(n.shape,"return float(int(x));");return this.compileAndRun(r,[n],"int32")},t.prototype.clip=function(n,r,o){var i,a=(i=G().getBool("WEBGL_PACK_CLIP")?new HI(n.shape):new $I(n.shape)).getCustomSetupFunc(r,o);return this.compileAndRun(i,[n],null,a)},t.prototype.abs=function(n){if(this.shouldExecuteOnCPU([n]))return this.cpuBackend.abs(n);if(G().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(n,ny,n.dtype);var r=new ke(n.shape,ny);return this.compileAndRun(r,[n])},t.prototype.complexAbs=function(n){var r=this.texData.get(n.dataId),o=new GI(n.shape),i=[this.makeComplexComponentTensorInfo(n,r.complexTensors.real),this.makeComplexComponentTensorInfo(n,r.complexTensors.imag)];return this.compileAndRun(o,i)},t.prototype.sigmoid=function(n){var r=new ke(n.shape,"return 1.0 / (1.0 + exp(-1.0 * x));");return this.compileAndRun(r,[n])},t.prototype.softplus=function(n){var r=new ke(n.shape,`
  float epsilon = 1.1920928955078125e-7;
  float threshold = log(epsilon) + 2.0;

  bool too_large = x > -threshold;
  bool too_small = x < threshold;

  float result;
  float exp_x = exp(x);

  if (too_large){
    result = x;
  }
  else if (too_small){
    result = exp_x;
  }
  else{
    result = log(exp_x + 1.0);
  }
  return result;
`);return this.compileAndRun(r,[n])},t.prototype.sin=function(n){var r=new ke(n.shape,fT);return this.compileAndRun(r,[n])},t.prototype.cos=function(n){var r=new ke(n.shape,dT);return this.compileAndRun(r,[n])},t.prototype.tan=function(n){var r=new ke(n.shape,"return tan(x);");return this.compileAndRun(r,[n])},t.prototype.asin=function(n){var r=new ke(n.shape,hT);return this.compileAndRun(r,[n])},t.prototype.acos=function(n){var r=new ke(n.shape,pT);return this.compileAndRun(r,[n])},t.prototype.atan=function(n){var r=new ke(n.shape,vT);return this.compileAndRun(r,[n])},t.prototype.atan2=function(n,r){var o=G().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Mr(`
  vec4 result = atan(a, b);
  vec4 isNaN = min(vec4(isnan(a)) + vec4(isnan(b)), vec4(1.0));
  
  result.r = isNaN.r > 0. ? NAN : result.r;
  result.g = isNaN.g > 0. ? NAN : result.g;
  result.b = isNaN.b > 0. ? NAN : result.b;
  result.a = isNaN.a > 0. ? NAN : result.a;

  return result;
`,n.shape,r.shape):new ht(`
  if (isnan(a)) return a;
  if (isnan(b)) return b;

  return atan(a, b);
`,n.shape,r.shape);return this.compileAndRun(o,[n,r])},t.prototype.sinh=function(n){var r=new ke(n.shape,`
  float e2x = exp(x);
  return (e2x - 1.0 / e2x) / 2.0;
`);return this.compileAndRun(r,[n])},t.prototype.cosh=function(n){var r=new ke(n.shape,`
  float e2x = exp(-x);
  return (e2x + 1.0 / e2x) / 2.0;
`);return this.compileAndRun(r,[n])},t.prototype.tanh=function(n){var r=new ke(n.shape,`
  float e2x = exp(-2.0 * abs(x));
  return sign(x) * (1.0 - e2x) / (1.0 + e2x);
`);return this.compileAndRun(r,[n])},t.prototype.asinh=function(n){var r=new ke(n.shape,mT);return this.compileAndRun(r,[n])},t.prototype.acosh=function(n){var r=new ke(n.shape,gT);return this.compileAndRun(r,[n])},t.prototype.atanh=function(n){var r=new ke(n.shape,yT);return this.compileAndRun(r,[n])},t.prototype.erf=function(n){var r=new ke(n.shape,`
  // Error function is calculated approximately with elementary function.
  // See "Handbook of Mathematical Functions with Formulas,
  // Graphs, and Mathematical Tables", Abramowitz and Stegun.
  float p = 0.3275911;
  float a1 = 0.254829592;
  float a2 = -0.284496736;
  float a3 = 1.421413741;
  float a4 = -1.453152027;
  float a5 = 1.061405429;

  float sign = sign(x);
  x = abs(x);
  float t = 1.0 / (1.0 + p * x);
  return sign * (1.0 - (((((a5*t + a4)*t) + a3)*t + a2)*t + a1)*t*exp(-x*x));
`);return this.compileAndRun(r,[n])},t.prototype.step=function(n,r){var o=new ke(n.shape,function(i){return i===void 0&&(i=0),cr+`
    return x > 0.0 ? 1.0 : float(`+i+`);
  `}(r));return this.compileAndRun(o,[n])},t.prototype.conv2dByMatMul=function(n,r,o,i,a,s){var u=n.shape,l=this.texData.get(n.dataId),c=o.inChannels,f=u[0]*u[1]*u[2],d=o.outChannels,h=o.dataFormat==="channelsLast",p=(f===1||d===1)&&c>1e3,v=u[2]%2!=0&&!!l.isPacked;if(p||!G().getBool("WEBGL_LAZILY_UNPACK")||!G().getBool("WEBGL_PACK_BINARY_OPERATIONS")||!v){var g=h?u[0]*u[1]*u[2]:u[0]*u[2]*u[3],m=this.reshape(n,[1,g,o.inChannels]),y=this.reshape(r,[1,o.inChannels,o.outChannels]);return this.reshape(this.fusedBatchMatMul({a:m,b:y,transposeA:!1,transposeB:!1,bias:i,activation:a,preluActivationWeights:s}),o.outShape)}var x=h?u[0]*u[1]*(u[2]+1):u[0]*u[2]*(u[3]+1),w={dataId:n.dataId,shape:[1,x,o.inChannels],dtype:n.dtype},E=l.shape;l.shape=l.shape.slice(),l.shape[l.shape.length-2]++,I(Tu(l.shape,w.shape),function(){return"packed reshape "+l.shape+" to "+w.shape+" isn't free"});var b=this.reshape(r,[1,o.inChannels,o.outChannels]),C=this.fusedBatchMatMul({a:w,b,transposeA:!1,transposeB:!1,bias:i,activation:a,preluActivationWeights:s}),_=this.texData.get(C.dataId);return I(_.isPacked,function(){return"batchMatMul result is expected to be packed"}),l.shape=E,_.shape=o.outShape,P.makeTensorFromDataId(C.dataId,o.outShape,C.dtype)},t.prototype.conv2dWithIm2Row=function(n,r,o,i,a,s){var u=o.filterWidth,l=o.filterHeight,c=o.inChannels,f=o.outWidth,d=o.outHeight,h=o.dataFormat==="channelsLast",p=u*l*c,v=d*f,g=[p,v],m=n.squeeze([0]),y=r.reshape([1,p,-1]),x=new FD(g,m.shape,o),w=this.compileAndRun(x,[m]).reshape([1,g[0],g[1]]),E=i!=null,b=s!=null,C=a?Fu(a,!0):null,_=new Bf(w.shape,[1,v,o.outChannels],!0,!1,E,C,b),S=[w,y];i&&S.push(i),b&&S.push(s);var R=this.compileAndRun(_,S);return h?R.reshape([1,d,f,o.outChannels]):R.reshape([1,o.outChannels,d,f])},t.prototype.fusedConv2d=function(n){var r=n.input,o=n.filter,i=n.convInfo,a=n.bias,s=n.activation,u=n.preluActivationWeights;if(i.filterHeight===1&&i.filterWidth===1&&i.dilationHeight===1&&i.dilationWidth===1&&i.strideHeight===1&&i.strideWidth===1&&(i.padInfo.type==="SAME"||i.padInfo.type==="VALID"))return this.conv2dByMatMul(r,o,i,a,s,u);if(G().getBool("WEBGL_CONV_IM2COL")&&r.shape[0]===1)return this.conv2dWithIm2Row(r,o,i,a,s,u);var l=a!=null,c=u!=null,f=s?Fu(s,!1):null,d=new qg(i,l,f,c),h=[r,o];return a&&h.push(a),u&&h.push(u),this.compileAndRun(d,h)},t.prototype.conv2d=function(n,r,o){if(o.filterHeight===1&&o.filterWidth===1&&o.dilationHeight===1&&o.dilationWidth===1&&o.strideHeight===1&&o.strideWidth===1&&(o.padInfo.type==="SAME"||o.padInfo.type==="VALID"))return this.conv2dByMatMul(n,r,o);if(G().getBool("WEBGL_CONV_IM2COL")&&n.shape[0]===1)return this.conv2dWithIm2Row(n,r,o);var i=new qg(o);return this.compileAndRun(i,[n,r])},t.prototype.conv2dDerInput=function(n,r,o){var i=new YI(o);return this.compileAndRun(i,[n,r])},t.prototype.conv2dDerFilter=function(n,r,o){var i=new XI(o);return this.compileAndRun(i,[n,r])},t.prototype.fusedDepthwiseConv2D=function(n){var r,o=n.input,i=n.filter,a=n.convInfo,s=n.bias,u=n.activation,l=n.preluActivationWeights,c=G().getBool("WEBGL_PACK_DEPTHWISECONV")&&a.strideWidth<=2&&a.outChannels/a.inChannels==1,f=u?Fu(u,c):null,d=[o,i],h=s!=null,p=l!=null;return h&&d.push(s),p&&d.push(l),c?(r=new Xg(a,h,f,p),this.compileAndRun(r,d)):(r=new Kg(a,h,f,p),this.compileAndRun(r,d))},t.prototype.depthwiseConv2D=function(n,r,o){var i;return G().getBool("WEBGL_PACK_DEPTHWISECONV")&&o.strideWidth<=2&&o.outChannels/o.inChannels==1?(i=new Xg(o),this.compileAndRun(i,[n,r])):(i=new Kg(o),this.compileAndRun(i,[n,r]))},t.prototype.depthwiseConv2DDerInput=function(n,r,o){var i=new eD(o);return this.compileAndRun(i,[n,r])},t.prototype.depthwiseConv2DDerFilter=function(n,r,o){var i=new ZI(o);return this.compileAndRun(i,[n,r])},t.prototype.conv3d=function(n,r,o){var i=new tD(o);return this.compileAndRun(i,[n,r])},t.prototype.conv3dDerInput=function(n,r,o){var i=new JI(o);return this.compileAndRun(i,[n,r])},t.prototype.conv3dDerFilter=function(n,r,o){var i=new QI(o);return this.compileAndRun(i,[n,r])},t.prototype.maxPool=function(n,r){var o=new Uf(r,"max",!1);return this.compileAndRun(o,[n])},t.prototype.avgPool=function(n,r){var o=new Uf(r,"avg",!1);return this.compileAndRun(o,[n],"float32")},t.prototype.maxPoolBackprop=function(n,r,o,i){var a=new Uf(i,"max",!0),s=this.compileAndRun(a,[r]),u=new BD(i),l=this.compileAndRun(u,[n,s],r.dtype);return s.dispose(),l},t.prototype.avgPoolBackprop=function(n,r,o){var i=new BI(o);return this.compileAndRun(i,[n],r.dtype)},t.prototype.cast=function(n,r){return cw(n,r,this)},t.prototype.unstack=function(n,r){for(var o=n.shape[r],i=new Array(n.rank-1),a=0,s=0;s<n.rank;s++)s!==r&&(i[a++]=n.shape[s]);var u=new Array(n.rank).fill(0),l=n.shape.slice();l[r]=1;var c=new Array(o);for(s=0;s<c.length;s++)u[r]=s,c[s]=this.slice(n,u,l).reshape(i);return c},t.prototype.avgPool3d=function(n,r){var o=new Wf(r,"avg",!1);return this.compileAndRun(o,[n],"float32")},t.prototype.avgPool3dBackprop=function(n,r,o){var i=new UI(o);return this.compileAndRun(i,[n],r.dtype)},t.prototype.maxPool3d=function(n,r){var o=new Wf(r,"max",!1);return this.compileAndRun(o,[n],"float32")},t.prototype.maxPool3dBackprop=function(n,r,o,i){var a=new Wf(i,"max",!0),s=this.compileAndRun(a,[r]),u=new UD(i),l=this.compileAndRun(u,[n,s],r.dtype);return s.dispose(),l},t.prototype.reshape=function(n,r){var o=this.texData.get(n.dataId);if(o.isPacked&&!Tu(n.shape,r)&&(o.texture===null||!Tu(o.shape,r))){var i=this.packedReshape(n,r);return P.makeTensorFromDataId(i.dataId,i.shape,i.dtype)}return hh(n,r)},t.prototype.resizeBilinear=function(n,r,o,i){var a=G().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new XD(n.shape,r,o,i):new KD(n.shape,r,o,i);return this.compileAndRun(a,[n],"float32")},t.prototype.resizeBilinearBackprop=function(n,r,o){var i=new qD(n,r,o);return this.compileAndRun(i,[n])},t.prototype.resizeNearestNeighbor=function(n,r,o,i){var a=new QD(n.shape,r,o,i);return this.compileAndRun(a,[n])},t.prototype.resizeNearestNeighborBackprop=function(n,r,o){var i=new YD(n,r,o);return this.compileAndRun(i,[n])},t.prototype.multinomial=function(n,r,o,i){var a=r?n:Xr(n),s=a.shape[0],u=a.shape[1],l=new WD(s,u,o),c=l.getCustomSetupFunc(i);return this.compileAndRun(l,[a],"int32",c)},t.prototype.oneHot=function(n,r,o,i){var a=new zD(n.size,r,o,i);return this.compileAndRun(a,[n])},t.prototype.diag=function(n){var r=new sD(n.size);return this.compileAndRun(r,[n])},t.prototype.nonMaxSuppression=function(n,r,o,i,a){return Bl("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead"),Bp(n.dataSync(),r.dataSync(),o,i,a)},t.prototype.cropAndResize=function(n,r,o,i,a,s){var u=new nD(n.shape,r.shape,i,a,s);return this.compileAndRun(u,[n,r,o],"float32")},t.prototype.depthToSpace=function(n,r,o){I(r>1,function(){return"blockSize should be > 1 for depthToSpace, but was: "+r});var i=n.shape[0],a=o==="NHWC"?n.shape[1]:n.shape[2],s=o==="NHWC"?n.shape[2]:n.shape[3],u=o==="NHWC"?n.shape[3]:n.shape[1],l=a*r,c=s*r,f=u/(r*r),d=new aD(o==="NHWC"?[i,l,c,f]:[i,f,l,c],r,o);return this.compileAndRun(d,[n])},t.prototype.split=function(n,r,o){return hw(n,r,o)},t.prototype.scatterND=function(n,r,o){var i=$l(0,n,o),a=i.sliceRank,s=i.numUpdates,u=i.sliceSize,l=i.strides,c=i.outputSize,f=[c/u,u],d=n.reshape([s,a]),h=r.reshape([s,u]);if(c===0)return hh(Wt([]),o);var p=ne(0),v=new Zg(s,a,d.rank,h.rank,l,f);return this.compileAndRun(v,[h,d,p]).reshape(o)},t.prototype.sparseToDense=function(n,r,o,i){var a=$l(0,n,o),s=a.sliceRank,u=a.numUpdates,l=a.strides,c=a.outputSize,f=new Zg(u,s,n.rank,r.rank,l,[c,1]);return this.compileAndRun(f,[r,n,i]).reshape(o)},t.prototype.fft=function(n){return this.fftImpl(n,!1)},t.prototype.ifft=function(n){return this.fftImpl(n,!0)},t.prototype.fftImpl=function(n,r){var o=this.texData.get(n.dataId),i=new Qg(dD,n.shape,r),a=new Qg(hD,n.shape,r),s=[this.makeComplexComponentTensorInfo(n,o.complexTensors.real),this.makeComplexComponentTensorInfo(n,o.complexTensors.imag)],u=this.compileAndRun(i,s),l=this.compileAndRun(a,s),c=this.complex(u,l).as2D(n.shape[0],n.shape[1]);return u.dispose(),l.dispose(),c},t.prototype.gatherND=function(n,r){var o=r.shape,i=o[o.length-1],a=rw(n,r),s=a[0],u=a[1],l=a[2],c=a[3],f=r.reshape([u,i]),d=n.reshape([n.size/l,l]),h=new mD(i,c,[u,l]);return this.compileAndRun(h,[d,f]).reshape(s)},t.prototype.fill=function(n,r,o){if((o=o||Gs(r))==="string"){var i=Fl(o,le(n));return i.fill(r),P.makeTensor(i,n,o,this)}var a=new pD(n,r),s=a.getCustomSetupFunc(r);return this.compileAndRun(a,[],o,s)},t.prototype.onesLike=function(n){if(n.dtype==="string")throw new Error("onesLike is not supported under string dtype");return this.fill(n.shape,1,n.dtype)},t.prototype.zerosLike=function(n){return this.fill(n.shape,n.dtype==="string"?"":0,n.dtype)},t.prototype.linspace=function(n,r,o){return fw(n,r,o)},t.prototype.makeTensorInfo=function(n,r){var o=this.write(null,n,r);return this.texData.get(o).usage=null,{dataId:o,shape:n,dtype:r}},t.prototype.makeOutput=function(n,r){var o=this.makeTensorInfo(n,r).dataId;return P.makeTensorFromDataId(o,n,r,this)},t.prototype.unpackTensor=function(n){var r=new wT(n.shape);return this.runWebGLProgram(r,[n],n.dtype)},t.prototype.packTensor=function(n){var r=new jD(n.shape);return this.runWebGLProgram(r,[n],n.dtype,null,!0)},t.prototype.packedReshape=function(n,r){var o=[Ol(n.shape)].concat(Ll(n.shape)),i={dtype:n.dtype,shape:o,dataId:n.dataId},a=[Ol(r)].concat(Ll(r)),s=new GD(a,o),u=this.runWebGLProgram(s,[i],n.dtype,null,!0);return{dataId:u.dataId,shape:r,dtype:u.dtype}},t.prototype.decode=function(n){var r,o=this.texData.get(n),i=o.isPacked,a=o.shape,s=o.dtype,u=Ff(a);return r=i?new iD(u):new oD(u),{dtype:s,shape:a,dataId:this.runWebGLProgram(r,[{shape:u,dtype:s,dataId:n}],s,null,!0).dataId}},t.prototype.runWebGLProgram=function(n,r,o,i,a){var s=this;a===void 0&&(a=!1);var u=this.makeTensorInfo(n.outputShape,o),l=this.texData.get(u.dataId);if(n.packedOutput&&(l.isPacked=!0),n.outPackingScheme===Ps.DENSE){var c=ss(n.outputShape);l.texShape=c.map(function(x){return 2*x})}if(n.outTexUsage!=null&&(l.usage=n.outTexUsage),le(u.shape)===0)return l.values=Ns(u.dtype,0),u;var f=[],d=r.map(function(x){if(x.dtype==="complex64")throw new Error("GPGPUProgram does not support complex64 input. For complex64 dtypes, please separate the program into real and imaginary parts.");var w=s.texData.get(x.dataId);if(w.texture==null){if(!n.packedInputs&&le(x.shape)<=G().getNumber("WEBGL_SIZE_UPLOAD_UNIFORM"))return{shape:x.shape,texData:null,isUniform:!0,uniformValues:w.values};n.packedInputs&&(w.isPacked=!0,w.shape=x.shape)}else if(!!w.isPacked!=!!n.packedInputs)x=w.isPacked?s.unpackTensor(x):s.packTensor(x),f.push(x),w=s.texData.get(x.dataId);else if(w.isPacked&&!Tu(w.shape,x.shape)){var E=x,b=x.shape;x.shape=w.shape,x=s.packedReshape(x,b),f.push(x),w=s.texData.get(x.dataId),E.shape=b}return s.uploadToGPU(x.dataId),{shape:x.shape,texData:w,isUniform:!1}});this.uploadToGPU(u.dataId);var h,p={shape:u.shape,texData:l,isUniform:!1},v=function(x,w,E){var b="";w.concat(E).forEach(function(S){var R=S.texData!=null&&S.texData.slice!=null&&S.texData.slice.flatOffset>0,D=S.isUniform?"uniform":S.texData.texShape;b+=S.shape+"_"+D+"_"+R});var C=x.userCode,_=x.constructor.name;return _+="_"+b+"_"+C}(n,d,p),g=this.getAndSaveBinary(v,function(){return function(x,w,E,b){var C=w.userCode,_=E.map(function(F,L){var U={logicalShape:F.shape,texShape:F.isUniform?null:F.texData.texShape,isUniform:F.isUniform,isPacked:!F.isUniform&&F.texData.isPacked,flatOffset:null};return F.texData!=null&&F.texData.slice!=null&&F.texData.slice.flatOffset>0&&(U.flatOffset=F.texData.slice.flatOffset),{name:w.variableNames[L],shapeInfo:U}}),S=_.map(function(F){return F.shapeInfo}),R={logicalShape:b.shape,texShape:b.texData.texShape,isUniform:!1,isPacked:b.texData.isPacked,flatOffset:null},D=AI(_,R,C,w.packedInputs),T=x.createProgram(D),z=null,O=x.getUniformLocation(T,"NAN",!1);G().getNumber("WEBGL_VERSION")===1&&(z=x.getUniformLocation(T,"INFINITY",!1));for(var $={},q=0;q<w.variableNames.length;q++){var V=w.variableNames[q];$[V]=x.getUniformLocation(T,V,!1),$["offset"+V]=x.getUniformLocation(T,"offset"+V,!1)}return{program:w,source:D,webGLProgram:T,uniformLocations:$,inShapeInfos:S,outShapeInfo:R,infLoc:z,nanLoc:O}}(s.gpgpu,n,d,p)}),m=this.activeTimers!=null;if(m&&(h=this.startTimer()),function(x,w,E,b,C){Jg(w.inShapeInfos,E),Jg([w.outShapeInfo],[b]);var _=b.texData.texture,S=b.texData.texShape;b.texData.isPacked?x.setOutputPackedMatrixTexture(_,S[0],S[1]):x.setOutputMatrixTexture(_,S[0],S[1]),x.setProgram(w.webGLProgram),G().getNumber("WEBGL_VERSION")===1&&w.infLoc!==null&&x.gl.uniform1f(w.infLoc,1/0),w.nanLoc!==null&&x.gl.uniform1f(w.nanLoc,NaN),E.forEach(function(R,D){var T=w.program.variableNames[D],z=w.uniformLocations[T],O=w.uniformLocations["offset"+T];if(z!=null)if(R.isUniform)if(le(R.shape)<2)x.gl.uniform1f(z,R.uniformValues[0]);else{var $=R.uniformValues;$ instanceof Float32Array||($=new Float32Array($)),x.gl.uniform1fv(z,$)}else R.texData.slice!=null&&O!=null&&x.gl.uniform1i(O,R.texData.slice.flatOffset),x.setInputMatrixTexture(R.texData.texture,z,D)}),C!=null&&C(x,w.webGLProgram),x.executeProgram()}(this.gpgpu,g,d,p,i),f.forEach(function(x){return s.disposeData(x.dataId)}),m&&(h=this.endTimer(h),this.activeTimers.push({name:n.constructor.name,query:this.getQueryTime(h)})),!G().getBool("WEBGL_LAZILY_UNPACK")&&l.isPacked&&a===!1){var y=this.unpackTensor(u);return this.disposeData(u.dataId),y}return u},t.prototype.compileAndRun=function(n,r,o,i,a){a===void 0&&(a=!1),o=o||r[0].dtype;var s=this.runWebGLProgram(n,r,o,i,a);return P.makeTensorFromDataId(s.dataId,s.shape,s.dtype)},t.prototype.getAndSaveBinary=function(n,r){return n in this.binaryCache||(this.binaryCache[n]=r()),this.binaryCache[n]},t.prototype.getTextureManager=function(){return this.textureManager},t.prototype.dispose=function(){var n=this;this.disposed||(G().getBool("IS_TEST")||Object.keys(this.binaryCache).forEach(function(r){n.gpgpu.deleteProgram(n.binaryCache[r].webGLProgram),delete n.binaryCache[r]}),this.textureManager.dispose(),this.canvas!=null&&typeof HTMLCanvasElement<"u"&&this.canvas instanceof HTMLCanvasElement?this.canvas.remove():this.canvas=null,this.gpgpuCreatedLocally&&(this.gpgpu.program=null,this.gpgpu.dispose()),this.disposed=!0)},t.prototype.floatPrecision=function(){var n=this;return this.floatPrecisionValue==null&&(this.floatPrecisionValue=oe(function(){if(!G().get("WEBGL_RENDER_FLOAT32_ENABLED")){var r=G().getBool("DEBUG");G().set("DEBUG",!1);var o=n.abs(ne(1e-8)).dataSync()[0];if(G().set("DEBUG",r),o>0)return 32}return 16})),this.floatPrecisionValue},t.prototype.epsilon=function(){return this.floatPrecision()===32?1e-7:1e-4},t.prototype.uploadToGPU=function(n){var r,o=this.texData.get(n),i=o.shape,a=o.dtype,s=o.values,u=o.texture,l=o.usage,c=o.isPacked;if(u==null){var f,d=this.activeTimers!=null;d&&(f=yr());var h=o.texShape;if(h==null&&(h=Ik(i,c),o.texShape=h),s!=null){var p=Ff(i),v=void 0,g=h[1],m=h[0],y=s instanceof Uint8Array;c?(g=(r=Ks(h[0],h[1]))[0],m=r[1],v=new fD(p,[m,g],y)):v=new cD(p,[m,g],y);var x=this.makeTensorInfo([m,g],a);this.texData.get(x.dataId).usage=y?Sn.PIXELS:Sn.UPLOAD,this.gpgpu.uploadDenseMatrixToTexture(this.getTexture(x.dataId),g,m,s);var w=this.runWebGLProgram(v,[x],a,null,!0),E=this.texData.get(w.dataId);o.texture=E.texture,o.texShape=E.texShape,o.isPacked=E.isPacked,o.usage=E.usage,this.disposeData(x.dataId),this.texData.delete(w.dataId),o.values=null,d&&(this.uploadWaitMs+=yr()-f)}else{var b=this.acquireTexture(h,l,a,c);o.texture=b}}},t.prototype.convertAndCacheOnCPU=function(n,r){var o=this.texData.get(n),i=o.dtype;return this.releaseGPUData(n),r!=null&&(o.values=function(a,s){if(s==="float32"||s==="complex64")return a;if(s==="int32"||s==="bool"){for(var u=s==="int32"?new Int32Array(a.length):new Uint8Array(a.length),l=0;l<u.length;++l)u[l]=Math.round(a[l]);return u}throw new Error("Unknown dtype "+s)}(r,i)),o.values},t.prototype.acquireTexture=function(n,r,o,i){if(this.numBytesInGPU+=this.computeBytes(n,o),!this.warnedAboutMemory&&this.numBytesInGPU>1024*this.numMBBeforeWarning*1024){var a=(this.numBytesInGPU/1024/1024).toFixed(2);this.warnedAboutMemory=!0,console.warn("High memory usage in GPU: "+a+" MB, most likely due to a memory leak")}return this.textureManager.acquireTexture(n,r,i)},t.prototype.computeBytes=function(n,r){return n[0]*n[1]*Ux(r)},t}(uw);Gx()&&P.registerBackend("webgl",function(){return new ET},2);var CT=N({square_:function(e){var t=k(e,"x","square"),n=[t];return P.runKernelFunc(function(r,o){return o([t]),r.square(t)},{x:t},null,"Square",{},n,[])}}),Ms="SquaredDifference",kw=N({squaredDifference_:function(e,t){var n,r=k(e,"a","squaredDifference"),o=k(t,"b","squaredDifference");n=ft(r,o),r=n[0],o=n[1],Fe(r.shape,o.shape);var i={a:r,b:o},a=[r,o];return P.runKernelFunc(function(s,u){var l=s.squaredDifference(r,o);return u([r,o]),l},i,function(s,u){var l=u[0],c=u[1],f=ne(2);return{a:function(){return s.mul(l.sub(c).mul(f))},b:function(){return s.mul(c.sub(l).mul(f))}}},Ms,{},a,[])}}),_T=N({abs_:function(e){var t=k(e,"x","abs");return t.dtype==="complex64"?P.runKernelFunc(function(n){return n.complexAbs(t)},{$x:t}):P.runKernelFunc(function(n,r){var o=n.abs(t);return r([t]),o},{x:t},function(n,r){var o=r[0];return{x:function(){return n.mul(o.toFloat().step(-1))}}},"Abs")}}),ST=N({acos_:function(e){var t=k(e,"x","acos");return P.runKernelFunc(function(n,r){var o=n.acos(t);return r([t]),o},{$x:t},function(n,r){var o=r[0];return{$x:function(){return n.divStrict(ne(1).sub(o.toFloat().square()).sqrt()).neg()}}})}}),RT=N({acosh_:function(e){var t=k(e,"x","acosh");return P.runKernelFunc(function(n,r){var o=n.acosh(t);return r([t]),o},{$x:t},function(n,r){var o=r[0];return{$x:function(){return n.divStrict(o.toFloat().square().sub(1).sqrt())}}})}}),kT=N({asin_:function(e){var t=k(e,"x","asin");return P.runKernelFunc(function(n,r){var o=n.asin(t);return r([t]),o},{$x:t},function(n,r){var o=r[0];return{$x:function(){return n.divStrict(ne(1).sub(o.toFloat().square()).sqrt())}}})}}),IT=N({asinh_:function(e){var t=k(e,"x","asinh");return P.runKernelFunc(function(n,r){var o=n.asinh(t);return r([t]),o},{$x:t},function(n,r){var o=r[0];return{$x:function(){return n.divStrict(ne(1).add(o.toFloat().square()).sqrt())}}})}}),DT=N({atan_:function(e){var t=k(e,"x","atan");return P.runKernelFunc(function(n,r){var o=n.atan(t);return r([t]),o},{$x:t},function(n,r){var o=r[0];return{$x:function(){return n.div(o.toFloat().square().add(1))}}})}}),TT=N({atanh_:function(e){var t=k(e,"x","atanh");return P.runKernelFunc(function(n,r){var o=n.atanh(t);return r([t]),o},{$x:t},function(n,r){var o=r[0];return{$x:function(){return n.div(ne(1).sub(o.toFloat().square()))}}})}}),NT=N({ceil_:function(e){var t=k(e,"x","ceil");return P.runKernelFunc(function(n){return n.ceil(t)},{$x:t},function(n){return{$x:function(){return Le(n)}}})}}),$p=N({clipByValue_:function(e,t,n){var r=k(e,"x","clipByValue");I(t<=n,function(){return"Error in clip: min ("+t+") must be less than or equal to max ("+n+")."});var o=[r],i={min:t,max:n};return P.runKernelFunc(function(a,s){var u=a.clip(r,t,n);return s([r]),u},{x:r},function(a,s){var u=s[0];return{x:function(){return a.where(u.greaterEqual(t).logicalAnd(u.lessEqual(n)),Le(a))}}},"ClipByValue",i,o)}}),AT=N({cos_:function(e){var t=k(e,"x","cos"),n=[t];return P.runKernelFunc(function(r,o){var i=r.cos(t);return o([t]),i},{x:t},function(r,o){var i=o[0];return{x:function(){return i.toFloat().sin().neg().mul(r)}}},"Cos",{},n)}}),PT=N({cosh_:function(e){var t=k(e,"x","cosh");return P.runKernelFunc(function(n,r){var o=n.cosh(t);return r([t]),o},{$x:t},function(n,r){var o=r[0];return{$x:function(){return o.toFloat().sinh().mulStrict(n)}}})}}),FT=N({erf_:function(e){var t=k(e,"x","erf");return I(t.dtype==="int32"||t.dtype==="float32",function(){return"Input dtype must be `int32` or `float32`."}),t.dtype==="int32"&&(t=t.toFloat()),P.runKernelFunc(function(n,r){var o=n.erf(t);return r([t]),o},{$x:t},function(n,r){var o=r[0];return{$x:function(){return n.mul(o.square().neg().exp().mul(2/Math.sqrt(Math.PI)))}}})}}),vh=N({exp_:function(e){var t=k(e,"x","exp");return P.runKernelFunc(function(n,r){var o=n.exp(t);return r([o]),o},{x:t},function(n,r){return{x:function(){return n.mulStrict(r[0])}}},"Exp",{},[],[!0])}}),MT=N({expm1_:function(e){var t=k(e,"x","expm1");return P.runKernelFunc(function(n,r){var o=n.expm1(t);return r([t]),o},{$x:t},function(n,r){var o=r[0];return{$x:function(){return n.mul(o.exp())}}})}}),OT=N({floor_:function(e){var t=k(e,"x","floor");return P.runKernelFunc(function(n){return n.floor(t)},{$x:t},function(n){return{$x:function(){return Le(n)}}})}}),LT=N({log_:function(e){var t=k(e,"x","log"),n=[t];return P.runKernelFunc(function(r,o){var i=r.log(t);return o([t]),i},{x:t},function(r,o){var i=o[0];return{x:function(){return r.div(i.toFloat())}}},"Log",{},n)}}),BT=N({log1p_:function(e){var t=k(e,"x","log1p");return P.runKernelFunc(function(n,r){var o=n.log1p(t);return r([t]),o},{$x:t},function(n,r){var o=r[0];return{$x:function(){return n.div(o.add(1))}}})}}),UT=N({logSigmoid_:function(e){var t=k(e,"x","logSigmoid");return P.runKernelFunc(function(n,r){var o=n.softplus(t.neg()).neg();return r([t]),o},{$x:t},function(n,r){var o=r[0];return{$x:function(){return n.mul(o.neg().sigmoid())}}})}}),Kl=N({neg_:function(e){var t=k(e,"x","neg"),n=[t];return P.runKernelFunc(function(r){return r.neg(t)},{x:t},function(r){return{x:function(){return r.neg()}}},"Neg",{},n)}}),WT=N({reciprocal_:function(e){var t=k(e,"x","reciprocal");return P.runKernelFunc(function(n,r){var o=n.reciprocal(t);return r([t]),o},{$x:t},function(n,r){var o=r[0];return{$x:function(){return n.div(o.square().neg())}}})}}),zT=N({round_:function(e){var t=k(e,"x","round");return P.runKernelFunc(function(n){return n.round(t)},{$x:t},function(n){return{$x:function(){return Le(n)}}})}}),Iw=N({rsqrt_:function(e){var t=k(e,"x","rsqrt"),n=[t];return P.runKernelFunc(function(r,o){var i=r.rsqrt(t);return o([t]),i},{x:t},function(r,o){var i=o[0];return{x:function(){return r.div(i.pow(1.5).mul(2)).neg()}}},"Rsqrt",{},n)}}),Dw=N({sigmoid_:function(e){var t=k(e,"x","sigmoid");return P.runKernelFunc(function(n,r){var o=n.sigmoid(t);return r([o]),o},{x:t},function(n,r){var o=r[0];return{x:function(){return n.mul(o.mul(ne(1).sub(o)))}}},"Sigmoid")}}),jT=N({sign_:function(e){var t=k(e,"x","sign");return P.runKernelFunc(function(n){return n.sign(t)},{$x:t},function(n){return{$x:function(){return Le(n)}}})}}),VT=N({isNaN_:function(e){var t=k(e,"x","isNaN");return P.runKernelFunc(function(n){return n.isNaN(t)},{$x:t},function(n){return{$x:function(){return Le(n)}}})}}),$T=N({isInf_:function(e){var t=k(e,"x","isInf");return P.runKernelFunc(function(n){return n.isInf(t)},{$x:t},function(n){return{$x:function(){return Le(n)}}})}}),HT=N({isFinite_:function(e){var t=k(e,"x","isFinite");return P.runKernelFunc(function(n){return n.isFinite(t)},{$x:t},function(n){return{$x:function(){return Le(n)}}})}}),GT=N({sin_:function(e){var t=k(e,"x","sin"),n=[t];return P.runKernelFunc(function(r,o){var i=r.sin(t);return o([t]),i},{x:t},function(r,o){var i=o[0];return{x:function(){return i.toFloat().cos().mul(r)}}},"Sin",{},n)}}),qT=N({sinh_:function(e){var t=k(e,"x","sinh");return P.runKernelFunc(function(n,r){var o=n.sinh(t);return r([t]),o},{$x:t},function(n,r){var o=r[0];return{$x:function(){return o.toFloat().cosh().mulStrict(n)}}})}}),KT=N({softplus_:function(e){var t=k(e,"x","softplus");return P.runKernelFunc(function(n,r){var o=n.softplus(t);return r([t]),o},{$x:t},function(n,r){var o=r[0];return{$x:function(){return n.mul(o.sigmoid())}}})}}),XT=N({sqrt_:function(e){var t=k(e,"x","sqrt");return P.runKernelFunc(function(n,r){var o=n.sqrt(t);return r([t]),o},{$x:t},function(n,r){var o=r[0];return{$x:function(){return n.div(o.toFloat().sqrt().mul(2))}}})}}),YT=N({step_:function(e,t){t===void 0&&(t=0);var n=k(e,"x","step");return P.runKernelFunc(function(r){return r.step(n,t)},{$x:n},function(r){return{$x:function(){return Le(r)}}})}}),QT=N({tan_:function(e){var t=k(e,"x","tan");return P.runKernelFunc(function(n,r){var o=n.tan(t);return r([t]),o},{$x:t},function(n,r){var o=r[0];return{$x:function(){return n.div(o.cos().square())}}})}}),JT=N({tanh_:function(e){var t=k(e,"x","tanh");return P.runKernelFunc(function(n,r){var o=n.tanh(t);return r([o]),o},{x:t},function(n,r){var o=r[0];return{x:function(){return ne(1).sub(o.square()).mulStrict(n)}}},"Tanh",{},null,[!0])}});function Tw(e,t,n,r,o,i){var a,s,u=k(e,"x","batchNorm"),l=k(t,"mean","batchNorm"),c=k(n,"variance","batchNorm");return o!=null&&(a=k(o,"scale","batchNorm")),r!=null&&(s=k(r,"offset","batchNorm")),I(u.rank===2,function(){return"Error in batchNorm3D: x must be rank 3 but got rank "+u.rank+"."}),I(l.rank===2||l.rank===1,function(){return"Error in batchNorm2D: mean must be rank 2 or rank 1 but got rank "+l.rank+"."}),I(c.rank===2||c.rank===1,function(){return"Error in batchNorm2D: variance must be rank 2 or rank 1 but got rank "+c.rank+"."}),a!=null&&I(a.rank===2||a.rank===1,function(){return"Error in batchNorm2D: scale must be rank 2 or rank 1 but got rank "+a.rank+"."}),s!=null&&I(s.rank===2||s.rank===1,function(){return"Error in batchNorm2D: offset must be rank 2 or rank 1 but got rank "+s.rank+"."}),Ys(u,l,c,s,a,i)}function Nw(e,t,n,r,o,i){var a,s,u=k(e,"x","batchNorm"),l=k(t,"mean","batchNorm"),c=k(n,"variance","batchNorm");return o!=null&&(a=k(o,"scale","batchNorm")),r!=null&&(s=k(r,"offset","batchNorm")),I(u.rank===3,function(){return"Error in batchNorm3D: x must be rank 3 but got rank "+u.rank+"."}),I(l.rank===3||l.rank===1,function(){return"Error in batchNorm3D: mean must be rank 3 or rank 1 but got rank "+l.rank+"."}),I(c.rank===3||c.rank===1,function(){return"Error in batchNorm3D: variance must be rank 3 or rank 1 but got rank "+c.rank+"."}),a!=null&&I(a.rank===3||a.rank===1,function(){return"Error in batchNorm3D: scale must be rank 3 or rank 1 but got rank "+a.rank+"."}),s!=null&&I(s.rank===3||s.rank===1,function(){return"Error in batchNorm3D: offset must be rank 3 or rank 1 but got rank "+s.rank+"."}),Ys(u,l,c,s,a,i)}function Aw(e,t,n,r,o,i){var a,s,u=k(e,"x","batchNorm"),l=k(t,"mean","batchNorm"),c=k(n,"variance","batchNorm");return o!=null&&(a=k(o,"scale","batchNorm")),r!=null&&(s=k(r,"offset","batchNorm")),I(u.rank===4,function(){return"Error in batchNorm4D: x must be rank 4 but got rank "+u.rank+"."}),I(l.rank===4||l.rank===1,function(){return"Error in batchNorm4D: mean must be rank 4 or rank 1 but got rank "+l.rank+"."}),I(c.rank===4||c.rank===1,function(){return"Error in batchNorm4D: variance must be rank 4 or rank 1 but got rank "+c.rank+"."}),a!=null&&I(a.rank===4||a.rank===1,function(){return"Error in batchNorm4D: scale must be rank 4 or rank 1 but got rank "+a.rank+"."}),s!=null&&I(s.rank===4||s.rank===1,function(){return"Error in batchNorm4D: offset must be rank 4 or rank 1 but got rank "+s.rank+"."}),Ys(u,l,c,s,a,i)}function Ys(e,t,n,r,o,i){i==null&&(i=.001);var a,s,u,l=k(e,"x","batchNorm"),c=k(t,"mean","batchNorm"),f=k(n,"variance","batchNorm");o!=null&&(a=k(o,"scale","batchNorm")),r!=null&&(s=k(r,"offset","batchNorm")),I(c.rank===f.rank,function(){return"Batch normalization gradient requires mean and variance to have equal ranks."}),I(s==null||c.rank===s.rank,function(){return"Batch normalization gradient requires mean and offset to have equal ranks."}),I(a==null||c.rank===a.rank,function(){return"Batch normalization gradient requires mean and scale to have equal ranks."}),u=l.rank===0||l.rank===1?l.as4D(1,1,1,l.size):l.rank===2?l.as4D(1,1,l.shape[0],l.shape[1]):l.rank===3?l.as4D(1,l.shape[0],l.shape[1],l.shape[2]):l;var d=[l,c,f,a];return P.runKernelFunc(function(h,p){var v=h.batchNormalization(u,Mu(c),Mu(f),i,Mu(a),Mu(s));return p([l,c,f,a]),v},{x:l,mean:c,variance:f,scale:a,offset:s},function(h,p){var v=p,g=v[0],m=v[1],y=v[2],x=v[3],w=x??ne(1),E=kt(m.shape,u.shape),b=[];if(m.rank===1){for(var C=0;C<u.shape.length-1;++C)b.push(u.shape[C]);b.push(1)}var _=g.sub(m),S=h.mul(w),R=Iw(y.add(ne(i))),D=R.mul(R).mul(R).mul(ne(-.5));return{x:function(){return m.rank===1?h.mul(ra(R.as4D(1,1,1,m.shape[0]),b)).mul(w).reshape(g.shape):h.mul(R).mul(w).reshape(g.shape)},mean:function(){var T=R.mul(ne(-1)).mul(S);return m.rank===1&&(T=T.sum(E)),T.reshape(m.shape)},variance:function(){var T=D.mul(_).mul(S);return m.rank===1&&(T=T.sum(E)),T.reshape(m.shape)},scale:function(){var T=_.mul(R),z=h.mul(T);return m.rank===1&&(z=z.sum(E)),z.reshape(m.shape)},offset:function(){var T=h;return m.rank===1&&(T=T.sum(E)),T.reshape(m.shape)}}},"BatchNormalization",{varianceEpsilon:i},d).reshape(l.shape)}function Mu(e){return e==null?null:e.rank===0?e.as1D():e.rank===1?e:e.rank===2?e.as4D(1,1,e.shape[0],e.shape[1]):e.rank===3?e.as4D(1,e.shape[0],e.shape[1],e.shape[2]):e}function Tc(){qx("tf.batchNormalization() is going away. Use tf.batchNorm() instead, and note the positional argument change of scale, offset, and varianceEpsilon")}var ZT=N({batchNormalization2d_:function(e,t,n,r,o,i){return r===void 0&&(r=.001),Tc(),Tw(e,t,n,i,o,r)}}),eN=N({batchNormalization3d_:function(e,t,n,r,o,i){return r===void 0&&(r=.001),Tc(),Nw(e,t,n,i,o,r)}}),tN=N({batchNormalization4d_:function(e,t,n,r,o,i){return r===void 0&&(r=.001),Tc(),Aw(e,t,n,i,o,r)}}),nN=N({batchNormalization_:function(e,t,n,r,o,i){return r===void 0&&(r=.001),Tc(),Ys(e,t,n,i,o,r)}}),Pw=N({batchNorm_:Ys}),rN=N({batchNorm2d_:Tw}),oN=N({batchNorm3d_:Nw}),iN=N({batchNorm4d_:Aw}),Nc=N({logicalAnd_:function(e,t){var n=k(e,"a","logicalAnd","bool"),r=k(t,"b","logicalAnd","bool");return Fe(n.shape,r.shape),P.runKernelFunc(function(o){return o.logicalAnd(n,r)},{a:n,b:r},null,"LogicalAnd")}}),aN=N({logicalNot_:function(e){var t=k(e,"x","logicalNot","bool");return P.runKernelFunc(function(n){return n.logicalNot(t)},{$x:t})}}),Fw=N({logicalOr_:function(e,t){var n=k(e,"a","logicalOr","bool"),r=k(t,"b","logicalOr","bool");return Fe(n.shape,r.shape),P.runKernelFunc(function(o){return o.logicalOr(n,r)},{$a:n,$b:r})}}),sN=N({logicalXor_:function(e,t){var n=k(e,"a","logicalXor","bool"),r=k(t,"b","logicalXor","bool");return Fe(n.shape,r.shape),Fw(e,t).logicalAnd(Nc(e,t).logicalNot())}}),li=N({where_:function(e,t,n){var r=k(t,"a","where"),o=k(n,"b","where"),i=k(e,"condition","where","bool");return je(r.shape,o.shape,"Error in where: "),i.rank===1?I(i.shape[0]===r.shape[0],function(){return"The first dimension of `a` must match the size of `condition`."}):je(i.shape,o.shape,"Error in where: "),P.runKernelFunc(function(a,s){var u=a.select(i,r,o);return s([i]),u},{$condition:i,$a:r,$b:o},function(a,s){var u=s[0];return{$condition:function(){return Le(u).toFloat()},$a:function(){return a.mul(u.cast(a.dtype))},$b:function(){return a.mul(u.logicalNot().cast(a.dtype))}}})}}),Mw=function(e){return se(this,void 0,void 0,function(){var t,n,r;return ue(this,function(o){switch(o.label){case 0:return[4,(t=k(e,"condition","whereAsync","bool")).data()];case 1:return n=o.sent(),r=Wp(t.shape,n),e!==t&&t.dispose(),[2,r]}})})},Ae=N({add_:function(e,t){var n,r=k(e,"a","add"),o=k(t,"b","add");n=ft(r,o),r=n[0],o=n[1];var i=Fe(r.shape,o.shape);return P.runKernelFunc(function(a){return a.add(r,o)},{a:r,b:o},function(a){return{a:function(){var s=a,u=kt(r.shape,i);return u.length>0&&(s=s.sum(u)),s.reshape(r.shape)},b:function(){var s=a,u=kt(o.shape,i);return u.length>0&&(s=s.sum(u)),s.reshape(o.shape)}}},"Add")}}),uN=N({addN_:function(e){I(Array.isArray(e),function(){return"The argument passed to tf.addN() must be a list of tensors"}),I(e.length>=1,function(){return"Must pass at least one tensor to tf.addN(), but got "+e.length});var t=e.map(function(o,i){return k(o,"tensors"+i,"addN")}),n=t[0];t.forEach(function(o){if(o.dtype!==n.dtype)throw new Error("All tensors passed to tf.addN() must have the same dtype")}),t.forEach(function(o){if(!Ft(o.shape,n.shape))throw new Error("All tensors passed to tf.addN() must have the same shape")});var r=t;return P.runKernelFunc(function(o){return o.addN(t)},r,function(o){var i={};return t.forEach(function(a,s){i[s]=function(){return o.clone()}}),i},"AddN")}}),lN=N({addStrict_:function(e,t){var n=k(e,"a","addStrict"),r=k(t,"b","addStrict");return je(n.shape,r.shape,"Error in addStrict: "),n.add(r)}}),cN=N({atan2_:function(e,t){var n,r=k(e,"a","atan2"),o=k(t,"b","atan2");n=ft(r,o),r=n[0],o=n[1];var i=Fe(r.shape,o.shape);return P.runKernelFunc(function(a,s){var u=a.atan2(r,o);return s([r,o]),u},{$a:r,$b:o},function(a,s){var u=s[0],l=s[1];return{$a:function(){var c=Ae(u.square(),l.square()),f=a.mul(l.div(c)),d=kt(u.shape,i);return d.length>0&&(f=f.sum(d)),f.reshape(u.shape)},$b:function(){var c=Ae(u.square(),l.square()),f=Kl(a.mul(u.div(c))),d=kt(l.shape,i);return d.length>0&&(f=f.sum(d)),f.reshape(l.shape)}}})}}),tr=N({div_:function(e,t){var n,r=k(e,"a","div"),o=k(t,"b","div");if(n=ft(r,o),r=n[0],o=n[1],r.dtype==="int32"&&o.dtype==="int32")return Ow(r,o);var i=Fe(r.shape,o.shape);return P.runKernelFunc(function(a,s){var u=a.realDivide(r,o);return s([r,o]),u},{a:r,b:o},function(a,s){var u=s[0],l=s[1];return{a:function(){var c=a.div(l.toFloat()),f=kt(u.shape,i);return f.length>0?c.sum(f).reshape(u.shape):c},b:function(){var c=a.mul(u.toFloat()),f=kt(l.shape,i);f.length>0&&(c=c.sum(f).reshape(l.shape));var d=l.square();return c.div(d.toFloat()).neg()}}},"Div")}}),fN=N({divNoNan_:function(e,t){var n,r=k(e,"a","div"),o=k(t,"b","div");r=(n=ft(r,o))[0],o=n[1];var i=tr(r,o),a=Le(i),s=o.equal(a);return li(s,a,i)}}),dN=N({divStrict_:function(e,t){var n=k(e,"a","div"),r=k(t,"b","div");return je(n.shape,r.shape,"Error in divideStrict: "),n.div(r)}}),Ow=N({floorDiv_:function(e,t){var n,r=k(e,"a","floorDiv"),o=k(t,"b","floorDiv");n=ft(r,o),r=n[0],o=n[1];var i=Fe(r.shape,o.shape);return P.runKernelFunc(function(a,s){var u=a.floorDiv(r,o);return s([r,o]),u},{a:r,b:o},function(a,s){var u=s[0],l=s[1];return{a:function(){var c=a.div(l.toFloat()),f=kt(u.shape,i);return f.length>0?c.sum(f).reshape(u.shape):c},b:function(){var c=a.mul(u.toFloat()),f=kt(l.shape,i);f.length>0&&(c=c.sum(f).reshape(l.shape));var d=l.square();return c.div(d.toFloat()).neg()}}},"FloorDiv")}}),Hp=N({maximum_:function(e,t){var n,r=k(e,"a","maximum"),o=k(t,"b","maximum");return n=ft(r,o),r=n[0],o=n[1],r.dtype==="bool"&&(r=r.toInt(),o=o.toInt()),Fe(r.shape,o.shape),P.runKernelFunc(function(i,a){var s=i.maximum(r,o);return a([r,o]),s},{a:r,b:o},function(i,a){var s=a[0],u=a[1];return{a:function(){return i.mul(s.greaterEqual(u).toFloat())},b:function(){return i.mul(s.less(u).toFloat())}}},"Maximum")}}),hN=N({maximumStrict_:function(e,t){var n=k(e,"a","maximumStrict"),r=k(t,"b","maximumStrict");return je(n.shape,r.shape,"Error in maximumStrict: "),n.maximum(r)}}),Lw=N({minimum_:function(e,t){var n,r=k(e,"a","minimum"),o=k(t,"b","minimum");return n=ft(r,o),r=n[0],o=n[1],r.dtype==="bool"&&(r=r.toInt(),o=o.toInt()),Fe(r.shape,o.shape),P.runKernelFunc(function(i,a){var s=i.minimum(r,o);return a([r,o]),s},{a:r,b:o},function(i,a){var s=a[0],u=a[1];return{a:function(){return i.mul(s.lessEqual(u).toFloat())},b:function(){return i.mul(s.greater(u).toFloat())}}},"Minimum")}}),pN=N({minimumStrict_:function(e,t){var n=k(e,"a","minimumStrict"),r=k(t,"b","minimumStrict");return je(n.shape,r.shape,"Error in minimumStrict: "),n.minimum(r)}}),vN=N({mod_:function(e,t){var n,r=k(e,"a","mod"),o=k(t,"b","mod");n=ft(r,o),r=n[0],o=n[1];var i=Fe(r.shape,o.shape);return P.runKernelFunc(function(a,s){var u=a.mod(r,o);return s([r,o]),u},{$a:r,$b:o},function(a,s){var u=s[0],l=s[1];return{$a:function(){var c=kt(u.shape,i);return c.length>0?a.sum(c).reshape(u.shape):a},$b:function(){var c=a.mul(u.div(l).floor().neg()),f=kt(l.shape,i);return f.length>0?c.sum(f).reshape(l.shape):c}}})}}),mN=N({modStrict_:function(e,t){var n=k(e,"a","modStrict"),r=k(t,"b","modStrict");return je(n.shape,r.shape,"Error in modStrict: "),n.mod(r)}}),Qt=N({mul_:function(e,t){var n,r=k(e,"a","mul"),o=k(t,"b","mul");n=ft(r,o),r=n[0],o=n[1];var i=Fe(r.shape,o.shape);return P.runKernelFunc(function(a,s){var u=a.multiply(r,o);return s([r,o]),u},{a:r,b:o},function(a,s){var u=s[0],l=s[1];return{a:function(){var c=a.mul(l.toFloat()),f=kt(u.shape,i);return f.length>0?c.sum(f).reshape(u.shape):c},b:function(){var c=a.mul(u.toFloat()),f=kt(l.shape,i);return f.length>0?c.sum(f).reshape(l.shape):c}}},"Mul")}}),gN=N({mulStrict_:function(e,t){var n=k(e,"a","mul"),r=k(t,"b","mul");return je(n.shape,r.shape,"Error in multiplyStrict: "),n.mul(r)}}),Xl=N({pow_:function(e,t){var n,r=k(e,"base","pow"),o=k(t,"exp","pow");n=ft(r,o),r=n[0],o=n[1];var i=Fe(r.shape,o.shape),a=[r,o];return P.runKernelFunc(function(s,u){var l=s.pow(r,o);return u([r,o,l]),l},{a:r,b:o},function(s,u){var l=u[0],c=u[1],f=u[2];return{a:function(){var d=c.toFloat(),h=s.mul(d.mul(l.pow(d.sub(ne(1))))),p=kt(l.shape,i);return p.length>0&&(h=h.sum(p)),h.reshape(l.shape)},b:function(){var d=l.greater(0),h=l.log().where(d,Le(l)),p=s.mul(f.mul(h)),v=kt(c.shape,i);return v.length>0&&(p=p.sum(v)),p.reshape(c.shape)}}},"Pow",{},a,[!0])}}),yN=N({powStrict_:function(e,t){return je(e.shape,t.shape,"Error in powStrict: "),e.pow(t)}}),xN=N({squaredDifferenceStrict_:function(e,t){var n=k(e,"a","squaredDifferenceStrict"),r=k(t,"b","squaredDifferenceStrict");return je(n.shape,r.shape,"Error in squaredDifferenceStrict: "),n.squaredDifference(r)}}),It=N({sub_:function(e,t){var n,r=k(e,"a","sub"),o=k(t,"b","sub");n=ft(r,o),r=n[0],o=n[1];var i=Fe(r.shape,o.shape);return P.runKernelFunc(function(a){return a.subtract(r,o)},{a:r,b:o},function(a){return{a:function(){var s=a,u=kt(r.shape,i);return u.length>0&&(s=s.sum(u)),s.reshape(r.shape)},b:function(){var s=a,u=kt(o.shape,i);return u.length>0&&(s=s.sum(u)),s.neg().reshape(o.shape)}}},"Sub")}}),wN=N({subStrict_:function(e,t){var n=k(e,"a","subStrict"),r=k(t,"b","subStrict");return je(n.shape,r.shape,"Error in subStrict: "),n.sub(r)}}),Bw=N({equal_:function(e,t){var n,r=k(e,"a","equal"),o=k(t,"b","equal");return n=ft(r,o),r=n[0],o=n[1],Fe(r.shape,o.shape),P.runKernelFunc(function(i){return i.equal(r,o)},{$a:r,$b:o})}}),bN=N({equalStrict_:function(e,t){var n=k(e,"a","equalStrict"),r=k(t,"b","equalStrict");return je(n.shape,r.shape,"Error in equalStrict: "),n.equal(r)}}),EN=N({greater_:function(e,t){var n,r=k(e,"a","greater"),o=k(t,"b","greater");return n=ft(r,o),r=n[0],o=n[1],Fe(r.shape,o.shape),P.runKernelFunc(function(i){return i.greater(r,o)},{a:r,b:o},null,"Greater")}}),Uw=N({greaterEqual_:function(e,t){var n,r=k(e,"a","greaterEqual"),o=k(t,"b","greaterEqual");return n=ft(r,o),r=n[0],o=n[1],Fe(r.shape,o.shape),P.runKernelFunc(function(i,a){var s=i.greaterEqual(r,o);return a([r,o]),s},{a:r,b:o},function(i,a){var s=a[0],u=a[1];return{a:function(){return Le(s)},b:function(){return Le(u)}}},"GreaterEqual")}}),CN=N({greaterEqualStrict_:function(e,t){var n=k(e,"a","greaterEqualStrict"),r=k(t,"b","greaterEqualStrict");return je(n.shape,r.shape,"Error in greaterEqualStrict: "),n.greaterEqual(r)}}),_N=N({greaterStrict_:function(e,t){var n=k(e,"a","greaterStrict"),r=k(t,"b","greaterStrict");return je(n.shape,r.shape,"Error in greaterStrict: "),n.greater(r)}}),SN=N({less_:function(e,t){var n,r=k(e,"a","less"),o=k(t,"b","less");return n=ft(r,o),r=n[0],o=n[1],Fe(r.shape,o.shape),P.runKernelFunc(function(i){return i.less(r,o)},{a:r,b:o},null,"Less")}}),RN=N({lessEqual_:function(e,t){var n,r=k(e,"a","lessEqual"),o=k(t,"b","lessEqual");return n=ft(r,o),r=n[0],o=n[1],Fe(r.shape,o.shape),P.runKernelFunc(function(i,a){var s=i.lessEqual(r,o);return a([r,o]),s},{a:r,b:o},null,"LessEqual")}}),kN=N({lessEqualStrict_:function(e,t){var n=k(e,"a","lessEqualStrict"),r=k(t,"b","lessEqualStrict");return je(n.shape,r.shape,"Error in lessEqualStrict: "),n.lessEqual(r)}}),IN=N({lessStrict_:function(e,t){var n=k(e,"a","lessStrict"),r=k(t,"b","lessStrict");return je(n.shape,r.shape,"Error in lessStrict: "),n.less(r)}}),DN=N({notEqual_:function(e,t){var n,r=k(e,"a","notEqual"),o=k(t,"b","notEqual");return n=ft(r,o),r=n[0],o=n[1],Fe(r.shape,o.shape),P.runKernelFunc(function(i){return i.notEqual(r,o)},{a:r,b:o},null,"NotEqual")}}),TN=N({notEqualStrict_:function(e,t){var n=k(e,"a","notEqualStrict"),r=k(t,"b","notEqualStrict");return je(n.shape,r.shape,"Error in notEqualStrict: "),n.notEqual(r)}});function uy(e,t){for(var n=[],r=e;r<t;++r)n.push(r);return n}function ly(e){for(var t=[],n=0;n<e.length;++n)for(var r=0;r<e[n].length;++r)t.push(e[n][r]);return t}var Gp=N({gather_:function(e,t,n){n===void 0&&(n=0);var r=k(e,"x","gather"),o=k(t,"indices","gather","int32");n=Dt(n,r.shape)[0];var i=function(a,s,u){for(var l=a.shape[u],c=[],f=1,d=1,h=0;h<u;h++)c.push(a.shape[h]),f*=a.shape[h];for(h=0;h<s.rank;h++)c.push(s.shape[h]);for(h=u+1;h<a.rank;h++)c.push(a.shape[h]),d*=a.shape[h];return{batchSize:f,sliceSize:d,dimSize:l,outputShape:c}}(r,o,n);return P.runKernelFunc(function(a,s){var u=a.gather(r,o.flatten(),n);return s([o]),u},{x:r,indices:o},function(a,s){var u=s[0];return{x:function(){var l=r.shape,c=u.size,f=l.slice(0,n),d=f.length,h=l.slice(n,l.length).slice(1),p=h.length,v=uy(0,d),g=uy(d+1,d+1+p),m=ly([f,[c],h]),y=a.reshape(m),x=u.reshape([c]),w=ly([[d],v,g]),E=y.transpose(w),b=Ww(E,x,r.shape[n]),C=Ap(w);return b=b.transpose(C)},indices:function(){return u}}},"Gather",{axis:n}).reshape(i.outputShape)}}),Ww=N({unsortedSegmentSum_:function(e,t,n){var r=k(e,"x","unsortedSegmentSum"),o=k(t,"segmentIds","unsortedSegmentSum","int32");return I(mt(n),function(){return"numSegments must be of dtype int"}),P.runKernelFunc(function(i,a){var s=i.unsortedSegmentSum(r,o,n);return a([o]),s},{$x:r},function(i,a){var s=a[0];return{$x:function(){return function(u,l){for(var c=Hp(l,Le(l)),f=Gp(u,c),d=Uw(l,ne(0,"int32")),h=f.rank-d.rank,p=0;p<h;++p)d=Un(d,p+1);d=Nc(d,Da(f.shape,"bool"));var v=Le(f);return li(d,f,v)}(i,s)}}})}}),NN=function(e,t,n){return se(this,void 0,void 0,function(){var r,o,i,a,s,u,l,c,f,d,h,p,v;return ue(this,function(g){switch(g.label){case 0:for(r=k(e,"tensor","boolMask"),o=k(t,"mask","boolMask","bool"),i=n??0,a=o.rank,s=r.shape,I(a>0,function(){return"mask cannot be scalar"}),je(s.slice(i,i+a),o.shape,"mask's shape must match the first K dimensions of tensor's shape,"),u=1,l=i;l<i+a;l++)u*=s[l];return c=s.slice(0,i).concat([u],s.slice(i+a)),f=r.reshape(c),d=o.reshape([-1]),[4,Mw(d)];case 1:return h=g.sent(),p=h.squeeze([1]),v=Gp(f,p,i),e!==r&&r.dispose(),t!==o&&o.dispose(),p.dispose(),f.dispose(),d.dispose(),h.dispose(),[2,v]}})})};function zw(e,t,n,r,o,i,a){i===void 0&&(i="NHWC"),I(e.length===t.rank,function(){return"Length of inShape ("+e.length+") and rank of dy ("+t.rank+") must match"});var s=e,u=t,l=!1;t.rank===3&&(l=!0,u=t.as4D(1,t.shape[0],t.shape[1],t.shape[2]),s=[1,e[0],e[1],e[2]]),I(s.length===4,function(){return"Error in conv2dDerInput: inShape must be length 4, but got length "+s.length+"."}),I(u.rank===4,function(){return"Error in conv2dDerInput: dy must be rank 4, but got rank "+u.rank}),I(n.rank===4,function(){return"Error in conv2dDerInput: filter must be rank 4, but got rank "+n.rank});var c=i==="NHWC"?s[3]:s[1],f=i==="NHWC"?u.shape[3]:u.shape[1];I(c===n.shape[2],function(){return"Error in conv2dDerInput: depth of input ("+c+") must match input depth for filter "+n.shape[2]+"."}),I(f===n.shape[3],function(){return"Error in conv2dDerInput: depth of output ("+f+") must match output depth for filter "+n.shape[3]+"."}),a!=null&&I(mt(o),function(){return"Error in conv2dDerInput: pad must be an integer when using, dimRoundingMode "+a+" but got pad "+o+"."});var d=Lp(i),h=gi(s,n.shape,r,1,o,a,!1,d),p=P.runKernelFunc(function(v,g){var m=v.conv2dDerInput(u,n,h);return g([n,u]),m},{dy4D:u,filter:n},function(v,g){var m=g[0],y=g[1];return{dy4D:function(){return qn(v,m,r,o,i,1,a)},filter:function(){return qp(v,y,m.shape,r,o,i,a)}}});return l?p.as3D(p.shape[1],p.shape[2],p.shape[3]):p}function jf(e){var t=function(i){return typeof i=="number"?[i,i,i]:i.length===2?[i[0],i[1],1]:i}(e),n=t[0],r=t[1],o=t[2];return n===1&&r===1&&o===1}function jw(e,t,n,r,o){I(e.length===t.rank,function(){return"Length of inShape ("+e.length+") and rank of dy ("+t.rank+") must match"});var i=e,a=t,s=!1;t.rank===4&&(s=!0,a=t.as5D(1,t.shape[0],t.shape[1],t.shape[2],t.shape[3]),i=[1,e[0],e[1],e[2],e[3]]);var u=i[4],l=a.shape[4];I(i.length===5,function(){return"Error in conv3dDerInput: inShape must be length 5, but got length "+i.length+"."}),I(a.rank===5,function(){return"Error in conv3dDerInput: dy must be rank 5, but got rank "+a.rank}),I(n.rank===5,function(){return"Error in conv3dDerInput: filter must be rank 5, but got rank "+n.rank}),I(u===n.shape[3],function(){return"Error in conv3dDerInput: depth of input ("+u+") must match input depth for filter "+n.shape[3]+"."}),I(l===n.shape[4],function(){return"Error in conv3dDerInput: depth of output ("+l+") must match output depth for filter "+n.shape[4]+"."});var c=Gl(i,n.shape,r,1,o),f=P.runKernelFunc(function(d){return d.conv3dDerInput(a,n,c)},{dy5D:a});return s?f.as4D(f.shape[1],f.shape[2],f.shape[3],f.shape[4]):f}var AN=N({conv1d_:function(e,t,n,r,o,i,a){o===void 0&&(o="NWC"),i===void 0&&(i=1);var s=k(e,"x","conv1d"),u=k(t,"filter","conv1d"),l=s,c=!1;s.rank===2&&(c=!0,l=s.as3D(1,s.shape[0],s.shape[1])),I(l.rank===3,function(){return"Error in conv1d: input must be rank 3, but got rank "+l.rank+"."}),I(u.rank===3,function(){return"Error in conv1d: filter must be rank 3, but got rank "+u.rank+"."}),a!=null&&I(mt(r),function(){return"Error in conv1d: pad must be an integer when using, dimRoundingMode "+a+" but got pad "+r+"."}),I(l.shape[2]===u.shape[1],function(){return"Error in conv1d: depth of input ("+l.shape[2]+") must match input depth for filter "+u.shape[1]+"."}),I(gn(n,i),function(){return"Error in conv1D: Either stride or dilation must be 1. Got stride "+n+" and dilation '"+i+"'"}),I(o==="NWC",function(){return"Error in conv1d: got dataFormat of "+o+" but only NWC is currently supported."});var f=u.as4D(1,u.shape[0],u.shape[1],u.shape[2]),d=l.as4D(l.shape[0],1,l.shape[1],l.shape[2]),h=qn(d,f,[1,n],r,"NHWC",[1,i],a);return c?h.as2D(h.shape[2],h.shape[3]):h.as3D(h.shape[0],h.shape[2],h.shape[3])}}),qn=N({conv2d_:function(e,t,n,r,o,i,a){o===void 0&&(o="NHWC"),i===void 0&&(i=[1,1]);var s=k(e,"x","conv2d"),u=k(t,"filter","conv2d"),l=s,c=!1;s.rank===3&&(c=!0,l=s.as4D(1,s.shape[0],s.shape[1],s.shape[2])),I(l.rank===4,function(){return"Error in conv2d: input must be rank 4, but got rank "+l.rank+"."}),I(u.rank===4,function(){return"Error in conv2d: filter must be rank 4, but got rank "+u.rank+"."}),a!=null&&I(mt(r),function(){return"Error in conv2d: pad must be an integer when using, dimRoundingMode "+a+" but got pad "+r+"."});var f=o==="NHWC"?l.shape[3]:l.shape[1];I(f===u.shape[2],function(){return"Error in conv2d: depth of input ("+f+") must match input depth for filter "+u.shape[2]+"."}),I(gn(n,i),function(){return"Error in conv2D: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+i+"'"});var d=Lp(o),h=gi(l.shape,u.shape,n,i,r,a,!1,d),p=[u,l],v=P.runKernelFunc(function(g,m){var y=g.conv2d(l,u,h);return m([u,l]),y},{x:l,filter:u},function(g,m){var y=m,x=y[0],w=y[1];return I(ba(i),function(){return"Error in gradient of conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '"+i+"'"}),{x:function(){return Vw(w.shape,g,x,n,r,o)},filter:function(){return qp(w,g,x.shape,n,r,o)}}},"Conv2D",h,p);return c?v.as3D(v.shape[1],v.shape[2],v.shape[3]):v}}),PN=N({conv3d_:function(e,t,n,r,o,i){o===void 0&&(o="NDHWC"),i===void 0&&(i=[1,1,1]);var a=k(e,"x","conv3d"),s=k(t,"filter","conv3d"),u=a,l=!1;a.rank===4&&(l=!0,u=a.as5D(1,a.shape[0],a.shape[1],a.shape[2],a.shape[3])),I(u.rank===5,function(){return"Error in conv3d: input must be rank 5, but got rank "+u.rank+"."}),I(s.rank===5,function(){return"Error in conv3d: filter must be rank 5, but got rank "+s.rank+"."}),I(u.shape[4]===s.shape[3],function(){return"Error in conv3d: depth of input ("+u.shape[4]+") must match input depth for filter "+s.shape[3]+"."}),I(function(d,h){return jf(d)||jf(h)}(n,i),function(){return"Error in conv3D: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+i+"'"}),I(o==="NDHWC",function(){return"Error in conv3d: got dataFormat of "+o+" but only NDHWC is currently supported."});var c=Gl(u.shape,s.shape,n,i,r),f=P.runKernelFunc(function(d,h){var p=d.conv3d(u,s,c);return h([u,s]),p},{x:u,$filter:s},function(d,h){I(jf(i),function(){return"Error in gradient of conv3D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '"+i+"'"});var p=h[0],v=h[1];return{x:function(){return jw(p.shape,d,v,n,r)},$filter:function(){return function(g,m,y,x,w){var E=g;g.rank===4&&(E=g.as5D(1,g.shape[0],g.shape[1],g.shape[2],g.shape[3]));var b=m;b.rank===4&&(b=m.as5D(1,m.shape[0],m.shape[1],m.shape[2],m.shape[3])),I(E.rank===5,function(){return"Error in conv3dDerFilter: input must be rank 5, but got shape "+E.shape+"."}),I(b.rank===5,function(){return"Error in conv3dDerFilter: dy must be rank 5, but got shape "+b.shape+"."}),I(y.length===5,function(){return"Error in conv3dDerFilter: filterShape must be length 5, but got "+y+"."}),I(E.shape[4]===y[3],function(){return"Error in conv3dDerFilter: depth of input "+E.shape[4]+") must match input depth in filter ("+y[3]+"."}),I(b.shape[4]===y[4],function(){return"Error in conv3dDerFilter: depth of dy ("+b.shape[4]+") must match output depth for filter ("+y[4]+")."});var C=Gl(E.shape,y,x,1,w);return P.runKernelFunc(function(_){return _.conv3dDerFilter(E,b,C)},{x5D:E,dy5D:b})}(p,d,v.shape,n,r)}}});return l?f.as4D(f.shape[1],f.shape[2],f.shape[3],f.shape[4]):f}}),qp=N({conv2dDerFilter_:function(e,t,n,r,o,i,a){i===void 0&&(i="NHWC");var s=e;e.rank===3&&(s=e.as4D(1,e.shape[0],e.shape[1],e.shape[2]));var u=t;u.rank===3&&(u=t.as4D(1,t.shape[0],t.shape[1],t.shape[2])),I(s.rank===4,function(){return"Error in conv2dDerFilter: input must be rank 4, but got shape "+s.shape+"."}),I(u.rank===4,function(){return"Error in conv2dDerFilter: dy must be rank 4, but got shape "+u.shape+"."}),I(n.length===4,function(){return"Error in conv2dDerFilter: filterShape must be length 4, but got "+n+"."});var l=i==="NHWC"?s.shape[3]:s.shape[1],c=i==="NHWC"?u.shape[3]:u.shape[1];I(l===n[2],function(){return"Error in conv2dDerFilter: depth of input "+l+") must match input depth in filter ("+n[2]+"."}),I(c===n[3],function(){return"Error in conv2dDerFilter: depth of dy ("+c+") must match output depth for filter ("+n[3]+")."}),a!=null&&I(mt(o),function(){return"Error in conv2dDerFilter: pad must be an integer when using, dimRoundingMode "+a+" but got pad "+o+"."});var f=Lp(i),d=gi(s.shape,n,r,1,o,a,!1,f);return P.runKernelFunc(function(h){return h.conv2dDerFilter(s,u,d)},{x4D:s,dy4D:u})}}),Vw=N({conv2dDerInput_:zw}),Ac=N({depthwiseConv2d_:function(e,t,n,r,o,i,a){i===void 0&&(i=[1,1]);var s=k(e,"x","depthwiseConv2d"),u=k(t,"filter","depthwiseConv2d"),l=s,c=!1;s.rank===3&&(c=!0,l=s.as4D(1,s.shape[0],s.shape[1],s.shape[2])),I(l.rank===4,function(){return"Error in depthwiseConv2d: input must be rank 4, but got rank "+l.rank+"."}),I(u.rank===4,function(){return"Error in depthwiseConv2d: filter must be rank 4, but got rank "+u.rank+"."}),I(l.shape[3]===u.shape[2],function(){return"Error in depthwiseConv2d: number of input channels ("+l.shape[3]+") must match the inChannels dimension in filter "+u.shape[2]+"."}),i==null&&(i=[1,1]),I(gn(n,i),function(){return"Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+i+"'"}),a!=null&&I(mt(r),function(){return"Error in depthwiseConv2d: pad must be an integer when using, dimRoundingMode "+a+" but got pad "+r+"."});var f=gi(l.shape,u.shape,n,i,r,a,!0),d=[l,u],h=P.runKernelFunc(function(p,v){var g=p.depthwiseConv2D(l,u,f);return v([l,u]),g},{x:l,filter:u},function(p,v){I(ba(i),function(){return"Error in gradient of depthwiseConv2d: dilation rates greater than 1 are not yet supported. Got dilations '"+i+"'"});var g=v[0],m=v[1];return{x:function(){return $w(g.shape,p,m,f)},filter:function(){return Hw(g,p,m.shape,f)}}},"DepthwiseConv2dNative",f,d);return c?h.as3D(h.shape[1],h.shape[2],h.shape[3]):h}}),$w=N({depthwiseConv2dDerInput_:function(e,t,n,r){var o=t,i=!1;t.rank===3&&(i=!0,o=t.as4D(1,t.shape[0],t.shape[1],t.shape[2]));var a=P.runKernelFunc(function(s){return s.depthwiseConv2DDerInput(o,n,r)},{dy4D:o});return i?a.as3D(a.shape[1],a.shape[2],a.shape[3]):a}}),Hw=N({depthwiseConv2dDerFilter_:function(e,t,n,r){var o=e;e.rank===3&&(o=e.as4D(1,e.shape[0],e.shape[1],e.shape[2]));var i=t;return i.rank===3&&(i=t.as4D(1,t.shape[0],t.shape[1],t.shape[2])),P.runKernelFunc(function(a){return a.depthwiseConv2DDerFilter(o,i,r)},{x4D:o,dy4D:i})}}),Kp=N({separableConv2d_:function(e,t,n,r,o,i,a){i===void 0&&(i=[1,1]),a===void 0&&(a="NHWC");var s=k(e,"x","separableConv2d"),u=k(t,"depthwiseFilter","separableConv2d"),l=k(n,"pointwiseFilter","separableConv2d"),c=s,f=!1;if(s.rank===3&&(f=!0,c=s.as4D(1,s.shape[0],s.shape[1],s.shape[2])),a==="NCHW")throw new Error("separableConv2d currently does not support dataFormat NCHW; only NHWC is supported");I(c.rank===4,function(){return"Error in separableConv2d: input must be rank 4, but got rank "+c.rank+"."}),I(u.rank===4,function(){return"Error in separableConv2d: depthwise filter must be rank 4, but got rank "+u.rank+"."}),I(l.rank===4,function(){return"Error in separableConv2d: pointwise filter must be rank 4, but got rank "+u.rank+"."}),I(l.shape[0]===1,function(){return"Error in separableConv2d: the first dimension of pointwise filter  must be 1, but got "+l.shape[0]+"."}),I(l.shape[1]===1,function(){return"Error in separableConv2d: the second dimension of pointwise filter must be 1, but got "+l.shape[1]+"."});var d=u.shape[2],h=u.shape[3];I(l.shape[2]===d*h,function(){return"Error in separableConv2d: the third dimension of pointwise filter must be "+d*h+", but got "+l.shape[2]+"."});var p=Ac(c,u,r,o,a,i),v=qn(p,l,1,"valid",a);return f?v.as3D(v.shape[1],v.shape[2],v.shape[3]):v}}),FN=N({conv2dTranspose_:function(e,t,n,r,o,i){return zw(n,k(e,"x","conv2dTranspose"),k(t,"filter","conv2dTranspose"),r,o,"NHWC",i)}}),MN=N({conv3dTranspose_:function(e,t,n,r,o){return jw(n,k(e,"x","conv3dTranspose"),k(t,"filter","conv3dTranspose"),r,o)}}),Pc=N({matMul_:function(e,t,n,r){var o;n===void 0&&(n=!1),r===void 0&&(r=!1);var i=k(e,"a","matMul"),a=k(t,"b","matMul");o=ft(i,a),i=o[0],a=o[1];var s=n?i.shape[i.rank-2]:i.shape[i.rank-1],u=r?a.shape[a.rank-1]:a.shape[a.rank-2],l=n?i.shape[i.rank-1]:i.shape[i.rank-2],c=r?a.shape[a.rank-2]:a.shape[a.rank-1],f=i.shape.slice(0,-2),d=a.shape.slice(0,-2),h=le(f),p=le(d);I(i.rank>=2&&a.rank>=2&&i.rank===a.rank,function(){return"Error in matMul: inputs must have the same rank of at least 2, got ranks "+i.rank+" and "+a.rank+"."}),I(Ft(f,d),function(){return"Error in matMul: outer dimensions ("+f+") and ("+d+") of Tensors with shapes "+i.shape+" and "+a.shape+" must match."}),I(s===u,function(){return"Error in matMul: inner shapes ("+s+") and ("+u+") of Tensors with shapes "+i.shape+" and "+a.shape+" and transposeA="+n+" and transposeB="+r+" must match."});var v=i.shape.slice(0,-2).concat([l,c]),g=n?i.as3D(h,s,l):i.as3D(h,l,s),m=r?a.as3D(p,c,u):a.as3D(p,u,c),y={transposeA:n,transposeB:r};return P.runKernelFunc(function(x,w){var E=x.batchMatMul(g,m,n,r);return w([g,m]),E},{a:g,b:m},function(x,w){var E=w,b=E[0],C=E[1];return n||r?!n&&r?{a:function(){return x.matMul(C,!1,!1)},b:function(){return x.matMul(b,!0,!1)}}:n&&!r?{a:function(){return C.matMul(x,!1,!0)},b:function(){return b.matMul(x,!1,!1)}}:{a:function(){return C.matMul(x,!0,!0)},b:function(){return x.matMul(b,!0,!0)}}:{a:function(){return x.matMul(C,!1,!0)},b:function(){return b.matMul(x,!0,!1)}}},"BatchMatMul",y).reshape(v)}}),ON=N({dot_:function(e,t){var n=k(e,"t1","dot"),r=k(t,"t2","dot");I(!(n.rank!==1&&n.rank!==2||r.rank!==1&&r.rank!==2),function(){return"Error in dot: inputs must all be rank 1 or 2, but got ranks "+n.rank+" and "+r.rank+"."});var o=n.rank===1?n.size:n.shape[1],i=r.rank===1?r.size:r.shape[0];return I(o===i,function(){return"Error in dot: inner dimensions of inputs must match, but got "+o+" and "+i+"."}),n.rank===1&&r.rank===1?n.as2D(1,-1).matMul(r.as2D(-1,1)).asScalar():n.rank===1&&r.rank===2?n.as2D(1,-1).matMul(r.as2D(r.shape[0],r.shape[1])).as1D():n.rank===2&&r.rank===1?n.matMul(r.as2D(-1,1)).as1D():n.matMul(r.as2D(r.shape[0],r.shape[1]))}}),LN=N({outerProduct_:function(e,t){var n=k(e,"v1","outerProduct"),r=k(t,"v2","outerProduct");return I(n.rank===1&&r.rank===1,function(){return"Error in outerProduct: inputs must be rank 1, but got ranks "+n.rank+" and "+r.rank+"."}),n.as2D(-1,1).matMul(r.as2D(1,-1))}}),Qs=N({reverse_:function(e,t){var n=k(e,"x","reverse");if(n.rank===0)return n.clone();var r=Dt(t,n.shape);return P.runKernelFunc(function(o){return o.reverse(n,r)},{$x:n},function(o){return{$x:function(){return o.reverse(r)}}}).reshapeAs(n)}}),BN=N({reverse1d_:function(e){var t=k(e,"x","reverse");return I(t.rank===1,function(){return"Error in reverse1D: x must be rank 1 but got rank "+t.rank+"."}),Qs(t,0)}}),UN=N({reverse2d_:function(e,t){var n=k(e,"x","reverse");return I(n.rank===2,function(){return"Error in reverse2D: x must be rank 2 but got rank "+n.rank+"."}),Qs(n,t)}}),WN=N({reverse3d_:function(e,t){var n=k(e,"x","reverse");return I(n.rank===3,function(){return"Error in reverse3D: x must be rank 3 but got rank "+n.rank+"."}),Qs(n,t)}}),zN=N({reverse4d_:function(e,t){var n=k(e,"x","reverse");return I(n.rank===4,function(){return"Error in reverse4D: x must be rank 4 but got rank "+n.rank+"."}),Qs(n,t)}});function Gw(e,t,n,r,o,i){var a=k(e,"x","maxPool"),s=a,u=!1;a.rank===3&&(u=!0,s=a.as4D(1,a.shape[0],a.shape[1],a.shape[2])),I(s.rank===4,function(){return"Error in maxPool: input must be rank 4 but got rank "+s.rank+"."}),I(gn(n,r),function(){return"Error in maxPool: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+r+"'"}),i!=null&&I(mt(o),function(){return"Error in maxPool: pad must be an integer when using, dimRoundingMode "+i+" but got pad "+o+"."});var l=Fs(s.shape,t,n,r,o,i);if(l.filterWidth===1&&l.filterHeight===1&&Ft(l.inShape,l.outShape))return a.clone();var c=[s],f=P.runKernelFunc(function(d,h){var p=d.maxPool(s,l);return h([s,p]),p},{x:s},function(d,h){var p=h[0],v=h[1];return{x:function(){return function(g,m,y,x,w,E,b,C){var _=k(g,"dy","maxPoolBackprop"),S=k(m,"input","maxPoolBackprop"),R=k(y,"output","maxPoolBackprop");I(S.rank===_.rank,function(){return"Rank of input ("+S.rank+") does not match rank of dy ("+_.rank+")"}),I(gn(w,E),function(){return"Error in maxPoolBackProp: Either strides or dilations must be 1. Got strides "+w+" and dilations '"+E+"'"}),I(_.rank===4,function(){return"Error in maxPoolBackprop: dy must be rank 4 but got rank "+_.rank+"."}),I(S.rank===4,function(){return"Error in maxPoolBackprop: input must be rank 4 but got rank "+S.rank+"."});var D=Fs(S.shape,x,w,E,b,C);return P.runKernelFunc(function(T){return T.maxPoolBackprop(_,S,R,D)},{$dy:_,$input:S})}(d,p,v,t,n,r,o)}}},"MaxPool",l,c);return u?f.as3D(f.shape[1],f.shape[2],f.shape[3]):f}function qw(e,t,n,r,o,i){var a=k(e,"x","avgPool","float32");I(gn(n,r),function(){return"Error in avgPool: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+r+"'"});var s=a,u=!1;a.rank===3&&(u=!0,s=a.as4D(1,a.shape[0],a.shape[1],a.shape[2])),I(s.rank===4,function(){return"Error in avgPool: x must be rank 4 but got rank "+s.rank+"."}),i!=null&&I(mt(o),function(){return"Error in avgPool: pad must be an integer when using, dimRoundingMode "+i+" but got pad "+o+"."});var l=Fs(s.shape,t,n,r,o,i);if(l.filterWidth===1&&l.filterHeight===1&&Ft(l.inShape,l.outShape))return a.clone();var c=P.runKernelFunc(function(f){return f.avgPool(s,l)},{x:s},function(f){return{x:function(){return function(d,h,p,v,g,m){var y=k(d,"dy","avgPoolBackprop"),x=k(h,"input","avgPoolBackprop");I(x.rank===y.rank,function(){return"Rank of input ("+x.rank+") does not match rank of dy ("+y.rank+")"}),I(gn(v,g),function(){return"Error in avgPoolBackprop: Either strides or dilations must be 1. Got strides "+v+" and dilations '"+g+"'"});var w=x,E=y,b=!1;x.rank===3&&(b=!0,w=x.as4D(1,x.shape[0],x.shape[1],x.shape[2]),E=y.as4D(1,y.shape[0],y.shape[1],y.shape[2])),I(E.rank===4,function(){return"Error in avgPoolBackprop: dy must be rank 4 but got rank "+E.rank+"."}),I(w.rank===4,function(){return"Error in avgPoolBackprop: input must be rank 4 but got rank "+w.rank+"."});var C=Fs(w.shape,p,v,g,m),_=P.runKernelFunc(function(S){return S.avgPoolBackprop(E,w,C)},{dy4D:E,input4D:w});return b?_.as3D(_.shape[1],_.shape[2],_.shape[3]):_}(f,s,t,n,r,o)}}},"AvgPool",l);return c=c.cast(a.dtype),u?c.as3D(c.shape[1],c.shape[2],c.shape[3]):c}var Tt=N({maxPool_:function(e,t,n,r,o){return Gw(e,t,n,1,r,o)}}),Js=N({avgPool_:function(e,t,n,r,o){return qw(e,t,n,1,r,o)}}),jN=N({pool_:function(e,t,n,r,o,i){o==null&&(o=[1,1]),i==null&&(i=1),r===0&&(r="valid");var a=k(e,"x","maxPool"),s=a,u=!1;a.rank===3&&(u=!0,s=a.as4D(1,a.shape[0],a.shape[1],a.shape[2])),I(gn(i,o),function(){return"Error in pool: Either strides or dilations must be 1. Got strides "+i+" and dilations '"+o+"'"});var l,c=Fs(s.shape,t,i,o,r),f=[c.dilationHeight,c.dilationWidth];l=r==="same"?function(w,E){var b=w.map(function(S,R){return S+(S-1)*(E[R]-1)}).map(function(S){return S-1}),C=b.map(function(S){return Math.floor(S/2)}),_=b.map(function(S,R){return S-C[R]});return b.map(function(S,R){return[C[R],_[R]]})}([c.filterHeight,c.filterWidth],f):[[0,0],[0,0]];var d=f[0]===1&&f[1]===1,h=function(w,E,b){var C=b.map(function(O){return O[0]}),_=b.map(function(O){return O[1]}),S=w.concat(C,_),R=E.map(function(O,$){return(O-S[$]%O)%O}),D=_.map(function(O,$){return O+R[$]}),T=E.map(function(O,$){return[C[$],D[$]]}),z=E.map(function(O,$){return[0,R[$]]});return[T,z]}([c.inHeight,c.inWidth],f,l),p=h[0],v=h[1],g=d?r:"valid",m=d?s:Zx(s,f,p),y=(n==="avg"?function(){return qw(m,t,i,1,g)}:function(){return Gw(m,t,i,1,g)})(),x=d?y:Yx(y,f,v);return u?x.as3D(x.shape[1],x.shape[2],x.shape[3]):x}}),VN=N({maxPool3d_:function(e,t,n,r,o,i,a){i===void 0&&(i="NDHWC");var s=k(e,"x","maxPool3d"),u=s,l=!1;s.rank===4&&(l=!0,u=s.as5D(1,s.shape[0],s.shape[1],s.shape[2],s.shape[3])),a==null&&(a=[1,1,1]),I(u.rank===5,function(){return"Error in maxPool3d: x must be rank 5 but got rank "+u.rank+"."}),I(i==="NDHWC",function(){return"Error in maxPool3d: Only NDHWC is currently supported, but got dataFormat of "+i}),I(gn(n,a),function(){return"Error in maxPool3d: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+a+"'"}),o!=null&&I(mt(r),function(){return"Error in maxPool3d: pad must be an integer when using, dimRoundingMode "+o+" but got pad "+r+"."});var c=Hl(u.shape,t,n,a,r,o,i),f=P.runKernelFunc(function(d,h){var p=d.maxPool3d(u,c);return h([u,p]),p},{x:u},function(d,h){var p=h[0],v=h[1];return{x:function(){return function(g,m,y,x,w,E,b,C){var _=k(g,"dy","maxPool3dBackprop"),S=k(m,"input","maxPool3dBackprop"),R=k(y,"output","maxPool3dBackprop"),D=_,T=S,z=R,O=!1;S.rank===4&&(O=!0,D=_.as5D(1,_.shape[0],_.shape[1],_.shape[2],_.shape[3]),T=S.as5D(1,S.shape[0],S.shape[1],S.shape[2],S.shape[3]),z=R.as5D(1,R.shape[0],R.shape[1],R.shape[2],R.shape[3])),I(D.rank===5,function(){return"Error in maxPool3dBackprop: dy must be rank 5 but got rank "+D.rank+"."}),I(T.rank===5,function(){return"Error in maxPool3dBackprop: input must be rank 5 but got rank "+T.rank+"."}),I(z.rank===5,function(){return"Error in maxPool3dBackprop: output must be rank 5 but got rank "+z.rank+"."}),E==null&&(E=[1,1,1]),I(gn(w,E),function(){return"Error in maxPool3dBackprop: Either strides or dilations must be 1. Got strides "+w+" and dilations '"+E+"'"}),C!=null&&I(mt(b),function(){return"Error in maxPool3dBackprop: pad must be an integer when using, dimRoundingMode "+C+" but got pad "+b+"."});var $=Hl(T.shape,x,w,E,b,C),q=P.runKernelFunc(function(V){return V.maxPool3dBackprop(D,T,z,$)},{dy5D:D,input5D:T});return O?q.as4D(q.shape[1],q.shape[2],q.shape[3],q.shape[4]):q}(d,p,v,t,n,a,r,o)}}});return l?f.as4D(f.shape[1],f.shape[2],f.shape[3],f.shape[4]):f}}),$N=N({avgPool3d_:function(e,t,n,r,o,i,a){i===void 0&&(i="NDHWC");var s=k(e,"x","avgPool3d","float32"),u=s,l=!1;s.rank===4&&(l=!0,u=s.as5D(1,s.shape[0],s.shape[1],s.shape[2],s.shape[3])),a==null&&(a=[1,1,1]),I(u.rank===5,function(){return"Error in avgPool3d: x must be rank 5 but got rank "+u.rank+"."}),I(i==="NDHWC",function(){return"Error in avgPool3d: Only NDHWC is currently supported, but got dataFormat of "+i}),I(gn(n,a),function(){return"Error in avgPool3d: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+a+"'"}),o!=null&&I(mt(r),function(){return"Error in avgPool3d: pad must be an integer when using, dimRoundingMode "+o+" but got pad "+r+"."});var c=Hl(u.shape,t,n,a,r,o,i),f=P.runKernelFunc(function(d){return d.avgPool3d(u,c)},{x:u},function(d){return{x:function(){return function(h,p,v,g,m,y,x){var w=k(h,"dy","avgPool3dBackprop"),E=k(p,"input","avgPool3dBackprop"),b=w,C=E,_=!1;E.rank===4&&(_=!0,b=w.as5D(1,w.shape[0],w.shape[1],w.shape[2],w.shape[3]),C=E.as5D(1,E.shape[0],E.shape[1],E.shape[2],E.shape[3])),I(b.rank===5,function(){return"Error in avgPool3dBackprop: dy must be rank 5 but got rank "+b.rank+"."}),I(C.rank===5,function(){return"Error in avgPool3dBackprop: input must be rank 5 but got rank "+C.rank+"."}),m==null&&(m=[1,1,1]),I(gn(g,m),function(){return"Error in avgPool3dBackprop: Either strides or dilations must be 1. Got strides "+g+" and dilations '"+m+"'"}),x!=null&&I(mt(y),function(){return"Error in maxPool3dBackprop: pad must be an integer when using, dimRoundingMode "+x+" but got pad "+y+"."});var S=Hl(C.shape,v,g,m,y,x),R=P.runKernelFunc(function(D){return D.avgPool3dBackprop(b,C,S)},{dy5D:b,input5D:C});return _?R.as4D(R.shape[1],R.shape[2],R.shape[3],R.shape[4]):R}(d,u,t,n,a,r,o)}}});return f=f.cast(u.dtype),l?f.as4D(f.shape[1],f.shape[2],f.shape[3],f.shape[4]):f}}),Ir=N({slice_:function(e,t,n){var r,o,i=k(e,"x","slice");if(i.rank===0)throw new Error("Slicing scalar is not possible");(r=typeof t=="number"?[t].concat(new Array(i.rank-1).fill(0)):t.length<i.rank?t.concat(new Array(i.rank-t.length).fill(0)):t.slice()).forEach(function(u){I(u!==-1,function(){return"slice() does not support negative begin indexing."})}),o=(o=n==null?new Array(i.rank).fill(-1):typeof n=="number"?[n].concat(new Array(i.rank-1).fill(-1)):n.length<i.rank?n.concat(new Array(i.rank-n.length).fill(-1)):n).map(function(u,l){return u>=0?u:(I(u===-1,function(){return"Negative size values should be exactly -1 but got "+u+" for the slice() size at index "+l+"."}),i.shape[l]-r[l])}),yI(i,r,o);var a=i.shape,s={begin:r,size:o};return P.runKernelFunc(function(u){return u.slice(i,r,o)},{x:i},function(u){for(var l=[],c=0;c<u.rank;c++)l.push([r[c],a[c]-r[c]-o[c]]);return{x:function(){return u.pad(l)}}},"Slice",s)}}),HN=N({slice1d_:function(e,t,n){var r=k(e,"x","slice1d");return I(r.rank===1,function(){return"slice1d expects a rank-1 tensor, but got a rank-"+r.rank+" tensor"}),Ir(r,[t],[n])}}),GN=N({slice2d_:function(e,t,n){var r=k(e,"x","slice2d");return I(r.rank===2,function(){return"slice2d expects a rank-2 tensor, but got a rank-"+r.rank+" tensor"}),Ir(r,t,n)}}),Kw=N({slice3d_:function(e,t,n){var r=k(e,"x","slice3d");return I(r.rank===3,function(){return"slice3d expects a rank-3 tensor, but got a rank-"+r.rank+" tensor"}),Ir(r,t,n)}}),qN=N({slice4d_:function(e,t,n){var r=k(e,"x","slice4d");return I(r.rank===4,function(){return"slice4d expects a rank-4 tensor, but got a rank-"+r.rank+" tensor"}),Ir(r,t,n)}});function Xw(e,t,n,r,o){return t.rank<n.rank&&(t=t.reshape(mn(t.shape,r))),e.rank<n.rank&&(e=e.reshape(mn(e.shape,r))),{x:function(){var i=e.mul(n.equal(t).cast(e.dtype));return o==null?i:i.transpose(o)}}}var KN=N({all_:function(e,t,n){t===void 0&&(t=null),n===void 0&&(n=!1);var r=k(e,"x","all","bool"),o=Dt(t,r.shape),i=o,a=Tr(i,r.rank);a!=null&&(r=r.transpose(a),i=Nr(i.length,r.rank));var s=P.runKernelFunc(function(l){return l.all(r,i)},{$x:r});if(n){var u=mn(s.shape,o);return s.reshape(u)}return s}}),XN=N({any_:function(e,t,n){t===void 0&&(t=null),n===void 0&&(n=!1);var r=k(e,"x","any","bool"),o=Dt(t,r.shape),i=o,a=Tr(i,r.rank);a!=null&&(r=r.transpose(a),i=Nr(i.length,r.rank));var s=P.runKernelFunc(function(l){return l.any(r,i)},{$x:r});if(n){var u=mn(s.shape,o);return s.reshape(u)}return s}}),YN=N({argMax_:function(e,t){t===void 0&&(t=0);var n=k(e,"x","argMax");t==null&&(t=0);var r=Dt(t,n.shape),o=Tr(r,n.rank);o!=null&&(n=n.transpose(o),r=Nr(r.length,n.rank));var i={axis:r[0]},a=[n];return P.runKernelFunc(function(s,u){var l=s.argMax(n,r[0]);return u([n]),l},{x:n},function(s,u){var l=u[0];return{x:function(){return Le(l)}}},"ArgMax",i,a)}}),QN=N({argMin_:function(e,t){t===void 0&&(t=0);var n=k(e,"x","argMin");t==null&&(t=0);var r=Dt(t,n.shape),o=Tr(r,n.rank);return o!=null&&(n=n.transpose(o),r=Nr(r.length,n.rank)),P.runKernelFunc(function(i,a){var s=i.argMin(n,r[0]);return a([n]),s},{$x:n},function(i,a){var s=a[0];return{$x:function(){return Le(s)}}})}}),JN=N({logSumExp_:function(e,t,n){t===void 0&&(t=null),n===void 0&&(n=!1);var r=k(e,"x","logSumExp"),o=Dt(t,r.shape),i=r.max(o,!0),a=r.sub(i).exp().sum(o).log(),s=i.reshape(a.shape).add(a);if(n){var u=mn(s.shape,o);return s.reshape(u)}return s}}),Fc=N({max_:function(e,t,n){t===void 0&&(t=null),n===void 0&&(n=!1);var r=k(e,"x","max"),o=r,i=Dt(t,r.shape),a=i,s=Tr(a,r.rank);s!=null&&(r=r.transpose(s),a=Nr(a.length,r.rank));var u=[r],l=P.runKernelFunc(function(f,d){var h=f.max(r,a);return d([o,h]),h},{x:r},function(f,d){return Xw(f,d[1],d[0],i,s)},"Max",{axes:a},u,[!0]);if(n){var c=mn(l.shape,i);l=l.reshape(c)}return l}}),ZN=N({mean_:function(e,t,n){t===void 0&&(t=null),n===void 0&&(n=!1);var r=k(e,"x","mean"),o=Dt(t,r.shape),i=le(Gt(r.shape,o)[1]);return Dc(function(a){var s=ne(i);return{value:(s.dtype===a.dtype?a:a.cast(s.dtype)).div(s).sum(t,n),gradFunc:function(u){var l=a.shape.slice();return o.forEach(function(c){l[c]=1}),u.reshape(l).mul(Da(a.shape,"float32")).div(i)}}})(r)}}),eA=N({min_:function(e,t,n){t===void 0&&(t=null),n===void 0&&(n=!1);var r=k(e,"x","min"),o=r,i=Dt(t,r.shape),a=i,s=Tr(a,r.rank);s!=null&&(r=r.transpose(s),a=Nr(a.length,r.rank));var u=[r],l=P.runKernelFunc(function(f,d){var h=f.min(r,a);return d([o,h]),h},{x:r},function(f,d){return Xw(f,d[1],d[0],i,s)},"Min",{axes:a},u,[!0]);if(n){var c=mn(l.shape,i);l=l.reshape(c)}return l}}),tA=N({moments_:function(e,t,n){t===void 0&&(t=null),n===void 0&&(n=!1);var r=Dt(t,(e=k(e,"x","moments")).shape),o=e.mean(r,n),i=o.shape;n||(i=mn(o.shape,r));var a=e.toFloat().sub(o.reshape(i)).square();return{mean:o,variance:a.mean(r,n)}}}),Yw=N({sum_:function(e,t,n){t===void 0&&(t=null),n===void 0&&(n=!1);var r=k(e,"x","sum");r.dtype==="bool"&&(r=r.toInt());var o=Dt(t,r.shape);return Dc(function(i){var a=Tr(o,i.rank),s=o,u=i;a!=null&&(u=i.transpose(a),s=Nr(s.length,i.rank));var l=function(h){var p=i.shape.slice();return o.forEach(function(v){p[v]=1}),h.reshape(p).mul(Da(i.shape,"float32"))},c={axes:s},f=P.runKernelFunc(function(h){return h.sum(u,s)},{x:u},function(h){return{x:function(){return l(h)}}},"Sum",c);if(n){var d=mn(f.shape,o);f=f.reshape(d)}return{value:f,gradFunc:l}})(r)}}),nA=N({prod_:function(e,t,n){t===void 0&&(t=null),n===void 0&&(n=!1);var r=k(e,"x","prod");r.dtype==="bool"&&(r=r.toInt());var o=Dt(t,r.shape),i=Tr(o,r.rank),a=o,s=r;i!=null&&(s=r.transpose(i),a=Nr(a.length,r.rank));var u=P.runKernelFunc(function(c){return c.prod(s,a)},{permutedX:s});if(n){var l=mn(u.shape,o);u=u.reshape(l)}return u}}),Qw=N({elu_:function(e){var t=k(e,"x","elu");return P.runKernelFunc(function(n,r){var o=n.elu(t);return r([o]),o},{$x:t},function(n,r){var o=r[0];return{$x:function(){return P.runKernelFunc(function(i){return i.eluDer(n,o)},{dy:n,y:o})}}})}}),rA=N({leakyRelu_:function(e,t){t===void 0&&(t=.2);var n=k(e,"x","leakyRelu");return Hp(ne(t).mul(n),n)}}),Jw=N({prelu_:function(e,t){var n=k(e,"x","prelu"),r=k(t,"alpha","prelu");return P.runKernelFunc(function(o,i){var a=o.prelu(n,r);return i([n,r]),a},{x:n,alpha:r},function(o,i){var a=i[0],s=i[1],u=a.greater(0);return{x:function(){return li(u,o,o.mul(s))},alpha:function(){var l=li(u,Le(o),o.mul(a)),c=kt(s.shape,o.shape);return c.length>0&&(l=l.sum(c)),l.reshape(s.shape)}}},"Prelu")}}),ut=N({relu_:function(e){var t=k(e,"x","relu");return t.dtype==="bool"?t.toInt():P.runKernelFunc(function(n,r){var o=n.relu(t);return r([t]),o},{x:t},function(n,r){var o=r[0];return{x:function(){return n.mulStrict(o.step().toFloat())}}},"Relu")}}),Zw=N({relu6_:function(e){var t=k(e,"x","relu6");return t.dtype==="bool"?t.toInt():P.runKernelFunc(function(n,r){var o=n.relu6(t);return r([t]),o},{x:t},function(n,r){var o=r[0],i=o.lessEqual(6).mul(o.step());return{x:function(){return n.mulStrict(i.toFloat())}}},"Relu6")}}),oA=N({selu_:function(e){var t=k(e,"x","selu");return P.runKernelFunc(function(n,r){var o=n.selu(t);return r([t]),o},{$x:t},function(n,r){var o=r[0];return{$x:function(){var i=o.greater(ne(0)),a=ne(jp),s=ne(Vp),u=n.mul(s),l=n.mul(a).mul(o.toFloat().exp());return li(i,u,l)}}})}}),Do=N({transpose_:function(e,t){var n=k(e,"x","transpose");if(t==null&&(t=n.shape.map(function(o,i){return i}).reverse()),I(n.rank===t.length,function(){return"Error in transpose: rank of input "+n.rank+" must match length of perm "+t+"."}),t.forEach(function(o){I(o>=0&&o<n.rank,function(){return"All entries in 'perm' must be between 0 and "+(n.rank-1)+" but got "+t})}),n.rank<=1)return n.clone();var r={perm:t};return P.runKernelFunc(function(o){return o.transpose(n,t)},{x:n},function(o){var i=Ap(t);return{x:function(){return o.transpose(i)}}},"Transpose",r)}}),iA=N({localResponseNormalization_:function(e,t,n,r,o){t===void 0&&(t=5),n===void 0&&(n=1),r===void 0&&(r=1),o===void 0&&(o=.5);var i=k(e,"x","localResponseNormalization");I(i.rank===4||i.rank===3,function(){return`Error in localResponseNormalization: x must be rank 3 or 4 but got
               rank `+i.rank+"."}),I(mt(t),function(){return"Error in localResponseNormalization: depthRadius must be an integer but got depthRadius "+t+"."});var a=i,s=!1;i.rank===3&&(s=!0,a=i.as4D(1,i.shape[0],i.shape[1],i.shape[2]));var u=P.runKernelFunc(function(l,c){var f=l.localResponseNormalization4D(a,t,n,r,o);return c([a,f]),f},{x4D:a},function(l,c){var f=c[0],d=c[1];return{x4D:function(){return P.runKernelFunc(function(h){return h.LRNGrad(l,f,d,t,n,r,o)},{})}}});return s?u.as3D(u.shape[1],u.shape[2],u.shape[3]):u}}),eb=N({norm_:function(e,t,n,r){t===void 0&&(t="euclidean"),n===void 0&&(n=null),r===void 0&&(r=!1);var o=function s(u,l,c){if(c===void 0&&(c=null),u.rank===0)return u.abs();if(u.rank!==1&&c===null)return s(u.reshape([-1]),l,c);if(u.rank===1||typeof c=="number"||Array.isArray(c)&&c.length===1){if(l===1)return u.abs().sum(c);if(l===1/0)return u.abs().max(c);if(l===-1/0)return u.abs().min(c);if(l==="euclidean"||l===2)return u.abs().pow(ne(2,"int32")).sum(c).sqrt();throw new Error("Error in norm: invalid ord value: "+l)}if(Array.isArray(c)&&c.length===2){if(l===1)return u.abs().sum(c[0]).max(c[1]-1);if(l===1/0)return u.abs().sum(c[1]).max(c[0]);if(l===-1/0)return u.abs().sum(c[1]).min(c[0]);if(l==="fro"||l==="euclidean")return u.square().sum(c).sqrt();throw new Error("Error in norm: invalid ord value: "+l)}throw new Error("Error in norm: invalid axis: "+c)}(e=k(e,"x","norm"),t,n),i=o.shape;if(r){var a=Dt(n,e.shape);i=mn(o.shape,a)}return o.reshape(i)}}),aA=N({basicLSTMCell_:function(e,t,n,r,o,i){var a=k(e,"forgetBias","basicLSTMCell"),s=k(t,"lstmKernel","basicLSTMCell"),u=k(n,"lstmBias","basicLSTMCell"),l=k(r,"data","basicLSTMCell"),c=k(o,"c","basicLSTMCell"),f=k(i,"h","basicLSTMCell"),d=l.concat(f,1).matMul(s).add(u),h=d.shape[0],p=d.shape[1]/4,v=[h,p],g=d.slice([0,0],v),m=d.slice([0,p],v),y=d.slice([0,2*p],v),x=d.slice([0,3*p],v),w=g.sigmoid().mulStrict(m.tanh()).addStrict(c.mulStrict(a.add(y).sigmoid())),E=w.tanh().mulStrict(x.sigmoid());return[w,E]}}),sA=N({multiRNNCell_:function(e,t,n,r){for(var o=k(t,"data","multiRNNCell"),i=Ul(n,"c","multiRNNCell"),a=Ul(r,"h","multiRNNCell"),s=o,u=[],l=0;l<e.length;l++){var c=e[l](s,i[l],a[l]);u.push(c[0]),u.push(c[1]),s=c[1]}var f=[],d=[];for(l=0;l<u.length;l+=2)f.push(u[l]),d.push(u[l+1]);return[f,d]}}),uA=N({movingAverage_:function(e,t,n,r,o){o===void 0&&(o=!0);var i=k(e,"v","movingAverage"),a=k(t,"x","movingAverage"),s=k(n,"decay","movingAverage");ik(i,a),I(Ft(i.shape,a.shape),function(){return"Shape mismatch in v and x"});var u=ne(1),l=u.sub(s),c=a.sub(i).mul(l);if(o){I(r!=null,function(){return"When using zeroDebias: true, step is required."});var f=k(r,"step","movingAverage");c=c.div(u.sub(Xl(s,f)))}return i.add(c)}}),lA=N({stridedSlice_:function(e,t,n,r,o,i,a,s,u){if(o===void 0&&(o=0),i===void 0&&(i=0),a===void 0&&(a=0),s===void 0&&(s=0),u===void 0&&(u=0),r==null&&(r=new Array(t.length)),a!==0)throw new Error("ellipsis mask is not yet supported");var l=k(e,"x","stridedSlice"),c=jg(s),f=l.shape.slice();c.forEach(function(g){t[g]=0,n[g]=1,f.splice(g,0,1)}),l=l.reshape(f);for(var d=0;d<l.rank;d++)t[d]=xI(o,t,r,l.shape,d),n[d]=wI(i,n,r,l.shape,d),r[d]=r[d]||1;var h=jg(u);h.forEach(function(g){n[g]=t[g]+1,r[g]=1});var p=Op(t,n,r),v=p.filter(function(g,m){return h.indexOf(m)===-1});return r.every(function(g){return g===1})?Ir(l,t,p).reshape(v):P.runKernelFunc(function(g){return g.stridedSlice(l,t,n,r)},{$x:l}).reshape(v)}}),cA=N({topk_:function(e,t,n){t===void 0&&(t=1),n===void 0&&(n=!0);var r=k(e,"x","topk");if(r.rank===0)throw new Error("topk() expects the input to be of rank 1 or higher");var o=r.shape[r.shape.length-1];if(t>o)throw new Error("'k' passed to topk() must be <= the last dimension ("+o+") but got "+t);var i=P.runKernelFunc(function(a){return a.topk(r,t,n)},{$x:r});return{values:i[0],indices:i[1]}}}),fA=N({scatterND_:function(e,t,n){var r=k(e,"indices","scatterND","int32"),o=k(t,"updates","scatterND");return gI(o,r,n),P.runKernelFunc(function(i){return i.scatterND(r,o,n)},{indices:r,updates:o},null,"ScatterNd",{shape:n})}}),Xp=N({fft_:function(e){I(e.dtype==="complex64",function(){return"The dtype for tf.spectral.fft() must be complex64 but got "+e.dtype+"."});var t=e.shape[e.shape.length-1],n=e.size/t,r=e.as2D(n,t);return P.runKernelFunc(function(o){return o.fft(r)},{input:e}).reshape(e.shape)}}),Yl=N({ifft_:function(e){I(e.dtype==="complex64",function(){return"The dtype for tf.spectral.ifft() must be complex64 but got "+e.dtype+"."});var t=e.shape[e.shape.length-1],n=e.size/t,r=e.as2D(n,t);return P.runKernelFunc(function(o){return o.ifft(r)},{input:e}).reshape(e.shape)}}),Yp=N({rfft_:function(e,t){I(e.dtype==="float32",function(){return"The dtype for rfft() must be real value but got "+e.dtype});var n,r=e.shape[e.shape.length-1],o=e.size/r;if(t!=null&&t<r){var i=e.shape.map(function(m){return 0}),a=e.shape.map(function(m){return m});a[e.shape.length-1]=t,n=e.slice(i,a),r=t}else if(t!=null&&t>r){var s=e.shape.map(function(m){return m});s[e.shape.length-1]=t-r,n=e.concat(et(s),e.shape.length-1),r=t}else n=e;var u=n.zerosLike(),l=Bt(n,u).as2D(o,r),c=Xp(l),f=Math.floor(r/2)+1,d=Wn(c),h=br(c),p=d.split([f,r-f],d.shape.length-1),v=h.split([f,r-f],h.shape.length-1),g=n.shape.slice();return g[n.shape.length-1]=f,Bt(p[0],v[0]).reshape(g)}}),tb=N({irfft_:function(e){var t=e.shape[e.shape.length-1],n=e.size/t;if(t<=2){var r=e.as2D(n,t),o=Yl(r);return Wn(o)}var i=[n,2*(t-1)],a=Wn(e).as2D(n,t),s=br(e).as2D(n,t),u=a.slice([0,1],[n,t-2]).reverse(1),l=s.slice([0,1],[n,t-2]).reverse(1).mul(ne(-1)),c=a.concat(u,1),f=s.concat(l,1);return r=Bt(c,f).as2D(i[0],i[1]),o=Yl(r),Wn(o)}}),dA=Object.freeze({fft:Xp,ifft:Yl,rfft:Yp,irfft:tb}),hA=N({sparseToDense_:function(e,t,n,r){r===void 0&&(r=0);var o=k(e,"sparseIndices","sparseToDense","int32"),i=k(t,"sparseValues","sparseToDense"),a=k(r,"defaultValue","sparseToDense",i.dtype);return function(s,u,l,c){if(s.dtype!=="int32")throw new Error("tf.sparseToDense() expects the indices to be int32 type, but the dtype was "+s.dtype+".");if(s.rank>2)throw new Error("sparseIndices should be a scalar, vector, or matrix, but got shape "+s.shape+".");var f=s.rank>0?s.shape[0]:1,d=s.rank>1?s.shape[1]:1;if(l.length!==d)throw new Error("outputShape has incorrect number of elements:, "+l.length+", should be: "+d+".");var h=u.size;if(u.rank!==0&&(u.rank!==1||h!==f))throw new Error("sparseValues has incorrect shape "+u.shape+", should be [] or ["+f+"]");if(u.dtype!==c.dtype)throw new Error("sparseValues.dtype must match defaultValues.dtype")}(o,i,n,a),P.runKernelFunc(function(s){return s.sparseToDense(o,i,n,a)},{$sparseIndices:o,$sparseValues:i,$defaultValue:a})}}),pA=N({gatherND_:function(e,t){var n=k(t,"indices","gatherND","int32"),r=k(e,"x","gatherND");return P.runKernelFunc(function(o){return o.gatherND(r,n)},{x:r,indices:n},null,"GatherNd")}}),vA=N({diag_:function(e){var t=k(e,"x","diag").flatten(),n=e.shape.concat(e.shape);return P.runKernelFunc(function(r){return r.diag(t)},{$x:t}).reshape(n)}}),mA=N({dropout_:function(e,t,n,r){var o=k(e,"x","dropout");if(I(o.dtype==="float32",function(){return"x has to be a floating point tensor since it's going to be scaled, but got a "+o.dtype+" tensor instead."}),I(t>=0&&t<1,function(){return"rate must be a float in the range [0, 1), but got "+t+"."}),t===0)return e instanceof st?o.clone():o;var i=function(u,l){if(l==null)return u.shape.slice();if(Ft(u.shape,l))return l;if(u.shape.length===l.length){for(var c=[],f=0;f<u.shape.length;f++)l[f]==null&&u.shape[f]!=null?c.push(u.shape[f]):c.push(l[f]);return c}return l}(o,n),a=1-t,s=Jx(i,0,1,"float32",r).add(a).floor().div(a);return o.mul(s)}});function nb(e,t,n){for(var r=1-e%2,o=new Float32Array(e),i=0;i<e;++i){var a=2*Math.PI*i/(e+r-1);o[i]=t-n*Math.cos(a)}return wt(o,"float32")}var Qp=N({hannWindow_:function(e){return nb(e,.5,.5)}}),rb=N({hammingWindow_:function(e){return nb(e,.54,.46)}}),Jp=N({frame_:function(e,t,n,r,o){r===void 0&&(r=!1),o===void 0&&(o=0);for(var i=0,a=[];i+t<=e.size;)a.push(Ir(e,i,t)),i+=n;if(r)for(;i<e.size;){var s=i+t-e.size,u=St([Ir(e,i,t-s),kr([s],o)]);a.push(u),i+=n}return a.length===0?_o([],[0,t]):St(a).as2D(a.length,t)}}),ob=N({stft_:function(e,t,n,r,o){var i;o===void 0&&(o=Qp),r==null&&(i=t,r=Math.floor(Math.pow(2,Math.ceil(Math.log(i)/Math.log(2)))));for(var a=Jp(e,t,n),s=Qt(a,o(t)),u=[],l=0;l<a.shape[0];l++)u.push(Yp(s.slice([l,0],[1,t]),r));return St(u)}}),gA=Object.freeze({hannWindow:Qp,hammingWindow:rb,frame:Jp,stft:ob}),Yt,yA=function(e,t,n){return n===void 0&&(n=1),se(this,void 0,void 0,function(){var r,o,i,a,s,u,l,c,f,d,h,p,v,g;return ue(this,function(m){switch(m.label){case 0:return r=k(e,"predictions","inTopK"),o=k(t,"targets","inTopK"),I(r.rank>1,function(){return"inTopK() expects the predictions to be of rank 2 or higher, but got "+r.rank}),I(r.rank-1===o.rank,function(){return"predictions rank should be 1 larger than targets rank, but got predictions rank "+r.rank+" and targets rank "+o.rank}),je(r.shape.slice(0,r.shape.length-1),o.shape,"predictions's shape should be align with the targets' shape, except the last dimension."),i=r.shape[r.shape.length-1],I(n>0&&n<=i,function(){return"'k' passed to inTopK() must be > 0 && <= the predictions last dimension ("+i+"), but got "+n}),[4,r.data()];case 1:return a=m.sent(),[4,o.data()];case 2:for(s=m.sent(),u=[a.length/i,i],c=u[1],f=Ns("bool",l=u[0]),d=0;d<l;d++){for(h=d*c,p=a.subarray(h,h+c),v=[],g=0;g<p.length;g++)v.push({value:p[g],index:g});for(v.sort(function(y,x){return x.value-y.value}),f[d]=0,g=0;g<n;g++)if(v[g].index===s[d]){f[d]=1;break}}return e!==r&&r.dispose(),t!==o&&o.dispose(),[2,Wt(f,o.shape,"bool")]}})})};(function(e){e[e.NONE=0]="NONE",e[e.MEAN=1]="MEAN",e[e.SUM=2]="SUM",e[e.SUM_BY_NONZERO_WEIGHTS=3]="SUM_BY_NONZERO_WEIGHTS"})(Yt||(Yt={}));var xA=N({absoluteDifference_:function(e,t,n,r){r===void 0&&(r=Yt.SUM_BY_NONZERO_WEIGHTS);var o=k(e,"labels","absoluteDifference"),i=k(t,"predictions","absoluteDifference"),a=null;n!=null&&(a=k(n,"weights","absoluteDifference")),je(o.shape,i.shape,"Error in absoluteDifference: ");var s=o.sub(i).abs();return Yr(s,a,r)}}),Yr=N({computeWeightedLoss_:function(e,t,n){n===void 0&&(n=Yt.SUM_BY_NONZERO_WEIGHTS);var r=k(e,"losses","computeWeightedLoss"),o=null;t!=null&&(o=k(t,"weights","computeWeightedLoss"));var i=o==null?r:r.mul(o);if(n===Yt.NONE)return i;if(n===Yt.SUM)return i.sum();if(n===Yt.MEAN){if(o==null)return i.mean();var a=r.size/o.size,s=i.sum().div(o.sum());return a>1?s.div(ne(a)):s}if(n===Yt.SUM_BY_NONZERO_WEIGHTS){if(o==null)return i.sum().div(ne(r.size));var u=o.mul(Da(r.shape)).notEqual(ne(0)).sum().toFloat();return i.sum().div(u)}throw Error("Unknown reduction: "+n)}}),wA=N({cosineDistance_:function(e,t,n,r,o){o===void 0&&(o=Yt.SUM_BY_NONZERO_WEIGHTS);var i=k(e,"labels","cosineDistance"),a=k(t,"predictions","cosineDistance"),s=null;r!=null&&(s=k(r,"weights","cosineDistance")),je(i.shape,a.shape,"Error in cosineDistance: ");var u=ne(1).sub(i.mul(a).sum(n,!0));return Yr(u,s,o)}}),bA=N({hingeLoss_:function(e,t,n,r){r===void 0&&(r=Yt.SUM_BY_NONZERO_WEIGHTS);var o=k(e,"labels","hingeLoss"),i=k(t,"predictions","hingeLoss"),a=null;n!=null&&(a=k(n,"weights","hingeLoss")),je(o.shape,i.shape,"Error in hingeLoss: ");var s=ne(1);o=ne(2).mul(o).sub(s);var u=s.sub(o.mul(i)).relu();return Yr(u,a,r)}}),EA=N({huberLoss_:function(e,t,n,r,o){r===void 0&&(r=1),o===void 0&&(o=Yt.SUM_BY_NONZERO_WEIGHTS);var i=k(e,"labels","huberLoss"),a=k(t,"predictions","huberLoss"),s=null;n!=null&&(s=k(n,"weights","huberLoss")),je(i.shape,a.shape,"Error in huberLoss: ");var u=ne(r),l=a.sub(i).abs(),c=Lw(l,u),f=l.sub(c),d=ne(.5).mul(c.square()).add(u.mul(f));return Yr(d,s,o)}}),CA=N({logLoss_:function(e,t,n,r,o){r===void 0&&(r=1e-7),o===void 0&&(o=Yt.SUM_BY_NONZERO_WEIGHTS);var i=k(e,"labels","logLoss"),a=k(t,"predictions","logLoss"),s=null;n!=null&&(s=k(n,"weights","logLoss")),je(i.shape,a.shape,"Error in logLoss: ");var u=ne(1),l=ne(r),c=i.mul(a.add(l).log()).neg().sub(u.sub(i).mul(u.sub(a).add(l).log()));return Yr(c,s,o)}}),_A=N({meanSquaredError_:function(e,t,n,r){r===void 0&&(r=Yt.SUM_BY_NONZERO_WEIGHTS);var o=k(e,"labels","meanSquaredError"),i=k(t,"predictions","meanSquaredError"),a=null;n!=null&&(a=k(n,"weights","meanSquaredError")),je(o.shape,i.shape,"Error in meanSquaredError: ");var s=o.squaredDifference(i);return Yr(s,a,r)}}),SA=N({sigmoidCrossEntropy_:function(e,t,n,r,o){r===void 0&&(r=0),o===void 0&&(o=Yt.SUM_BY_NONZERO_WEIGHTS);var i=k(e,"multiClassLabels","sigmoidCrossEntropy"),a=k(t,"logits","sigmoidCrossEntropy"),s=null;if(n!=null&&(s=k(n,"weights","sigmoidCrossEntropy")),je(i.shape,a.shape,"Error in sigmoidCrossEntropy: "),r>0){var u=ne(r),l=ne(1),c=ne(.5);i=i.mul(l.sub(u)).add(c.mul(u))}var f=function(d,h){var p=k(d,"labels","sigmoidCrossEntropyWithLogits"),v=k(h,"logits","sigmoidCrossEntropyWithLogits");je(p.shape,v.shape,"Error in sigmoidCrossEntropyWithLogits: ");var g=v.relu(),m=v.mul(p),y=v.abs().neg().exp().log1p();return g.sub(m).add(y)}(i,a);return Yr(f,s,o)}}),RA=N({softmaxCrossEntropy_:function(e,t,n,r,o){r===void 0&&(r=0),o===void 0&&(o=Yt.SUM_BY_NONZERO_WEIGHTS);var i=k(e,"onehotLabels","softmaxCrossEntropy"),a=k(t,"logits","softmaxCrossEntropy"),s=null;if(n!=null&&(s=k(n,"weights","softmaxCrossEntropy")),je(i.shape,a.shape,"Error in softmaxCrossEntropy: "),r>0){var u=ne(r),l=ne(1),c=ne(i.shape[1]);i=i.mul(l.sub(u)).add(u.div(c))}var f=function(d,h,p){if(p===void 0&&(p=-1),p===-1&&(p=h.rank-1),p!==h.rank-1)throw Error("Softmax cross entropy along a non-last dimension is not yet supported. Labels / logits was rank "+h.rank+" and dim was "+p);return Dc(function(v,g,m){var y=g.logSumExp([p],!0),x=g.toFloat().sub(y);return m([v,x]),{value:x.mul(v).neg().sum([p]),gradFunc:function(w,E){var b=E[0],C=E[1],_=mn(w.shape,[p]);return[w.reshape(_).mul(b.toFloat().sub(C.exp())),w.reshape(_).mul(C.exp().sub(b.toFloat()))]}}})(d,h)}(i,a);return Yr(f,s,o)}}),kA=Object.freeze({get Reduction(){return Yt},absoluteDifference:xA,computeWeightedLoss:Yr,cosineDistance:wA,hingeLoss:bA,huberLoss:EA,logLoss:CA,meanSquaredError:_A,sigmoidCrossEntropy:SA,softmaxCrossEntropy:RA});function cy(e,t){return t===void 0&&(t=!1),P.tidy(function(){if(e.shape.length!==2)throw new Error("qr2d() requires a 2D Tensor, but got a "+e.shape.length+"D Tensor.");for(var n=e.shape[0],r=e.shape[1],o=Qx(n),i=e.clone(),a=_o([[1]],[1,1]),s=a.clone(),u=n>=r?r:n,l=function(f){var d,h=i,p=s,v=o;d=P.tidy(function(){var g=i.slice([f,f],[n-f,1]),m=g.norm(),y=i.slice([f,f],[1,1]),x=_o([[-1]]).where(y.greater(0),_o([[1]])),w=y.sub(x.mul(m)),E=g.div(w);s=E.shape[0]===1?a.clone():a.concat(E.slice([1,0],[E.shape[0]-1,E.shape[1]]),0);var b=x.matMul(w).div(m).neg(),C=i.slice([f,0],[n-f,r]),_=b.mul(s);if(f===0)i=C.sub(_.matMul(s.transpose().matMul(C)));else{var S=C.sub(_.matMul(s.transpose().matMul(C)));i=i.slice([0,0],[f,r]).concat(S,0)}var R=o.slice([0,f],[n,o.shape[1]-f]);if(f===0)o=R.sub(R.matMul(s).matMul(_.transpose()));else{var D=R.sub(R.matMul(s).matMul(_.transpose()));o=o.slice([0,0],[n,f]).concat(D,1)}return[s,i,o]}),s=d[0],i=d[1],o=d[2],vn([h,p,v])},c=0;c<u;++c)l(c);return!t&&n>r&&(o=o.slice([0,0],[n,r]),i=i.slice([0,0],[r,r])),[o,i]})}var IA=N({bandPart_:function(e,t,n){if(t%1!=0)throw new Error("bandPart(): numLower must be an integer, got "+t+".");if(n%1!=0)throw new Error("bandPart(): numUpper must be an integer, got "+n+".");var r=k(e,"a","bandPart");if(r.rank<2)throw new Error("bandPart(): Rank must be at least 2, got "+r.rank+".");var o=r.shape,i=r.shape.slice(-2),a=i[0],s=i[1];if(!(t<=a))throw new Error("bandPart(): numLower ("+t+") must not be greater than the number of rows ("+a+").");if(!(n<=s))throw new Error("bandPart(): numUpper ("+n+") must not be greater than the number of columns ("+s+").");t<0&&(t=a),n<0&&(n=s);var u=Wl(0,a,1,"int32").reshape([-1,1]),l=Wl(0,s,1,"int32"),c=It(u,l),f=Nc(c.lessEqual(ne(+t,"int32")),c.greaterEqual(ne(-n,"int32"))),d=et([a,s],r.dtype);return Dn(Rt(r.reshape([-1,a,s])).map(function(h){return li(f,h,d)})).reshape(o)}}),DA=N({gramSchmidt_:function(e){var t;if(Array.isArray(e)){t=!1,I(e!=null&&e.length>0,function(){return"Gram-Schmidt process: input must not be null, undefined, or empty"});for(var n=e[0].shape[0],r=function(u){I(e[u].shape[0]===n,function(){return"Gram-Schmidt: Non-unique lengths found in the input vectors: ("+e[u].shape[0]+" vs. "+n+")"})},o=1;o<e.length;++o)r(o)}else t=!0,e=Fp(e,e.shape[0],0).map(function(u){return ew(u,[0])});I(e.length<=e[0].shape[0],function(){return"Gram-Schmidt: Number of vectors ("+e.length+") exceeds number of dimensions ("+e[0].shape[0]+")."});var i=[],a=e,s=function(u){i.push(P.tidy(function(){var l=a[u];if(u>0)for(var c=0;c<u;++c){var f=Yw(i[c].mulStrict(l)).mul(i[c]);l=l.sub(f)}return l.div(eb(l,"euclidean"))}))};for(o=0;o<e.length;++o)s(o);return t?Dn(i,0):i}}),TA=N({qr_:function(e,t){if(t===void 0&&(t=!1),e.rank<2)throw new Error("qr() requires input tensor to have a rank >= 2, but got rank "+e.rank);if(e.rank===2)return cy(e,t);var n=e.shape.slice(0,e.shape.length-2).reduce(function(a,s){return a*s}),r=Rt(e.reshape([n,e.shape[e.shape.length-2],e.shape[e.shape.length-1]]),0),o=[],i=[];return r.forEach(function(a){var s=cy(a,t),u=s[0],l=s[1];o.push(u),i.push(l)}),[Dn(o,0).reshape(e.shape),Dn(i,0).reshape(e.shape)]}}),NA=Object.freeze({bandPart:IA,gramSchmidt:DA,qr:TA});function Mc(e,t,n,r,o,i){r==null&&(r=.5),o==null&&(o=Number.NEGATIVE_INFINITY),i==null&&(i=0);var a=e.shape[0];return n=Math.min(n,a),I(0<=r&&r<=1,function(){return"iouThreshold must be in [0, 1], but was '"+r+"'"}),I(e.rank===2,function(){return"boxes must be a 2D tensor, but was of rank '"+e.rank+"'"}),I(e.shape[1]===4,function(){return"boxes must have 4 columns, but 2nd dimension was "+e.shape[1]}),I(t.rank===1,function(){return"scores must be a 1D tensor"}),I(t.shape[0]===a,function(){return"scores has incompatible shape with boxes. Expected "+a+", but was "+t.shape[0]}),I(0<=i&&i<=1,function(){return"softNmsSigma must be in [0, 1], but was '"+i+"'"}),{maxOutputSize:n,iouThreshold:r,scoreThreshold:o,softNmsSigma:i}}var AA=N({resizeBilinear_:function(e,t,n){n===void 0&&(n=!1);var r=k(e,"images","resizeBilinear");I(r.rank===3||r.rank===4,function(){return"Error in resizeBilinear: x must be rank 3 or 4, but got rank "+r.rank+"."}),I(t.length===2,function(){return"Error in resizeBilinear: new shape must 2D, but got shape "+t+"."});var o=r,i=!1;r.rank===3&&(i=!0,o=r.as4D(1,r.shape[0],r.shape[1],r.shape[2]));var a=t[0],s=t[1],u=P.runKernelFunc(function(l,c){return c([o]),l.resizeBilinear(o,a,s,n)},{x:o},function(l,c){return{x:function(){return P.runKernelFunc(function(f){return f.resizeBilinearBackprop(l,c[0],n)},{})}}},"ResizeBilinear",{alignCorners:n,newHeight:a,newWidth:s});return i?u.as3D(u.shape[1],u.shape[2],u.shape[3]):u}}),PA=N({resizeNearestNeighbor_:function(e,t,n){n===void 0&&(n=!1);var r=k(e,"images","resizeNearestNeighbor");I(r.rank===3||r.rank===4,function(){return"Error in resizeNearestNeighbor: x must be rank 3 or 4, but got rank "+r.rank+"."}),I(t.length===2,function(){return"Error in resizeNearestNeighbor: new shape must 2D, but got shape "+t+"."}),I(r.dtype==="float32"||r.dtype==="int32",function(){return"`images` must have `int32` or `float32` as dtype"});var o=r,i=!1;r.rank===3&&(i=!0,o=r.as4D(1,r.shape[0],r.shape[1],r.shape[2]));var a=t[0],s=t[1],u=P.runKernelFunc(function(l,c){return c([o]),l.resizeNearestNeighbor(o,a,s,n)},{batchImages:o},function(l,c){return{batchImages:function(){return P.runKernelFunc(function(f){return f.resizeNearestNeighborBackprop(l,c[0],n)},{})}}});return i?u.as3D(u.shape[1],u.shape[2],u.shape[3]):u}}),FA=N({nonMaxSuppression_:function(e,t,n,r,o){r===void 0&&(r=.5),o===void 0&&(o=Number.NEGATIVE_INFINITY);var i=k(e,"boxes","nonMaxSuppression"),a=k(t,"scores","nonMaxSuppression"),s=Mc(i,a,n,r,o);n=s.maxOutputSize,r=s.iouThreshold,o=s.scoreThreshold;var u={maxOutputSize:n,iouThreshold:r,scoreThreshold:o};return P.runKernelFunc(function(l){return l.nonMaxSuppression(i,a,n,r,o)},{boxes:i,scores:a},null,"NonMaxSuppressionV3",u)}}),MA=function(e,t,n,r,o){return r===void 0&&(r=.5),o===void 0&&(o=Number.NEGATIVE_INFINITY),se(this,void 0,void 0,function(){var i,a,s,u,l,c,f;return ue(this,function(d){switch(d.label){case 0:return i=k(e,"boxes","nonMaxSuppressionAsync"),a=k(t,"scores","nonMaxSuppressionAsync"),s=Mc(i,a,n,r,o),n=s.maxOutputSize,r=s.iouThreshold,o=s.scoreThreshold,[4,Promise.all([i.data(),a.data()])];case 1:return u=d.sent(),l=u[0],c=u[1],f=Bp(l,c,n,r,o),i!==e&&i.dispose(),a!==t&&a.dispose(),[2,f]}})})},OA=N({nonMaxSuppressionWithScore_:function(e,t,n,r,o,i){r===void 0&&(r=.5),o===void 0&&(o=Number.NEGATIVE_INFINITY),i===void 0&&(i=0);var a=k(e,"boxes","nonMaxSuppression"),s=k(t,"scores","nonMaxSuppression"),u=Mc(a,s,n,r,o,i),l={maxOutputSize:n=u.maxOutputSize,iouThreshold:r=u.iouThreshold,scoreThreshold:o=u.scoreThreshold,softNmsSigma:i=u.softNmsSigma},c=P.runKernel("NonMaxSuppressionV5",{boxes:a,scores:s},l);return{selectedIndices:c[0],selectedScores:c[1]}}}),LA=function(e,t,n,r,o,i){return r===void 0&&(r=.5),o===void 0&&(o=Number.NEGATIVE_INFINITY),i===void 0&&(i=0),se(this,void 0,void 0,function(){var a,s,u,l,c,f,d;return ue(this,function(h){switch(h.label){case 0:return a=k(e,"boxes","nonMaxSuppressionAsync"),s=k(t,"scores","nonMaxSuppressionAsync"),u=Mc(a,s,n,r,o,i),n=u.maxOutputSize,r=u.iouThreshold,o=u.scoreThreshold,i=u.softNmsSigma,[4,Promise.all([a.data(),s.data()])];case 1:return l=h.sent(),c=l[0],f=l[1],d=Up(c,f,n,r,o,i),a!==e&&a.dispose(),s!==t&&s.dispose(),[2,d]}})})},BA=N({cropAndResize_:function(e,t,n,r,o,i){var a=k(e,"image","cropAndResize"),s=k(t,"boxes","cropAndResize","float32"),u=k(n,"boxInd","cropAndResize","int32");o=o||"bilinear",i=i||0;var l=s.shape[0];return I(a.rank===4,function(){return"Error in cropAndResize: image must be rank 4,but got rank "+a.rank+"."}),I(s.rank===2&&s.shape[1]===4,function(){return"Error in cropAndResize: boxes must be have size ["+l+",4] but had shape "+s.shape+"."}),I(u.rank===1&&u.shape[0]===l,function(){return"Error in cropAndResize: boxInd must be have size ["+l+"] but had shape "+s.shape+"."}),I(r.length===2,function(){return"Error in cropAndResize: cropSize must be of length 2, but got length "+r.length+"."}),I(r[0]>=1&&r[1]>=1,function(){return"cropSize must be atleast [1,1], but was "+r}),I(o==="bilinear"||o==="nearest",function(){return"method must be bilinear or nearest, but was "+o}),P.runKernelFunc(function(c,f){return c.cropAndResize(a,s,u,r,o,i)},{images:a,boxes:s,boxInd:u},null,"CropAndResize",{method:o,extrapolationValue:i,cropSize:r})}}),Zp=Object.freeze({resizeBilinear:AA,resizeNearestNeighbor:PA,nonMaxSuppression:FA,nonMaxSuppressionAsync:MA,nonMaxSuppressionWithScore:OA,nonMaxSuppressionWithScoreAsync:LA,cropAndResize:BA}),ev=function(e,t){return!(e>0)||t==="linear"},tv=function(e,t,n){if(n==null||n==="linear")return e;if(n==="relu")return e.mul(t.step());throw new Error("Gradient for activation "+n+" has not been implemented yet.")},nv=function(e,t){var n=t,r=kt(e.shape,t.shape);return r.length>0&&(n=n.sum(r)),n.reshape(e.shape)},rv=function(e,t,n){if(t==="linear")return e;if(t==="relu")return ut(e);if(t==="elu")return Qw(e);if(t==="relu6")return Zw(e);if(t==="prelu")return Jw(e,n);throw new Error("Unknown fused activation "+t+".")},UA=N({fusedMatMul_:function(e){var t,n=e.a,r=e.b,o=e.transposeA,i=o!==void 0&&o,a=e.transposeB,s=a!==void 0&&a,u=e.bias,l=e.activation,c=l===void 0?"linear":l,f=e.preluActivationWeights;if(ev(P.state.gradientDepth,c)===!1){var d=Pc(n,r,i,s);return u!=null&&(d=Ae(d,u)),rv(d,c,f)}var h=k(n,"a","fused matMul"),p=k(r,"b","fused matMul");t=ft(h,p),h=t[0],p=t[1];var v=i?h.shape[h.rank-2]:h.shape[h.rank-1],g=s?p.shape[p.rank-1]:p.shape[p.rank-2],m=i?h.shape[h.rank-1]:h.shape[h.rank-2],y=s?p.shape[p.rank-2]:p.shape[p.rank-1],x=h.shape.slice(0,-2),w=p.shape.slice(0,-2),E=le(x),b=le(w);I(h.rank>=2&&p.rank>=2&&h.rank===p.rank,function(){return"Error in fused matMul: inputs must have the same rank of at least 2, got ranks "+h.rank+" and "+p.rank+"."}),I(Ft(x,w),function(){return"Error in fused matMul: outer dimensions ("+x+") and ("+w+") of Tensors with shapes "+h.shape+" and "+p.shape+" must match."}),I(v===g,function(){return"Error in fused matMul: inner shapes ("+v+") and ("+g+") of Tensors with shapes "+h.shape+" and "+p.shape+" and transposeA="+i+" and transposeB="+s+" must match."});var C,_,S=h.shape.slice(0,-2).concat([m,y]),R=i?h.as3D(E,v,m):h.as3D(E,m,v),D=s?p.as3D(b,y,g):p.as3D(b,g,y);u!=null&&Fe(S,(C=ft(C=k(u,"bias","fused matMul"),h)[0]).shape),f!=null&&(_=k(f,"prelu weights","fused matMul"));var T={a:R,b:D};u!=null&&(T.bias=C),f!=null&&(T.preluActivationWeights=_);var z=[R,D];return P.runKernelFunc(function(O,$){var q=O.fusedBatchMatMul({a:R,b:D,transposeA:i,transposeB:s,bias:C,activation:c,preluActivationWeights:_});return $([R,D,q]),q},T,function(O,$){var q=$[0],V=$[1],F=$[2],L=tv(O,F,c),U={};return u!=null&&(U={bias:function(){return nv(C,L)}}),Object.assign(i||s?!i&&s?{a:function(){return L.matMul(V,!1,!1)},b:function(){return L.matMul(q,!0,!1)}}:i&&!s?{a:function(){return V.matMul(L,!1,!0)},b:function(){return q.matMul(L,!1,!1)}}:{a:function(){return V.matMul(L,!0,!0)},b:function(){return L.matMul(q,!0,!0)}}:{a:function(){return L.matMul(V,!1,!0)},b:function(){return q.matMul(L,!0,!1)}},U)},"_FusedMatMul",{transposeA:i,transposeB:s,activation:c},z,[!0]).reshape(S)}}),WA=N({fusedConv2d_:function(e){var t=e.x,n=e.filter,r=e.strides,o=e.pad,i=e.dataFormat,a=i===void 0?"NHWC":i,s=e.dilations,u=s===void 0?[1,1]:s,l=e.dimRoundingMode,c=e.bias,f=e.activation,d=f===void 0?"linear":f,h=e.preluActivationWeights;if(d=d||"linear",ev(P.state.gradientDepth,d)===!1){var p=qn(t,n,r,o,a,u,l);return c!=null&&(p=Ae(p,c)),rv(p,d,h)}var v=k(t,"x","conv2d"),g=k(n,"filter","conv2d"),m=v,y=!1;v.rank===3&&(y=!0,m=v.as4D(1,v.shape[0],v.shape[1],v.shape[2])),I(m.rank===4,function(){return"Error in fused conv2d: input must be rank 4, but got rank "+m.rank+"."}),I(g.rank===4,function(){return"Error in fused conv2d: filter must be rank 4, but got rank "+g.rank+"."}),l!=null&&I(mt(o),function(){return"Error in fused conv2d: pad must be an integer when using, dimRoundingMode "+l+" but got pad "+o+"."}),I(m.shape[3]===g.shape[2],function(){return"Error in conv2d: depth of input ("+m.shape[3]+") must match input depth for filter "+g.shape[2]+"."}),I(gn(r,u),function(){return"Error in conv2D: Either strides or dilations must be 1. Got strides "+r+" and dilations '"+u+"'"}),I(a==="NHWC",function(){return"Error in conv2d: got dataFormat of "+a+" but only NHWC is currently supported."});var x,w,E=gi(m.shape,g.shape,r,u,o,l);c!=null&&(x=ft(x=k(c,"bias","fused conv2d"),v)[0],Fe(E.outShape,x.shape)),h!=null&&(w=k(h,"prelu weights","fused conv2d"));var b={x:m,filter:g};c!=null&&(b.bias=x),h!=null&&(b.preluActivationWeights=w);var C=[g,m],_=P.runKernelFunc(function(S,R){var D=S.fusedConv2d({input:m,filter:g,convInfo:E,bias:x,activation:d,preluActivationWeights:w});return R([g,m,D]),D},b,function(S,R){var D=R,T=D[0],z=D[1],O=D[2],$=tv(S,O,d);I(ba(u),function(){return"Error in gradient of fused conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '"+u+"'"});var q={};return c!=null&&(q={bias:function(){return nv(x,$)}}),Object.assign({x:function(){return Vw(z.shape,$,T,r,o)},filter:function(){return qp(z,$,T.shape,r,o)}},q)},"FusedConv2D",{convInfo:E,activation:d},C,[!0]);return y?_.as3D(_.shape[1],_.shape[2],_.shape[3]):_}}),zA=N({fusedDepthwiseConv2d_:function(e){var t=e.x,n=e.filter,r=e.strides,o=e.pad,i=e.dataFormat,a=i===void 0?"NHWC":i,s=e.dilations,u=s===void 0?[1,1]:s,l=e.dimRoundingMode,c=e.bias,f=e.activation,d=f===void 0?"linear":f,h=e.preluActivationWeights;if(ev(P.state.gradientDepth,d)===!1){var p=Ac(t,n,r,o,a,u,l);return c!=null&&(p=Ae(p,c)),rv(p,d,h)}var v=k(t,"x","depthwiseConv2d"),g=k(n,"filter","depthwiseConv2d"),m=v,y=!1;v.rank===3&&(y=!0,m=v.as4D(1,v.shape[0],v.shape[1],v.shape[2])),I(m.rank===4,function(){return"Error in fused depthwiseConv2d: input must be rank 4, but got rank "+m.rank+"."}),I(g.rank===4,function(){return"Error in fused depthwiseConv2d: filter must be rank 4, but got rank "+g.rank+"."}),I(m.shape[3]===g.shape[2],function(){return"Error in fused depthwiseConv2d: number of input channels ("+m.shape[3]+") must match the inChannels dimension in filter "+g.shape[2]+"."}),u==null&&(u=[1,1]),I(gn(r,u),function(){return"Error in fused depthwiseConv2d: Either strides or dilations must be 1. Got strides "+r+" and dilations '"+u+"'"}),l!=null&&I(mt(o),function(){return"Error in fused depthwiseConv2d: pad must be an integer when using dimRoundingMode "+l+" but got pad "+o+"."});var x,w,E=gi(m.shape,g.shape,r,u,o,l,!0);c!=null&&(x=ft(x=k(c,"bias","fused conv2d"),v)[0],Fe(E.outShape,x.shape)),h!=null&&(w=k(h,"prelu weights","fused depthwiseConv2d"));var b={x:m,filter:g};c!=null&&(b.bias=x),h!=null&&(b.preluActivationWeights=w);var C=[g,m],_=P.runKernelFunc(function(S,R){var D=S.fusedDepthwiseConv2D({input:m,filter:g,convInfo:E,bias:x,activation:d,preluActivationWeights:w});return R([g,m,D]),D},b,function(S,R){I(ba(u),function(){return"Error in gradient of fused depthwiseConv2d: dilation rates greater than 1 are not yet supported. Got dilations '"+u+"'"});var D=R[0],T=R[1],z=R[2],O=tv(S,z,d),$={};return c!=null&&($={bias:function(){return nv(x,O)}}),Object.assign({x:function(){return $w(T.shape,O,D,E)},filter:function(){return Hw(T,O,D.shape,E)}},$)},"FusedDepthwiseConv2D",{convInfo:E,activation:d},C,[!0]);return y?_.as3D(_.shape[1],_.shape[2],_.shape[3]):_}}),jA=Object.freeze({matMul:UA,conv2d:WA,depthwiseConv2d:zA}),VA=Object.freeze({image:Zp,linalg:NA,losses:kA,spectral:dA,fused:jA,signal:gA,square:CT,squaredDifference:kw,conv1d:AN,conv2d:qn,conv3d:PN,depthwiseConv2d:Ac,separableConv2d:Kp,conv2dTranspose:FN,conv3dTranspose:MN,op:N,batchNormalization2d:ZT,batchNormalization3d:eN,batchNormalization4d:tN,batchNormalization:nN,batchNorm:Pw,batchNorm2d:rN,batchNorm3d:oN,batchNorm4d:iN,booleanMaskAsync:NN,complex:Bt,real:Wn,imag:br,concat:St,concat1d:jk,concat2d:Vk,concat3d:$k,concat4d:Hk,split:Fp,matMul:Pc,dot:ON,outerProduct:LN,reverse:Qs,reverse1d:BN,reverse2d:UN,reverse3d:WN,reverse4d:zN,maxPool:Tt,avgPool:Js,pool:jN,maxPool3d:VN,avgPool3d:$N,slice:Ir,slice1d:HN,slice2d:GN,slice3d:Kw,slice4d:qN,abs:_T,acos:ST,acosh:RT,asin:kT,asinh:IT,atan:DT,atanh:TT,ceil:NT,clipByValue:$p,cos:AT,cosh:PT,erf:FT,exp:vh,expm1:MT,floor:OT,log:LT,log1p:BT,logSigmoid:UT,neg:Kl,reciprocal:WT,round:zT,rsqrt:Iw,sigmoid:Dw,sign:jT,isNaN:VT,isInf:$T,isFinite:HT,sin:GT,sinh:qT,softplus:KT,sqrt:XT,step:YT,tan:QT,tanh:JT,all:KN,any:XN,argMax:YN,argMin:QN,logSumExp:JN,max:Fc,mean:ZN,min:eA,moments:tA,sum:Yw,prod:nA,equal:Bw,equalStrict:bN,greater:EN,greaterEqual:Uw,greaterEqualStrict:CN,greaterStrict:_N,less:SN,lessEqual:RN,lessEqualStrict:kN,lessStrict:IN,notEqual:DN,notEqualStrict:TN,add:Ae,addN:uN,addStrict:lN,atan2:cN,div:tr,divNoNan:fN,divStrict:dN,floorDiv:Ow,maximum:Hp,maximumStrict:hN,minimum:Lw,minimumStrict:pN,mod:vN,modStrict:mN,mul:Qt,mulStrict:gN,pow:Xl,powStrict:yN,squaredDifferenceStrict:xN,sub:It,subStrict:wN,elu:Qw,leakyRelu:rA,prelu:Jw,relu:ut,relu6:Zw,selu:oA,logicalAnd:Nc,logicalNot:aN,logicalOr:Fw,logicalXor:sN,where:li,whereAsync:Mw,buffer:Ce,print:eI,batchToSpaceND:Yx,broadcastTo:tI,cast:nI,clone:rI,cumsum:oI,depthToSpace:iI,expandDims:Un,eye:Qx,multinomial:aI,oneHot:fh,pad:mi,pad1d:sI,pad2d:uI,pad3d:lI,pad4d:cI,rand:fI,randomNormal:dI,randomGamma:hI,randomUniform:Jx,reshape:nr,spaceToBatchND:Zx,squeeze:ew,stack:Dn,tile:ra,truncatedNormal:pI,unstack:Rt,setdiff1dAsync:vI,fill:kr,linspace:zk,ones:Da,range:Wl,scalar:ne,tensor:Wt,tensor1d:wt,tensor2d:_o,tensor3d:Pp,tensor4d:un,tensor5d:Bk,tensor6d:Uk,variable:Wk,zeros:et,onesLike:Xx,zerosLike:Le,transpose:Do,softmax:Xr,logSoftmax:EI,localResponseNormalization:iA,norm:eb,gather:Gp,unsortedSegmentSum:Ww,basicLSTMCell:aA,multiRNNCell:sA,movingAverage:uA,stridedSlice:lA,topk:cA,scatterND:fA,fft:Xp,ifft:Yl,rfft:Yp,irfft:tb,sparseToDense:hA,gatherND:pA,diag:vA,dropout:mA,hannWindow:Qp,hammingWindow:rb,frame:Jp,stft:ob,inTopKAsync:yA});function Y(e,t){Array.isArray(e)||(e=[e]),e.forEach(function(n){n!=null&&I(n.dtype!=="complex64",function(){return t+" does not support complex64 tensors."})})}function Vf(e,t,n,r){if(n==="linear")return e.linear(t);if(n==="relu")return e.relu(t);if(n==="elu")return e.elu(t);if(n==="relu6")return e.relu6(t);if(n==="prelu")return e.prelu(t,r);throw new Error("Activation "+n+" has not been implemented for the CPU backend.")}var $A=function(e){function t(){var n=e.call(this)||this;return n.blockSize=48,n.firstUse=!0,n.data=new sw(n,P),n}return lr(t,e),t.prototype.write=function(n,r,o){this.firstUse&&(this.firstUse=!1,G().get("IS_NODE")&&Bl(`
============================
Hi there . Looks like you are running TensorFlow.js in Node.js. To speed things up dramatically, install our node backend, which binds to TensorFlow C++, by running npm i @tensorflow/tfjs-node, or npm i @tensorflow/tfjs-node-gpu if you have CUDA. Then call require('@tensorflow/tfjs-node'); (-gpu suffix for CUDA) at the start of your program. Visit https://github.com/tensorflow/tfjs-node for more details.
============================`));var i={};return this.data.set(i,{values:n,dtype:o}),i},t.prototype.move=function(n,r,o,i){this.data.set(n,{values:r,dtype:i})},t.prototype.numDataIds=function(){return this.data.numDataIds()},t.prototype.read=function(n){return se(this,void 0,void 0,function(){return ue(this,function(r){return[2,this.readSync(n)]})})},t.prototype.readSync=function(n){var r=this.data.get(n),o=r.dtype,i=r.complexTensors;return o==="complex64"?ph(this.readSync(i.real.dataId),this.readSync(i.imag.dataId)):this.data.get(n).values},t.prototype.bufferSync=function(n){var r=this.readSync(n.dataId),o=r;if(n.dtype==="string")try{o=r.map(function(i){return Ml(i)})}catch{throw new Error("Failed to decode encoded string bytes into utf-8")}return Ce(n.shape,n.dtype,o)},t.prototype.makeOutput=function(n,r,o){var i=this.write(n,r,o);return P.makeTensorFromDataId(i,r,o,this)},t.prototype.disposeData=function(n){if(this.data.has(n)){var r=this.data.get(n).complexTensors;r!=null&&(r.real.dispose(),r.imag.dispose()),this.data.delete(n)}},t.prototype.time=function(n){return se(this,void 0,void 0,function(){var r;return ue(this,function(o){return r=yr(),n(),[2,{kernelMs:yr()-r}]})})},t.prototype.memory=function(){return{unreliable:!0,reasons:["The reported memory is an upper bound. Due to automatic garbage collection, the true allocated memory may be less."]}},t.prototype.complex=function(n,r){var o=this.makeOutput(null,n.shape,"complex64");return this.data.get(o.dataId).complexTensors={real:P.keep(n.clone()),imag:P.keep(r.clone())},o},t.prototype.real=function(n){return this.data.get(n.dataId).complexTensors.real.clone()},t.prototype.imag=function(n){return this.data.get(n.dataId).complexTensors.imag.clone()},t.prototype.slice=function(n,r,o){if(Y(n,"slice"),iw(n.shape,r,o)){var i=aw(r,n.strides),a=le(o);return Wt(this.readSync(n.dataId).subarray(i,i+a),o,n.dtype)}for(var s=Ce(o,n.dtype),u=this.bufferSync(n),l=0;l<s.size;++l){var c=s.indexToLoc(l).map(function(f,d){return f+r[d]});s.values[l]=u.get.apply(u,c)}return s.toTensor()},t.prototype.stridedSlice=function(n,r,o,i){Y(n,"stridedSlice");var a=Op(r,o,i);if(a.some(function(h){return h===0}))return Wt([],a);for(var s=Ce(a,n.dtype),u=this.bufferSync(n),l=0;l<s.size;l++){for(var c=s.indexToLoc(l),f=new Array(c.length),d=0;d<f.length;d++)f[d]=c[d]*i[d]+r[d];s.set.apply(s,[u.get.apply(u,f)].concat(c))}return s.toTensor()},t.prototype.diag=function(n){for(var r=this.readSync(n.dataId),o=Ce([n.size,n.size],n.dtype),i=o.values,a=0;a<r.length;a++)i[a*n.size+a]=r[a];return o.toTensor()},t.prototype.unstack=function(n,r){for(var o=n.shape[r],i=new Array(n.rank-1),a=0,s=0;s<n.rank;s++)s!==r&&(i[a++]=n.shape[s]);var u=new Array(n.rank).fill(0),l=n.shape.slice();l[r]=1;var c=new Array(o);for(s=0;s<c.length;s++)u[r]=s,c[s]=this.slice(n,u,l).reshape(i);return c},t.prototype.reverse=function(n,r){Y(n,"reverse");for(var o=Ce(n.shape,n.dtype),i=this.bufferSync(n),a=function(u){var l=o.indexToLoc(u),c=l.slice();r.forEach(function(f){return c[f]=n.shape[f]-1-c[f]}),o.set.apply(o,[i.get.apply(i,c)].concat(l))},s=0;s<o.size;s++)a(s);return o.toTensor()},t.prototype.concat=function(n,r){var o=this;if(n[0].dtype==="complex64"){var i=n.map(function(h){return Wn(h)}),a=n.map(function(h){return br(h)});return Bt(this.concat(i,r),this.concat(a,r))}var s=n.map(function(h){var p=le(h.shape.slice(r));return h.as2D(-1,p)}),u=wa(s.map(function(h){return h.shape}),1),l=Ce(u,n[0].dtype).values;if(s[0].shape[0]===1){var c=0;s.forEach(function(h){l.set(o.readSync(h.dataId),c),c+=h.size})}else{var f=0;s.forEach(function(h){for(var p=o.readSync(h.dataId),v=0,g=0;g<h.shape[0];++g)for(var m=g*u[1]+f,y=0;y<h.shape[1];++y)l[m+y]=p[v++];f+=h.shape[1]})}var d=wa(n.map(function(h){return h.shape}),r);return Wt(l,d,n[0].dtype)},t.prototype.neg=function(n){return Y(n,"neg"),this.multiply(ne(-1),n)},t.prototype.add=function(n,r){return n.dtype==="complex64"||r.dtype==="complex64"?this.broadcastedBinaryComplexOp(n.cast("complex64"),r.cast("complex64"),function(o,i,a,s){return{real:o+a,imag:i+s}}):this.broadcastedBinaryOp(n,r,Ut(n.dtype,r.dtype),function(o,i){return o+i})},t.prototype.addN=function(n){var r=this;Y(n,"addN");for(var o=n.map(function(c){return r.readSync(c.dataId)}),i=Ce(n[0].shape,n[0].dtype),a=i.values,s=0;s<n.length;s++)for(var u=o[s],l=0;l<a.length;l++)a[l]+=u[l];return i.toTensor()},t.prototype.softmax=function(n,r){var o=Dt([r],n.shape),i=this.max(n,o),a=mn(i.shape,o),s=this.subtract(n,i.reshape(a)),u=this.exp(s),l=this.sum(u,o).reshape(a);return this.realDivide(u,l)},t.prototype.subtract=function(n,r){return n.dtype==="complex64"||r.dtype==="complex64"?this.broadcastedBinaryComplexOp(n.cast("complex64"),r.cast("complex64"),function(o,i,a,s){return{real:o-a,imag:i-s}}):this.broadcastedBinaryOp(n,r,Ut(n.dtype,r.dtype),function(o,i){return o-i})},t.prototype.pow=function(n,r){return Y([n,r],"pow"),this.broadcastedBinaryOp(n,r,n.dtype,function(o,i){return Math.pow(o,i)})},t.prototype.batchMatMul=function(n,r,o,i){Y([n,r],"matMul");for(var a=o?n.shape[1]:n.shape[2],s=o?n.shape[2]:n.shape[1],u=i?r.shape[1]:r.shape[2],l=n.shape[0],c=this.readSync(n.dataId),f=this.readSync(r.dataId),d=o?[n.strides[0],1,n.strides[1]]:[n.strides[0],n.strides[1],1],h=d[0],p=d[1],v=d[2],g=i?[1,r.strides[1],r.strides[0]]:[r.strides[1],1,r.strides[0]],m=g[0],y=g[1],x=g[2],w=s*u,E=Ce([l,s,u],n.dtype),b=E.values,C=this.blockSize,_=0;_<l;_++)for(var S=0;S<s;S+=C)for(var R=0;R<u;R+=C)for(var D=0;D<a;D+=C)for(var T=Math.min(S+C,s),z=Math.min(R+C,u),O=Math.min(D+C,a),$=S;$<T;$++)for(var q=R;q<z;q++){for(var V=0,F=D;F<O;F++)V+=c[_*h+$*p+F*v]*f[F*m+q*y+_*x];b[_*w+($*u+q)]+=V}return E.toTensor()},t.prototype.fusedBatchMatMul=function(n){var r=n.a,o=n.b,i=n.transposeA,a=n.transposeB,s=n.bias,u=n.activation,l=n.preluActivationWeights,c=this.batchMatMul(r,o,i,a);return s&&(c=this.add(c,s)),u&&(c=Vf(this,c,u,l)),c},t.prototype.multiply=function(n,r){return n.dtype==="complex64"||r.dtype==="complex64"?this.broadcastedBinaryComplexOp(n.cast("complex64"),r.cast("complex64"),function(o,i,a,s){return{real:o*a-i*s,imag:o*s+i*a}}):this.broadcastedBinaryOp(n,r,Ut(n.dtype,r.dtype),function(o,i){return o*i})},t.prototype.realDivide=function(n,r){return Y([n,r],"realDivide"),this.broadcastedBinaryOp(n,r,"float32",function(o,i){return o/i})},t.prototype.floorDiv=function(n,r){return Y([n,r],"floorDiv"),this.broadcastedBinaryOp(n,r,"int32",function(o,i){return Math.floor(o/i)})},t.prototype.sum=function(n,r){Y(n,"sum"),En("sum",r,n.rank);for(var o=Gt(n.shape,r),i=o[0],a=o[1],s=et(i,Ut(n.dtype,"int32")),u=le(a),l=this.readSync(s.dataId),c=this.readSync(n.dataId),f=0;f<l.length;++f){for(var d=f*u,h=0,p=0;p<u;++p)h+=c[d+p];l[f]=h}return s},t.prototype.prod=function(n,r){Y(n,"sum");for(var o=Gt(n.shape,r),i=o[0],a=o[1],s=et(i,Ut(n.dtype,"int32")),u=le(a),l=this.readSync(s.dataId),c=this.readSync(n.dataId),f=0;f<l.length;++f){for(var d=f*u,h=1,p=0;p<u;++p)h*=c[d+p];l[f]=h}return s},t.prototype.unsortedSegmentSum=function(n,r,o){Y(n,"unsortedSegmentSum");for(var i=[],a=n.rank-r.rank,s=0;s<a;++s)r=r.expandDims(s+1);for(s=0;s<o;++s){var u=ne(s,"int32"),l=Bw(u,r).asType("float32").mul(n).sum(0);i.push(l)}return Dn(i)},t.prototype.argMin=function(n,r){Y(n,"argMin");var o=[r];En("argMin",o,n.rank);for(var i=Gt(n.shape,o),a=i[0],s=i[1],u=et(a,"int32"),l=le(s),c=this.readSync(u.dataId),f=this.readSync(n.dataId),d=0;d<c.length;++d){for(var h=d*l,p=f[h],v=0,g=0;g<l;++g){var m=f[h+g];m<p&&(p=m,v=g)}c[d]=v}return u},t.prototype.argMax=function(n,r){Y(n,"argMax");var o=[r];En("argMax",o,n.rank);for(var i=Gt(n.shape,o),a=i[0],s=i[1],u=et(a,"int32"),l=le(s),c=this.readSync(u.dataId),f=this.readSync(n.dataId),d=0;d<c.length;++d){for(var h=d*l,p=f[h],v=0,g=0;g<l;++g){var m=f[h+g];m>p&&(p=m,v=g)}c[d]=v}return u},t.prototype.cumsum=function(n,r,o,i){if(Y(n,"cumsum"),r!==n.rank-1)throw new Error("backend.cumsum in CPU expects an inner-most axis="+(n.rank-1)+" but got axis="+r);for(var a=Ut(n.dtype,"int32"),s=et(n.shape,a),u=this.readSync(s.dataId),l=this.readSync(n.dataId),c=n.shape[n.rank-1],f=i?function(g,m){return g+c-m-1}:function(g,m){return g+m},d=0;d<l.length;d+=c)for(var h=0;h<c;h++){var p=f(d,h);if(h===0)u[p]=o?0:l[p];else{var v=f(d,h-1);u[p]=o?l[v]+u[v]:l[p]+u[v]}}return s},t.prototype.equal=function(n,r){return Y([n,r],"equal"),this.broadcastedBinaryOp(n,r,"bool",function(o,i){return o===i?1:0})},t.prototype.notEqual=function(n,r){return Y([n,r],"notEqual"),this.broadcastedBinaryOp(n,r,"bool",function(o,i){return o!==i?1:0})},t.prototype.less=function(n,r){return Y([n,r],"less"),this.broadcastedBinaryOp(n,r,"bool",function(o,i){return o<i?1:0})},t.prototype.lessEqual=function(n,r){return Y([n,r],"lessEqual"),this.broadcastedBinaryOp(n,r,"bool",function(o,i){return o<=i?1:0})},t.prototype.greater=function(n,r){return Y([n,r],"greater"),this.broadcastedBinaryOp(n,r,"bool",function(o,i){return o>i?1:0})},t.prototype.greaterEqual=function(n,r){return Y([n,r],"greaterEqual"),this.broadcastedBinaryOp(n,r,"bool",function(o,i){return o>=i?1:0})},t.prototype.logicalNot=function(n){Y(n,"logicalNot");for(var r=this.readSync(n.dataId),o=new Uint8Array(r.length),i=0;i<r.length;++i)o[i]=r[i]?0:1;return this.makeOutput(o,n.shape,"bool")},t.prototype.logicalAnd=function(n,r){return Y([n,r],"logicalAnd"),this.broadcastedBinaryOp(n,r,"bool",function(o,i){return o&&i})},t.prototype.logicalOr=function(n,r){return Y([n,r],"logicalOr"),this.broadcastedBinaryOp(n,r,"bool",function(o,i){return o||i})},t.prototype.select=function(n,r,o){Y([n,r,o],"select");for(var i=this.readSync(n.dataId),a=this.readSync(r.dataId),s=this.readSync(o.dataId),u=et(r.shape,Ut(r.dtype,o.dtype)),l=this.readSync(u.dataId),c=0,f=n.rank===0||n.rank>1||r.rank===1?1:le(r.shape.slice(1)),d=0;d<i.length;d++)for(var h=0;h<f;h++)i[d]===1?l[c++]=a[d]:l[c++]=s[d];return u},t.prototype.where=function(n){Y([n],"where");var r=this.readSync(n.dataId);return Wp(n.shape,r)},t.prototype.topk=function(n,r,o){return Y(n,"topk"),vw(this.readSync(n.dataId),n.shape,n.dtype,r)},t.prototype.min=function(n,r){Y(n,"min"),En("min",r,n.rank);for(var o=Gt(n.shape,r),i=o[0],a=o[1],s=et(i,n.dtype),u=le(a),l=this.readSync(s.dataId),c=this.readSync(n.dataId),f=0;f<l.length;++f){for(var d=f*u,h=c[d],p=0;p<u;++p){var v=c[d+p];v<h&&(h=v)}l[f]=h}return s},t.prototype.minimum=function(n,r){return Y([n,r],"minimum"),this.broadcastedBinaryOp(n,r,n.dtype,function(o,i){return Math.min(o,i)})},t.prototype.mod=function(n,r){return Y([n,r],"mod"),this.broadcastedBinaryOp(n,r,n.dtype,function(o,i){var a=o%i;return o<0&&i<0||o>=0&&i>=0?a:(a+i)%i})},t.prototype.max=function(n,r){Y(n,"max"),En("max",r,n.rank);for(var o=Gt(n.shape,r),i=o[0],a=o[1],s=et(i,n.dtype),u=le(a),l=this.readSync(s.dataId),c=this.readSync(n.dataId),f=0;f<l.length;++f){for(var d=f*u,h=c[d],p=0;p<u;++p){var v=c[d+p];v>h&&(h=v)}l[f]=h}return s},t.prototype.maximum=function(n,r){return Y([n,r],"maximum"),this.broadcastedBinaryOp(n,r,n.dtype,function(o,i){return Math.max(o,i)})},t.prototype.all=function(n,r){Y(n,"all"),En("all",r,n.rank);for(var o=Gt(n.shape,r),i=o[0],a=o[1],s=et(i,n.dtype),u=le(a),l=this.readSync(s.dataId),c=this.readSync(n.dataId),f=0;f<l.length;++f){for(var d=f*u,h=c[d],p=0;p<u;++p){var v=c[d+p];h=h&&v}l[f]=h}return s},t.prototype.any=function(n,r){Y(n,"any"),En("any",r,n.rank);for(var o=Gt(n.shape,r),i=o[0],a=o[1],s=et(i,n.dtype),u=le(a),l=this.readSync(s.dataId),c=this.readSync(n.dataId),f=0;f<l.length;++f){for(var d=f*u,h=c[d],p=0;p<u;++p){var v=c[d+p];h=h||v}l[f]=h}return s},t.prototype.squaredDifference=function(n,r){return Y([n,r],"squaredDifference"),this.broadcastedBinaryOp(n,r,n.dtype,function(o,i){var a=o-i;return a*a})},t.prototype.ceil=function(n){Y(n,"ceil");for(var r=this.readSync(n.dataId),o=new Float32Array(r.length),i=0;i<r.length;++i)o[i]=Math.ceil(r[i]);return this.makeOutput(o,n.shape,"float32")},t.prototype.floor=function(n){Y(n,"floor");for(var r=this.readSync(n.dataId),o=new Float32Array(r.length),i=0;i<r.length;++i)o[i]=Math.floor(r[i]);return this.makeOutput(o,n.shape,"float32")},t.prototype.sign=function(n){Y(n,"x");for(var r=this.readSync(n.dataId),o=new Float32Array(r.length),i=0;i<r.length;++i)r[i]<0?o[i]=-1:r[i]>0?o[i]=1:o[i]=0;return this.makeOutput(o,n.shape,"float32")},t.prototype.isNaN=function(n){Y(n,"x");for(var r=this.readSync(n.dataId),o=new Uint8Array(r.length),i=0;i<r.length;++i)Number.isNaN(r[i])&&(o[i]=1);return this.makeOutput(o,n.shape,"bool")},t.prototype.isInf=function(n){Y(n,"x");for(var r=this.readSync(n.dataId),o=new Uint8Array(r.length),i=0;i<r.length;++i)Math.abs(r[i])===1/0&&(o[i]=1);return this.makeOutput(o,n.shape,"bool")},t.prototype.isFinite=function(n){Y(n,"x");for(var r=this.readSync(n.dataId),o=new Uint8Array(r.length),i=0;i<r.length;++i)Number.isFinite(r[i])&&(o[i]=1);return this.makeOutput(o,n.shape,"bool")},t.prototype.round=function(n){Y(n,"round");for(var r=this.readSync(n.dataId),o=new Float32Array(r.length),i=0;i<r.length;++i){var a=Math.floor(r[i]);r[i]-a<.5?o[i]=Math.floor(r[i]):r[i]-a>.5?o[i]=Math.ceil(r[i]):o[i]=a%2==0?a:a+1}return this.makeOutput(o,n.shape,"float32")},t.prototype.exp=function(n){Y(n,"exp");for(var r=this.readSync(n.dataId),o=new Float32Array(r.length),i=0;i<r.length;++i)o[i]=Math.exp(r[i]);return this.makeOutput(o,n.shape,"float32")},t.prototype.expm1=function(n){Y(n,"expm1");for(var r=this.readSync(n.dataId),o=new Float32Array(r.length),i=0;i<r.length;++i)o[i]=Math.expm1(r[i]);return this.makeOutput(o,n.shape,"float32")},t.prototype.log=function(n){Y(n,"log");for(var r=this.readSync(n.dataId),o=new Float32Array(r.length),i=0;i<r.length;++i){var a=r[i];o[i]=Math.log(a)}return this.makeOutput(o,n.shape,"float32")},t.prototype.log1p=function(n){Y(n,"log1p");for(var r=this.readSync(n.dataId),o=new Float32Array(r.length),i=0;i<r.length;++i){var a=r[i];o[i]=Math.log1p(a)}return this.makeOutput(o,n.shape,"float32")},t.prototype.sqrt=function(n){Y(n,"sqrt");for(var r=this.readSync(n.dataId),o=new Float32Array(r.length),i=0;i<r.length;++i){var a=r[i];o[i]=Math.sqrt(a)}return this.makeOutput(o,n.shape,"float32")},t.prototype.rsqrt=function(n){Y(n,"rsqrt");for(var r=this.readSync(n.dataId),o=new Float32Array(r.length),i=0;i<r.length;++i){var a=r[i];o[i]=1/Math.sqrt(a)}return this.makeOutput(o,n.shape,"float32")},t.prototype.reciprocal=function(n){Y(n,"reciprocal");for(var r=this.readSync(n.dataId),o=new Float32Array(r.length),i=0;i<r.length;++i)o[i]=1/r[i];return this.makeOutput(o,n.shape,"float32")},t.prototype.linear=function(n){return n},t.prototype.relu=function(n){Y(n,"relu");for(var r=et(n.shape,n.dtype),o=this.readSync(r.dataId),i=this.readSync(n.dataId),a=0;a<i.length;++a)o[a]=Math.max(0,i[a]);return r},t.prototype.relu6=function(n){Y(n,"relu");for(var r=et(n.shape,n.dtype),o=this.readSync(r.dataId),i=this.readSync(n.dataId),a=0;a<i.length;++a)o[a]=Math.min(Math.max(0,i[a]),6);return r},t.prototype.prelu=function(n,r){return Y([n,r],"prelu"),this.broadcastedBinaryOp(n,r,n.dtype,function(o,i){return o<0?i*o:o})},t.prototype.elu=function(n){Y(n,"elu");for(var r=new Float32Array(n.size),o=this.readSync(n.dataId),i=0;i<o.length;++i){var a=o[i];r[i]=a>=0?a:Math.exp(a)-1}return this.makeOutput(r,n.shape,"float32")},t.prototype.eluDer=function(n,r){Y([n,r],"eluDer");for(var o=new Float32Array(r.size),i=this.readSync(r.dataId),a=this.readSync(n.dataId),s=0;s<i.length;++s){var u=i[s];o[s]=u>=1?a[s]:a[s]*(u+1)}return this.makeOutput(o,r.shape,"float32")},t.prototype.selu=function(n){Y(n,"selu");for(var r=jp,o=Vp,i=new Float32Array(n.size),a=this.readSync(n.dataId),s=0;s<a.length;++s){var u=a[s];i[s]=u>=0?o*u:r*(Math.exp(u)-1)}return this.makeOutput(i,n.shape,"float32")},t.prototype.clip=function(n,r,o){Y(n,"clip");for(var i=new Float32Array(n.size),a=this.readSync(n.dataId),s=0;s<a.length;++s){var u=a[s];i[s]=u>o?o:u<r?r:u}return this.makeOutput(i,n.shape,"float32")},t.prototype.abs=function(n){for(var r=new Float32Array(n.size),o=this.readSync(n.dataId),i=0;i<o.length;++i)r[i]=Math.abs(o[i]);return this.makeOutput(r,n.shape,"float32")},t.prototype.complexAbs=function(n){for(var r=new Float32Array(n.size),o=this.readSync(n.dataId),i=0;i<n.size;++i){var a=o[2*i],s=o[2*i+1];r[i]=Math.hypot(a,s)}return this.makeOutput(r,n.shape,"float32")},t.prototype.int=function(n){Y(n,"int");for(var r=new Int32Array(n.size),o=this.readSync(n.dataId),i=0;i<o.length;++i)r[i]=o[i];return this.makeOutput(r,n.shape,"int32")},t.prototype.sigmoid=function(n){Y(n,"sigmoid");for(var r=new Float32Array(n.size),o=this.readSync(n.dataId),i=0;i<o.length;++i)r[i]=1/(1+Math.exp(-o[i]));return this.makeOutput(r,n.shape,"float32")},t.prototype.softplus=function(n){Y(n,"softplus");for(var r=Math.log(11920928955078125e-23)+2,o=new Float32Array(n.size),i=this.readSync(n.dataId),a=0;a<i.length;++a){var s=i[a]>-r,u=i[a]<r,l=Math.exp(i[a]),c=void 0;c=u?l:s?i[a]:Math.log(1+l),o[a]=c}return this.makeOutput(o,n.shape,"float32")},t.prototype.sin=function(n){Y(n,"sin");for(var r=new Float32Array(n.size),o=this.readSync(n.dataId),i=0;i<o.length;++i)r[i]=Math.sin(o[i]);return this.makeOutput(r,n.shape,"float32")},t.prototype.cos=function(n){Y(n,"cos");for(var r=new Float32Array(n.size),o=this.readSync(n.dataId),i=0;i<o.length;++i)r[i]=Math.cos(o[i]);return this.makeOutput(r,n.shape,"float32")},t.prototype.tan=function(n){Y(n,"tan");for(var r=new Float32Array(n.size),o=this.readSync(n.dataId),i=0;i<o.length;++i)r[i]=Math.tan(o[i]);return this.makeOutput(r,n.shape,"float32")},t.prototype.asin=function(n){Y(n,"asin");for(var r=new Float32Array(n.size),o=this.readSync(n.dataId),i=0;i<o.length;++i)r[i]=Math.asin(o[i]);return this.makeOutput(r,n.shape,"float32")},t.prototype.acos=function(n){Y(n,"acos");for(var r=new Float32Array(n.size),o=this.readSync(n.dataId),i=0;i<o.length;++i)r[i]=Math.acos(o[i]);return this.makeOutput(r,n.shape,"float32")},t.prototype.atan=function(n){Y(n,"atan");for(var r=new Float32Array(n.size),o=this.readSync(n.dataId),i=0;i<o.length;++i)r[i]=Math.atan(o[i]);return this.makeOutput(r,n.shape,"float32")},t.prototype.atan2=function(n,r){return Y([n,r],"atan2"),this.broadcastedBinaryOp(n,r,n.dtype,function(o,i){return Math.atan2(o,i)})},t.prototype.sinh=function(n){Y(n,"sinh");for(var r=new Float32Array(n.size),o=this.readSync(n.dataId),i=0;i<o.length;++i)r[i]=Math.sinh(o[i]);return this.makeOutput(r,n.shape,"float32")},t.prototype.cosh=function(n){Y(n,"cosh");for(var r=new Float32Array(n.size),o=this.readSync(n.dataId),i=0;i<o.length;++i)r[i]=Math.cosh(o[i]);return this.makeOutput(r,n.shape,"float32")},t.prototype.tanh=function(n){Y(n,"tanh");for(var r=new Float32Array(n.size),o=this.readSync(n.dataId),i=0;i<o.length;++i)r[i]=HR(o[i]);return this.makeOutput(r,n.shape,"float32")},t.prototype.asinh=function(n){Y(n,"asinh");for(var r=new Float32Array(n.size),o=this.readSync(n.dataId),i=0;i<o.length;++i)r[i]=Math.asinh(o[i]);return this.makeOutput(r,n.shape,"float32")},t.prototype.acosh=function(n){Y(n,"acosh");for(var r=new Float32Array(n.size),o=this.readSync(n.dataId),i=0;i<o.length;++i)r[i]=Math.acosh(o[i]);return this.makeOutput(r,n.shape,"float32")},t.prototype.atanh=function(n){Y(n,"atanh");for(var r=new Float32Array(n.size),o=this.readSync(n.dataId),i=0;i<o.length;++i)r[i]=Math.atanh(o[i]);return this.makeOutput(r,n.shape,"float32")},t.prototype.erf=function(n){Y(n,"erf");for(var r=new Float32Array(n.size),o=this.readSync(n.dataId),i=0;i<o.length;++i){var a=Math.sign(o[i]),s=Math.abs(o[i]),u=1/(1+.3275911*s);r[i]=a*(1-((((1.061405429*u-1.453152027)*u+1.421413741)*u-.284496736)*u+.254829592)*u*Math.exp(-s*s))}return this.makeOutput(r,n.shape,"float32")},t.prototype.step=function(n,r){r===void 0&&(r=0),Y(n,"step");for(var o=new Float32Array(n.size),i=this.readSync(n.dataId),a=0;a<i.length;++a){var s=i[a];isNaN(s)?o[a]=NaN:o[a]=s>0?1:r}return this.makeOutput(o,n.shape,"float32")},t.prototype.fusedConv2d=function(n){var r=n.input,o=n.filter,i=n.convInfo,a=n.bias,s=n.activation,u=n.preluActivationWeights,l=this.conv2d(r,o,i);return a&&(l=this.add(l,a)),s&&(l=Vf(this,l,s,u)),l},t.prototype.conv2d=function(n,r,o){Y([n,r],"conv2d");for(var i=o.filterHeight,a=o.filterWidth,s=o.dilationHeight,u=o.dilationWidth,l=o.padInfo.left,c=o.padInfo.top,f=o.dataFormat==="channelsLast",d=Ce(o.outShape,n.dtype),h=n.strides[0],p=f?n.strides[1]:n.strides[2],v=f?n.strides[2]:1,g=f?1:n.strides[1],m=d.strides[0],y=f?d.strides[1]:d.strides[2],x=f?d.strides[2]:1,w=f?1:d.strides[1],E=this.readSync(n.dataId),b=this.readSync(r.dataId),C=d.values,_=0;_<o.batchSize;++_)for(var S=_*h,R=_*m,D=0;D<o.outHeight;++D)for(var T=R+D*y,z=D*o.strideHeight-c,O=0;O<i;O++){var $=z+O*s;if(!($<0||$>=o.inHeight))for(var q=O*r.strides[0],V=S+$*p,F=0;F<o.outWidth;++F)for(var L=T+F*x,U=F*o.strideWidth-l,Q=0;Q<a;Q++){var ee=U+Q*u;if(!(ee<0||ee>=o.inWidth))for(var ae=V+ee*v,he=q+Q*r.strides[1],ye=0;ye<o.inChannels;++ye){for(var ve=E[ae+ye*g],Se=0;Se<o.outChannels;++Se)C[L+Se*w]+=ve*b[he+Se];he+=o.outChannels}}}return d.toTensor()},t.prototype.conv3d=function(n,r,o){for(var i=o.filterDepth,a=o.filterHeight,s=o.filterWidth,u=o.dilationDepth,l=o.dilationHeight,c=o.dilationWidth,f=o.padInfo.front,d=o.padInfo.left,h=o.padInfo.top,p=Ce(o.outShape,n.dtype),v=this.readSync(n.dataId),g=this.readSync(r.dataId),m=p.values,y=0;y<o.batchSize;++y)for(var x=y*n.strides[0],w=y*p.strides[0],E=0;E<o.outDepth;++E)for(var b=w+E*p.strides[1],C=E*o.strideDepth-f,_=0;_<i;_++){var S=C+_*u;if(!(S<0||S>=o.inDepth))for(var R=_*r.strides[0],D=x+S*n.strides[1],T=0;T<o.outHeight;++T)for(var z=b+T*p.strides[2],O=T*o.strideHeight-h,$=0;$<a;$++){var q=O+$*l;if(!(q<0||q>=o.inHeight))for(var V=R+$*r.strides[1],F=D+q*n.strides[2],L=0;L<o.outWidth;++L)for(var U=z+L*o.outChannels,Q=L*o.strideWidth-d,ee=0;ee<s;ee++){var ae=Q+ee*c;if(!(ae<0||ae>=o.inWidth))for(var he=V+ee*r.strides[2],ye=F+ae*o.inChannels,ve=he,Se=0;Se<o.inChannels;++Se){for(var De=v[ye+Se],Oe=0;Oe<o.outChannels;++Oe)m[U+Oe]+=De*g[ve+Oe];ve+=o.outChannels}}}}return p.toTensor()},t.prototype.conv2dDerInput=function(n,r,o){Y([n,r],"conv2dDerInput");for(var i=Ce(o.inShape,"float32"),a=i.values,s=this.readSync(n.dataId),u=this.readSync(r.dataId),l=r.strides,c=l[0],f=l[1],d=l[2],h=o.batchSize,p=o.filterHeight,v=o.filterWidth,g=o.inChannels,m=o.inHeight,y=o.inWidth,x=o.outChannels,w=o.outHeight,E=o.outWidth,b=o.strideHeight,C=o.strideWidth,_=o.dataFormat,S=p-1-o.padInfo.top,R=v-1-o.padInfo.left,D=_==="channelsLast",T=i.strides[0],z=D?i.strides[1]:i.strides[2],O=D?i.strides[2]:1,$=D?1:i.strides[1],q=n.strides[0],V=D?n.strides[1]:n.strides[2],F=D?n.strides[2]:1,L=D?1:n.strides[1],U=0;U<h;++U)for(var Q=0;Q<g;++Q)for(var ee=0;ee<m;++ee)for(var ae=ee-S,he=Math.max(0,Math.ceil(ae/b)),ye=Math.min(w,(p+ae)/b),ve=0;ve<y;++ve){for(var Se=ve-R,De=Math.max(0,Math.ceil(Se/C)),Oe=Math.min(E,(v+Se)/C),ot=0,Pe=he;Pe<ye;++Pe)for(var Ee=Pe*b-ae,Te=De;Te<Oe;++Te)for(var Qe=q*U+V*Pe+F*Te,Je=c*(p-1-Ee)+f*(v-1-(Te*C-Se))+d*Q,Ue=0;Ue<x;++Ue)ot+=s[Qe+L*Ue]*u[Je+Ue];a[T*U+z*ee+O*ve+$*Q]=ot}return i.toTensor()},t.prototype.conv3dDerInput=function(n,r,o){for(var i=Ce(o.inShape,"float32"),a=i.values,s=i.strides,u=s[0],l=s[1],c=s[2],f=s[3],d=this.readSync(n.dataId),h=n.strides,p=h[0],v=h[1],g=h[2],m=h[3],y=this.readSync(r.dataId),x=r.strides,w=x[0],E=x[1],b=x[2],C=x[3],_=o.batchSize,S=o.filterDepth,R=o.filterHeight,D=o.filterWidth,T=o.inChannels,z=o.inDepth,O=o.inHeight,$=o.inWidth,q=o.outChannels,V=o.outDepth,F=o.outHeight,L=o.outWidth,U=o.strideDepth,Q=o.strideHeight,ee=o.strideWidth,ae=S-1-o.padInfo.front,he=R-1-o.padInfo.top,ye=D-1-o.padInfo.left,ve=0;ve<_;++ve)for(var Se=0;Se<T;++Se)for(var De=0;De<z;++De)for(var Oe=De-ae,ot=Math.max(0,Math.ceil(Oe/U)),Pe=Math.min(V,(S+Oe)/U),Ee=0;Ee<O;++Ee)for(var Te=Ee-he,Qe=Math.max(0,Math.ceil(Te/Q)),Je=Math.min(F,(R+Te)/Q),Ue=0;Ue<$;++Ue){for(var Pn=Ue-ye,Fn=Math.max(0,Math.ceil(Pn/ee)),Vt=Math.min(L,(D+Pn)/ee),eo=0,Kn=ot;Kn<Pe;++Kn)for(var fr=Kn*U-Oe,Xn=Qe;Xn<Je;++Xn)for(var Mn=Xn*Q-Te,en=Fn;en<Vt;++en)for(var wi=p*ve+v*Kn+g*Xn+m*en,dr=w*(S-1-fr)+E*(R-1-Mn)+b*(D-1-(en*ee-Pn))+C*Se,bt=0;bt<q;++bt)eo+=d[wi+bt]*y[dr+bt];a[u*ve+l*De+c*Ee+f*Ue+Se]=eo}return i.toTensor()},t.prototype.conv2dDerFilter=function(n,r,o){Y([n,r],"conv2dDerFilter");for(var i=o.strideHeight,a=o.strideWidth,s=o.filterHeight,u=o.filterWidth,l=o.dataFormat==="channelsLast",c=Ce(o.filterShape,"float32"),f=o.padInfo.left,d=o.padInfo.top,h=this.bufferSync(n),p=this.bufferSync(r),v=0;v<s;++v)for(var g=Math.max(0,Math.ceil((d-v)/i)),m=Math.min(o.outHeight,(o.inHeight+d-v)/i),y=0;y<u;++y)for(var x=Math.max(0,Math.ceil((f-y)/a)),w=Math.min(o.outWidth,(o.inWidth+f-y)/a),E=0;E<o.inChannels;++E)for(var b=0;b<o.outChannels;++b){for(var C=0,_=0;_<o.batchSize;++_)for(var S=g;S<m;++S)for(var R=v+S*i-d,D=x;D<w;++D){var T=y+D*a-f;C+=l?h.get(_,R,T,E)*p.get(_,S,D,b):h.get(_,E,R,T)*p.get(_,b,S,D)}c.set(C,v,y,E,b)}return c.toTensor()},t.prototype.conv3dDerFilter=function(n,r,o){for(var i=o.strideDepth,a=o.strideHeight,s=o.strideWidth,u=o.filterDepth,l=o.filterHeight,c=o.filterWidth,f=Ce(o.filterShape,"float32"),d=f.values,h=f.strides,p=h[0],v=h[1],g=h[2],m=h[3],y=this.readSync(r.dataId),x=r.strides,w=x[0],E=x[1],b=x[2],C=x[3],_=this.readSync(n.dataId),S=n.strides,R=S[0],D=S[1],T=S[2],z=S[3],O=o.padInfo.front,$=o.padInfo.left,q=o.padInfo.top,V=0;V<u;++V)for(var F=Math.max(0,Math.ceil((O-V)/i)),L=Math.min(o.outDepth,(o.inDepth+O-V)/i),U=V*p,Q=0;Q<l;++Q)for(var ee=Math.max(0,Math.ceil((q-Q)/a)),ae=Math.min(o.outHeight,(o.inHeight+q-Q)/a),he=Q*v+U,ye=0;ye<c;++ye)for(var ve=Math.max(0,Math.ceil(($-ye)/s)),Se=Math.min(o.outWidth,(o.inWidth+$-ye)/s),De=ye*g+he,Oe=0;Oe<o.inChannels;++Oe)for(var ot=Oe*m+De,Pe=0;Pe<o.outChannels;++Pe){for(var Ee=0,Te=0;Te<o.batchSize;++Te)for(var Qe=Te*R,Je=Te*w,Ue=F;Ue<L;++Ue)for(var Pn=(V+Ue*i-O)*D+Qe,Fn=Ue*E+Je,Vt=ee;Vt<ae;++Vt)for(var eo=(Q+Vt*a-q)*T+Pn,Kn=Vt*b+Fn,fr=ve;fr<Se;++fr){var Xn=fr*C+Kn;Ee+=_[(ye+fr*s-$)*z+eo+Oe]*y[Xn+Pe]}d[ot+Pe]=Ee}return f.toTensor()},t.prototype.fusedDepthwiseConv2D=function(n){var r=n.input,o=n.filter,i=n.convInfo,a=n.bias,s=n.activation,u=n.preluActivationWeights,l=this.depthwiseConv2D(r,o,i);return a&&(l=this.add(l,a)),s&&(l=Vf(this,l,s,u)),l},t.prototype.depthwiseConv2D=function(n,r,o){Y([n,r],"depthwiseConv2D");for(var i=o.filterHeight,a=o.filterWidth,s=o.dilationHeight,u=o.dilationWidth,l=o.padInfo.left,c=o.padInfo.top,f=o.outChannels/o.inChannels,d=Ce(o.outShape,n.dtype),h=this.readSync(n.dataId),p=this.readSync(r.dataId),v=d.values,g=0;g<o.batchSize;++g)for(var m=g*n.strides[0],y=g*d.strides[0],x=0;x<o.outHeight;++x)for(var w=y+x*d.strides[1],E=x*o.strideHeight-l,b=0;b<i;++b){var C=E+b*s;if(!(C<0||C>=o.inHeight))for(var _=b*r.strides[0],S=m+C*n.strides[1],R=0;R<o.outWidth;++R)for(var D=w+R*d.strides[2],T=R*o.strideWidth-c,z=0;z<a;++z){var O=T+z*u;if(!(O<0||O>=o.inWidth))for(var $=_+z*r.strides[1],q=S+O*o.inChannels,V=D,F=$,L=0;L<o.inChannels;++L){for(var U=h[q+L],Q=0;Q<f;++Q)v[V+Q]+=U*p[F+Q];V+=f,F+=f}}}return d.toTensor()},t.prototype.depthwiseConv2DDerInput=function(n,r,o){Y([n,r],"depthwiseConv2DDerInput");for(var i=Ce(o.inShape,"float32"),a=i.values,s=i.strides,u=s[0],l=s[1],c=s[2],f=this.readSync(n.dataId),d=n.strides,h=d[0],p=d[1],v=d[2],g=this.readSync(r.dataId),m=r.strides,y=m[0],x=m[1],w=m[2],E=o.batchSize,b=o.filterHeight,C=o.filterWidth,_=o.inChannels,S=o.inHeight,R=o.inWidth,D=o.outChannels,T=o.outHeight,z=o.outWidth,O=o.strideHeight,$=o.strideWidth,q=b-1-o.padInfo.top,V=C-1-o.padInfo.left,F=D/_,L=0;L<E;++L)for(var U=0;U<_;++U)for(var Q=0;Q<S;++Q)for(var ee=Q-q,ae=Math.max(0,Math.ceil(ee/O)),he=Math.min(T,(b+ee)/O),ye=0;ye<R;++ye){for(var ve=ye-V,Se=Math.max(0,Math.ceil(ve/$)),De=Math.min(z,(C+ve)/$),Oe=0,ot=ae;ot<he;++ot)for(var Pe=ot*O-ee,Ee=Se;Ee<De;++Ee)for(var Te=h*L+p*ot+v*Ee,Qe=y*(b-1-Pe)+x*(C-1-(Ee*$-ve))+w*U,Je=0;Je<F;++Je)Oe+=f[Te+(U*F+Je)]*g[Qe+Je];a[u*L+l*Q+c*ye+U]=Oe}return i.toTensor()},t.prototype.depthwiseConv2DDerFilter=function(n,r,o){Y([n,r],"depthwiseConv2DDerFilter");for(var i=o.strideHeight,a=o.strideWidth,s=o.filterHeight,u=o.filterWidth,l=Ce(o.filterShape,"float32"),c=o.padInfo.left,f=o.padInfo.top,d=o.outChannels/o.inChannels,h=this.bufferSync(n),p=this.bufferSync(r),v=0;v<s;++v)for(var g=Math.max(0,Math.ceil((f-v)/i)),m=Math.min(o.outHeight,(o.inHeight+f-v)/i),y=0;y<u;++y)for(var x=Math.max(0,Math.ceil((c-y)/a)),w=Math.min(o.outWidth,(o.inWidth+c-y)/a),E=0;E<o.outChannels;++E){for(var b=Math.trunc(E/d),C=E%d,_=0,S=0;S<o.batchSize;++S)for(var R=g;R<m;++R)for(var D=v+R*i-f,T=x;T<w;++T){var z=y+T*a-c;_+=h.get(S,D,z,b)*p.get(S,R,T,E)}l.set(_,v,y,b,C)}return l.toTensor()},t.prototype.tile=function(n,r){return Y(n,"tile"),pw(this.bufferSync(n),r)},t.prototype.pad=function(n,r,o){Y(n,"pad");var i=r.map(function(d,h){return d[0]+n.shape[h]+d[1]}),a=r.map(function(d){return d[0]}),s=this.bufferSync(n),u=Ce(i,n.dtype);o!==0&&u.values.fill(o);for(var l=0;l<n.size;l++){var c=s.indexToLoc(l),f=c.map(function(d,h){return d+a[h]});u.set.apply(u,[s.get.apply(s,c)].concat(f))}return u.toTensor()},t.prototype.transpose=function(n,r){Y(n,"transpose");for(var o=new Array(n.rank),i=0;i<o.length;i++)o[i]=n.shape[r[i]];var a=this.readSync(n.dataId),s=Ce(o,n.dtype),u=this.bufferSync(n);for(i=0;i<n.size;++i){for(var l=u.indexToLoc(i),c=new Array(l.length),f=0;f<c.length;f++)c[f]=l[r[f]];var d=s.locToIndex(c);s.values[d]=a[i]}return s.toTensor()},t.prototype.gather=function(n,r,o){Y([n,r],"gather");var i=n.shape.slice(),a=this.readSync(r.dataId);i[o]=a.length;for(var s=Ce(i,n.dtype),u=this.bufferSync(n),l=0;l<s.size;++l){var c=s.indexToLoc(l),f=c.slice();f[o]=a[c[o]];var d=u.locToIndex(f);s.values[l]=u.values[d]}return s.toTensor()},t.prototype.batchToSpaceND=function(n,r,o){Y([n],"batchToSpaceND");var i=r.reduce(function(f,d){return f*d}),a=zl(n.shape,r,i),s=jl(a.length,r.length),u=Vl(n.shape,r,i),l=tw(o,r.length),c=nw(u,o,r.length);return n.reshape(a).transpose(s).reshape(u).slice(l,c)},t.prototype.spaceToBatchND=function(n,r,o){Y([n],"spaceToBatchND");var i=r.reduce(function(d,h){return d*h}),a=[[0,0]];a.push.apply(a,o);for(var s=1+r.length;s<n.shape.length;++s)a.push([0,0]);var u=n.pad(a),l=zl(u.shape,r,i,!1),c=jl(l.length,r.length,!1),f=Vl(u.shape,r,i,!1);return u.reshape(l).transpose(c).reshape(f)},t.prototype.pool=function(n,r,o){Y(n,"pool");for(var i=r.strideHeight,a=r.strideWidth,s=r.dilationHeight,u=r.dilationWidth,l=r.effectiveFilterHeight,c=r.effectiveFilterWidth,f=r.padInfo.top,d=r.padInfo.left,h=o==="max"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,p=this.readSync(n.dataId),v=Ce(r.outShape,n.dtype),g=v.values,m=r.outShape[1]*r.outShape[2]*r.outShape[3],y=r.outShape[2]*r.outShape[3],x=r.outShape[3],w=0;w<r.batchSize;++w)for(var E=w*m,b=w*n.strides[0],C=0;C<r.inChannels;++C)for(var _=0;_<r.outHeight;++_)for(var S=_*i-f,R=Math.max(0,S),D=Math.min(r.inHeight,l+S),T=E+_*y,z=0;z<r.outWidth;++z){for(var O=z*a-d,$=Math.max(0,O),q=Math.min(r.inWidth,c+O),V=h,F=0,L=0,U=R;U<D;U+=s){for(var Q=b+U*n.strides[1],ee=$;ee<q;ee+=u){var ae=p[Q+ee*n.strides[2]+C];o==="max"&&ae>V?V=ae:o==="avg"&&(F+=ae,L++)}if(isNaN(V))break}g[T+z*x+C]=o==="avg"?F/L:V}return v.toTensor()},t.prototype.maxPool=function(n,r){return this.pool(n,r,"max")},t.prototype.maxPoolPositions=function(n,r){for(var o=Ce(r.outShape,"int32"),i=r.strideHeight,a=r.strideWidth,s=r.dilationHeight,u=r.dilationWidth,l=r.effectiveFilterHeight,c=r.effectiveFilterWidth,f=r.padInfo.top,d=r.padInfo.left,h=this.bufferSync(n),p=0;p<r.batchSize;++p)for(var v=0;v<r.inChannels;++v)for(var g=0;g<r.outHeight;++g){for(var m=g*i-f,y=m;y<0;)y+=s;for(var x=Math.min(r.inHeight,l+m),w=0;w<r.outWidth;++w){for(var E=w*a-d,b=E;b<0;)b+=u;for(var C=Math.min(r.inWidth,c+E),_=Number.NEGATIVE_INFINITY,S=-1,R=y;R<x;R+=s)for(var D=R-m,T=b;T<C;T+=u){var z=T-E,O=h.get(p,R,T,v);O>_&&(_=O,S=D*c+z)}o.set(S,p,g,w,v)}}return o.toTensor()},t.prototype.maxPoolBackprop=function(n,r,o,i){Y([r,o],"maxPoolBackprop");for(var a=this.maxPoolPositions(r,i),s=i.strideHeight,u=i.strideWidth,l=i.dilationHeight,c=i.dilationWidth,f=i.effectiveFilterHeight,d=i.effectiveFilterWidth,h=d-1-i.padInfo.left,p=f-1-i.padInfo.top,v=Ce(r.shape,"float32"),g=this.bufferSync(a),m=this.bufferSync(n),y=0;y<i.batchSize;++y)for(var x=0;x<i.inChannels;++x)for(var w=0;w<i.inHeight;++w)for(var E=0;E<i.inWidth;++E){for(var b=w-p,C=E-h,_=0,S=0;S<f;S+=l){var R=(b+S)/s;if(!(R<0||R>=i.outHeight||Math.floor(R)!==R))for(var D=0;D<d;D+=c){var T=(C+D)/u;if(!(T<0||T>=i.outWidth||Math.floor(T)!==T)){var z=f*d-1-g.get(y,R,T,x)===S*d+D?1:0;z!==0&&(_+=m.get(y,R,T,x)*z)}}}v.set(_,y,w,E,x)}return v.toTensor()},t.prototype.avgPoolBackprop=function(n,r,o){Y([n,r],"avgPoolBackprop");for(var i=o.strideHeight,a=o.strideWidth,s=o.filterHeight,u=o.filterWidth,l=o.dilationHeight,c=o.dilationWidth,f=o.effectiveFilterHeight,d=o.effectiveFilterWidth,h=d-1-o.padInfo.left,p=f-1-o.padInfo.top,v=Ce(r.shape,"float32"),g=1/(s*u),m=this.bufferSync(n),y=0;y<o.batchSize;++y)for(var x=0;x<o.inChannels;++x)for(var w=0;w<o.inHeight;++w)for(var E=0;E<o.inWidth;++E){for(var b=w-p,C=E-h,_=0,S=0;S<f;S+=l){var R=(b+S)/i;if(!(R<0||R>=o.outHeight||Math.floor(R)!==R))for(var D=0;D<d;D+=c){var T=(C+D)/a;T<0||T>=o.outWidth||Math.floor(T)!==T||(_+=m.get(y,R,T,x))}}v.set(_*g,y,w,E,x)}return v.toTensor()},t.prototype.pool3d=function(n,r,o){Y(n,"pool3d");for(var i=r.strideDepth,a=r.strideHeight,s=r.strideWidth,u=r.dilationDepth,l=r.dilationHeight,c=r.dilationWidth,f=r.effectiveFilterDepth,d=r.effectiveFilterHeight,h=r.effectiveFilterWidth,p=r.padInfo.front,v=r.padInfo.top,g=r.padInfo.left,m=o==="max"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,y=this.readSync(n.dataId),x=Ce(r.outShape,n.dtype),w=x.values,E=r.outShape[1]*r.outShape[2]*r.outShape[3]*r.outShape[4],b=r.outShape[2]*r.outShape[3]*r.outShape[4],C=r.outShape[3]*r.outShape[4],_=r.outShape[4],S=0;S<r.batchSize;++S)for(var R=S*E,D=S*n.strides[0],T=0;T<r.inChannels;++T)for(var z=0;z<r.outDepth;++z){for(var O=z*i-p,$=O;$<0;)$+=u;for(var q=Math.min(r.inDepth,f+O),V=R+z*b,F=0;F<r.outHeight;++F){for(var L=F*a-v,U=L;U<0;)U+=l;for(var Q=Math.min(r.inHeight,d+L),ee=V+F*C,ae=0;ae<r.outWidth;++ae){for(var he=ae*s-g,ye=he;ye<0;)ye+=c;for(var ve=Math.min(r.inWidth,h+he),Se=ee+ae*_,De=m,Oe=0,ot=0,Pe=$;Pe<q;Pe+=u){for(var Ee=D+Pe*n.strides[1],Te=U;Te<Q;Te+=l){for(var Qe=Ee+Te*n.strides[2],Je=ye;Je<ve;Je+=c){var Ue=y[Qe+Je*n.strides[3]+T];if(o==="max"&&Ue>De?De=Ue:o==="avg"&&(Oe+=Ue,ot++),isNaN(De))break}if(isNaN(De))break}if(isNaN(De))break}w[Se+T]=o==="avg"?Oe/ot:De}}}return x.toTensor()},t.prototype.avgPool3d=function(n,r){return Y(n,"avgPool3d"),this.pool3d(n,r,"avg").toFloat()},t.prototype.avgPool3dBackprop=function(n,r,o){Y([n,r],"avgPool3dBackprop");for(var i=o.strideDepth,a=o.strideHeight,s=o.strideWidth,u=o.filterDepth,l=o.filterHeight,c=o.filterWidth,f=o.dilationDepth,d=o.dilationHeight,h=o.dilationWidth,p=o.effectiveFilterDepth,v=o.effectiveFilterHeight,g=o.effectiveFilterWidth,m=p-1-o.padInfo.front,y=g-1-o.padInfo.left,x=v-1-o.padInfo.top,w=Ce(r.shape,"float32"),E=1/(u*l*c),b=this.bufferSync(n),C=0;C<o.batchSize;++C)for(var _=0;_<o.inChannels;++_)for(var S=0;S<o.inDepth;++S)for(var R=0;R<o.inHeight;++R)for(var D=0;D<o.inWidth;++D){for(var T=S-m,z=R-x,O=D-y,$=0,q=0;q<p;q+=f){var V=(T+q)/i;if(!(V<0||V>=o.outDepth||Math.floor(V)!==V))for(var F=0;F<v;F+=d){var L=(z+F)/a;if(!(L<0||L>=o.outHeight||Math.floor(L)!==L))for(var U=0;U<g;U+=h){var Q=(O+U)/s;Q<0||Q>=o.outWidth||Math.floor(Q)!==Q||($+=b.get(C,V,L,Q,_))}}}w.set($*E,C,S,R,D,_)}return w.toTensor()},t.prototype.maxPool3d=function(n,r){return Y(n,"maxPool3d"),this.pool3d(n,r,"max").toFloat()},t.prototype.maxPool3dPositions=function(n,r){for(var o=Ce(r.outShape,"int32"),i=r.strideDepth,a=r.strideHeight,s=r.strideWidth,u=r.dilationDepth,l=r.dilationHeight,c=r.dilationWidth,f=r.effectiveFilterDepth,d=r.effectiveFilterHeight,h=r.effectiveFilterWidth,p=r.padInfo.front,v=r.padInfo.top,g=r.padInfo.left,m=this.bufferSync(n),y=0;y<r.batchSize;++y)for(var x=0;x<r.inChannels;++x)for(var w=0;w<r.outDepth;++w){for(var E=w*i-p,b=E;b<0;)b+=u;for(var C=Math.min(r.inDepth,f+E),_=0;_<r.outHeight;++_){for(var S=_*a-v,R=S;R<0;)R+=l;for(var D=Math.min(r.inHeight,d+S),T=0;T<r.outWidth;++T){for(var z=T*s-g,O=z;O<0;)O+=c;for(var $=Math.min(r.inWidth,h+z),q=Number.NEGATIVE_INFINITY,V=-1,F=b;F<C;F+=u)for(var L=F-E,U=R;U<D;U+=l)for(var Q=U-S,ee=O;ee<$;ee+=c){var ae=ee-z,he=m.get(y,F,U,ee,x);he>=q&&(q=he,V=L*d*h+Q*d+ae)}o.set(V,y,w,_,T,x)}}}return o.toTensor()},t.prototype.maxPool3dBackprop=function(n,r,o,i){Y([r,o],"maxPool3dBackprop");for(var a=this.maxPool3dPositions(r,i),s=i.strideDepth,u=i.strideHeight,l=i.strideWidth,c=i.dilationDepth,f=i.dilationHeight,d=i.dilationWidth,h=i.effectiveFilterDepth,p=i.effectiveFilterHeight,v=i.effectiveFilterWidth,g=h-1-i.padInfo.front,m=v-1-i.padInfo.left,y=p-1-i.padInfo.top,x=Ce(r.shape,"float32"),w=this.bufferSync(a),E=this.bufferSync(n),b=0;b<i.batchSize;++b)for(var C=0;C<i.inChannels;++C)for(var _=0;_<i.inDepth;++_)for(var S=0;S<i.inHeight;++S)for(var R=0;R<i.inWidth;++R){for(var D=_-g,T=S-y,z=R-m,O=0,$=0;$<h;$+=c){var q=(D+$)/s;if(!(q<0||q>=i.outDepth||Math.floor(q)!==q))for(var V=0;V<p;V+=f){var F=(T+V)/u;if(!(F<0||F>=i.outHeight||Math.floor(F)!==F))for(var L=0;L<v;L+=d){var U=(z+L)/l;if(!(U<0||U>=i.outWidth||Math.floor(U)!==U)){var Q=h*p*v-1-w.get(b,q,F,U,C)===$*p*v+V*v+L?1:0;Q!==0&&(O+=E.get(b,q,F,U,C)*Q)}}}}x.set(O,b,_,S,R,C)}return x.toTensor()},t.prototype.cast=function(n,r){return cw(n,r,this)},t.prototype.reshape=function(n,r){return hh(n,r)},t.prototype.avgPool=function(n,r){return Y(n,"avgPool"),this.pool(n,r,"avg").toFloat()},t.prototype.resizeBilinear=function(n,r,o,i){Y(n,"resizeBilinear");for(var a=n.shape,s=a[0],u=a[1],l=a[2],c=a[3],f=this.readSync(n.dataId),d=new Float32Array(le([s,r,o,c])),h=[i&&r>1?u-1:u,i&&o>1?l-1:l],p=[i&&r>1?r-1:r,i&&o>1?o-1:o],v=0,g=h[0]/p[0],m=h[1]/p[1],y=0;y<s;y++)for(var x=0;x<r;x++)for(var w=g*x,E=Math.floor(w),b=w-E,C=Math.min(u-1,Math.ceil(w)),_=y*n.strides[0]+E*n.strides[1],S=y*n.strides[0]+C*n.strides[1],R=0;R<o;R++)for(var D=m*R,T=Math.floor(D),z=D-T,O=Math.min(l-1,Math.ceil(D)),$=_+T*n.strides[2],q=S+T*n.strides[2],V=_+O*n.strides[2],F=S+O*n.strides[2],L=0;L<c;L++){var U=f[$+L],Q=f[q+L],ee=U+(f[V+L]-U)*z,ae=ee+(Q+(f[F+L]-Q)*z-ee)*b;d[v++]=ae}return Wt(d,[s,r,o,c])},t.prototype.resizeBilinearBackprop=function(n,r,o){Y([n,r],"resizeBilinearBackprop");for(var i=r.shape,a=i[0],s=i[1],u=i[2],l=i[3],c=n.shape,f=c[1],d=c[2],h=new Float32Array(a*s*u*l),p=[o&&f>1?s-1:s,o&&d>1?u-1:u],v=[o&&f>1?f-1:f,o&&d>1?d-1:d],g=p[0]/v[0],m=p[1]/v[1],y=this.readSync(n.dataId),x=0,w=0;w<a;w++)for(var E=w*r.strides[0],b=0;b<f;b++)for(var C=b*g,_=Math.floor(C),S=Math.min(Math.ceil(C),s-1),R=E+_*r.strides[1],D=E+S*r.strides[1],T=C-_,z=1-T,O=0;O<d;O++)for(var $=O*m,q=Math.floor($),V=Math.min(Math.ceil($),u-1),F=$-q,L=1-F,U=R+q*r.strides[2],Q=R+V*r.strides[2],ee=D+q*r.strides[2],ae=D+V*r.strides[2],he=z*L,ye=z*F,ve=T*L,Se=T*F,De=0;De<l;De++){var Oe=y[x++];h[U+De]+=Oe*he,h[Q+De]+=Oe*ye,h[ee+De]+=Oe*ve,h[ae+De]+=Oe*Se}return un(h,[a,u,s,l],r.dtype)},t.prototype.resizeNearestNeighbor=function(n,r,o,i){Y(n,"resizeNearestNeighbor");for(var a=n.shape,s=a[0],u=a[1],l=a[2],c=a[3],f=this.readSync(n.dataId),d=new Float32Array(s*r*o*c),h=[i&&r>1?u-1:u,i&&o>1?l-1:l],p=[i&&r>1?r-1:r,i&&o>1?o-1:o],v=h[0]/p[0],g=h[1]/p[1],m=0,y=0;y<s;y++)for(var x=y*n.strides[0],w=0;w<r;w++)for(var E=v*w,b=x+Math.min(u-1,i?Math.round(E):Math.floor(E))*n.strides[1],C=0;C<o;C++)for(var _=g*C,S=b+Math.min(l-1,i?Math.round(_):Math.floor(_))*n.strides[2],R=0;R<c;R++){var D=f[S+R];d[m++]=D}return Wt(d,[s,r,o,c],n.dtype)},t.prototype.resizeNearestNeighborBackprop=function(n,r,o){Y([n,r],"resizeNearestNeighborBackprop");for(var i=r.shape,a=i[0],s=i[1],u=i[2],l=i[3],c=n.shape,f=c[1],d=c[2],h=new Float32Array(a*s*u*l),p=this.readSync(n.dataId),v=[o&&f>1?s-1:s,o&&d>1?u-1:u],g=[o&&f>1?f-1:f,o&&d>1?d-1:d],m=v[0]/g[0],y=v[1]/g[1],x=1/m,w=1/y,E=2*Math.ceil(x)+2,b=2*Math.ceil(w)+2,C=0;C<a;C++)for(var _=C*r.strides[0],S=0;S<s;S++)for(var R=_+S*r.strides[1],D=Math.floor(S*x),T=Math.floor(D-E/2),z=0;z<u;z++)for(var O=R+z*r.strides[2],$=Math.floor(z*w),q=Math.floor($-b/2),V=0;V<l;V++){for(var F=0,L=0;L<E;L++){var U=L+T;if(!(U<0||U>=f)){var Q=_+U*n.strides[1],ee=U*m;if(S===Math.min(s-1,o?Math.round(ee):Math.floor(ee)))for(var ae=0;ae<b;ae++){var he=ae+q;if(!(he<0||he>=d)){var ye=Q+he*n.strides[2],ve=he*y;z===Math.min(u-1,o?Math.round(ve):Math.floor(ve))&&(F+=p[ye+V])}}}}h[O+V]=F}return un(h,r.shape,r.dtype)},t.prototype.batchNormalization=function(n,r,o,i,a,s){Y([n,r,o,a,s],"batchNorm");for(var u=this.readSync(n.dataId),l=this.readSync(r.dataId),c=this.readSync(o.dataId),f=a?this.readSync(a.dataId):new Float32Array([1]),d=s?this.readSync(s.dataId):new Float32Array([0]),h=new Float32Array(u.length),p=d.length,v=f.length,g=c.length,m=l.length,y=0,x=0,w=0,E=0,b=0;b<u.length;++b)h[b]=d[y++]+(u[b]-l[x++])*f[w++]/Math.sqrt(c[E++]+i),y>=p&&(y=0),x>=m&&(x=0),w>=v&&(w=0),E>=g&&(E=0);return un(h,n.shape)},t.prototype.localResponseNormalization4D=function(n,r,o,i,a){Y(n,"localResponseNormalization4D");var s=n.shape[3],u=s-1,l=this.readSync(n.dataId),c=n.size,f=new Float32Array(c);function d(g){for(var m=g%s,y=g-m+Math.max(0,m-r),x=g-m+Math.min(m+r,u),w=0;y<=x;y++){var E=l[y];w+=E*E}return w}for(var h=0;h<c;h++){var p=d(h),v=l[h]*Math.pow(o+i*p,-a);f[h]=v}return un(f,n.shape)},t.prototype.LRNGrad=function(n,r,o,i,a,s,u){Y(n,"LRNGrad");for(var l=n.shape[3],c=this.readSync(n.dataId),f=this.readSync(r.dataId),d=this.readSync(o.dataId),h=new Float32Array(n.size),p=n.size,v=0;v<p;v++){for(var g=v%l,m=v-g+Math.max(0,g-i),y=v-g+Math.min(l,g+i+1),x=0,w=m;w<y;w++)x+=Math.pow(f[w],2);for(x=s*x+a,w=m;w<y;w++){var E=-2*s*u*f[w]*d[v]/x;v===w&&(E+=Math.pow(x,-u)),E*=c[v],h[w]+=E}}return un(h,n.shape)},t.prototype.multinomial=function(n,r,o,i){Y(n,"multinomial");for(var a=r?n:Xr(n),s=a.shape[0],u=a.shape[1],l=et([s,o],"int32"),c=this.readSync(l.dataId),f=this.readSync(a.dataId),d=0;d<s;++d){var h=d*u,p=new Float32Array(u-1);p[0]=f[h];for(var v=1;v<p.length;++v)p[v]=p[v-1]+f[h+v];for(var g=Ic(i.toString()),m=d*o,y=0;y<o;++y){var x=g();c[m+y]=p.length;for(var w=0;w<p.length;w++)if(x<p[w]){c[m+y]=w;break}}}return l},t.prototype.oneHot=function(n,r,o,i){Y(n,"oneHot");var a=new Float32Array(n.size*r);a.fill(i);for(var s=this.readSync(n.dataId),u=0;u<n.size;++u)s[u]>=0&&s[u]<r&&(a[u*r+s[u]]=o);return _o(a,[n.size,r],"int32")},t.prototype.nonMaxSuppression=function(n,r,o,i,a){return Y(n,"nonMaxSuppression"),Bp(this.readSync(n.dataId),this.readSync(r.dataId),o,i,a)},t.prototype.fft=function(n){return this.fftBatch(n,!1)},t.prototype.ifft=function(n){return this.fftBatch(n,!0)},t.prototype.fftBatch=function(n,r){for(var o=n.shape[0],i=n.shape[1],a=Ce(n.shape,"float32"),s=Ce(n.shape,"float32"),u=Wn(n).as2D(o,i),l=br(n).as2D(o,i),c=0;c<o;c++)for(var f=u.slice([c,0],[1,i]),d=l.slice([c,0],[1,i]),h=Bt(f,d),p=this.readSync(this.fftImpl(h,r).dataId),v=0;v<i;v++){var g=Vg(p,v);a.values[c*i+v]=g.real,s.values[c*i+v]=g.imag}return Bt(a.toTensor(),s.toTensor()).as2D(o,i)},t.prototype.fftImpl=function(n,r){var o=n.as1D(),i=o.size;if(this.isExponentOf2(i)){var a=this.fftRadix2(o,i,r).as2D(n.shape[0],n.shape[1]);return r&&(a=Bt(Wn(a).div(ne(i)),br(a).div(ne(i)))),a}var s=this.readSync(n.dataId),u=function(l){for(var c=new Float32Array(l.length/2),f=new Float32Array(l.length/2),d=0;d<l.length;d+=2)c[d/2]=l[d],f[d/2]=l[d+1];return{real:c,imag:f}}(this.fourierTransformByMatmul(s,i,r));return Bt(u.real,u.imag).as2D(n.shape[0],n.shape[1])},t.prototype.isExponentOf2=function(n){return(n&n-1)==0},t.prototype.fftRadix2=function(n,r,o){if(r===1)return n;var i=this.readSync(n.dataId),a=r/2,s=function(m){for(var y=Math.ceil(m.length/4),x=new Float32Array(y),w=new Float32Array(y),E=0;E<m.length;E+=4)x[Math.floor(E/4)]=m[E],w[Math.floor(E/4)]=m[E+1];return{real:x,imag:w}}(i),u=Bt(s.real,s.imag).as1D(),l=function(m){for(var y=Math.floor(m.length/4),x=new Float32Array(y),w=new Float32Array(y),E=2;E<m.length;E+=4)x[Math.floor(E/4)]=m[E],w[Math.floor(E/4)]=m[E+1];return{real:x,imag:w}}(i),c=Bt(l.real,l.imag).as1D();u=this.fftRadix2(u,a,o),c=this.fftRadix2(c,a,o);var f=function(m,y){for(var x=new Float32Array(m/2),w=new Float32Array(m/2),E=0;E<Math.ceil(m/2);E++){var b=(y?2:-2)*Math.PI*(E/m);x[E]=Math.cos(b),w[E]=Math.sin(b)}return{real:x,imag:w}}(r,o),d=Bt(f.real,f.imag).mul(c),h=u.add(d),p=u.sub(d),v=Wn(h).concat(Wn(p)),g=br(h).concat(br(p));return Bt(v,g).as1D()},t.prototype.fourierTransformByMatmul=function(n,r,o){for(var i=new Float32Array(2*r),a=0;a<r;a++){for(var s=0,u=0,l=0;l<r;l++){var c=_I(a*l,r,o),f=Vg(n,l);s+=f.real*c.real-f.imag*c.imag,u+=f.real*c.imag+f.imag*c.real}o&&(s/=r,u/=r),CI(i,s,u,a)}return i},t.prototype.depthToSpace=function(n,r,o){I(o==="NHWC",function(){return"Only NHWC dataFormat supported on CPU for depthToSpace. Got "+o}),I(r>1,function(){return"blockSize should be > 1 for depthToSpace, but was: "+r});for(var i=n.shape[0],a=n.shape[1],s=n.shape[2],u=n.shape[3],l=a*r,c=s*r,f=u/(r*r),d=this.readSync(n.dataId),h=new Float32Array(i*l*c*f),p=0,v=0;v<i;++v)for(var g=0;g<l;++g)for(var m=Math.floor(g/r),y=g%r,x=0;x<c;++x)for(var w=Math.floor(x/r),E=(y*r+x%r)*f,b=0;b<f;++b){var C=b+E+u*(w+s*(m+a*v));h[p++]=d[C]}return un(h,[i,l,c,f])},t.prototype.broadcastedBinaryOp=function(n,r,o,i){var a=Fe(n.shape,r.shape),s=Ce(a,o),u=this.readSync(n.dataId),l=this.readSync(r.dataId),c=po(n.shape,a),f=po(r.shape,a),d=s.values;if(c.length+f.length===0)for(var h=0;h<d.length;++h)d[h]=i(u[h%u.length],l[h%l.length]);else{var p=this.bufferSync(n),v=this.bufferSync(r),g=function(m){var y=s.indexToLoc(m),x=y.slice(-n.rank);c.forEach(function(C){return x[C]=0});var w=p.locToIndex(x),E=y.slice(-r.rank);f.forEach(function(C){return E[C]=0});var b=v.locToIndex(E);d[m]=i(u[w],l[b])};for(h=0;h<d.length;++h)g(h)}return s.toTensor()},t.prototype.broadcastedBinaryComplexOp=function(n,r,o){var i=Fe(n.shape,r.shape),a=Ce(i,"float32"),s=Ce(i,"float32"),u=this.readSync(n.dataId),l=this.readSync(r.dataId),c=po(n.shape,i),f=po(r.shape,i),d=a.values,h=s.values;if(c.length+f.length===0)for(var p=0;p<d.length;p++){var v=p%u.length,g=p%l.length,m=o(u[2*v],u[2*v+1],l[2*g],l[2*g+1]);d[p]=m.real,h[p]=m.imag}else{var y=this.bufferSync(this.data.get(n.dataId).complexTensors.real),x=this.bufferSync(this.data.get(r.dataId).complexTensors.real),w=function(E){var b=a.indexToLoc(E),C=b.slice(-n.rank);c.forEach(function(T){return C[T]=0});var _=y.locToIndex(C),S=b.slice(-r.rank);f.forEach(function(T){return S[T]=0});var R=x.locToIndex(S),D=o(u[2*_],u[2*_+1],l[2*R],l[2*R+1]);d[E]=D.real,h[E]=D.imag};for(p=0;p<d.length;p++)w(p)}return this.complex(a.toTensor(),s.toTensor())},t.prototype.split=function(n,r,o){return hw(n,r,o)},t.prototype.dispose=function(){},t.prototype.floatPrecision=function(){return 32},t.prototype.epsilon=function(){return 1e-7},t.prototype.cropAndResize=function(n,r,o,i,a,s){for(var u=n.shape,l=u[0],c=u[1],f=u[2],d=u[3],h=r.shape[0],p=i[0],v=i[1],g=Ce([h,p,v,d],"float32"),m=this.readSync(r.dataId),y=this.readSync(o.dataId),x=this.readSync(n.dataId),w=n.strides,E=g.strides,b=0;b<h;b++){var C=4*b,_=m[C],S=m[C+1],R=m[C+2],D=m[C+3],T=y[b];if(!(T>=l))for(var z=p>1?(R-_)*(c-1)/(p-1):0,O=v>1?(D-S)*(f-1)/(v-1):0,$=0;$<p;$++){var q=p>1?_*(c-1)+$*z:.5*(_+R)*(c-1);if(q<0||q>c-1)for(var V=0;V<v;V++)for(var F=0;F<d;F++){var L=F+V*E[2]+$*E[1]+b*E[0];g.values[L]=s}else if(a==="bilinear"){var U=Math.floor(q),Q=Math.ceil(q),ee=q-U;for(V=0;V<v;V++)if((Pe=v>1?S*(f-1)+V*O:.5*(S+D)*(f-1))<0||Pe>f-1)for(F=0;F<d;F++)L=F+V*E[2]+$*E[1]+b*E[0],g.values[L]=s;else{var ae=Math.floor(Pe),he=Math.ceil(Pe),ye=Pe-ae;for(F=0;F<d;F++){var ve=x[L=F+ae*w[2]+U*w[1]+T*w[0]],Se=x[L=F+he*w[2]+U*w[1]+T*w[0]],De=x[L=F+ae*w[2]+Q*w[1]+T*w[0]],Oe=ve+(Se-ve)*ye,ot=De+(x[L=F+he*w[2]+Q*w[1]+T*w[0]]-De)*ye;L=F+V*E[2]+$*E[1]+b*E[0],g.values[L]=Oe+(ot-Oe)*ee}}}else for(V=0;V<v;++V){var Pe;if((Pe=v>1?S*(f-1)+V*O:.5*(S+D)*(f-1))<0||Pe>f-1)for(F=0;F<d;F++)L=F+V*E[2]+$*E[1]+b*E[0],g.values[L]=s;else{var Ee=Math.round(Pe),Te=Math.round(q);for(F=0;F<d;F++){var Qe=F+Ee*w[2]+Te*w[1]+T*w[0],Je=F+V*E[2]+$*E[1]+b*E[0];g.values[Je]=x[Qe]}}}}}return g.toTensor()},t.prototype.sparseToDense=function(n,r,o,i){var a=$l(0,n,o),s=a.sliceRank,u=a.numUpdates,l=a.sliceSize,c=a.strides,f=a.outputSize;return this.scatter(n,r,o,f,l,u,s,c,i,!1)},t.prototype.gatherND=function(n,r){var o=r.shape,i=o[o.length-1],a=rw(n,r),s=a[0],u=a[1],l=a[2],c=a[3];if(u===0)return Wt([],s,n.dtype);for(var f=new As([u,l],n.dtype),d=this.readSync(r.dataId),h=this.readSync(n.dataId),p=0;p<u;p++){for(var v=[],g=0,m=0;m<i;m++){var y=d[p*i+m];g+=y*c[m],v.push(y)}if(g<0||g>=n.size/l)throw new Error("Invalid indices: "+v+" does not index into "+n.shape);for(var x=0;x<l;x++)f.values[p*l+x]=h[g*l+x]}return f.toTensor().reshape(s)},t.prototype.scatterND=function(n,r,o){var i=$l(0,n,o),a=i.sliceRank,s=i.numUpdates,u=i.sliceSize,l=i.strides,c=i.outputSize,f=ne(0);return this.scatter(n,r,o,c,u,s,a,l,f,!0)},t.prototype.fill=function(n,r,o){var i=Fl(o=o||Gs(r),le(n));return i.fill(r),P.makeTensor(i,n,o,this)},t.prototype.onesLike=function(n){if(n.dtype==="string")throw new Error("onesLike is not supported for string tensors");return this.fill(n.shape,1,n.dtype)},t.prototype.zerosLike=function(n){var r=Fl(n.dtype,le(n.shape));return this.makeOutput(r,n.shape,n.dtype)},t.prototype.linspace=function(n,r,o){return fw(n,r,o)},t.prototype.scatter=function(n,r,o,i,a,s,u,l,c,f){var d=[i/a,a],h=this.readSync(n.dataId),p=this.readSync(r.dataId);if(i===0)return Wt([],o,r.dtype);var v=new As(d,r.dtype);v.values.fill(this.readSync(c.dataId)[0]);for(var g=0;g<s;g++){for(var m=[],y=0,x=0;x<u;x++){var w=h[g*u+x];m.push(w),y+=w*l[x]}if(y<0||y>=i/a)throw new Error("Invalid indices: "+m+" does not index into "+o);for(var E=0;E<a;E++)f?v.values[y*a+E]+=p[g*a+E]:v.values[y*a+E]=r.rank===0?p[0]:p[g*a+E]}return v.toTensor().reshape(o)},t}(uw);P.registerBackend("cpu",function(){return new $A},1);for(var $f=0,fy=[{kernelName:"NonMaxSuppressionV5",backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,o=t,i=o.boxes,a=o.scores,s=r,u=s.maxOutputSize,l=s.iouThreshold,c=s.scoreThreshold,f=s.softNmsSigma,d=n;Y(i,"NonMaxSuppressionWithScore");var h=Up(d.data.get(i.dataId).values,d.data.get(a.dataId).values,u,l,c,f);return[h.selectedIndices,h.selectedScores]}},{kernelName:"Square",backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.x,o=n;Y(r,"square");for(var i=o.data.get(r.dataId).values,a=new Float32Array(i.length),s=0;s<i.length;++s){var u=i[s];a[s]=u*u}return{dataId:o.write(a,r.shape,r.dtype),shape:r.shape,dtype:r.dtype}}},{kernelName:Ms,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t,o=r.a,i=r.b,a=n;Y([o,i],Ms);var s=a.data.get(o.dataId).values,u=a.data.get(i.dataId).values,l=function(d,h,p,v,g,m){var y=Fe(d,h),x=y.length,w=Rr(y),E=Ns(g,le(y)),b=d.length,C=h.length,_=Rr(d),S=Rr(h),R=po(d,y),D=po(h,y);if(R.length+D.length===0)for(var T=0;T<E.length;++T)E[T]=m(p[T%p.length],v[T%v.length]);else{var z=function(O){var $=ek(O,x,w),q=$.slice(-b);R.forEach(function(U){return q[U]=0});var V=Fg(q,b,_),F=$.slice(-C);D.forEach(function(U){return F[U]=0});var L=Fg(F,C,S);E[O]=m(p[V],v[L])};for(T=0;T<E.length;++T)z(T)}return[E,y]}(o.shape,i.shape,s,u,o.dtype,function(d,h){var p=d-h;return p*p}),c=l[0],f=l[1];return{dataId:a.write(c,f,o.dtype),shape:f,dtype:o.dtype}}}];$f<fy.length;$f++)Ox(fy[$f]);var Ti,HA=function(e){this.variableNames=["A"];var t=Xt(),n=e[0],r=e[1];this.outputShape=e,this.userCode=`
      void main() {
        ivec3 coords = getOutputCoords();
        int texR = coords[0];
        int texC = coords[1];
        int depth = coords[2];
        vec2 uv = (vec2(texC, texR) + halfCR) / vec2(`+r+".0, "+n+`.0);

        vec4 values = `+t.texture2D+`(A, uv);
        float value;
        if (depth == 0) {
          value = values.r;
        } else if (depth == 1) {
          value = values.g;
        } else if (depth == 2) {
          value = values.b;
        } else if (depth == 3) {
          value = values.a;
        }

        setOutput(floor(value * 255.0 + 0.5));
      }
    `},GA=function(e){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0;var t=Xt(),n=e[0],r=e[1];this.outputShape=e,this.userCode=`
      void main() {
        ivec3 coords = getOutputCoords();
        int texR = coords[0];
        int texC = coords[1];
        int depth = coords[2];

        vec4 result = vec4(0.);

        for(int row=0; row<=1; row++) {
          for(int col=0; col<=1; col++) {
            texC = coords[1] + row;
            depth = coords[2] + col;

            vec2 uv = (vec2(texC, texR) + halfCR) /
                       vec2(`+r+".0, "+n+`.0);
            vec4 values = `+t.texture2D+`(A, uv);
            float value;
            if (depth == 0) {
              value = values.r;
            } else if (depth == 1) {
              value = values.g;
            } else if (depth == 2) {
              value = values.b;
            } else if (depth == 3) {
              value = values.a;
            }

            result[row * 2 + col] = floor(value * 255.0 + 0.5);
          }
        }

        `+t.output+` = result;
      }
    `};for(var Hf=0,dy=[{kernelName:"FromPixels",backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,o=t.pixels,i=r.numChannels,a=typeof HTMLVideoElement<"u"&&o instanceof HTMLVideoElement,s=typeof HTMLImageElement<"u"&&o instanceof HTMLImageElement,u=a?[o.videoWidth,o.videoHeight]:[o.width,o.height],l=u[0],c=u[1],f=[c,l],d=[c,l,i];(s||a)&&(Ti==null&&(Ti=document.createElement("canvas").getContext("2d")),Ti.canvas.width=l,Ti.canvas.height=c,Ti.drawImage(o,0,0,l,c),o=Ti.canvas);var h=n.makeTensorInfo(f,"int32");n.texData.get(h.dataId).usage=Sn.PIXELS,n.gpgpu.uploadPixelDataToTexture(n.getTexture(h.dataId),o);var p=G().getBool("WEBGL_PACK")?new GA(d):new HA(d),v=n.runWebGLProgram(p,[h],"int32");return n.disposeData(h.dataId),v}},{kernelName:"NonMaxSuppressionV5",backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs;Bl("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");var o=t,i=o.boxes,a=o.scores,s=r,u=s.maxOutputSize,l=s.iouThreshold,c=s.scoreThreshold,f=s.softNmsSigma,d=n,h=Up(d.readSync(i.dataId),d.readSync(a.dataId),u,l,c,f);return[h.selectedIndices,h.selectedScores]}},{kernelName:"Square",backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.x,o=n,i=new ke(r.shape,"return x * x;");return o.runWebGLProgram(i,[r],r.dtype)}},{kernelName:Ms,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t,o=r.a,i=r.b,a=n,s=G().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Mr("return (a - b) * (a - b);",o.shape,i.shape):new ht("return (a - b) * (a - b);",o.shape,i.shape);return a.compileAndRun(s,[o,i])}}];Hf<dy.length;Hf++)Ox(dy[Hf]);for(var Gf=0,hy=[{kernelName:"Square",gradFunc:function(e,t){var n=t[0];return{x:function(){return e.mul(n.toFloat().mul(2))}}}},{kernelName:Ms,gradFunc:function(e,t){var n=t[0],r=t[1],o=ne(2);return{a:function(){return Qt(e,Qt(o,It(n,r)))},b:function(){return Qt(e,Qt(o,It(r,n)))}}}}];Gf<hy.length;Gf++)VR(hy[Gf]);var qA=function(){function e(){}return e.prototype.fetch=function(t,n){return fetch(t,n)},e.prototype.now=function(){return performance.now()},e.prototype.encode=function(t,n){if(n!=="utf-8"&&n!=="utf8")throw new Error("Browser's encoder only supports utf-8, but got "+n);return this.textEncoder==null&&(this.textEncoder=new TextEncoder),this.textEncoder.encode(t)},e.prototype.decode=function(t,n){return new TextDecoder(n).decode(t)},e}();G().get("IS_BROWSER")&&G().setPlatform("browser",new qA);var qf,KA=function(){return require("node-fetch")},XA=function(){function e(){this.util=require("util"),this.textEncoder=new this.util.TextEncoder}return e.prototype.fetch=function(t,n){return G().global.fetch!=null?G().global.fetch(t,n):(qf==null&&(qf=KA()),qf(t,n))},e.prototype.now=function(){var t=process.hrtime();return 1e3*t[0]+t[1]/1e6},e.prototype.encode=function(t,n){if(n!=="utf-8"&&n!=="utf8")throw new Error("Node built-in encoder only supports utf-8, but got "+n);return this.textEncoder.encode(t)},e.prototype.decode=function(t,n){return t.length===0?"":new this.util.TextDecoder(n).decode(t)},e}();G().get("IS_NODE")&&G().setPlatform("node",new XA);var mh={float32:4,int32:4,uint16:2,uint8:1,bool:1},Ql=4;function ib(e,t){for(var n={},r=0,o=function(s){var u=s.name,l=s.dtype,c=s.shape,f=le(c),d=void 0;if("quantization"in s){var h=s.quantization;if(h.dtype!=="uint8"&&h.dtype!=="uint16")throw new Error("Weight "+s.name+" has unknown quantization dtype "+h.dtype+". Supported quantization dtypes are: 'uint8' and 'uint16'.");var p=mh[h.dtype],v=e.slice(r,r+f*p),g=h.dtype==="uint8"?new Uint8Array(v):new Uint16Array(v);if(l==="float32")d=Float32Array.from(g,function(b){return b*h.scale+h.min});else{if(l!=="int32")throw new Error("Unsupported dtype in weight '"+u+"': "+l);d=Int32Array.from(g,function(b){return Math.round(b*h.scale+h.min)})}r+=f*p}else if(l==="string"){var m=le(s.shape);d=[];for(var y=0;y<m;y++){var x=new Uint32Array(e.slice(r,r+Ql))[0];r+=Ql;var w=new Uint8Array(e.slice(r,r+x));d.push(w),r+=x}}else{var E=mh[l];if(v=e.slice(r,r+f*E),l==="float32")d=new Float32Array(v);else if(l==="int32")d=new Int32Array(v);else{if(l!=="bool")throw new Error("Unsupported dtype in weight '"+u+"': "+l);d=new Uint8Array(v)}r+=f*E}n[u]=Wt(d,c,l)},i=0,a=t;i<a.length;i++)o(a[i]);return n}function YA(e){if(e===null)throw new Error("Invalid input value: "+JSON.stringify(e));var t=0,n=[];e.forEach(function(i){if(t+=i.byteLength,n.push(i.byteLength===i.buffer.byteLength?i:new i.constructor(i)),!(i instanceof Float32Array||i instanceof Int32Array||i instanceof Uint8Array))throw new Error("Unsupported TypedArray subtype: "+i.constructor.name)});var r=new Uint8Array(t),o=0;return n.forEach(function(i){r.set(new Uint8Array(i.buffer),o),o+=i.byteLength}),r.buffer}var gh=typeof Buffer<"u"&&(typeof Blob>"u"||typeof atob>"u"||typeof btoa>"u");function py(e){return gh?Buffer.byteLength(e):new Blob([e]).size}function ov(e){var t=0;e.forEach(function(o){t+=o.byteLength});var n=new Uint8Array(t),r=0;return e.forEach(function(o){n.set(new Uint8Array(o),r),r+=o.byteLength}),n.buffer}function vy(e){for(e=e.trim();e.endsWith("/");)e=e.slice(0,e.length-1);var t=e.split("/");return t[t.length-1]}function Zs(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("Expected JSON model topology, received ArrayBuffer.");return{dateSaved:new Date,modelTopologyType:"JSON",modelTopologyBytes:e.modelTopology==null?0:py(JSON.stringify(e.modelTopology)),weightSpecsBytes:e.weightSpecs==null?0:py(JSON.stringify(e.weightSpecs)),weightDataBytes:e.weightData==null?0:e.weightData.byteLength}}var Rn=function(){function e(){this.saveRouters=[],this.loadRouters=[]}return e.getInstance=function(){return e.instance==null&&(e.instance=new e),e.instance},e.registerSaveRouter=function(t){e.getInstance().saveRouters.push(t)},e.registerLoadRouter=function(t){e.getInstance().loadRouters.push(t)},e.getSaveHandlers=function(t){return e.getHandlers(t,"save")},e.getLoadHandlers=function(t,n){return e.getHandlers(t,"load",n)},e.getHandlers=function(t,n,r){var o=[];return(n==="load"?e.getInstance().loadRouters:e.getInstance().saveRouters).forEach(function(i){var a=i(t,r);a!==null&&o.push(a)}),o},e}(),ia="://",So=function(){function e(){this.managers={}}return e.getInstance=function(){return e.instance==null&&(e.instance=new e),e.instance},e.registerManager=function(t,n){I(t!=null,function(){return"scheme must not be undefined or null."}),t.endsWith(ia)&&(t=t.slice(0,t.indexOf(ia))),I(t.length>0,function(){return"scheme must not be an empty string."});var r=e.getInstance();I(r.managers[t]==null,function(){return"A model store manager is already registered for scheme '"+t+"'."}),r.managers[t]=n},e.getManager=function(t){var n=this.getInstance().managers[t];if(n==null)throw new Error("Cannot find model manager for scheme '"+t+"'");return n},e.getSchemes=function(){return Object.keys(this.getInstance().managers)},e}();function nl(e){if(e.indexOf(ia)===-1)throw new Error("The url string provided does not contain a scheme. Supported schemes are: "+So.getSchemes().join(","));return{scheme:e.split(ia)[0],path:e.split(ia)[1]}}function my(e,t,n){return n===void 0&&(n=!1),se(this,void 0,void 0,function(){var r,o,i,a,s,u,l,c,f;return ue(this,function(d){switch(d.label){case 0:return I(e!==t,function(){return"Old path and new path are the same: '"+e+"'"}),I((r=Rn.getLoadHandlers(e)).length>0,function(){return"Copying failed because no load handler is found for source URL "+e+"."}),I(r.length<2,function(){return"Copying failed because more than one ("+r.length+") load handlers for source URL "+e+"."}),o=r[0],I((i=Rn.getSaveHandlers(t)).length>0,function(){return"Copying failed because no save handler is found for destination URL "+t+"."}),I(i.length<2,function(){return"Copying failed because more than one ("+r.length+") save handlers for destination URL "+t+"."}),a=i[0],s=nl(e).scheme,u=nl(e).path,l=s===nl(e).scheme,[4,o.load()];case 1:return c=d.sent(),n&&l?[4,So.getManager(s).removeModel(u)]:[3,3];case 2:d.sent(),d.label=3;case 3:return[4,a.save(c)];case 4:return f=d.sent(),!n||l?[3,6]:[4,So.getManager(s).removeModel(u)];case 5:d.sent(),d.label=6;case 6:return[2,f.modelArtifactsInfo]}})})}var Qo="models_store",vo="model_info_store";function ab(){if(!G().getBool("IS_BROWSER"))throw new Error("Failed to obtain IndexedDB factory because the current environmentis not a web browser.");var e=window||self,t=e.indexedDB||e.mozIndexedDB||e.webkitIndexedDB||e.msIndexedDB||e.shimIndexedDB;if(t==null)throw new Error("The current browser does not appear to support IndexedDB.");return t}function yh(e){var t=e.result;t.createObjectStore(Qo,{keyPath:"modelPath"}),t.createObjectStore(vo,{keyPath:"modelPath"})}var aa=function(){function e(t){if(this.indexedDB=ab(),t==null||!t)throw new Error("For IndexedDB, modelPath must not be null, undefined or empty.");this.modelPath=t}return e.prototype.save=function(t){return se(this,void 0,void 0,function(){return ue(this,function(n){if(t.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");return[2,this.databaseAction(this.modelPath,t)]})})},e.prototype.load=function(){return se(this,void 0,void 0,function(){return ue(this,function(t){return[2,this.databaseAction(this.modelPath)]})})},e.prototype.databaseAction=function(t,n){var r=this;return new Promise(function(o,i){var a=r.indexedDB.open("tensorflowjs",1);a.onupgradeneeded=function(){return yh(a)},a.onsuccess=function(){var s=a.result;if(n==null){var u=s.transaction(Qo,"readonly"),l=u.objectStore(Qo).get(r.modelPath);l.onsuccess=function(){if(l.result==null)return s.close(),i(new Error("Cannot find model with path '"+r.modelPath+"' in IndexedDB."));o(l.result.modelArtifacts)},l.onerror=function(v){return s.close(),i(l.error)},u.oncomplete=function(){return s.close()}}else{var c,f=Zs(n),d=s.transaction(vo,"readwrite"),h=d.objectStore(vo),p=h.put({modelPath:r.modelPath,modelArtifactsInfo:f});p.onsuccess=function(){var v=(c=s.transaction(Qo,"readwrite")).objectStore(Qo).put({modelPath:r.modelPath,modelArtifacts:n,modelArtifactsInfo:f});v.onsuccess=function(){return o({modelArtifactsInfo:f})},v.onerror=function(g){var m=(h=d.objectStore(vo)).delete(r.modelPath);m.onsuccess=function(){return s.close(),i(v.error)},m.onerror=function(y){return s.close(),i(v.error)}}},p.onerror=function(v){return s.close(),i(p.error)},d.oncomplete=function(){c==null?s.close():c.oncomplete=function(){return s.close()}}}},a.onerror=function(s){return i(a.error)}})},e.URL_SCHEME="indexeddb://",e}(),gy=function(e){return G().getBool("IS_BROWSER")&&!Array.isArray(e)&&e.startsWith(aa.URL_SCHEME)?(t=e.slice(aa.URL_SCHEME.length),new aa(t)):null;var t};Rn.registerSaveRouter(gy),Rn.registerLoadRouter(gy);var QA=function(){function e(){this.indexedDB=ab()}return e.prototype.listModels=function(){return se(this,void 0,void 0,function(){var t=this;return ue(this,function(n){return[2,new Promise(function(r,o){var i=t.indexedDB.open("tensorflowjs",1);i.onupgradeneeded=function(){return yh(i)},i.onsuccess=function(){var a=i.result,s=a.transaction(vo,"readonly"),u=s.objectStore(vo).getAll();u.onsuccess=function(){for(var l={},c=0,f=u.result;c<f.length;c++){var d=f[c];l[d.modelPath]=d.modelArtifactsInfo}r(l)},u.onerror=function(l){return a.close(),o(u.error)},s.oncomplete=function(){return a.close()}},i.onerror=function(a){return o(i.error)}})]})})},e.prototype.removeModel=function(t){return se(this,void 0,void 0,function(){var n=this;return ue(this,function(r){var o;return t=(o=t).startsWith(aa.URL_SCHEME)?o.slice(aa.URL_SCHEME.length):o,[2,new Promise(function(i,a){var s=n.indexedDB.open("tensorflowjs",1);s.onupgradeneeded=function(){return yh(s)},s.onsuccess=function(){var u,l=s.result,c=l.transaction(vo,"readwrite"),f=c.objectStore(vo),d=f.get(t);d.onsuccess=function(){if(d.result==null)return l.close(),a(new Error("Cannot find model with path '"+t+"' in IndexedDB."));var h=f.delete(t),p=function(){var v=(u=l.transaction(Qo,"readwrite")).objectStore(Qo).delete(t);v.onsuccess=function(){return i(d.result.modelArtifactsInfo)},v.onerror=function(g){return a(d.error)}};h.onsuccess=p,h.onerror=function(v){return p(),l.close(),a(d.error)}},d.onerror=function(h){return l.close(),a(d.error)},c.oncomplete=function(){u==null?l.close():u.oncomplete=function(){return l.close()}}},s.onerror=function(u){return a(s.error)}})]})})},e}();if(G().getBool("IS_BROWSER"))try{So.registerManager(aa.URL_SCHEME,new QA)}catch{}var Br="/",Oi="tensorflowjs_models",sb="info",JA="model_topology",ZA="weight_specs",eP="weight_data",tP="model_metadata";function ub(e){return{info:[Oi,e,sb].join(Br),topology:[Oi,e,JA].join(Br),weightSpecs:[Oi,e,ZA].join(Br),weightData:[Oi,e,eP].join(Br),modelMetadata:[Oi,e,tP].join(Br)}}function nP(e){var t=e.split(Br);if(t.length<3)throw new Error("Invalid key format: "+e);return t.slice(1,t.length-1).join(Br)}var sa=function(){function e(t){if(!G().getBool("IS_BROWSER")||typeof window>"u"||window.localStorage===void 0)throw new Error("The current environment does not support local storage.");if(this.LS=window.localStorage,t==null||!t)throw new Error("For local storage, modelPath must not be null, undefined or empty.");this.modelPath=t,this.keys=ub(this.modelPath)}return e.prototype.save=function(t){return se(this,void 0,void 0,function(){var n,r,o;return ue(this,function(i){if(t.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");n=JSON.stringify(t.modelTopology),r=JSON.stringify(t.weightSpecs),o=Zs(t);try{return this.LS.setItem(this.keys.info,JSON.stringify(o)),this.LS.setItem(this.keys.topology,n),this.LS.setItem(this.keys.weightSpecs,r),this.LS.setItem(this.keys.weightData,function(a){if(gh)return Buffer.from(a).toString("base64");for(var s=new Uint8Array(a),u="",l=0,c=s.length;l<c;l++)u+=String.fromCharCode(s[l]);return btoa(u)}(t.weightData)),this.LS.setItem(this.keys.modelMetadata,JSON.stringify({format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy,userDefinedMetadata:t.userDefinedMetadata})),[2,{modelArtifactsInfo:o}]}catch{throw this.LS.removeItem(this.keys.info),this.LS.removeItem(this.keys.topology),this.LS.removeItem(this.keys.weightSpecs),this.LS.removeItem(this.keys.weightData),this.LS.removeItem(this.keys.modelMetadata),new Error("Failed to save model '"+this.modelPath+"' to local storage: size quota being exceeded is a possible cause of this failure: modelTopologyBytes="+o.modelTopologyBytes+", weightSpecsBytes="+o.weightSpecsBytes+", weightDataBytes="+o.weightDataBytes+".")}return[2]})})},e.prototype.load=function(){return se(this,void 0,void 0,function(){var t,n,r,o,i,a,s;return ue(this,function(u){if((t=JSON.parse(this.LS.getItem(this.keys.info)))==null)throw new Error("In local storage, there is no model with name '"+this.modelPath+"'");if(t.modelTopologyType!=="JSON")throw new Error("BrowserLocalStorage does not support loading non-JSON model topology yet.");if(n={},(r=JSON.parse(this.LS.getItem(this.keys.topology)))==null)throw new Error("In local storage, the topology of model '"+this.modelPath+"' is missing.");if(n.modelTopology=r,(o=JSON.parse(this.LS.getItem(this.keys.weightSpecs)))==null)throw new Error("In local storage, the weight specs of model '"+this.modelPath+"' are missing.");if(n.weightSpecs=o,(i=this.LS.getItem(this.keys.modelMetadata))!=null&&(a=JSON.parse(i),n.format=a.format,n.generatedBy=a.generatedBy,n.convertedBy=a.convertedBy,n.userDefinedMetadata=a.userDefinedMetadata),(s=this.LS.getItem(this.keys.weightData))==null)throw new Error("In local storage, the binary weight values of model '"+this.modelPath+"' are missing.");return n.weightData=function(l){if(gh){var c=Buffer.from(l,"base64");return c.buffer.slice(c.byteOffset,c.byteOffset+c.byteLength)}for(var f=atob(l),d=new Uint8Array(f.length),h=0;h<f.length;++h)d.set([f.charCodeAt(h)],h);return d.buffer}(s),[2,n]})})},e.URL_SCHEME="localstorage://",e}(),yy=function(e){return G().getBool("IS_BROWSER")&&!Array.isArray(e)&&e.startsWith(sa.URL_SCHEME)?(t=e.slice(sa.URL_SCHEME.length),new sa(t)):null;var t};Rn.registerSaveRouter(yy),Rn.registerLoadRouter(yy);var rP=function(){function e(){I(G().getBool("IS_BROWSER"),function(){return"Current environment is not a web browser"}),I(typeof window>"u"||window.localStorage!==void 0,function(){return"Current browser does not appear to support localStorage"}),this.LS=window.localStorage}return e.prototype.listModels=function(){return se(this,void 0,void 0,function(){var t,n,r,o,i,a;return ue(this,function(s){for(t={},n=Oi+Br,r=Br+sb,o=0;o<this.LS.length;++o)(i=this.LS.key(o)).startsWith(n)&&i.endsWith(r)&&(a=nP(i),t[a]=JSON.parse(this.LS.getItem(i)));return[2,t]})})},e.prototype.removeModel=function(t){return se(this,void 0,void 0,function(){var n,r;return ue(this,function(o){var i;if(t=(i=t).startsWith(sa.URL_SCHEME)?i.slice(sa.URL_SCHEME.length):i,n=ub(t),this.LS.getItem(n.info)==null)throw new Error("Cannot find model at path '"+t+"'");return r=JSON.parse(this.LS.getItem(n.info)),this.LS.removeItem(n.info),this.LS.removeItem(n.topology),this.LS.removeItem(n.weightSpecs),this.LS.removeItem(n.weightData),[2,r]})})},e}();if(G().getBool("IS_BROWSER"))try{So.registerManager(sa.URL_SCHEME,new rP)}catch{}var oP="model",iP=".json",aP=".weights.bin";function xy(e){return new Promise(function(t){return setTimeout(t)}).then(e)}var Kf=function(){function e(t){if(!G().getBool("IS_BROWSER"))throw new Error("browserDownloads() cannot proceed because the current environment is not a browser.");t.startsWith(e.URL_SCHEME)&&(t=t.slice(e.URL_SCHEME.length)),t!=null&&t.length!==0||(t=oP),this.modelTopologyFileName=t+iP,this.weightDataFileName=t+aP}return e.prototype.save=function(t){return se(this,void 0,void 0,function(){var n,r,o,i,a,s;return ue(this,function(u){switch(u.label){case 0:if(typeof document>"u")throw new Error("Browser downloads are not supported in this environment since `document` is not present");if(n=window.URL.createObjectURL(new Blob([t.weightData],{type:"application/octet-stream"})),!(t.modelTopology instanceof ArrayBuffer))return[3,1];throw new Error("BrowserDownloads.save() does not support saving model topology in binary formats yet.");case 1:return r=[{paths:["./"+this.weightDataFileName],weights:t.weightSpecs}],o={modelTopology:t.modelTopology,format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy,weightsManifest:r},i=window.URL.createObjectURL(new Blob([JSON.stringify(o)],{type:"application/json"})),(a=this.jsonAnchor==null?document.createElement("a"):this.jsonAnchor).download=this.modelTopologyFileName,a.href=i,[4,xy(function(){return a.dispatchEvent(new MouseEvent("click"))})];case 2:return u.sent(),t.weightData==null?[3,4]:((s=this.weightDataAnchor==null?document.createElement("a"):this.weightDataAnchor).download=this.weightDataFileName,s.href=n,[4,xy(function(){return s.dispatchEvent(new MouseEvent("click"))})]);case 3:u.sent(),u.label=4;case 4:return[2,{modelArtifactsInfo:Zs(t)}]}})})},e.URL_SCHEME="downloads://",e}(),sP=function(){function e(t){if(t==null||t.length<1)throw new Error("When calling browserFiles, at least 1 file is required, but received "+t);this.files=t}return e.prototype.load=function(){return se(this,void 0,void 0,function(){var t,n,r=this;return ue(this,function(o){return t=this.files[0],n=this.files.slice(1),[2,new Promise(function(i,a){var s=new FileReader;s.onload=function(u){var l=JSON.parse(u.target.result),c=l.modelTopology;if(c!=null){n.length===0&&i({modelTopology:c});var f=l.weightsManifest;if(f!=null){var d;try{d=r.checkManifestAndWeightFiles(f,n)}catch(g){return void a(g)}var h=[],p=[],v=[];f.forEach(function(g){g.paths.forEach(function(m){p.push(m),v.push(null)}),h.push.apply(h,g.weights)}),f.forEach(function(g){g.paths.forEach(function(m){var y=new FileReader;y.onload=function(x){var w=x.target.result,E=p.indexOf(m);v[E]=w,v.indexOf(null)===-1&&i({modelTopology:c,weightSpecs:h,weightData:ov(v),format:l.format,generatedBy:l.generatedBy,convertedBy:l.convertedBy,userDefinedMetadata:l.userDefinedMetadata})},y.onerror=function(x){return a("Failed to weights data from file of path '"+m+"'.")},y.readAsArrayBuffer(d[m])})})}else a(new Error("weightManifest field is missing from file "+t.name))}else a(new Error("modelTopology field is missing from file "+t.name))},s.onerror=function(u){return a("Failed to read model topology and weights manifest JSON from file '"+t.name+"'. BrowserFiles supports loading Keras-style tf.Model artifacts only.")},s.readAsText(t)})]})})},e.prototype.checkManifestAndWeightFiles=function(t,n){for(var r=[],o=n.map(function(u){return vy(u.name)}),i={},a=0,s=t;a<s.length;a++)s[a].paths.forEach(function(u){var l=vy(u);if(r.indexOf(l)!==-1)throw new Error("Duplicate file basename found in weights manifest: '"+l+"'");if(r.push(l),o.indexOf(l)===-1)throw new Error("Weight file with basename '"+l+"' is not provided.");i[u]=n[o.indexOf(l)]});if(r.length!==n.length)throw new Error("Mismatch in the number of files in weights manifest ("+r.length+") and the number of weight files provided ("+n.length+").");return i},e}();function wy(e,t,n,r){(function(i){I(i!=null&&Array.isArray(i)&&i.length>0,function(){return"promises must be a none empty array"})})(e),function(i,a){I(i>=0&&i<=1,function(){return"Progress fraction must be in range [0, 1], but got startFraction "+i}),I(a>=0&&a<=1,function(){return"Progress fraction must be in range [0, 1], but got endFraction "+a}),I(a>=i,function(){return"startFraction must be no more than endFraction, but got startFraction "+i+" and endFraction "+a})}(n=n??0,r=r??1);var o=0;return Promise.all(e.map(function(i){return i.then(function(a){var s=n+ ++o/e.length*(r-n);return t(s),a}),i}))}function lb(e,t){return se(this,void 0,void 0,function(){var n,r,o,i,a,s,u,l,c;return ue(this,function(f){switch(f.label){case 0:return t==null&&(t={}),n=t.fetchFunc==null?G().platform.fetch:t.fetchFunc,r=e.map(function(d){return n(d,t.requestInit,{isBinary:!0})}),o=0,i=.5,t.onProgress!=null?[3,2]:[4,Promise.all(r)];case 1:return a=f.sent(),[3,4];case 2:return[4,wy(r,t.onProgress,o,i)];case 3:a=f.sent(),f.label=4;case 4:return s=a.map(function(d){return d.arrayBuffer()}),u=.5,l=1,t.onProgress!=null?[3,6]:[4,Promise.all(s)];case 5:return c=f.sent(),[3,8];case 6:return[4,wy(s,t.onProgress,u,l)];case 7:c=f.sent(),f.label=8;case 8:return[2,c]}})})}function by(e){var t=this;return function(n,r,o){return r===void 0&&(r=""),se(t,void 0,void 0,function(){var i,a,s,u,l,c,f,d,h,p;return ue(this,function(v){switch(v.label){case 0:if(i=n.map(function(){return!1}),a={},s=o!=null?o.map(function(){return!1}):[],u=[],n.forEach(function(g,m){var y=0;g.weights.forEach(function(x){var w="quantization"in x?x.quantization.dtype:x.dtype,E=mh[w]*le(x.shape),b=function(){i[m]=!0,a[m]==null&&(a[m]=[]),a[m].push({manifestEntry:x,groupOffset:y,sizeBytes:E})};o!=null?o.forEach(function(C,_){C===x.name&&(b(),s[_]=!0)}):b(),u.push(x.name),y+=E})}),!s.every(function(g){return g}))throw l=o.filter(function(g,m){return!s[m]}),new Error("Could not find weights in manifest with names: "+l.join(", ")+`. 
Manifest JSON has weights with names: `+u.join(", ")+".");return c=i.reduce(function(g,m,y){return m&&g.push(y),g},[]),f=[],c.forEach(function(g){n[g].paths.forEach(function(m){var y=r+(r.endsWith("/")?"":"/")+m;f.push(y)})}),[4,e(f)];case 1:return d=v.sent(),h={},p=0,c.forEach(function(g){for(var m=n[g].paths.length,y=0,x=0;x<m;x++)y+=d[p+x].byteLength;for(var w=new ArrayBuffer(y),E=new Uint8Array(w),b=0,C=0;C<m;C++){var _=new Uint8Array(d[p+C]);E.set(_,b),b+=_.byteLength}a[g].forEach(function(S){var R=ib(w.slice(S.groupOffset,S.groupOffset+S.sizeBytes),[S.manifestEntry]);for(var D in R)h[D]=R[D]}),p+=m}),[2,h]}})})}}Rn.registerSaveRouter(function(e){return G().getBool("IS_BROWSER")&&!Array.isArray(e)&&e.startsWith(Kf.URL_SCHEME)?function(t){return t===void 0&&(t="model"),new Kf(t)}(e.slice(Kf.URL_SCHEME.length)):null});var cb=function(){function e(t,n){if(this.DEFAULT_METHOD="POST",n==null&&(n={}),this.weightPathPrefix=n.weightPathPrefix,this.onProgress=n.onProgress,n.fetchFunc!=null?(I(typeof n.fetchFunc=="function",function(){return"Must pass a function that matches the signature of `fetch` (see https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API)"}),this.fetch=n.fetchFunc):this.fetch=G().platform.fetch,I(t!=null&&t.length>0,function(){return"URL path for http must not be null, undefined or empty."}),Array.isArray(t)&&I(t.length===2,function(){return"URL paths for http must have a length of 2, (actual length is "+t.length+")."}),this.path=t,n.requestInit!=null&&n.requestInit.body!=null)throw new Error("requestInit is expected to have no pre-existing body, but has one.");this.requestInit=n.requestInit||{}}return e.prototype.save=function(t){return se(this,void 0,void 0,function(){var n,r,o,i;return ue(this,function(a){switch(a.label){case 0:if(t.modelTopology instanceof ArrayBuffer)throw new Error("BrowserHTTPRequest.save() does not support saving model topology in binary formats yet.");return(n=Object.assign({method:this.DEFAULT_METHOD},this.requestInit)).body=new FormData,r=[{paths:["./model.weights.bin"],weights:t.weightSpecs}],o={modelTopology:t.modelTopology,format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy,userDefinedMetadata:t.userDefinedMetadata,weightsManifest:r},n.body.append("model.json",new Blob([JSON.stringify(o)],{type:"application/json"}),"model.json"),t.weightData!=null&&n.body.append("model.weights.bin",new Blob([t.weightData],{type:"application/octet-stream"}),"model.weights.bin"),[4,this.fetch(this.path,n)];case 1:if((i=a.sent()).ok)return[2,{modelArtifactsInfo:Zs(t),responses:[i]}];throw new Error("BrowserHTTPRequest.save() failed due to HTTP response status "+i.status+".")}})})},e.prototype.load=function(){return se(this,void 0,void 0,function(){var t,n,r,o,i,a,s,u,l,c,f,d;return ue(this,function(h){switch(h.label){case 0:return[4,this.fetch(this.path,this.requestInit)];case 1:if(!(t=h.sent()).ok)throw new Error("Request to "+this.path+" failed with status code "+t.status+". Please verify this URL points to the model JSON of the model to load.");h.label=2;case 2:return h.trys.push([2,4,,5]),[4,t.json()];case 3:return n=h.sent(),[3,5];case 4:throw h.sent(),r="Failed to parse model JSON of response from "+this.path+".",this.path.endsWith(".pb")?r+=" Your path contains a .pb file extension. Support for .pb models have been removed in TensorFlow.js 1.0 in favor of .json models. You can re-convert your Python TensorFlow model using the TensorFlow.js 1.0 conversion scripts or you can convert your.pb models with the 'pb2json'NPM script in the tensorflow/tfjs-converter repository.":r+=" Please make sure the server is serving valid JSON for this request.",new Error(r);case 5:if(o=n.modelTopology,i=n.weightsManifest,a=n.generatedBy,s=n.convertedBy,u=n.format,l=n.userDefinedMetadata,o==null&&i==null)throw new Error("The JSON from HTTP path "+this.path+" contains neither model topology or manifest for weights.");return i==null?[3,7]:[4,this.loadWeights(i)];case 6:d=h.sent(),c=d[0],f=d[1],h.label=7;case 7:return[2,{modelTopology:o,weightSpecs:c,weightData:f,userDefinedMetadata:l,generatedBy:a,convertedBy:s,format:u}]}})})},e.prototype.loadWeights=function(t){return se(this,void 0,void 0,function(){var n,r,o,i,a,s,u,l,c,f,d;return ue(this,function(h){switch(h.label){case 0:for(n=Array.isArray(this.path)?this.path[1]:this.path,r=function(p){var v=p.lastIndexOf("/"),g=p.lastIndexOf("?"),m=p.substring(0,v),y=g>v?p.substring(g):"";return[m+"/",y]}(n),o=r[0],i=r[1],a=this.weightPathPrefix||o,s=[],u=0,l=t;u<l.length;u++)c=l[u],s.push.apply(s,c.weights);return f=[],t.forEach(function(p){p.paths.forEach(function(v){f.push(a+v+i)})}),[4,lb(f,{requestInit:this.requestInit,fetchFunc:this.fetch,onProgress:this.onProgress})];case 1:return d=h.sent(),[2,[s,ov(d)]]}})})},e.URL_SCHEME_REGEX=/^https?:\/\//,e}();function xh(e){return e.match(cb.URL_SCHEME_REGEX)!=null}var Ey=function(e,t){return typeof fetch>"u"?null:(Array.isArray(e)?e.every(function(n){return xh(n)}):xh(e))?wh(e,{onProgress:t}):null};function wh(e,t){return new cb(e,t)}Rn.registerSaveRouter(Ey),Rn.registerLoadRouter(Ey);var Xf=function(){function e(t){this.modelArtifacts=t}return e.prototype.load=function(){return se(this,void 0,void 0,function(){return ue(this,function(t){return[2,this.modelArtifacts]})})},e}(),uP=function(){function e(t){this.saveHandler=t}return e.prototype.save=function(t){return se(this,void 0,void 0,function(){return ue(this,function(n){return[2,this.saveHandler(t)]})})},e}(),fb=Object.freeze({browserFiles:function(e){return new sP(e)},browserHTTPRequest:function(e,t){return wh(e,t)},concatenateArrayBuffers:ov,decodeWeights:ib,encodeWeights:function(e,t){return se(this,void 0,void 0,function(){var n,r,o,i,a,s=this;return ue(this,function(u){switch(u.label){case 0:for(n=[],r=[],o=Array.isArray(e)?e.map(function(l){return l.name}):Object.keys(e),i=function(l){var c=o[l],f=Array.isArray(e)?e[l].tensor:e[c];if(f.dtype!=="float32"&&f.dtype!=="int32"&&f.dtype!=="bool"&&f.dtype!=="string")throw new Error("Unsupported dtype in weight '"+c+"': "+f.dtype);var d={name:c,shape:f.shape,dtype:f.dtype};if(f.dtype==="string"){var h=new Promise(function(p){return se(s,void 0,void 0,function(){var v,g,m,y,x,w,E;return ue(this,function(b){switch(b.label){case 0:return[4,f.bytes()];case 1:for(v=b.sent(),g=v.reduce(function(C,_){return C+_.length},0)+Ql*v.length,m=new Uint8Array(g),y=0,x=0;x<v.length;x++)w=v[x],E=new Uint8Array(new Uint32Array([w.length]).buffer),m.set(E,y),y+=Ql,m.set(w,y),y+=w.length;return p(m),[2]}})})});r.push(h)}else r.push(f.data());t!=null&&(d.group=t),n.push(d)},a=0;a<o.length;++a)i(a);return[4,Promise.all(r)];case 1:return[2,{data:YA(u.sent()),specs:n}]}})})},fromMemory:function(e,t,n,r){return arguments.length===1?e.modelTopology!=null||e.weightSpecs!=null?new Xf(e):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new Xf({modelTopology:e})):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new Xf({modelTopology:e,weightSpecs:t,weightData:n,trainingConfig:r}))},getLoadHandlers:function(e,t){return Rn.getLoadHandlers(e,t)},getModelArtifactsInfoForJSON:Zs,getSaveHandlers:function(e){return Rn.getSaveHandlers(e)},http:wh,isHTTPScheme:xh,loadWeights:function(e,t,n,r){return t===void 0&&(t=""),se(this,void 0,void 0,function(){return ue(this,function(o){return[2,by(function(i){return lb(i,{requestInit:r})})(e,t,n)]})})},registerLoadRouter:function(e){return Rn.registerLoadRouter(e)},registerSaveRouter:function(e){return Rn.registerSaveRouter(e)},weightsLoaderFactory:by,withSaveHandler:function(e){return new uP(e)},copyModel:function(e,t){return se(this,void 0,void 0,function(){return ue(this,function(n){return[2,my(e,t,!1)]})})},listModels:function(){return se(this,void 0,void 0,function(){var e,t,n,r,o,i,a;return ue(this,function(s){switch(s.label){case 0:e=So.getSchemes(),t={},n=0,r=e,s.label=1;case 1:return n<r.length?(o=r[n],[4,So.getManager(o).listModels()]):[3,4];case 2:for(a in i=s.sent())t[o+ia+a]=i[a];s.label=3;case 3:return n++,[3,1];case 4:return[2,t]}})})},moveModel:function(e,t){return se(this,void 0,void 0,function(){return ue(this,function(n){return[2,my(e,t,!0)]})})},removeModel:function(e){return se(this,void 0,void 0,function(){var t;return ue(this,function(n){return t=nl(e),[2,So.getManager(t.scheme).removeModel(t.path)]})})}}),Ni;N({confusionMatrix_:function(e,t,n){var r=k(e,"labels","confusionMatrix"),o=k(t,"predictions","confusionMatrix");I(n==null||n>0&&Number.isInteger(n),function(){return"If provided, numClasses must be a positive integer, but got "+n}),I(r.rank===1,function(){return"Expected the rank of labels to be 1, but got "+r.rank}),I(o.rank===1,function(){return"Expected the rank of predictions to be 1, but got "+o.rank}),I(r.shape[0]===o.shape[0],function(){return"Mismatch in the number of examples: "+r.shape[0]+" vs. "+o.shape[0]+". Labels and predictions should have the same number of elements."}),I(n>0&&Number.isInteger(n),function(){return"numClasses is required to be a positive integer, but got "+n});var i=fh(r.asType("int32"),n),a=fh(o.asType("int32"),n);return i.transpose().matMul(a).asType("int32")}});var lP=N({fromPixels_:function(e,t){if(t===void 0&&(t=3),t>4)throw new Error("Cannot construct Tensor with more than 4 channels from pixels.");if(e==null)throw new Error("pixels passed to tf.browser.fromPixels() can not be null");var n=!1,r=!1,o=!1,i=!1,a=!1;if(e.data instanceof Uint8Array)n=!0;else if(typeof ImageData<"u"&&e instanceof ImageData)r=!0;else if(typeof HTMLVideoElement<"u"&&e instanceof HTMLVideoElement)o=!0;else if(typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement)i=!0;else{if(e.getContext==null)throw new Error("pixels passed to tf.browser.fromPixels() must be either an HTMLVideoElement, HTMLImageElement, HTMLCanvasElement, ImageData in browser, or OffscreenCanvas, ImageData in webworker or {data: Uint32Array, width: number, height: number}, but was "+e.constructor.name);a=!0}if(o&&o&&e.readyState<2)throw new Error("The video element has not loaded data yet. Please wait for `loadeddata` event on the <video> element.");if(Mx("FromPixels",P.backendName)!=null)return P.runKernel("FromPixels",{pixels:e},{numChannels:t});var s,u,l=o?[e.videoWidth,e.videoHeight]:[e.width,e.height],c=l[0],f=l[1];if(a?s=e.getContext("2d").getImageData(0,0,c,f).data:r||n?s=e.data:(i||o)&&(Ni==null&&(Ni=document.createElement("canvas").getContext("2d")),Ni.canvas.width=c,Ni.canvas.height=f,Ni.drawImage(e,0,0,c,f),s=Ni.getImageData(0,0,c,f).data),t===4)u=new Int32Array(s);else{var d=c*f;u=new Int32Array(d*t);for(var h=0;h<d;h++)for(var p=0;p<t;++p)u[h*t+p]=s[4*h+p]}return Pp(u,[f,c,t],"int32")}}),iv=Object.freeze({toPixels:function(e,t){return se(this,void 0,void 0,function(){var n,r,o,i,a,s,u,l,c,f,d,h,p,v,g,m,y,x,w,E,b,C,_;return ue(this,function(S){switch(S.label){case 0:if(n=k(e,"img","toPixels"),e instanceof st||(n=n.toInt()),n.rank!==2&&n.rank!==3)throw new Error("toPixels only supports rank 2 or 3 tensors, got rank "+n.rank+".");if(r=n.shape.slice(0,2),o=r[0],i=r[1],(a=n.rank===2?1:n.shape[2])>4||a===2)throw new Error("toPixels only supports depth of size 1, 3 or 4 but got "+a);return[4,n.data()];case 1:return s=S.sent(),u=n.min(),l=n.max(),[4,Promise.all([u.data(),l.data()])];case 2:if(c=S.sent(),f=c[0],d=c[1],h=f[0],p=d[0],u.dispose(),l.dispose(),n.dtype==="float32"){if(h<0||p>1)throw new Error("Tensor values for a float32 Tensor must be in the range [0 - 1] but got range ["+h+" - "+p+"].")}else{if(n.dtype!=="int32")throw new Error("Unsupported type for toPixels: "+n.dtype+". Please use float32 or int32 tensors.");if(h<0||p>255)throw new Error("Tensor values for a int32 Tensor must be in the range [0 - 255] but got range ["+h+" - "+p+"].")}for(v=n.dtype==="float32"?255:1,g=new Uint8ClampedArray(i*o*4),m=0;m<o*i;++m)y=void 0,x=void 0,w=void 0,E=void 0,a===1?(y=s[m]*v,x=s[m]*v,w=s[m]*v,E=255):a===3?(y=s[3*m]*v,x=s[3*m+1]*v,w=s[3*m+2]*v,E=255):a===4&&(y=s[4*m]*v,x=s[4*m+1]*v,w=s[4*m+2]*v,E=s[4*m+3]*v),g[(b=4*m)+0]=Math.round(y),g[b+1]=Math.round(x),g[b+2]=Math.round(w),g[b+3]=Math.round(E);return t!=null&&(t.width=i,t.height=o,C=t.getContext("2d"),_=new ImageData(g,i,o),C.putImageData(_,0,0)),n!==e&&n.dispose(),[2,g]}})})},fromPixels:lP}),cP=function(){function e(){}return e.prototype.getClassName=function(){return this.constructor.className},e.fromConfig=function(t,n){return new t(n)},e}(),fP=function(){function e(){this.classNameMap={}}return e.getMap=function(){return e.instance==null&&(e.instance=new e),e.instance},e.register=function(t){e.getMap().classNameMap[t.className]=[t,t.fromConfig]},e}();function yi(e){I(e.className!=null,function(){return"Class being registered does not have the static className property defined."}),I(typeof e.className=="string",function(){return"className is required to be a string, but got type "+typeof e.className}),I(e.className.length>0,function(){return"Class being registered has an empty-string as its className, which is disallowed."}),fP.register(e)}var xi=function(e){function t(){return e!==null&&e.apply(this,arguments)||this}return lr(t,e),t.prototype.minimize=function(n,r,o){r===void 0&&(r=!1);var i=this.computeGradients(n,o),a=i.value,s=i.grads;if(o!=null){var u=o.map(function(l){return{name:l.name,tensor:s[l.name]}});this.applyGradients(u)}else this.applyGradients(s);return vn(s),r?a:(a.dispose(),null)},Object.defineProperty(t.prototype,"iterations",{get:function(){return this.iterations_==null&&(this.iterations_=0),this.iterations_},enumerable:!0,configurable:!0}),t.prototype.incrementIterations=function(){this.iterations_=this.iterations+1},t.prototype.computeGradients=function(n,r){return bI(n,r)},t.prototype.dispose=function(){this.iterations_!=null&&vn(this.iterations_)},t.prototype.saveIterations=function(){return se(this,void 0,void 0,function(){return ue(this,function(n){return this.iterations_==null&&(this.iterations_=0),[2,{name:"iter",tensor:ne(this.iterations_,"int32")}]})})},t.prototype.getWeights=function(){return se(this,void 0,void 0,function(){return ue(this,function(n){throw new Error("getWeights() is not implemented for this optimizer yet.")})})},t.prototype.setWeights=function(n){return se(this,void 0,void 0,function(){return ue(this,function(r){throw new Error("setWeights() is not implemented for this optimizer class "+this.getClassName())})})},t.prototype.extractIterations=function(n){return se(this,void 0,void 0,function(){var r;return ue(this,function(o){switch(o.label){case 0:return r=this,[4,n[0].tensor.data()];case 1:return r.iterations_=o.sent()[0],[2,n.slice(1)]}})})},t}(cP);Object.defineProperty(xi,Symbol.hasInstance,{value:function(e){return e.minimize!=null&&e.computeGradients!=null&&e.applyGradients!=null}});var dP=function(e){function t(n,r,o){o===void 0&&(o=null);var i=e.call(this)||this;return i.learningRate=n,i.rho=r,i.epsilon=o,i.accumulatedGrads=[],i.accumulatedUpdates=[],o==null&&(i.epsilon=P.backend.epsilon()),i}return lr(t,e),t.prototype.applyGradients=function(n){var r=this;(Array.isArray(n)?n.map(function(o){return o.name}):Object.keys(n)).forEach(function(o,i){var a=P.registeredVariables[o];r.accumulatedGrads[i]==null&&(r.accumulatedGrads[i]={originalName:o+"/accum_grad",variable:oe(function(){return Le(a).variable(!1)})}),r.accumulatedUpdates[i]==null&&(r.accumulatedUpdates[i]={originalName:o+"/accum_var",variable:oe(function(){return Le(a).variable(!1)})});var s=Array.isArray(n)?n[i].tensor:n[o];if(s!=null){var u=r.accumulatedGrads[i].variable,l=r.accumulatedUpdates[i].variable;oe(function(){var c=u.mul(r.rho).add(s.square().mul(1-r.rho)),f=l.add(r.epsilon).sqrt().div(u.add(r.epsilon).sqrt()).mul(s),d=l.mul(r.rho).add(f.square().mul(1-r.rho));u.assign(c),l.assign(d);var h=f.mul(-r.learningRate).add(a);a.assign(h)})}}),this.incrementIterations()},t.prototype.dispose=function(){this.accumulatedUpdates!=null&&(vn(this.accumulatedGrads.map(function(n){return n.variable})),vn(this.accumulatedUpdates.map(function(n){return n.variable})))},t.prototype.getWeights=function(){return se(this,void 0,void 0,function(){var n;return ue(this,function(r){switch(r.label){case 0:return n=this.accumulatedGrads.concat(this.accumulatedUpdates),[4,this.saveIterations()];case 1:return[2,[r.sent()].concat(n.map(function(o){return{name:o.originalName,tensor:o.variable}}))]}})})},t.prototype.setWeights=function(n){return se(this,void 0,void 0,function(){var r;return ue(this,function(o){switch(o.label){case 0:return[4,this.extractIterations(n)];case 1:return n=o.sent(),r=n.length/2,this.accumulatedGrads=n.slice(0,r).map(function(i){return{originalName:i.name,variable:i.tensor.variable(!1)}}),this.accumulatedUpdates=n.slice(r,2*r).map(function(i){return{originalName:i.name,variable:i.tensor.variable(!1)}}),[2]}})})},t.prototype.getConfig=function(){return{learningRate:this.learningRate,rho:this.rho,epsilon:this.epsilon}},t.fromConfig=function(n,r){return new n(r.learningRate,r.rho,r.epsilon)},t.className="Adadelta",t}(xi);yi(dP);var hP=function(e){function t(n,r){r===void 0&&(r=.1);var o=e.call(this)||this;return o.learningRate=n,o.initialAccumulatorValue=r,o.accumulatedGrads=[],o}return lr(t,e),t.prototype.applyGradients=function(n){var r=this;(Array.isArray(n)?n.map(function(o){return o.name}):Object.keys(n)).forEach(function(o,i){var a=P.registeredVariables[o];r.accumulatedGrads[i]==null&&(r.accumulatedGrads[i]={originalName:o+"/accumulator",variable:oe(function(){return kr(a.shape,r.initialAccumulatorValue).variable(!1)})});var s=Array.isArray(n)?n[i].tensor:n[o];if(s!=null){var u=r.accumulatedGrads[i].variable;oe(function(){var l=u.add(s.square());u.assign(l);var c=s.div(l.add(P.backend.epsilon()).sqrt()).mul(-r.learningRate).add(a);a.assign(c)})}}),this.incrementIterations()},t.prototype.dispose=function(){this.accumulatedGrads!=null&&vn(this.accumulatedGrads.map(function(n){return n.variable}))},t.prototype.getWeights=function(){return se(this,void 0,void 0,function(){return ue(this,function(n){switch(n.label){case 0:return[4,this.saveIterations()];case 1:return[2,[n.sent()].concat(this.accumulatedGrads.map(function(r){return{name:r.originalName,tensor:r.variable}}))]}})})},t.prototype.setWeights=function(n){return se(this,void 0,void 0,function(){return ue(this,function(r){switch(r.label){case 0:return[4,this.extractIterations(n)];case 1:return n=r.sent(),this.accumulatedGrads=n.map(function(o){return{originalName:o.name,variable:o.tensor.variable(!1)}}),[2]}})})},t.prototype.getConfig=function(){return{learningRate:this.learningRate,initialAccumulatorValue:this.initialAccumulatorValue}},t.fromConfig=function(n,r){return new n(r.learningRate,r.initialAccumulatorValue)},t.className="Adagrad",t}(xi);yi(hP);var pP=function(e){function t(n,r,o,i){i===void 0&&(i=null);var a=e.call(this)||this;return a.learningRate=n,a.beta1=r,a.beta2=o,a.epsilon=i,a.accumulatedFirstMoment=[],a.accumulatedSecondMoment=[],oe(function(){a.accBeta1=ne(r).variable(),a.accBeta2=ne(o).variable()}),i==null&&(a.epsilon=P.backend.epsilon()),a}return lr(t,e),t.prototype.applyGradients=function(n){var r=this,o=Array.isArray(n)?n.map(function(i){return i.name}):Object.keys(n);oe(function(){var i=It(1,r.accBeta1),a=It(1,r.accBeta2);o.forEach(function(s,u){var l=P.registeredVariables[s];r.accumulatedFirstMoment[u]==null&&(r.accumulatedFirstMoment[u]={originalName:s+"/m",variable:oe(function(){return Le(l).variable(!1)})}),r.accumulatedSecondMoment[u]==null&&(r.accumulatedSecondMoment[u]={originalName:s+"/v",variable:oe(function(){return Le(l).variable(!1)})});var c=Array.isArray(n)?n[u].tensor:n[s];if(c!=null){var f=r.accumulatedFirstMoment[u].variable,d=r.accumulatedSecondMoment[u].variable,h=f.mul(r.beta1).add(c.mul(1-r.beta1)),p=d.mul(r.beta2).add(c.square().mul(1-r.beta2)),v=h.div(i),g=p.div(a);f.assign(h),d.assign(p);var m=v.div(g.sqrt().add(r.epsilon)).mul(-r.learningRate).add(l);l.assign(m)}}),r.accBeta1.assign(r.accBeta1.mul(r.beta1)),r.accBeta2.assign(r.accBeta2.mul(r.beta2))}),this.incrementIterations()},t.prototype.dispose=function(){this.accBeta1.dispose(),this.accBeta2.dispose(),this.accumulatedFirstMoment!=null&&vn(this.accumulatedFirstMoment.map(function(n){return n.variable})),this.accumulatedSecondMoment!=null&&vn(this.accumulatedSecondMoment.map(function(n){return n.variable}))},t.prototype.getWeights=function(){return se(this,void 0,void 0,function(){var n;return ue(this,function(r){switch(r.label){case 0:return n=this.accumulatedFirstMoment.concat(this.accumulatedSecondMoment),[4,this.saveIterations()];case 1:return[2,[r.sent()].concat(n.map(function(o){return{name:o.originalName,tensor:o.variable}}))]}})})},t.prototype.setWeights=function(n){return se(this,void 0,void 0,function(){var r,o=this;return ue(this,function(i){switch(i.label){case 0:return[4,this.extractIterations(n)];case 1:return n=i.sent(),oe(function(){o.accBeta1.assign(Xl(o.beta1,o.iterations_+1)),o.accBeta2.assign(Xl(o.beta2,o.iterations_+1))}),r=n.length/2,this.accumulatedFirstMoment=n.slice(0,r).map(function(a){return{originalName:a.name,variable:a.tensor.variable(!1)}}),this.accumulatedSecondMoment=n.slice(r,2*r).map(function(a){return{originalName:a.name,variable:a.tensor.variable(!1)}}),[2]}})})},t.prototype.getConfig=function(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon}},t.fromConfig=function(n,r){return new n(r.learningRate,r.beta1,r.beta2,r.epsilon)},t.className="Adam",t}(xi);yi(pP);var vP=function(e){function t(n,r,o,i,a){i===void 0&&(i=null),a===void 0&&(a=0);var s=e.call(this)||this;return s.learningRate=n,s.beta1=r,s.beta2=o,s.epsilon=i,s.decay=a,s.accumulatedFirstMoment=[],s.accumulatedWeightedInfNorm=[],oe(function(){s.iteration=ne(0).variable(),s.accBeta1=ne(r).variable()}),i==null&&(s.epsilon=P.backend.epsilon()),s}return lr(t,e),t.prototype.applyGradients=function(n){var r=this,o=Array.isArray(n)?n.map(function(i){return i.name}):Object.keys(n);oe(function(){var i=It(1,r.accBeta1),a=tr(-r.learningRate,r.iteration.mul(r.decay).add(1));o.forEach(function(s,u){var l=P.registeredVariables[s];r.accumulatedFirstMoment[u]==null&&(r.accumulatedFirstMoment[u]={originalName:s+"/m",variable:Le(l).variable(!1)}),r.accumulatedWeightedInfNorm[u]==null&&(r.accumulatedWeightedInfNorm[u]={originalName:s+"/v",variable:Le(l).variable(!1)});var c=Array.isArray(n)?n[u].tensor:n[s];if(c!=null){var f=r.accumulatedFirstMoment[u].variable,d=r.accumulatedWeightedInfNorm[u].variable,h=f.mul(r.beta1).add(c.mul(1-r.beta1)),p=d.mul(r.beta2),v=c.abs(),g=p.maximum(v);f.assign(h),d.assign(g);var m=a.div(i).mul(h.div(g.add(r.epsilon))).add(l);l.assign(m)}}),r.iteration.assign(r.iteration.add(1)),r.accBeta1.assign(r.accBeta1.mul(r.beta1))}),this.incrementIterations()},t.prototype.dispose=function(){this.accBeta1.dispose(),this.iteration.dispose(),this.accumulatedFirstMoment!=null&&vn(this.accumulatedFirstMoment.map(function(n){return n.variable})),this.accumulatedWeightedInfNorm!=null&&vn(this.accumulatedWeightedInfNorm.map(function(n){return n.variable}))},t.prototype.getWeights=function(){return se(this,void 0,void 0,function(){return ue(this,function(n){throw new Error("getWeights() is not implemented for Adamax yet.")})})},t.prototype.setWeights=function(n){return se(this,void 0,void 0,function(){return ue(this,function(r){throw new Error("setWeights() is not implemented for Adamax yet.")})})},t.prototype.getConfig=function(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon,decay:this.decay}},t.fromConfig=function(n,r){return new n(r.learningRate,r.beta1,r.beta2,r.epsilon,r.decay)},t.className="Adamax",t}(xi);yi(vP);var db=function(e){function t(n){var r=e.call(this)||this;return r.learningRate=n,r.setLearningRate(n),r}return lr(t,e),t.prototype.applyGradients=function(n){var r=this;(Array.isArray(n)?n.map(function(o){return o.name}):Object.keys(n)).forEach(function(o,i){var a=Array.isArray(n)?n[i].tensor:n[o];if(a!=null){var s=P.registeredVariables[o];oe(function(){var u=r.c.mul(a).add(s);s.assign(u)})}}),this.incrementIterations()},t.prototype.setLearningRate=function(n){this.learningRate=n,this.c!=null&&this.c.dispose(),this.c=Mk(ne(-n))},t.prototype.dispose=function(){this.c.dispose()},t.prototype.getWeights=function(){return se(this,void 0,void 0,function(){return ue(this,function(n){switch(n.label){case 0:return[4,this.saveIterations()];case 1:return[2,[n.sent()]]}})})},t.prototype.setWeights=function(n){return se(this,void 0,void 0,function(){return ue(this,function(r){switch(r.label){case 0:return[4,this.extractIterations(n)];case 1:if((n=r.sent()).length!==0)throw new Error("SGD optimizer does not have settable weights.");return[2]}})})},t.prototype.getConfig=function(){return{learningRate:this.learningRate}},t.fromConfig=function(n,r){return new n(r.learningRate)},t.className="SGD",t}(xi);yi(db);var mP=function(e){function t(n,r,o){o===void 0&&(o=!1);var i=e.call(this,n)||this;return i.learningRate=n,i.momentum=r,i.useNesterov=o,i.accumulations=[],i.m=ne(i.momentum),i}return lr(t,e),t.prototype.applyGradients=function(n){var r=this;(Array.isArray(n)?n.map(function(o){return o.name}):Object.keys(n)).forEach(function(o,i){var a=P.registeredVariables[o];r.accumulations[i]==null&&(r.accumulations[i]={originalName:o+"/momentum",variable:oe(function(){return Le(a).variable(!1)})});var s=r.accumulations[i].variable,u=Array.isArray(n)?n[i].tensor:n[o];u!=null&&oe(function(){var l,c=r.m.mul(s).add(u);l=r.useNesterov?r.c.mul(u.add(c.mul(r.m))).add(a):r.c.mul(c).add(a),s.assign(c),a.assign(l)})}),this.incrementIterations()},t.prototype.dispose=function(){this.m.dispose(),this.accumulations!=null&&vn(this.accumulations.map(function(n){return n.variable}))},t.prototype.setMomentum=function(n){this.momentum=n},t.prototype.getWeights=function(){return se(this,void 0,void 0,function(){return ue(this,function(n){switch(n.label){case 0:return[4,this.saveIterations()];case 1:return[2,[n.sent()].concat(this.accumulations.map(function(r){return{name:r.originalName,tensor:r.variable}}))]}})})},t.prototype.setWeights=function(n){return se(this,void 0,void 0,function(){return ue(this,function(r){switch(r.label){case 0:return[4,this.extractIterations(n)];case 1:return n=r.sent(),this.accumulations=n.map(function(o){return{originalName:o.name,variable:o.tensor.variable(!1)}}),[2]}})})},t.prototype.getConfig=function(){return{learningRate:this.learningRate,momentum:this.momentum,useNesterov:this.useNesterov}},t.fromConfig=function(n,r){return new n(r.learningRate,r.momentum,r.useNesterov)},t.className="Momentum",t}(db);yi(mP);var gP=function(e){function t(n,r,o,i,a){r===void 0&&(r=.9),o===void 0&&(o=0),i===void 0&&(i=null),a===void 0&&(a=!1);var s=e.call(this)||this;if(s.learningRate=n,s.decay=r,s.momentum=o,s.epsilon=i,s.accumulatedMeanSquares=[],s.accumulatedMoments=[],s.accumulatedMeanGrads=[],s.centered=a,i==null&&(s.epsilon=P.backend.epsilon()),n==null)throw new Error("learningRate for RMSPropOptimizer must be defined.");return s}return lr(t,e),t.prototype.applyGradients=function(n){var r=this;(Array.isArray(n)?n.map(function(o){return o.name}):Object.keys(n)).forEach(function(o,i){var a=P.registeredVariables[o];r.accumulatedMeanSquares[i]==null&&(r.accumulatedMeanSquares[i]={originalName:o+"/rms",variable:oe(function(){return Le(a).variable(!1)})}),r.accumulatedMoments[i]==null&&(r.accumulatedMoments[i]={originalName:o+"/momentum",variable:oe(function(){return Le(a).variable(!1)})}),r.accumulatedMeanGrads[i]==null&&r.centered&&(r.accumulatedMeanGrads[i]={originalName:o+"/mg",variable:oe(function(){return Le(a).variable(!1)})});var s=Array.isArray(n)?n[i].tensor:n[o];if(s!=null){var u=r.accumulatedMeanSquares[i].variable,l=r.accumulatedMoments[i].variable;oe(function(){var c=u.mul(r.decay).add(s.square().mul(1-r.decay));if(r.centered){var f=r.accumulatedMeanGrads[i].variable,d=f.mul(r.decay).add(s.mul(1-r.decay)),h=l.mul(r.momentum).add(s.mul(r.learningRate).div(c.sub(d.square().add(r.epsilon)).sqrt()));u.assign(c),f.assign(d),l.assign(h);var p=a.sub(h);a.assign(p)}else{var v=u.mul(r.decay).add(s.square().mul(1-r.decay));h=l.mul(r.momentum).add(s.mul(r.learningRate).div(v.add(r.epsilon).sqrt())),u.assign(v),l.assign(h),p=a.sub(h),a.assign(p)}})}}),this.incrementIterations()},t.prototype.dispose=function(){this.accumulatedMeanSquares!=null&&vn(this.accumulatedMeanSquares.map(function(n){return n.variable})),this.accumulatedMeanGrads!=null&&this.centered&&vn(this.accumulatedMeanGrads.map(function(n){return n.variable})),this.accumulatedMoments!=null&&vn(this.accumulatedMoments.map(function(n){return n.variable}))},t.prototype.getWeights=function(){return se(this,void 0,void 0,function(){var n;return ue(this,function(r){switch(r.label){case 0:return n=this.accumulatedMeanSquares.concat(this.accumulatedMoments),this.centered&&n.push.apply(n,this.accumulatedMeanGrads),[4,this.saveIterations()];case 1:return[2,[r.sent()].concat(n.map(function(o){return{name:o.originalName,tensor:o.variable}}))]}})})},t.prototype.setWeights=function(n){return se(this,void 0,void 0,function(){var r;return ue(this,function(o){switch(o.label){case 0:return[4,this.extractIterations(n)];case 1:return n=o.sent(),r=this.centered?n.length/3:n.length/2,this.accumulatedMeanSquares=n.slice(0,r).map(function(i){return{originalName:i.name,variable:i.tensor.variable(!1)}}),this.accumulatedMoments=n.slice(r,2*r).map(function(i){return{originalName:i.name,variable:i.tensor.variable(!1)}}),this.centered&&(this.accumulatedMeanGrads=n.slice(2*r,3*r).map(function(i){return{originalName:i.name,variable:i.tensor.variable(!1)}})),[2]}})})},t.prototype.getConfig=function(){return{learningRate:this.learningRate,decay:this.decay,momentum:this.momentum,epsilon:this.epsilon,centered:this.centered}},t.fromConfig=function(n,r){return new n(r.learningRate,r.decay,r.momentum,r.epsilon,r.centered)},t.className="RMSProp",t}(xi);yi(gP);st.prototype.squaredDifference=function(e){return kw(this,e)},j=VA;/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var bh=function(e,t){return bh=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var o in r)r.hasOwnProperty(o)&&(n[o]=r[o])},bh(e,t)};function be(e,t){bh(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}var Kt=function(){return Kt=Object.assign||function(t){for(var n,r=1,o=arguments.length;r<o;r++){n=arguments[r];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},Kt.apply(this,arguments)};function fe(e,t,n,r){function o(i){return i instanceof n?i:new n(function(a){a(i)})}return new(n||(n=Promise))(function(i,a){function s(c){try{l(r.next(c))}catch(f){a(f)}}function u(c){try{l(r.throw(c))}catch(f){a(f)}}function l(c){c.done?i(c.value):o(c.value).then(s,u)}l((r=r.apply(e,[])).next())})}function de(e,t){var n={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},r,o,i,a;return a={next:s(0),throw:s(1),return:s(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function s(l){return function(c){return u([l,c])}}function u(l){if(r)throw new TypeError("Generator is already executing.");for(;n;)try{if(r=1,o&&(i=l[0]&2?o.return:l[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,l[1])).done)return i;switch(o=0,i&&(l=[l[0]&2,i.value]),l[0]){case 0:case 1:i=l;break;case 4:return n.label++,{value:l[1],done:!1};case 5:n.label++,o=l[1],l=[0];continue;case 7:l=n.ops.pop(),n.trys.pop();continue;default:if(i=n.trys,!(i=i.length>0&&i[i.length-1])&&(l[0]===6||l[0]===2)){n=0;continue}if(l[0]===3&&(!i||l[1]>i[0]&&l[1]<i[3])){n.label=l[1];break}if(l[0]===6&&n.label<i[1]){n.label=i[1],i=l;break}if(i&&n.label<i[2]){n.label=i[2],n.ops.push(l);break}i[2]&&n.ops.pop(),n.trys.pop();continue}l=t.call(e,n)}catch(c){l=[6,c],o=0}finally{r=i=0}if(l[0]&5)throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}}function ls(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;for(var r=Array(e),o=0,t=0;t<n;t++)for(var i=arguments[t],a=0,s=i.length;a<s;a++,o++)r[o]=i[a];return r}var ua=function(){function e(t,n){if(!ti(t)||!ti(n))throw new Error("Dimensions.constructor - expected width and height to be valid numbers, instead have "+JSON.stringify({width:t,height:n}));this._width=t,this._height=n}return Object.defineProperty(e.prototype,"width",{get:function(){return this._width},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return this._height},enumerable:!0,configurable:!0}),e.prototype.reverse=function(){return new e(1/this.width,1/this.height)},e}();function Oc(e,t){return e instanceof st&&e.shape.length===t}function yP(e){return Oc(e,2)}function Lc(e){return Oc(e,3)}function Ro(e){return Oc(e,4)}function xP(e){return e%1!==0}function Cy(e){return e%2===0}function wP(e,t){t===void 0&&(t=2);var n=Math.pow(10,t);return Math.floor(e*n)/n}function _y(e){return e&&e.width&&e.height}function bP(e,t){var n=e.width,r=e.height,o=t/Math.max(r,n);return new ua(Math.round(n*o),Math.round(r*o))}function av(e){return e.reduce(function(t,n){return t.add(n)},new We(0,0)).div(new We(e.length,e.length))}function Os(e,t,n){return Array(e).fill(0).map(function(r,o){return t+o*n})}function ti(e){return!!e&&e!==1/0&&e!==-1/0&&!isNaN(e)||e===0}function Sy(e){return ti(e)&&0<=e&&e<=1}var We=function(){function e(t,n){this._x=t,this._y=n}return Object.defineProperty(e.prototype,"x",{get:function(){return this._x},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"y",{get:function(){return this._y},enumerable:!0,configurable:!0}),e.prototype.add=function(t){return new e(this.x+t.x,this.y+t.y)},e.prototype.sub=function(t){return new e(this.x-t.x,this.y-t.y)},e.prototype.mul=function(t){return new e(this.x*t.x,this.y*t.y)},e.prototype.div=function(t){return new e(this.x/t.x,this.y/t.y)},e.prototype.abs=function(){return new e(Math.abs(this.x),Math.abs(this.y))},e.prototype.magnitude=function(){return Math.sqrt(Math.pow(this.x,2)+Math.pow(this.y,2))},e.prototype.floor=function(){return new e(Math.floor(this.x),Math.floor(this.y))},e}(),To=function(){function e(t,n){n===void 0&&(n=!0);var r=t||{},o=[r.left,r.top,r.right,r.bottom].every(ti),i=[r.x,r.y,r.width,r.height].every(ti);if(!i&&!o)throw new Error("Box.constructor - expected box to be IBoundingBox | IRect, instead have "+JSON.stringify(r));var a=i?[r.x,r.y,r.width,r.height]:[r.left,r.top,r.right-r.left,r.bottom-r.top],s=a[0],u=a[1],l=a[2],c=a[3];e.assertIsValidBox({x:s,y:u,width:l,height:c},"Box.constructor",n),this._x=s,this._y=u,this._width=l,this._height=c}return e.isRect=function(t){return!!t&&[t.x,t.y,t.width,t.height].every(ti)},e.assertIsValidBox=function(t,n,r){if(r===void 0&&(r=!1),!e.isRect(t))throw new Error(n+" - invalid box: "+JSON.stringify(t)+", expected object with properties x, y, width, height");if(!r&&(t.width<0||t.height<0))throw new Error(n+" - width ("+t.width+") and height ("+t.height+") must be positive numbers")},Object.defineProperty(e.prototype,"x",{get:function(){return this._x},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"y",{get:function(){return this._y},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"width",{get:function(){return this._width},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return this._height},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"left",{get:function(){return this.x},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"top",{get:function(){return this.y},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"right",{get:function(){return this.x+this.width},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bottom",{get:function(){return this.y+this.height},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"area",{get:function(){return this.width*this.height},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"topLeft",{get:function(){return new We(this.left,this.top)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"topRight",{get:function(){return new We(this.right,this.top)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bottomLeft",{get:function(){return new We(this.left,this.bottom)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bottomRight",{get:function(){return new We(this.right,this.bottom)},enumerable:!0,configurable:!0}),e.prototype.round=function(){var t=[this.x,this.y,this.width,this.height].map(function(a){return Math.round(a)}),n=t[0],r=t[1],o=t[2],i=t[3];return new e({x:n,y:r,width:o,height:i})},e.prototype.floor=function(){var t=[this.x,this.y,this.width,this.height].map(function(a){return Math.floor(a)}),n=t[0],r=t[1],o=t[2],i=t[3];return new e({x:n,y:r,width:o,height:i})},e.prototype.toSquare=function(){var t=this,n=t.x,r=t.y,o=t.width,i=t.height,a=Math.abs(o-i);return o<i&&(n-=a/2,o+=a),i<o&&(r-=a/2,i+=a),new e({x:n,y:r,width:o,height:i})},e.prototype.rescale=function(t){var n=_y(t)?t.width:t,r=_y(t)?t.height:t;return new e({x:this.x*n,y:this.y*r,width:this.width*n,height:this.height*r})},e.prototype.pad=function(t,n){var r=[this.x-t/2,this.y-n/2,this.width+t,this.height+n],o=r[0],i=r[1],a=r[2],s=r[3];return new e({x:o,y:i,width:a,height:s})},e.prototype.clipAtImageBorders=function(t,n){var r=this,o=r.x,i=r.y,a=r.right,s=r.bottom,u=Math.max(o,0),l=Math.max(i,0),c=a-u,f=s-l,d=Math.min(c,t-u),h=Math.min(f,n-l);return new e({x:u,y:l,width:d,height:h}).floor()},e.prototype.shift=function(t,n){var r=this,o=r.width,i=r.height,a=this.x+t,s=this.y+n;return new e({x:a,y:s,width:o,height:i})},e.prototype.padAtBorders=function(t,n){var r=this.width+1,o=this.height+1,i=1,a=1,s=r,u=o,l=this.left,c=this.top,f=this.right,d=this.bottom;return f>n&&(s=-f+n+r,f=n),d>t&&(u=-d+t+o,d=t),l<1&&(u=2-l,l=1),c<1&&(u=2-c,c=1),{dy:a,edy:u,dx:i,edx:s,y:c,ey:d,x:l,ex:f,w:r,h:o}},e.prototype.calibrate=function(t){return new e({left:this.left+t.left*this.width,top:this.top+t.top*this.height,right:this.right+t.right*this.width,bottom:this.bottom+t.bottom*this.height}).toSquare().round()},e}(),Bc=function(e){be(t,e);function t(n,r,o,i,a){return a===void 0&&(a=!1),e.call(this,{left:n,top:r,right:o,bottom:i},a)||this}return t}(To),hb=function(){function e(t,n,r,o,i){this._imageDims=new ua(i.width,i.height),this._score=t,this._classScore=n,this._className=r,this._box=new To(o).rescale(this._imageDims)}return Object.defineProperty(e.prototype,"score",{get:function(){return this._score},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"classScore",{get:function(){return this._classScore},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"className",{get:function(){return this._className},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"box",{get:function(){return this._box},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"imageDims",{get:function(){return this._imageDims},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"imageWidth",{get:function(){return this.imageDims.width},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"imageHeight",{get:function(){return this.imageDims.height},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"relativeBox",{get:function(){return new To(this._box).rescale(this.imageDims.reverse())},enumerable:!0,configurable:!0}),e.prototype.forSize=function(t,n){return new e(this.score,this.classScore,this.className,this.relativeBox,{width:t,height:n})},e}(),Ar=function(e){be(t,e);function t(n,r,o){return e.call(this,n,n,"",r,o)||this}return t.prototype.forSize=function(n,r){var o=e.prototype.forSize.call(this,n,r),i=o.score,a=o.relativeBox,s=o.imageDims;return new t(i,a,s)},t}(hb);function EP(e,t,n){n===void 0&&(n=!0);var r=Math.max(0,Math.min(e.right,t.right)-Math.max(e.left,t.left)),o=Math.max(0,Math.min(e.bottom,t.bottom)-Math.max(e.top,t.top)),i=r*o;return n?i/(e.area+t.area-i):i/Math.min(e.area,t.area)}function CP(e){var t=e.map(function(s){return s.x}),n=e.map(function(s){return s.y}),r=t.reduce(function(s,u){return u<s?u:s},1/0),o=n.reduce(function(s,u){return u<s?u:s},1/0),i=t.reduce(function(s,u){return s<u?u:s},0),a=n.reduce(function(s,u){return s<u?u:s},0);return new Bc(r,o,i,a)}function Ls(e,t,n,r){r===void 0&&(r=!0);for(var o=t.map(function(s,u){return{score:s,boxIndex:u}}).sort(function(s,u){return s.score-u.score}).map(function(s){return s.boxIndex}),i=[],a=function(){var s=o.pop();i.push(s);for(var u=o,l=[],c=0;c<u.length;c++){var f=u[c],d=e[s],h=e[f];l.push(EP(d,h,r))}o=o.filter(function(p,v){return l[v]<=n})};o.length>0;)a();return i}function eu(e,t){return oe(function(){var n=t[0],r=t[1],o=t[2],i=kr(ls(e.shape.slice(0,3),[1]),n),a=kr(ls(e.shape.slice(0,3),[1]),r),s=kr(ls(e.shape.slice(0,3),[1]),o),u=St([i,a,s],3);return It(e,u)})}function _P(e,t){return t===void 0&&(t=!1),oe(function(){var n=e.shape.slice(1),r=n[0],o=n[1];if(r===o)return e;var i=Math.abs(r-o),a=Math.round(i*(t?.5:1)),s=r>o?2:1,u=function(h){var p=e.shape.slice();return p[s]=h,kr(p,0)},l=u(a),c=i-l.shape[s],f=t&&c?u(c):null,d=[f,e,l].filter(function(h){return!!h}).map(function(h){return h.toFloat()});return St(d,s)})}function Yf(e){return 1/(1+Math.exp(-e))}var sv=function(e){be(t,e);function t(n,r,o,i,a){return a===void 0&&(a=!1),e.call(this,{x:n,y:r,width:o,height:i},a)||this}return t}(To),SP=.5,RP=.43,kP=.45,Jl=function(){function e(t,n,r){r===void 0&&(r=new We(0,0));var o=n.width,i=n.height;this._imgDims=new ua(o,i),this._shift=r,this._positions=t.map(function(a){return a.mul(new We(o,i)).add(r)})}return Object.defineProperty(e.prototype,"shift",{get:function(){return new We(this._shift.x,this._shift.y)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"imageWidth",{get:function(){return this._imgDims.width},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"imageHeight",{get:function(){return this._imgDims.height},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"positions",{get:function(){return this._positions},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"relativePositions",{get:function(){var t=this;return this._positions.map(function(n){return n.sub(t._shift).div(new We(t.imageWidth,t.imageHeight))})},enumerable:!0,configurable:!0}),e.prototype.forSize=function(t,n){return new this.constructor(this.relativePositions,{width:t,height:n})},e.prototype.shiftBy=function(t,n){return new this.constructor(this.relativePositions,this._imgDims,new We(t,n))},e.prototype.shiftByPoint=function(t){return this.shiftBy(t.x,t.y)},e.prototype.align=function(t,n){if(n===void 0&&(n={}),t){var r=t instanceof Ar?t.box.floor():new To(t);return this.shiftBy(r.x,r.y).align(null,n)}var o=Object.assign({},{useDlibAlignment:!1,minBoxPadding:.2},n),i=o.useDlibAlignment,a=o.minBoxPadding;return i?this.alignDlib():this.alignMinBbox(a)},e.prototype.alignDlib=function(){var t=this.getRefPointsForAlignment(),n=t[0],r=t[1],o=t[2],i=function(f){return o.sub(f).magnitude()},a=(i(n)+i(r))/2,s=Math.floor(a/kP),u=av(t),l=Math.floor(Math.max(0,u.x-SP*s)),c=Math.floor(Math.max(0,u.y-RP*s));return new sv(l,c,Math.min(s,this.imageWidth+l),Math.min(s,this.imageHeight+c))},e.prototype.alignMinBbox=function(t){var n=CP(this.positions);return n.pad(n.width*t,n.height*t)},e.prototype.getRefPointsForAlignment=function(){throw new Error("getRefPointsForAlignment not implemented by base class")},e}(),IP=function(e){be(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.getRefPointsForAlignment=function(){var n=this.positions;return[n[0],n[1],av([n[3],n[4]])]},t}(Jl),DP=function(e){be(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.getJawOutline=function(){return this.positions.slice(0,17)},t.prototype.getLeftEyeBrow=function(){return this.positions.slice(17,22)},t.prototype.getRightEyeBrow=function(){return this.positions.slice(22,27)},t.prototype.getNose=function(){return this.positions.slice(27,36)},t.prototype.getLeftEye=function(){return this.positions.slice(36,42)},t.prototype.getRightEye=function(){return this.positions.slice(42,48)},t.prototype.getMouth=function(){return this.positions.slice(48,68)},t.prototype.getRefPointsForAlignment=function(){return[this.getLeftEye(),this.getRightEye(),this.getMouth()].map(av)},t}(Jl),Ry=function(){function e(t,n){this._label=t,this._distance=n}return Object.defineProperty(e.prototype,"label",{get:function(){return this._label},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"distance",{get:function(){return this._distance},enumerable:!0,configurable:!0}),e.prototype.toString=function(t){return t===void 0&&(t=!0),""+this.label+(t?" ("+wP(this.distance)+")":"")},e}(),ky=function(e){be(t,e);function t(n,r){var o=e.call(this,n)||this;return o._label=r,o}return t.assertIsValidLabeledBox=function(n,r){if(To.assertIsValidBox(n,r),!ti(n.label))throw new Error(r+" - expected property label ("+n.label+") to be a number")},Object.defineProperty(t.prototype,"label",{get:function(){return this._label},enumerable:!0,configurable:!0}),t}(To),Ou=function(){function e(t,n){if(typeof t!="string")throw new Error("LabeledFaceDescriptors - constructor expected label to be a string");if(!Array.isArray(n)||n.some(function(r){return!(r instanceof Float32Array)}))throw new Error("LabeledFaceDescriptors - constructor expected descriptors to be an array of Float32Array");this._label=t,this._descriptors=n}return Object.defineProperty(e.prototype,"label",{get:function(){return this._label},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"descriptors",{get:function(){return this._descriptors},enumerable:!0,configurable:!0}),e.prototype.toJSON=function(){return{label:this.label,descriptors:this.descriptors.map(function(t){return Array.from(t)})}},e.fromJSON=function(t){var n=t.descriptors.map(function(r){return new Float32Array(r)});return new e(t.label,n)},e}();(function(e){be(t,e);function t(n,r,o,i){var a=e.call(this,n,r)||this;return a._score=o,a._classScore=i,a}return t.assertIsValidPredictedBox=function(n,r){if(ky.assertIsValidLabeledBox(n,r),!Sy(n.score)||!Sy(n.classScore))throw new Error(r+" - expected properties score ("+n.score+") and ("+n.classScore+") to be a number between [0, 1]")},Object.defineProperty(t.prototype,"score",{get:function(){return this._score},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"classScore",{get:function(){return this._classScore},enumerable:!0,configurable:!0}),t})(ky);function TP(e){return e.detection instanceof Ar}function uv(e,t){var n={detection:t};return Object.assign({},e,n)}function pb(){var e=window.fetch||function(){throw new Error("fetch - missing fetch implementation for browser environment")},t=function(){throw new Error("readFile - filesystem not available for browser environment")};return{Canvas:HTMLCanvasElement,CanvasRenderingContext2D,Image:HTMLImageElement,ImageData,Video:HTMLVideoElement,createCanvasElement:function(){return document.createElement("canvas")},createImageElement:function(){return document.createElement("img")},fetch:e,readFile:t}}function vb(e){var t="";if(!e)try{e=require("fs")}catch(r){t=r.toString()}var n=e?function(r){return new Promise(function(o,i){e.readFile(r,function(a,s){return a?i(a):o(s)})})}:function(){throw new Error("readFile - failed to require fs in nodejs environment with error: "+t)};return{readFile:n}}function mb(){var e=global.Canvas||global.HTMLCanvasElement,t=global.Image||global.HTMLImageElement,n=function(){if(e)return new e;throw new Error("createCanvasElement - missing Canvas implementation for nodejs environment")},r=function(){if(t)return new t;throw new Error("createImageElement - missing Image implementation for nodejs environment")},o=global.fetch||function(){throw new Error("fetch - missing fetch implementation for nodejs environment")},i=vb();return Kt({Canvas:e||function(){function a(){}return a}(),CanvasRenderingContext2D:global.CanvasRenderingContext2D||function(){function a(){}return a}(),Image:t||function(){function a(){}return a}(),ImageData:global.ImageData||function(){function a(){}return a}(),Video:global.HTMLVideoElement||function(){function a(){}return a}(),createCanvasElement:n,createImageElement:r,fetch:o},i)}function gb(){return typeof window=="object"&&typeof document<"u"&&typeof HTMLImageElement<"u"&&typeof HTMLCanvasElement<"u"&&typeof HTMLVideoElement<"u"&&typeof ImageData<"u"&&typeof CanvasRenderingContext2D<"u"}function yb(){return typeof global=="object"&&typeof require=="function"&&typeof Yb<"u"&&typeof process<"u"&&!!process.version}var Et;function NP(){if(!Et)throw new Error("getEnv - environment is not defined, check isNodejs() and isBrowser()");return Et}function Eh(e){Et=e}function lv(){gb()&&Eh(pb()),yb()&&Eh(mb())}function AP(e){if(Et||lv(),!Et)throw new Error("monkeyPatch - environment is not defined, check isNodejs() and isBrowser()");var t=e.Canvas,n=t===void 0?Et.Canvas:t,r=e.Image,o=r===void 0?Et.Image:r;Et.Canvas=n,Et.Image=o,Et.createCanvasElement=e.createCanvasElement||function(){return new n},Et.createImageElement=e.createImageElement||function(){return new o},Et.ImageData=e.ImageData||Et.ImageData,Et.Video=e.Video||Et.Video,Et.fetch=e.fetch||Et.fetch,Et.readFile=e.readFile||Et.readFile}var Zt={getEnv:NP,setEnv:Eh,initialize:lv,createBrowserEnv:pb,createFileSystem:vb,createNodejsEnv:mb,monkeyPatch:AP,isBrowser:gb,isNodejs:yb};lv();function xb(e){return!Zt.isNodejs()&&typeof e=="string"?document.getElementById(e):e}function ci(e){var t=Zt.getEnv(),n=t.Canvas,r=t.CanvasRenderingContext2D;if(e instanceof r)return e;var o=xb(e);if(!(o instanceof n))throw new Error("resolveContext2d - expected canvas to be of instance of Canvas");var i=o.getContext("2d");if(!i)throw new Error("resolveContext2d - canvas 2d context is null");return i}var Iy;(function(e){e.TOP_LEFT="TOP_LEFT",e.TOP_RIGHT="TOP_RIGHT",e.BOTTOM_LEFT="BOTTOM_LEFT",e.BOTTOM_RIGHT="BOTTOM_RIGHT"})(Iy||(Iy={}));function wb(e){var t=Zt.getEnv(),n=t.Image,r=t.Video;return e instanceof n&&e.complete||e instanceof r&&e.readyState>=3}function PP(e){return new Promise(function(t,n){if(e instanceof Zt.getEnv().Canvas||wb(e))return t();function r(i){i.currentTarget&&(i.currentTarget.removeEventListener("load",r),i.currentTarget.removeEventListener("error",o),t(i))}function o(i){i.currentTarget&&(i.currentTarget.removeEventListener("load",r),i.currentTarget.removeEventListener("error",o),n(i))}e.addEventListener("load",r),e.addEventListener("error",o)})}function bb(e){var t=Zt.getEnv(),n=t.Image,r=t.Video;return e instanceof n?new ua(e.naturalWidth,e.naturalHeight):e instanceof r?new ua(e.videoWidth,e.videoHeight):new ua(e.width,e.height)}function Uc(e){var t=e.width,n=e.height,r=Zt.getEnv().createCanvasElement,o=r();return o.width=t,o.height=n,o}function cv(e,t){var n=Zt.getEnv().ImageData;if(!(e instanceof n)&&!wb(e))throw new Error("createCanvasFromMedia - media has not finished loading yet");var r=bb(e),o=r.width,i=r.height,a=Uc({width:o,height:i});return e instanceof n?ci(a).putImageData(e,0,0):ci(a).drawImage(e,0,0,o,i),a}function FP(e,t){return fe(this,void 0,void 0,function(){var n,r,o,i,a,s;return de(this,function(u){switch(u.label){case 0:return n=Zt.getEnv().createCanvasElement(),r=e.shape.slice(Ro(e)?1:0),o=r[0],i=r[1],a=r[2],s=oe(function(){return e.as3D(o,i,a).toInt()}),[4,iv.toPixels(s,n)];case 1:return u.sent(),s.dispose(),[2,n]}})})}function Dy(e){var t=Zt.getEnv(),n=t.Image,r=t.Canvas,o=t.Video;return e instanceof n||e instanceof r||e instanceof o}function MP(e,t,n){n===void 0&&(n=!1);var r=Zt.getEnv(),o=r.Image,i=r.Canvas;if(!(e instanceof o||e instanceof i))throw new Error("imageToSquare - expected arg0 to be HTMLImageElement | HTMLCanvasElement");var a=bb(e),s=t/Math.max(a.height,a.width),u=s*a.width,l=s*a.height,c=Uc({width:t,height:t}),f=e instanceof i?e:cv(e),d=Math.abs(u-l)/2,h=n&&u<l?d:0,p=n&&l<u?d:0;return ci(c).drawImage(f,h,p,u,l),c}var Zl=function(){function e(t,n){var r=this;if(n===void 0&&(n=!1),this._imageTensors=[],this._canvases=[],this._treatAsBatchInput=!1,this._inputDimensions=[],!Array.isArray(t))throw new Error("NetInput.constructor - expected inputs to be an Array of TResolvedNetInput or to be instanceof tf.Tensor4D, instead have "+t);this._treatAsBatchInput=n,this._batchSize=t.length,t.forEach(function(o,i){if(Lc(o)){r._imageTensors[i]=o,r._inputDimensions[i]=o.shape;return}if(Ro(o)){var a=o.shape[0];if(a!==1)throw new Error("NetInput - tf.Tensor4D with batchSize "+a+" passed, but not supported in input array");r._imageTensors[i]=o,r._inputDimensions[i]=o.shape.slice(1);return}var s=o instanceof Zt.getEnv().Canvas?o:cv(o);r._canvases[i]=s,r._inputDimensions[i]=[s.height,s.width,3]})}return Object.defineProperty(e.prototype,"imageTensors",{get:function(){return this._imageTensors},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"canvases",{get:function(){return this._canvases},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isBatchInput",{get:function(){return this.batchSize>1||this._treatAsBatchInput},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"batchSize",{get:function(){return this._batchSize},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"inputDimensions",{get:function(){return this._inputDimensions},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"inputSize",{get:function(){return this._inputSize},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"reshapedInputDimensions",{get:function(){var t=this;return Os(this.batchSize,0,1).map(function(n,r){return t.getReshapedInputDimensions(r)})},enumerable:!0,configurable:!0}),e.prototype.getInput=function(t){return this.canvases[t]||this.imageTensors[t]},e.prototype.getInputDimensions=function(t){return this._inputDimensions[t]},e.prototype.getInputHeight=function(t){return this._inputDimensions[t][0]},e.prototype.getInputWidth=function(t){return this._inputDimensions[t][1]},e.prototype.getReshapedInputDimensions=function(t){if(typeof this.inputSize!="number")throw new Error("getReshapedInputDimensions - inputSize not set, toBatchTensor has not been called yet");var n=this.getInputWidth(t),r=this.getInputHeight(t);return bP({width:n,height:r},this.inputSize)},e.prototype.toBatchTensor=function(t,n){var r=this;return n===void 0&&(n=!0),this._inputSize=t,oe(function(){var o=Os(r.batchSize,0,1).map(function(a){var s=r.getInput(a);if(s instanceof st){var u=Ro(s)?s:s.expandDims();return u=_P(u,n),(u.shape[1]!==t||u.shape[2]!==t)&&(u=Zp.resizeBilinear(u,[t,t])),u.as3D(t,t,3)}if(s instanceof Zt.getEnv().Canvas)return iv.fromPixels(MP(s,t,n));throw new Error("toBatchTensor - at batchIdx "+a+", expected input to be instanceof tf.Tensor or instanceof HTMLCanvasElement, instead have "+s)}),i=Dn(o.map(function(a){return a.toFloat()})).as4D(r.batchSize,t,t,3);return i})},e}();function Mt(e){return fe(this,void 0,void 0,function(){var t,n,r;return de(this,function(o){switch(o.label){case 0:if(e instanceof Zl)return[2,e];if(t=Array.isArray(e)?e:[e],!t.length)throw new Error("toNetInput - empty array passed as input");return n=function(i){return Array.isArray(e)?" at input index "+i+":":""},r=t.map(xb),r.forEach(function(i,a){if(!Dy(i)&&!Lc(i)&&!Ro(i))throw typeof t[a]=="string"?new Error("toNetInput -"+n(a)+" string passed, but could not resolve HTMLElement for element id "+t[a]):new Error("toNetInput -"+n(a)+" expected media to be of type HTMLImageElement | HTMLVideoElement | HTMLCanvasElement | tf.Tensor3D, or to be an element id");if(Ro(i)){var s=i.shape[0];if(s!==1)throw new Error("toNetInput -"+n(a)+" tf.Tensor4D with batchSize "+s+" passed, but not supported in input array")}}),[4,Promise.all(r.map(function(i){return Dy(i)&&PP(i)}))];case 1:return o.sent(),[2,new Zl(r,Array.isArray(e))]}})})}function fv(e,t){return fe(this,void 0,void 0,function(){var n,r,o,i,a,s,u;return de(this,function(l){switch(l.label){case 0:return n=Zt.getEnv().Canvas,r=e,e instanceof n?[3,5]:[4,Mt(e)];case 1:if(o=l.sent(),o.batchSize>1)throw new Error("extractFaces - batchSize > 1 not supported");return i=o.getInput(0),i instanceof n?(a=i,[3,4]):[3,2];case 2:return[4,FP(i)];case 3:a=l.sent(),l.label=4;case 4:r=a,l.label=5;case 5:return s=ci(r),u=t.map(function(c){return c instanceof Ar?c.forSize(r.width,r.height).box.floor():c}).map(function(c){return c.clipAtImageBorders(r.width,r.height)}),[2,u.map(function(c){var f=c.x,d=c.y,h=c.width,p=c.height,v=Uc({width:h,height:p});return ci(v).putImageData(s.getImageData(f,d,h,p),0,0),v})]}})})}function dv(e,t){return fe(this,void 0,void 0,function(){return de(this,function(n){if(!Lc(e)&&!Ro(e))throw new Error("extractFaceTensors - expected image tensor to be 3D or 4D");if(Ro(e)&&e.shape[0]>1)throw new Error("extractFaceTensors - batchSize > 1 not supported");return[2,oe(function(){var r=e.shape.slice(Ro(e)?1:0),o=r[0],i=r[1],a=r[2],s=t.map(function(l){return l instanceof Ar?l.forSize(i,o).box:l}).map(function(l){return l.clipAtImageBorders(i,o)}),u=s.map(function(l){var c=l.x,f=l.y,d=l.width,h=l.height;return Kw(e.as3D(o,i,a),[f,c,0],[h,d,a])});return u})]})})}function OP(e,t){return fe(this,void 0,void 0,function(){var n,r;return de(this,function(o){switch(o.label){case 0:return n=Zt.getEnv().fetch,[4,n(e,t)];case 1:if(r=o.sent(),!(r.status<400))throw new Error("failed to fetch: ("+r.status+") "+r.statusText+", from url: "+r.url);return[2,r]}})})}function LP(e){return fe(this,void 0,void 0,function(){return de(this,function(t){switch(t.label){case 0:return[4,OP(e)];case 1:return[2,t.sent().json()]}})})}function Eb(e,t){var n=t+"-weights_manifest.json";if(!e)return{modelBaseUri:"",manifestUri:n};if(e==="/")return{modelBaseUri:"/",manifestUri:"/"+n};var r=e.startsWith("http://")?"http://":e.startsWith("https://")?"https://":"";e=e.replace(r,"");var o=e.split("/").filter(function(s){return s}),i=e.endsWith(".json")?o[o.length-1]:n,a=r+(e.endsWith(".json")?o.slice(0,o.length-1):o).join("/");return a=e.startsWith("/")?"/"+a:a,{modelBaseUri:a,manifestUri:a==="/"?"/"+i:a+"/"+i}}function BP(e,t){return fe(this,void 0,void 0,function(){var n,r,o,i;return de(this,function(a){switch(a.label){case 0:return n=Eb(e,t),r=n.manifestUri,o=n.modelBaseUri,[4,LP(r)];case 1:return i=a.sent(),[2,fb.loadWeights(i,o)]}})})}var Qr=function(){function e(t){this._name=t,this._params=void 0,this._paramMappings=[]}return Object.defineProperty(e.prototype,"params",{get:function(){return this._params},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"paramMappings",{get:function(){return this._paramMappings},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isLoaded",{get:function(){return!!this.params},enumerable:!0,configurable:!0}),e.prototype.getParamFromPath=function(t){var n=this.traversePropertyPath(t),r=n.obj,o=n.objProp;return r[o]},e.prototype.reassignParamFromPath=function(t,n){var r=this.traversePropertyPath(t),o=r.obj,i=r.objProp;o[i].dispose(),o[i]=n},e.prototype.getParamList=function(){var t=this;return this._paramMappings.map(function(n){var r=n.paramPath;return{path:r,tensor:t.getParamFromPath(r)}})},e.prototype.getTrainableParams=function(){return this.getParamList().filter(function(t){return t.tensor instanceof xa})},e.prototype.getFrozenParams=function(){return this.getParamList().filter(function(t){return!(t.tensor instanceof xa)})},e.prototype.variable=function(){var t=this;this.getFrozenParams().forEach(function(n){var r=n.path,o=n.tensor;t.reassignParamFromPath(r,o.variable())})},e.prototype.freeze=function(){var t=this;this.getTrainableParams().forEach(function(n){var r=n.path,o=n.tensor,i=Wt(o.dataSync());o.dispose(),t.reassignParamFromPath(r,i)})},e.prototype.dispose=function(t){t===void 0&&(t=!0),this.getParamList().forEach(function(n){if(t&&n.tensor.isDisposed)throw new Error("param tensor has already been disposed for path "+n.path);n.tensor.dispose()}),this._params=void 0},e.prototype.serializeParams=function(){return new Float32Array(this.getParamList().map(function(t){var n=t.tensor;return Array.from(n.dataSync())}).reduce(function(t,n){return t.concat(n)}))},e.prototype.load=function(t){return fe(this,void 0,void 0,function(){return de(this,function(n){switch(n.label){case 0:return t instanceof Float32Array?(this.extractWeights(t),[2]):[4,this.loadFromUri(t)];case 1:return n.sent(),[2]}})})},e.prototype.loadFromUri=function(t){return fe(this,void 0,void 0,function(){var n;return de(this,function(r){switch(r.label){case 0:if(t&&typeof t!="string")throw new Error(this._name+".loadFromUri - expected model uri");return[4,BP(t,this.getDefaultModelName())];case 1:return n=r.sent(),this.loadFromWeightMap(n),[2]}})})},e.prototype.loadFromDisk=function(t){return fe(this,void 0,void 0,function(){var n,r,o,i,a,s,u,l,c,f;return de(this,function(d){switch(d.label){case 0:if(t&&typeof t!="string")throw new Error(this._name+".loadFromDisk - expected model file path");return n=Zt.getEnv().readFile,r=Eb(t,this.getDefaultModelName()),o=r.manifestUri,i=r.modelBaseUri,a=function(h){return Promise.all(h.map(function(p){return n(p).then(function(v){return v.buffer})}))},s=fb.weightsLoaderFactory(a),c=(l=JSON).parse,[4,n(o)];case 1:return u=c.apply(l,[d.sent().toString()]),[4,s(u,i)];case 2:return f=d.sent(),this.loadFromWeightMap(f),[2]}})})},e.prototype.loadFromWeightMap=function(t){var n=this.extractParamsFromWeigthMap(t),r=n.paramMappings,o=n.params;this._paramMappings=r,this._params=o},e.prototype.extractWeights=function(t){var n=this.extractParams(t),r=n.paramMappings,o=n.params;this._paramMappings=r,this._params=o},e.prototype.traversePropertyPath=function(t){if(!this.params)throw new Error("traversePropertyPath - model has no loaded params");var n=t.split("/").reduce(function(i,a){if(!i.nextObj.hasOwnProperty(a))throw new Error("traversePropertyPath - object does not have property "+a+", for path "+t);return{obj:i.nextObj,objProp:a,nextObj:i.nextObj[a]}},{nextObj:this.params}),r=n.obj,o=n.objProp;if(!r||!o||!(r[o]instanceof st))throw new Error("traversePropertyPath - parameter is not a tensor, for path "+t);return{obj:r,objProp:o}},e}();function kn(e,t,n){return oe(function(){var r=Kp(e,t.depthwise_filter,t.pointwise_filter,n,"same");return r=Ae(r,t.bias),r})}function Qf(e,t,n){return n===void 0&&(n=!1),oe(function(){var r=ut(n?Ae(qn(e,t.conv0.filters,[2,2],"same"),t.conv0.bias):kn(e,t.conv0,[2,2])),o=kn(r,t.conv1,[1,1]),i=ut(Ae(r,o)),a=kn(i,t.conv2,[1,1]);return ut(Ae(r,Ae(o,a)))})}function Lu(e,t,n,r){return n===void 0&&(n=!1),r===void 0&&(r=!0),oe(function(){var o=ut(n?Ae(qn(e,t.conv0.filters,r?[2,2]:[1,1],"same"),t.conv0.bias):kn(e,t.conv0,r?[2,2]:[1,1])),i=kn(o,t.conv1,[1,1]),a=ut(Ae(o,i)),s=kn(a,t.conv2,[1,1]),u=ut(Ae(o,Ae(i,s))),l=kn(u,t.conv3,[1,1]);return ut(Ae(o,Ae(i,Ae(s,l))))})}function ar(e,t,n,r){return n===void 0&&(n="same"),r===void 0&&(r=!1),oe(function(){var o=Ae(qn(e,t.filters,[1,1],n),t.bias);return r?ut(o):o})}function Jr(e,t){Object.keys(e).forEach(function(n){t.some(function(r){return r.originalPath===n})||e[n].dispose()})}function Wc(e,t){return function(n,r,o,i){var a=un(e(n*r*o*o),[o,o,n,r]),s=wt(e(r));return t.push({paramPath:i+"/filters"},{paramPath:i+"/bias"}),{filters:a,bias:s}}}function hv(e,t){return function(n,r,o){var i=_o(e(n*r),[n,r]),a=wt(e(r));return t.push({paramPath:o+"/weights"},{paramPath:o+"/bias"}),{weights:i,bias:a}}}var Cb=function(){function e(t,n,r){this.depthwise_filter=t,this.pointwise_filter=n,this.bias=r}return e}();function pv(e,t){return function(n,r,o){var i=un(e(9*n),[3,3,n,1]),a=un(e(n*r),[1,1,n,r]),s=wt(e(r));return t.push({paramPath:o+"/depthwise_filter"},{paramPath:o+"/pointwise_filter"},{paramPath:o+"/bias"}),new Cb(i,a,s)}}function vv(e){return function(t){var n=e(t+"/depthwise_filter",4),r=e(t+"/pointwise_filter",4),o=e(t+"/bias",1);return new Cb(n,r,o)}}function Lo(e,t){return function(n,r,o){var i=e[n];if(!Oc(i,r))throw new Error("expected weightMap["+n+"] to be a Tensor"+r+"D, instead have "+i);return t.push({originalPath:n,paramPath:o||n}),i}}function Zr(e){var t=e;function n(o){var i=t.slice(0,o);return t=t.slice(o),i}function r(){return t}return{extractWeights:n,getRemainingWeights:r}}function _b(e,t){var n=Wc(e,t),r=pv(e,t);function o(a,s,u,l){l===void 0&&(l=!1);var c=l?n(a,s,3,u+"/conv0"):r(a,s,u+"/conv0"),f=r(s,s,u+"/conv1"),d=r(s,s,u+"/conv2");return{conv0:c,conv1:f,conv2:d}}function i(a,s,u,l){l===void 0&&(l=!1);var c=o(a,s,u,l),f=c.conv0,d=c.conv1,h=c.conv2,p=r(s,s,u+"/conv3");return{conv0:f,conv1:d,conv2:h,conv3:p}}return{extractDenseBlock3Params:o,extractDenseBlock4Params:i}}function UP(e){var t=[],n=Zr(e),r=n.extractWeights,o=n.getRemainingWeights,i=_b(r,t).extractDenseBlock4Params,a=i(3,32,"dense0",!0),s=i(32,64,"dense1"),u=i(64,128,"dense2"),l=i(128,256,"dense3");if(o().length!==0)throw new Error("weights remaing after extract: "+o().length);return{paramMappings:t,params:{dense0:a,dense1:s,dense2:u,dense3:l}}}function Sb(e){return function(t){var n=e(t+"/filters",4),r=e(t+"/bias",1);return{filters:n,bias:r}}}function Rb(e,t){var n=Lo(e,t),r=Sb(n),o=vv(n);function i(s,u){u===void 0&&(u=!1);var l=u?r(s+"/conv0"):o(s+"/conv0"),c=o(s+"/conv1"),f=o(s+"/conv2");return{conv0:l,conv1:c,conv2:f}}function a(s,u){u===void 0&&(u=!1);var l=u?r(s+"/conv0"):o(s+"/conv0"),c=o(s+"/conv1"),f=o(s+"/conv2"),d=o(s+"/conv3");return{conv0:l,conv1:c,conv2:f,conv3:d}}return{extractDenseBlock3Params:i,extractDenseBlock4Params:a}}function WP(e){var t=[],n=Rb(e,t).extractDenseBlock4Params,r={dense0:n("dense0",!0),dense1:n("dense1"),dense2:n("dense2"),dense3:n("dense3")};return Jr(e,t),{params:r,paramMappings:t}}var kb=function(e){be(t,e);function t(){return e.call(this,"FaceFeatureExtractor")||this}return t.prototype.forwardInput=function(n){var r=this.params;if(!r)throw new Error("FaceFeatureExtractor - load model before inference");return oe(function(){var o=n.toBatchTensor(112,!0),i=[122.782,117.001,104.298],a=eu(o,i).div(ne(255)),s=Lu(a,r.dense0,!0);return s=Lu(s,r.dense1),s=Lu(s,r.dense2),s=Lu(s,r.dense3),s=Js(s,[7,7],[2,2],"valid"),s})},t.prototype.forward=function(n){return fe(this,void 0,void 0,function(){var r;return de(this,function(o){switch(o.label){case 0:return r=this.forwardInput,[4,Mt(n)];case 1:return[2,r.apply(this,[o.sent()])]}})})},t.prototype.getDefaultModelName=function(){return"face_feature_extractor_model"},t.prototype.extractParamsFromWeigthMap=function(n){return WP(n)},t.prototype.extractParams=function(n){return UP(n)},t}(Qr);function Er(e,t){return oe(function(){return Ae(Pc(e,t.weights),t.bias)})}function zP(e,t,n){var r=[],o=Zr(e),i=o.extractWeights,a=o.getRemainingWeights,s=hv(i,r),u=s(t,n,"fc");if(a().length!==0)throw new Error("weights remaing after extract: "+a().length);return{paramMappings:r,params:{fc:u}}}function jP(e){var t=[],n=Lo(e,t);function r(i){var a=n(i+"/weights",2),s=n(i+"/bias",1);return{weights:a,bias:s}}var o={fc:r("fc")};return Jr(e,t),{params:o,paramMappings:t}}function Ib(e){var t={},n={};return Object.keys(e).forEach(function(r){var o=r.startsWith("fc")?n:t;o[r]=e[r]}),{featureExtractorMap:t,classifierMap:n}}var Db=function(e){be(t,e);function t(n,r){var o=e.call(this,n)||this;return o._faceFeatureExtractor=r,o}return Object.defineProperty(t.prototype,"faceFeatureExtractor",{get:function(){return this._faceFeatureExtractor},enumerable:!0,configurable:!0}),t.prototype.runNet=function(n){var r=this,o=this.params;if(!o)throw new Error(this._name+" - load model before inference");return oe(function(){var i=n instanceof Zl?r.faceFeatureExtractor.forwardInput(n):n;return Er(i.as2D(i.shape[0],-1),o.fc)})},t.prototype.dispose=function(n){n===void 0&&(n=!0),this.faceFeatureExtractor.dispose(n),e.prototype.dispose.call(this,n)},t.prototype.loadClassifierParams=function(n){var r=this.extractClassifierParams(n),o=r.params,i=r.paramMappings;this._params=o,this._paramMappings=i},t.prototype.extractClassifierParams=function(n){return zP(n,this.getClassifierChannelsIn(),this.getClassifierChannelsOut())},t.prototype.extractParamsFromWeigthMap=function(n){var r=Ib(n),o=r.featureExtractorMap,i=r.classifierMap;return this.faceFeatureExtractor.loadFromWeightMap(o),jP(i)},t.prototype.extractParams=function(n){var r=this.getClassifierChannelsIn(),o=this.getClassifierChannelsOut(),i=o*r+o,a=n.slice(0,n.length-i),s=n.slice(n.length-i);return this.faceFeatureExtractor.extractWeights(a),this.extractClassifierParams(s)},t}(Qr),Ty=["neutral","happy","sad","angry","fearful","disgusted","surprised"],VP=function(){function e(t){var n=this;if(t.length!==7)throw new Error("FaceExpressions.constructor - expected probabilities.length to be 7, have: "+t.length);Ty.forEach(function(r,o){n[r]=t[o]})}return e.prototype.asSortedArray=function(){var t=this;return Ty.map(function(n){return{expression:n,probability:t[n]}}).sort(function(n,r){return r.probability-n.probability})},e}(),$P=function(e){be(t,e);function t(n){return n===void 0&&(n=new kb),e.call(this,"FaceExpressionNet",n)||this}return t.prototype.forwardInput=function(n){var r=this;return oe(function(){return Xr(r.runNet(n))})},t.prototype.forward=function(n){return fe(this,void 0,void 0,function(){var r;return de(this,function(o){switch(o.label){case 0:return r=this.forwardInput,[4,Mt(n)];case 1:return[2,r.apply(this,[o.sent()])]}})})},t.prototype.predictExpressions=function(n){return fe(this,void 0,void 0,function(){var r,o,i,a,s=this;return de(this,function(u){switch(u.label){case 0:return[4,Mt(n)];case 1:return r=u.sent(),[4,this.forwardInput(r)];case 2:return o=u.sent(),[4,Promise.all(Rt(o).map(function(l){return fe(s,void 0,void 0,function(){var c;return de(this,function(f){switch(f.label){case 0:return[4,l.data()];case 1:return c=f.sent(),l.dispose(),[2,c]}})})}))];case 3:return i=u.sent(),o.dispose(),a=i.map(function(l){return new VP(l)}),[2,r.isBatchInput?a:a[0]]}})})},t.prototype.getDefaultModelName=function(){return"face_expression_model"},t.prototype.getClassifierChannelsIn=function(){return 256},t.prototype.getClassifierChannelsOut=function(){return 7},t}(Db);function Tb(e,t){var n={expressions:t};return Object.assign({},e,n)}function HP(e){return TP(e)&&e.landmarks instanceof Jl&&e.unshiftedLandmarks instanceof Jl&&e.alignedRect instanceof Ar}function mv(e,t){var n=e.detection.box,r=t.shiftBy(n.x,n.y),o=r.align(),i=e.detection.imageDims,a=new Ar(e.detection.score,o.rescale(i.reverse()),i),s={landmarks:r,unshiftedLandmarks:t,alignedRect:a};return Object.assign({},e,s)}function GP(e,t){var n=Wc(e,t),r=pv(e,t);function o(a,s,u){var l=r(a,s,u+"/separable_conv0"),c=r(s,s,u+"/separable_conv1"),f=n(a,s,1,u+"/expansion_conv");return{separable_conv0:l,separable_conv1:c,expansion_conv:f}}function i(a,s){var u=r(a,a,s+"/separable_conv0"),l=r(a,a,s+"/separable_conv1"),c=r(a,a,s+"/separable_conv2");return{separable_conv0:u,separable_conv1:l,separable_conv2:c}}return{extractConvParams:n,extractSeparableConvParams:r,extractReductionBlockParams:o,extractMainBlockParams:i}}function qP(e,t){var n=[],r=Zr(e),o=r.extractWeights,i=r.getRemainingWeights,a=GP(o,n),s=a.extractConvParams,u=a.extractSeparableConvParams,l=a.extractReductionBlockParams,c=a.extractMainBlockParams,f=s(3,32,3,"entry_flow/conv_in"),d=l(32,64,"entry_flow/reduction_block_0"),h=l(64,128,"entry_flow/reduction_block_1"),p={conv_in:f,reduction_block_0:d,reduction_block_1:h},v={};Os(t,0,1).forEach(function(x){v["main_block_"+x]=c(128,"middle_flow/main_block_"+x)});var g=l(128,256,"exit_flow/reduction_block"),m=u(256,512,"exit_flow/separable_conv"),y={reduction_block:g,separable_conv:m};if(i().length!==0)throw new Error("weights remaing after extract: "+i().length);return{paramMappings:n,params:{entry_flow:p,middle_flow:v,exit_flow:y}}}function KP(e,t){var n=Lo(e,t),r=Sb(n),o=vv(n);function i(s){var u=o(s+"/separable_conv0"),l=o(s+"/separable_conv1"),c=r(s+"/expansion_conv");return{separable_conv0:u,separable_conv1:l,expansion_conv:c}}function a(s){var u=o(s+"/separable_conv0"),l=o(s+"/separable_conv1"),c=o(s+"/separable_conv2");return{separable_conv0:u,separable_conv1:l,separable_conv2:c}}return{extractConvParams:r,extractSeparableConvParams:o,extractReductionBlockParams:i,extractMainBlockParams:a}}function XP(e,t){var n=[],r=KP(e,n),o=r.extractConvParams,i=r.extractSeparableConvParams,a=r.extractReductionBlockParams,s=r.extractMainBlockParams,u=o("entry_flow/conv_in"),l=a("entry_flow/reduction_block_0"),c=a("entry_flow/reduction_block_1"),f={conv_in:u,reduction_block_0:l,reduction_block_1:c},d={};Os(t,0,1).forEach(function(g){d["main_block_"+g]=s("middle_flow/main_block_"+g)});var h=a("exit_flow/reduction_block"),p=i("exit_flow/separable_conv"),v={reduction_block:h,separable_conv:p};return Jr(e,n),{params:{entry_flow:f,middle_flow:d,exit_flow:v},paramMappings:n}}function Nb(e,t,n){return Ae(qn(e,t.filters,n,"same"),t.bias)}function Jf(e,t,n){n===void 0&&(n=!0);var r=n?ut(e):e;return r=kn(r,t.separable_conv0,[1,1]),r=kn(ut(r),t.separable_conv1,[1,1]),r=Tt(r,[3,3],[2,2],"same"),r=Ae(r,Nb(e,t.expansion_conv,[2,2])),r}function YP(e,t){var n=kn(ut(e),t.separable_conv0,[1,1]);return n=kn(ut(n),t.separable_conv1,[1,1]),n=kn(ut(n),t.separable_conv2,[1,1]),n=Ae(n,e),n}var QP=function(e){be(t,e);function t(n){var r=e.call(this,"TinyXception")||this;return r._numMainBlocks=n,r}return t.prototype.forwardInput=function(n){var r=this,o=this.params;if(!o)throw new Error("TinyXception - load model before inference");return oe(function(){var i=n.toBatchTensor(112,!0),a=[122.782,117.001,104.298],s=eu(i,a).div(ne(256)),u=ut(Nb(s,o.entry_flow.conv_in,[2,2]));return u=Jf(u,o.entry_flow.reduction_block_0,!1),u=Jf(u,o.entry_flow.reduction_block_1),Os(r._numMainBlocks,0,1).forEach(function(l){u=YP(u,o.middle_flow["main_block_"+l])}),u=Jf(u,o.exit_flow.reduction_block),u=ut(kn(u,o.exit_flow.separable_conv,[1,1])),u})},t.prototype.forward=function(n){return fe(this,void 0,void 0,function(){var r;return de(this,function(o){switch(o.label){case 0:return r=this.forwardInput,[4,Mt(n)];case 1:return[2,r.apply(this,[o.sent()])]}})})},t.prototype.getDefaultModelName=function(){return"tiny_xception_model"},t.prototype.extractParamsFromWeigthMap=function(n){return XP(n,this._numMainBlocks)},t.prototype.extractParams=function(n){return qP(n,this._numMainBlocks)},t}(Qr);function JP(e){var t=[],n=Zr(e),r=n.extractWeights,o=n.getRemainingWeights,i=hv(r,t),a=i(512,1,"fc/age"),s=i(512,2,"fc/gender");if(o().length!==0)throw new Error("weights remaing after extract: "+o().length);return{paramMappings:t,params:{fc:{age:a,gender:s}}}}function ZP(e){var t=[],n=Lo(e,t);function r(i){var a=n(i+"/weights",2),s=n(i+"/bias",1);return{weights:a,bias:s}}var o={fc:{age:r("fc/age"),gender:r("fc/gender")}};return Jr(e,t),{params:o,paramMappings:t}}var ec;(function(e){e.FEMALE="female",e.MALE="male"})(ec||(ec={}));var eF=function(e){be(t,e);function t(n){n===void 0&&(n=new QP(2));var r=e.call(this,"AgeGenderNet")||this;return r._faceFeatureExtractor=n,r}return Object.defineProperty(t.prototype,"faceFeatureExtractor",{get:function(){return this._faceFeatureExtractor},enumerable:!0,configurable:!0}),t.prototype.runNet=function(n){var r=this,o=this.params;if(!o)throw new Error(this._name+" - load model before inference");return oe(function(){var i=n instanceof Zl?r.faceFeatureExtractor.forwardInput(n):n,a=Js(i,[7,7],[2,2],"valid").as2D(i.shape[0],-1),s=Er(a,o.fc.age).as1D(),u=Er(a,o.fc.gender);return{age:s,gender:u}})},t.prototype.forwardInput=function(n){var r=this;return oe(function(){var o=r.runNet(n),i=o.age,a=o.gender;return{age:i,gender:Xr(a)}})},t.prototype.forward=function(n){return fe(this,void 0,void 0,function(){var r;return de(this,function(o){switch(o.label){case 0:return r=this.forwardInput,[4,Mt(n)];case 1:return[2,r.apply(this,[o.sent()])]}})})},t.prototype.predictAgeAndGender=function(n){return fe(this,void 0,void 0,function(){var r,o,i,a,s,u,l=this;return de(this,function(c){switch(c.label){case 0:return[4,Mt(n)];case 1:return r=c.sent(),[4,this.forwardInput(r)];case 2:return o=c.sent(),i=Rt(o.age),a=Rt(o.gender),s=i.map(function(f,d){return{ageTensor:f,genderTensor:a[d]}}),[4,Promise.all(s.map(function(f){var d=f.ageTensor,h=f.genderTensor;return fe(l,void 0,void 0,function(){var p,v,g,m,y;return de(this,function(x){switch(x.label){case 0:return[4,d.data()];case 1:return p=x.sent()[0],[4,h.data()];case 2:return v=x.sent()[0],g=v>.5,m=g?ec.MALE:ec.FEMALE,y=g?v:1-v,d.dispose(),h.dispose(),[2,{age:p,gender:m,genderProbability:y}]}})})}))];case 3:return u=c.sent(),o.age.dispose(),o.gender.dispose(),[2,r.isBatchInput?u:u[0]]}})})},t.prototype.getDefaultModelName=function(){return"age_gender_model"},t.prototype.dispose=function(n){n===void 0&&(n=!0),this.faceFeatureExtractor.dispose(n),e.prototype.dispose.call(this,n)},t.prototype.loadClassifierParams=function(n){var r=this.extractClassifierParams(n),o=r.params,i=r.paramMappings;this._params=o,this._paramMappings=i},t.prototype.extractClassifierParams=function(n){return JP(n)},t.prototype.extractParamsFromWeigthMap=function(n){var r=Ib(n),o=r.featureExtractorMap,i=r.classifierMap;return this.faceFeatureExtractor.loadFromWeightMap(o),ZP(i)},t.prototype.extractParams=function(n){var r=1539,o=n.slice(0,n.length-r),i=n.slice(n.length-r);return this.faceFeatureExtractor.extractWeights(o),this.extractClassifierParams(i)},t}(Qr),Ab=function(e){be(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.postProcess=function(n,r,o){var i=o.map(function(s){var u=s.width,l=s.height,c=r/Math.max(l,u);return{width:u*c,height:l*c}}),a=i.length;return oe(function(){var s=function(d,h){return Dn([kr([68],d),kr([68],h)],1).as2D(1,136).as1D()},u=function(d,h){var p=i[d],v=p.width,g=p.height;return h(v,g)?Math.abs(v-g)/2:0},l=function(d){return u(d,function(h,p){return h<p})},c=function(d){return u(d,function(h,p){return p<h})},f=n.mul(kr([a,136],r)).sub(Dn(Array.from(Array(a),function(d,h){return s(l(h),c(h))}))).div(Dn(Array.from(Array(a),function(d,h){return s(i[h].width,i[h].height)})));return f})},t.prototype.forwardInput=function(n){var r=this;return oe(function(){var o=r.runNet(n);return r.postProcess(o,n.inputSize,n.inputDimensions.map(function(i){var a=i[0],s=i[1];return{height:a,width:s}}))})},t.prototype.forward=function(n){return fe(this,void 0,void 0,function(){var r;return de(this,function(o){switch(o.label){case 0:return r=this.forwardInput,[4,Mt(n)];case 1:return[2,r.apply(this,[o.sent()])]}})})},t.prototype.detectLandmarks=function(n){return fe(this,void 0,void 0,function(){var r,o,i,a=this;return de(this,function(s){switch(s.label){case 0:return[4,Mt(n)];case 1:return r=s.sent(),o=oe(function(){return Rt(a.forwardInput(r))}),[4,Promise.all(o.map(function(u,l){return fe(a,void 0,void 0,function(){var c,f,d,h,p;return de(this,function(v){switch(v.label){case 0:return d=(f=Array).from,[4,u.data()];case 1:return c=d.apply(f,[v.sent()]),h=c.filter(function(g,m){return Cy(m)}),p=c.filter(function(g,m){return!Cy(m)}),[2,new DP(Array(68).fill(0).map(function(g,m){return new We(h[m],p[m])}),{height:r.getInputHeight(l),width:r.getInputWidth(l)})]}})})}))];case 2:return i=s.sent(),o.forEach(function(u){return u.dispose()}),[2,r.isBatchInput?i:i[0]]}})})},t.prototype.getClassifierChannelsOut=function(){return 136},t}(Db),Pb=function(e){be(t,e);function t(n){return n===void 0&&(n=new kb),e.call(this,"FaceLandmark68Net",n)||this}return t.prototype.getDefaultModelName=function(){return"face_landmark_68_model"},t.prototype.getClassifierChannelsIn=function(){return 256},t}(Ab);function tF(e){var t=[],n=Rb(e,t).extractDenseBlock3Params,r={dense0:n("dense0",!0),dense1:n("dense1"),dense2:n("dense2")};return Jr(e,t),{params:r,paramMappings:t}}function nF(e){var t=[],n=Zr(e),r=n.extractWeights,o=n.getRemainingWeights,i=_b(r,t).extractDenseBlock3Params,a=i(3,32,"dense0",!0),s=i(32,64,"dense1"),u=i(64,128,"dense2");if(o().length!==0)throw new Error("weights remaing after extract: "+o().length);return{paramMappings:t,params:{dense0:a,dense1:s,dense2:u}}}var rF=function(e){be(t,e);function t(){return e.call(this,"TinyFaceFeatureExtractor")||this}return t.prototype.forwardInput=function(n){var r=this.params;if(!r)throw new Error("TinyFaceFeatureExtractor - load model before inference");return oe(function(){var o=n.toBatchTensor(112,!0),i=[122.782,117.001,104.298],a=eu(o,i).div(ne(255)),s=Qf(a,r.dense0,!0);return s=Qf(s,r.dense1),s=Qf(s,r.dense2),s=Js(s,[14,14],[2,2],"valid"),s})},t.prototype.forward=function(n){return fe(this,void 0,void 0,function(){var r;return de(this,function(o){switch(o.label){case 0:return r=this.forwardInput,[4,Mt(n)];case 1:return[2,r.apply(this,[o.sent()])]}})})},t.prototype.getDefaultModelName=function(){return"face_feature_extractor_tiny_model"},t.prototype.extractParamsFromWeigthMap=function(n){return tF(n)},t.prototype.extractParams=function(n){return nF(n)},t}(Qr),oF=function(e){be(t,e);function t(n){return n===void 0&&(n=new rF),e.call(this,"FaceLandmark68TinyNet",n)||this}return t.prototype.getDefaultModelName=function(){return"face_landmark_68_tiny_model"},t.prototype.getClassifierChannelsIn=function(){return 128},t}(Ab);(function(e){be(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t})(Pb);function iF(e,t){return Ae(Qt(e,t.weights),t.biases)}function gv(e,t,n,r,o){o===void 0&&(o="same");var i=t.conv,a=i.filters,s=i.bias,u=qn(e,a,n,o);return u=Ae(u,s),u=iF(u,t.scale),r?ut(u):u}function aF(e,t){return gv(e,t,[1,1],!0)}function Fb(e,t){return gv(e,t,[1,1],!1)}function Mb(e,t){return gv(e,t,[2,2],!0,"valid")}function sF(e,t){function n(s,u,l){var c=e(s),f=c.length/(u*l*l);if(xP(f))throw new Error("depth has to be an integer: "+f+", weights.length: "+c.length+", numFilters: "+u+", filterSize: "+l);return oe(function(){return Do(un(c,[u,f,l,l]),[2,3,1,0])})}function r(s,u,l,c){var f=n(s,u,l),d=wt(e(u));return t.push({paramPath:c+"/filters"},{paramPath:c+"/bias"}),{filters:f,bias:d}}function o(s,u){var l=wt(e(s)),c=wt(e(s));return t.push({paramPath:u+"/weights"},{paramPath:u+"/biases"}),{weights:l,biases:c}}function i(s,u,l,c){var f=r(s,u,l,c+"/conv"),d=o(u,c+"/scale");return{conv:f,scale:d}}function a(s,u,l,c,f){f===void 0&&(f=!1);var d=i((f?.5:1)*s,u,l,c+"/conv1"),h=i(s,u,l,c+"/conv2");return{conv1:d,conv2:h}}return{extractConvLayerParams:i,extractResidualLayerParams:a}}function uF(e){var t=Zr(e),n=t.extractWeights,r=t.getRemainingWeights,o=[],i=sF(n,o),a=i.extractConvLayerParams,s=i.extractResidualLayerParams,u=a(4704,32,7,"conv32_down"),l=s(9216,32,3,"conv32_1"),c=s(9216,32,3,"conv32_2"),f=s(9216,32,3,"conv32_3"),d=s(36864,64,3,"conv64_down",!0),h=s(36864,64,3,"conv64_1"),p=s(36864,64,3,"conv64_2"),v=s(36864,64,3,"conv64_3"),g=s(147456,128,3,"conv128_down",!0),m=s(147456,128,3,"conv128_1"),y=s(147456,128,3,"conv128_2"),x=s(589824,256,3,"conv256_down",!0),w=s(589824,256,3,"conv256_1"),E=s(589824,256,3,"conv256_2"),b=s(589824,256,3,"conv256_down_out"),C=oe(function(){return Do(_o(n(256*128),[128,256]),[1,0])});if(o.push({paramPath:"fc"}),r().length!==0)throw new Error("weights remaing after extract: "+r().length);var _={conv32_down:u,conv32_1:l,conv32_2:c,conv32_3:f,conv64_down:d,conv64_1:h,conv64_2:p,conv64_3:v,conv128_down:g,conv128_1:m,conv128_2:y,conv256_down:x,conv256_1:w,conv256_2:E,conv256_down_out:b,fc:C};return{params:_,paramMappings:o}}function lF(e,t){var n=Lo(e,t);function r(a){var s=n(a+"/scale/weights",1),u=n(a+"/scale/biases",1);return{weights:s,biases:u}}function o(a){var s=n(a+"/conv/filters",4),u=n(a+"/conv/bias",1),l=r(a);return{conv:{filters:s,bias:u},scale:l}}function i(a){return{conv1:o(a+"/conv1"),conv2:o(a+"/conv2")}}return{extractConvLayerParams:o,extractResidualLayerParams:i}}function cF(e){var t=[],n=lF(e,t),r=n.extractConvLayerParams,o=n.extractResidualLayerParams,i=r("conv32_down"),a=o("conv32_1"),s=o("conv32_2"),u=o("conv32_3"),l=o("conv64_down"),c=o("conv64_1"),f=o("conv64_2"),d=o("conv64_3"),h=o("conv128_down"),p=o("conv128_1"),v=o("conv128_2"),g=o("conv256_down"),m=o("conv256_1"),y=o("conv256_2"),x=o("conv256_down_out"),w=e.fc;if(t.push({originalPath:"fc",paramPath:"fc"}),!yP(w))throw new Error("expected weightMap[fc] to be a Tensor2D, instead have "+w);var E={conv32_down:i,conv32_1:a,conv32_2:s,conv32_3:u,conv64_down:l,conv64_1:c,conv64_2:f,conv64_3:d,conv128_down:h,conv128_1:p,conv128_2:v,conv256_down:g,conv256_1:m,conv256_2:y,conv256_down_out:x,fc:w};return Jr(e,t),{params:E,paramMappings:t}}function vr(e,t){var n=aF(e,t.conv1);return n=Fb(n,t.conv2),n=Ae(n,e),n=ut(n),n}function Bu(e,t){var n=Mb(e,t.conv1);n=Fb(n,t.conv2);var r=Js(e,2,2,"valid"),o=et(r.shape),i=r.shape[3]!==n.shape[3],a=r.shape[1]!==n.shape[1]||r.shape[2]!==n.shape[2];if(a){var s=ls(n.shape);s[1]=1;var u=et(s);n=St([n,u],1);var l=ls(n.shape);l[2]=1;var c=et(l);n=St([n,c],2)}return r=i?St([r,o],3):r,n=Ae(r,n),n=ut(n),n}var fF=function(e){be(t,e);function t(){return e.call(this,"FaceRecognitionNet")||this}return t.prototype.forwardInput=function(n){var r=this.params;if(!r)throw new Error("FaceRecognitionNet - load model before inference");return oe(function(){var o=n.toBatchTensor(150,!0).toFloat(),i=[122.782,117.001,104.298],a=eu(o,i).div(ne(256)),s=Mb(a,r.conv32_down);s=Tt(s,3,2,"valid"),s=vr(s,r.conv32_1),s=vr(s,r.conv32_2),s=vr(s,r.conv32_3),s=Bu(s,r.conv64_down),s=vr(s,r.conv64_1),s=vr(s,r.conv64_2),s=vr(s,r.conv64_3),s=Bu(s,r.conv128_down),s=vr(s,r.conv128_1),s=vr(s,r.conv128_2),s=Bu(s,r.conv256_down),s=vr(s,r.conv256_1),s=vr(s,r.conv256_2),s=Bu(s,r.conv256_down_out);var u=s.mean([1,2]),l=Pc(u,r.fc);return l})},t.prototype.forward=function(n){return fe(this,void 0,void 0,function(){var r;return de(this,function(o){switch(o.label){case 0:return r=this.forwardInput,[4,Mt(n)];case 1:return[2,r.apply(this,[o.sent()])]}})})},t.prototype.computeFaceDescriptor=function(n){return fe(this,void 0,void 0,function(){var r,o,i,a=this;return de(this,function(s){switch(s.label){case 0:return[4,Mt(n)];case 1:return r=s.sent(),o=oe(function(){return Rt(a.forwardInput(r))}),[4,Promise.all(o.map(function(u){return u.data()}))];case 2:return i=s.sent(),o.forEach(function(u){return u.dispose()}),[2,r.isBatchInput?i:i[0]]}})})},t.prototype.getDefaultModelName=function(){return"face_recognition_model"},t.prototype.extractParamsFromWeigthMap=function(n){return cF(n)},t.prototype.extractParams=function(n){return uF(n)},t}(Qr);function Ob(e,t){var n={descriptor:t};return Object.assign({},e,n)}function Lb(e,t){var n={age:t};return Object.assign({},e,n)}function Bb(e,t,n){var r={gender:t,genderProbability:n};return Object.assign({},e,r)}var Ub=function(){function e(t){var n=t===void 0?{}:t,r=n.minFaceSize,o=n.scaleFactor,i=n.maxNumScales,a=n.scoreThresholds,s=n.scaleSteps;if(this._name="MtcnnOptions",this._minFaceSize=r||20,this._scaleFactor=o||.709,this._maxNumScales=i||10,this._scoreThresholds=a||[.6,.7,.7],this._scaleSteps=s,typeof this._minFaceSize!="number"||this._minFaceSize<0)throw new Error(this._name+" - expected minFaceSize to be a number > 0");if(typeof this._scaleFactor!="number"||this._scaleFactor<=0||this._scaleFactor>=1)throw new Error(this._name+" - expected scaleFactor to be a number between 0 and 1");if(typeof this._maxNumScales!="number"||this._maxNumScales<0)throw new Error(this._name+" - expected maxNumScales to be a number > 0");if(!Array.isArray(this._scoreThresholds)||this._scoreThresholds.length!==3||this._scoreThresholds.some(function(u){return typeof u!="number"}))throw new Error(this._name+" - expected scoreThresholds to be an array of numbers of length 3");if(this._scaleSteps&&(!Array.isArray(this._scaleSteps)||this._scaleSteps.some(function(u){return typeof u!="number"})))throw new Error(this._name+" - expected scaleSteps to be an array of numbers")}return Object.defineProperty(e.prototype,"minFaceSize",{get:function(){return this._minFaceSize},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"scaleFactor",{get:function(){return this._scaleFactor},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"maxNumScales",{get:function(){return this._maxNumScales},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"scoreThresholds",{get:function(){return this._scoreThresholds},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"scaleSteps",{get:function(){return this._scaleSteps},enumerable:!0,configurable:!0}),e}();function dF(e,t){function n(u,l){var c=un(e(9*u),[3,3,u,1]),f=wt(e(u)),d=wt(e(u)),h=wt(e(u)),p=wt(e(u));return t.push({paramPath:l+"/filters"},{paramPath:l+"/batch_norm_scale"},{paramPath:l+"/batch_norm_offset"},{paramPath:l+"/batch_norm_mean"},{paramPath:l+"/batch_norm_variance"}),{filters:c,batch_norm_scale:f,batch_norm_offset:d,batch_norm_mean:h,batch_norm_variance:p}}function r(u,l,c,f,d){var h=un(e(u*l*c*c),[c,c,u,l]),p=wt(e(l));return t.push({paramPath:f+"/filters"},{paramPath:f+"/"+(d?"batch_norm_offset":"bias")}),{filters:h,bias:p}}function o(u,l,c,f){var d=r(u,l,c,f,!0),h=d.filters,p=d.bias;return{filters:h,batch_norm_offset:p}}function i(u,l,c){var f=n(u,c+"/depthwise_conv"),d=o(u,l,1,c+"/pointwise_conv");return{depthwise_conv:f,pointwise_conv:d}}function a(){var u=o(3,32,3,"mobilenetv1/conv_0"),l=i(32,64,"mobilenetv1/conv_1"),c=i(64,128,"mobilenetv1/conv_2"),f=i(128,128,"mobilenetv1/conv_3"),d=i(128,256,"mobilenetv1/conv_4"),h=i(256,256,"mobilenetv1/conv_5"),p=i(256,512,"mobilenetv1/conv_6"),v=i(512,512,"mobilenetv1/conv_7"),g=i(512,512,"mobilenetv1/conv_8"),m=i(512,512,"mobilenetv1/conv_9"),y=i(512,512,"mobilenetv1/conv_10"),x=i(512,512,"mobilenetv1/conv_11"),w=i(512,1024,"mobilenetv1/conv_12"),E=i(1024,1024,"mobilenetv1/conv_13");return{conv_0:u,conv_1:l,conv_2:c,conv_3:f,conv_4:d,conv_5:h,conv_6:p,conv_7:v,conv_8:g,conv_9:m,conv_10:y,conv_11:x,conv_12:w,conv_13:E}}function s(){var u=o(1024,256,1,"prediction_layer/conv_0"),l=o(256,512,3,"prediction_layer/conv_1"),c=o(512,128,1,"prediction_layer/conv_2"),f=o(128,256,3,"prediction_layer/conv_3"),d=o(256,128,1,"prediction_layer/conv_4"),h=o(128,256,3,"prediction_layer/conv_5"),p=o(256,64,1,"prediction_layer/conv_6"),v=o(64,128,3,"prediction_layer/conv_7"),g=r(512,12,1,"prediction_layer/box_predictor_0/box_encoding_predictor"),m=r(512,9,1,"prediction_layer/box_predictor_0/class_predictor"),y=r(1024,24,1,"prediction_layer/box_predictor_1/box_encoding_predictor"),x=r(1024,18,1,"prediction_layer/box_predictor_1/class_predictor"),w=r(512,24,1,"prediction_layer/box_predictor_2/box_encoding_predictor"),E=r(512,18,1,"prediction_layer/box_predictor_2/class_predictor"),b=r(256,24,1,"prediction_layer/box_predictor_3/box_encoding_predictor"),C=r(256,18,1,"prediction_layer/box_predictor_3/class_predictor"),_=r(256,24,1,"prediction_layer/box_predictor_4/box_encoding_predictor"),S=r(256,18,1,"prediction_layer/box_predictor_4/class_predictor"),R=r(128,24,1,"prediction_layer/box_predictor_5/box_encoding_predictor"),D=r(128,18,1,"prediction_layer/box_predictor_5/class_predictor"),T={box_encoding_predictor:g,class_predictor:m},z={box_encoding_predictor:y,class_predictor:x},O={box_encoding_predictor:w,class_predictor:E},$={box_encoding_predictor:b,class_predictor:C},q={box_encoding_predictor:_,class_predictor:S},V={box_encoding_predictor:R,class_predictor:D};return{conv_0:u,conv_1:l,conv_2:c,conv_3:f,conv_4:d,conv_5:h,conv_6:p,conv_7:v,box_predictor_0:T,box_predictor_1:z,box_predictor_2:O,box_predictor_3:$,box_predictor_4:q,box_predictor_5:V}}return{extractMobilenetV1Params:a,extractPredictionLayerParams:s}}function hF(e){var t=[],n=Zr(e),r=n.extractWeights,o=n.getRemainingWeights,i=dF(r,t),a=i.extractMobilenetV1Params,s=i.extractPredictionLayerParams,u=a(),l=s(),c=Pp(r(5118*4),[1,5118,4]),f={extra_dim:c};if(t.push({paramPath:"output_layer/extra_dim"}),o().length!==0)throw new Error("weights remaing after extract: "+o().length);return{params:{mobilenetv1:u,prediction_layer:l,output_layer:f},paramMappings:t}}function pF(e,t){var n=Lo(e,t);function r(l,c,f){var d=n(l+"/Conv2d_"+c+"_pointwise/weights",4,f+"/filters"),h=n(l+"/Conv2d_"+c+"_pointwise/convolution_bn_offset",1,f+"/batch_norm_offset");return{filters:d,batch_norm_offset:h}}function o(l){var c="mobilenetv1/conv_"+l,f="MobilenetV1/Conv2d_"+l+"_depthwise",d=c+"/depthwise_conv",h=c+"/pointwise_conv",p=n(f+"/depthwise_weights",4,d+"/filters"),v=n(f+"/BatchNorm/gamma",1,d+"/batch_norm_scale"),g=n(f+"/BatchNorm/beta",1,d+"/batch_norm_offset"),m=n(f+"/BatchNorm/moving_mean",1,d+"/batch_norm_mean"),y=n(f+"/BatchNorm/moving_variance",1,d+"/batch_norm_variance");return{depthwise_conv:{filters:p,batch_norm_scale:v,batch_norm_offset:g,batch_norm_mean:m,batch_norm_variance:y},pointwise_conv:r("MobilenetV1",l,h)}}function i(){return{conv_0:r("MobilenetV1",0,"mobilenetv1/conv_0"),conv_1:o(1),conv_2:o(2),conv_3:o(3),conv_4:o(4),conv_5:o(5),conv_6:o(6),conv_7:o(7),conv_8:o(8),conv_9:o(9),conv_10:o(10),conv_11:o(11),conv_12:o(12),conv_13:o(13)}}function a(l,c){var f=n(l+"/weights",4,c+"/filters"),d=n(l+"/biases",1,c+"/bias");return{filters:f,bias:d}}function s(l){var c=a("Prediction/BoxPredictor_"+l+"/BoxEncodingPredictor","prediction_layer/box_predictor_"+l+"/box_encoding_predictor"),f=a("Prediction/BoxPredictor_"+l+"/ClassPredictor","prediction_layer/box_predictor_"+l+"/class_predictor");return{box_encoding_predictor:c,class_predictor:f}}function u(){return{conv_0:r("Prediction",0,"prediction_layer/conv_0"),conv_1:r("Prediction",1,"prediction_layer/conv_1"),conv_2:r("Prediction",2,"prediction_layer/conv_2"),conv_3:r("Prediction",3,"prediction_layer/conv_3"),conv_4:r("Prediction",4,"prediction_layer/conv_4"),conv_5:r("Prediction",5,"prediction_layer/conv_5"),conv_6:r("Prediction",6,"prediction_layer/conv_6"),conv_7:r("Prediction",7,"prediction_layer/conv_7"),box_predictor_0:s(0),box_predictor_1:s(1),box_predictor_2:s(2),box_predictor_3:s(3),box_predictor_4:s(4),box_predictor_5:s(5)}}return{extractMobilenetV1Params:i,extractPredictionLayerParams:u}}function vF(e){var t=[],n=pF(e,t),r=n.extractMobilenetV1Params,o=n.extractPredictionLayerParams,i=e["Output/extra_dim"];if(t.push({originalPath:"Output/extra_dim",paramPath:"output_layer/extra_dim"}),!Lc(i))throw new Error("expected weightMap['Output/extra_dim'] to be a Tensor3D, instead have "+i);var a={mobilenetv1:r(),prediction_layer:o(),output_layer:{extra_dim:i}};return Jr(e,t),{params:a,paramMappings:t}}function gr(e,t,n){return oe(function(){var r=qn(e,t.filters,n,"same");return r=Ae(r,t.batch_norm_offset),$p(r,0,6)})}var mF=.0010000000474974513;function gF(e,t,n){return oe(function(){var r=Ac(e,t.filters,n,"same");return r=Pw(r,t.batch_norm_mean,t.batch_norm_variance,t.batch_norm_offset,t.batch_norm_scale,mF),$p(r,0,6)})}function yF(e){return[2,4,6,12].some(function(t){return t===e})?[2,2]:[1,1]}function xF(e,t){return oe(function(){var n=null,r=gr(e,t.conv_0,[2,2]),o=[t.conv_1,t.conv_2,t.conv_3,t.conv_4,t.conv_5,t.conv_6,t.conv_7,t.conv_8,t.conv_9,t.conv_10,t.conv_11,t.conv_12,t.conv_13];if(o.forEach(function(i,a){var s=a+1,u=yF(s);r=gF(r,i.depthwise_conv,u),r=gr(r,i.pointwise_conv,[1,1]),s===11&&(n=r)}),n===null)throw new Error("mobileNetV1 - output of conv layer 11 is null");return{out:r,conv11:n}})}function wF(e,t,n,r,o){var i=e.shape[0],a=Math.min(n,i),s=t.map(function(c,f){return{score:c,boxIndex:f}}).filter(function(c){return c.score>o}).sort(function(c,f){return f.score-c.score}),u=function(c){return c<=r?1:0},l=[];return s.forEach(function(c){if(!(l.length>=a)){for(var f=c.score,d=l.length-1;d>=0;--d){var h=bF(e,c.boxIndex,l[d]);if(h!==0&&(c.score*=u(h),c.score<=o))break}f===c.score&&l.push(c.boxIndex)}}),l}function bF(e,t,n){var r=e.arraySync(),o=Math.min(r[t][0],r[t][2]),i=Math.min(r[t][1],r[t][3]),a=Math.max(r[t][0],r[t][2]),s=Math.max(r[t][1],r[t][3]),u=Math.min(r[n][0],r[n][2]),l=Math.min(r[n][1],r[n][3]),c=Math.max(r[n][0],r[n][2]),f=Math.max(r[n][1],r[n][3]),d=(a-o)*(s-i),h=(c-u)*(f-l);if(d<=0||h<=0)return 0;var p=Math.max(o,u),v=Math.max(i,l),g=Math.min(a,c),m=Math.min(s,f),y=Math.max(g-p,0)*Math.max(m-v,0);return y/(d+h-y)}function EF(e){var t=Rt(Do(e,[1,0])),n=[It(t[2],t[0]),It(t[3],t[1])],r=[Ae(t[0],tr(n[0],ne(2))),Ae(t[1],tr(n[1],ne(2)))];return{sizes:n,centers:r}}function CF(e,t){var n=EF(e),r=n.sizes,o=n.centers,i=Rt(Do(t,[1,0])),a=tr(Qt(vh(tr(i[2],ne(5))),r[0]),ne(2)),s=Ae(Qt(tr(i[0],ne(10)),r[0]),o[0]),u=tr(Qt(vh(tr(i[3],ne(5))),r[1]),ne(2)),l=Ae(Qt(tr(i[1],ne(10)),r[1]),o[1]);return Do(Dn([It(s,a),It(l,u),Ae(s,a),Ae(l,u)]),[1,0])}function _F(e,t,n){return oe(function(){var r=e.shape[0],o=CF(nr(ra(n.extra_dim,[r,1,1]),[-1,4]),nr(e,[-1,4]));o=nr(o,[r,o.shape[0]/r,4]);var i=Dw(Ir(t,[0,0,1],[-1,-1,-1])),a=Ir(i,[0,0,0],[-1,-1,1]);a=nr(a,[r,a.shape[1]]);var s=Rt(o),u=Rt(a);return{boxes:s,scores:u}})}function Ai(e,t){return oe(function(){var n=e.shape[0],r=nr(ar(e,t.box_encoding_predictor),[n,-1,1,4]),o=nr(ar(e,t.class_predictor),[n,-1,3]);return{boxPredictionEncoding:r,classPrediction:o}})}function SF(e,t,n){return oe(function(){var r=gr(e,n.conv_0,[1,1]),o=gr(r,n.conv_1,[2,2]),i=gr(o,n.conv_2,[1,1]),a=gr(i,n.conv_3,[2,2]),s=gr(a,n.conv_4,[1,1]),u=gr(s,n.conv_5,[2,2]),l=gr(u,n.conv_6,[1,1]),c=gr(l,n.conv_7,[2,2]),f=Ai(t,n.box_predictor_0),d=Ai(e,n.box_predictor_1),h=Ai(o,n.box_predictor_2),p=Ai(a,n.box_predictor_3),v=Ai(u,n.box_predictor_4),g=Ai(c,n.box_predictor_5),m=St([f.boxPredictionEncoding,d.boxPredictionEncoding,h.boxPredictionEncoding,p.boxPredictionEncoding,v.boxPredictionEncoding,g.boxPredictionEncoding],1),y=St([f.classPrediction,d.classPrediction,h.classPrediction,p.classPrediction,v.classPrediction,g.classPrediction],1);return{boxPredictions:m,classPredictions:y}})}var zc=function(){function e(t){var n=t===void 0?{}:t,r=n.minConfidence,o=n.maxResults;if(this._name="SsdMobilenetv1Options",this._minConfidence=r||.5,this._maxResults=o||100,typeof this._minConfidence!="number"||this._minConfidence<=0||this._minConfidence>=1)throw new Error(this._name+" - expected minConfidence to be a number between 0 and 1");if(typeof this._maxResults!="number")throw new Error(this._name+" - expected maxResults to be a number")}return Object.defineProperty(e.prototype,"minConfidence",{get:function(){return this._minConfidence},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"maxResults",{get:function(){return this._maxResults},enumerable:!0,configurable:!0}),e}(),Wb=function(e){be(t,e);function t(){return e.call(this,"SsdMobilenetv1")||this}return t.prototype.forwardInput=function(n){var r=this.params;if(!r)throw new Error("SsdMobilenetv1 - load model before inference");return oe(function(){var o=n.toBatchTensor(512,!1).toFloat(),i=It(Qt(o,ne(.007843137718737125)),ne(1)),a=xF(i,r.mobilenetv1),s=SF(a.out,a.conv11,r.prediction_layer),u=s.boxPredictions,l=s.classPredictions;return _F(u,l,r.output_layer)})},t.prototype.forward=function(n){return fe(this,void 0,void 0,function(){var r;return de(this,function(o){switch(o.label){case 0:return r=this.forwardInput,[4,Mt(n)];case 1:return[2,r.apply(this,[o.sent()])]}})})},t.prototype.locateFaces=function(n,r){return r===void 0&&(r={}),fe(this,void 0,void 0,function(){var o,i,a,s,u,l,c,f,d,h,p,v,g,m,y,x,w,E,b,C,_;return de(this,function(S){switch(S.label){case 0:return o=new zc(r),i=o.maxResults,a=o.minConfidence,[4,Mt(n)];case 1:for(s=S.sent(),u=this.forwardInput(s),l=u.boxes,c=u.scores,f=l[0],d=c[0],h=1;h<l.length;h++)l[h].dispose(),c[h].dispose();return g=(v=Array).from,[4,d.data()];case 2:return p=g.apply(v,[S.sent()]),m=.5,y=wF(f,p,i,m,a),x=s.getReshapedInputDimensions(0),w=s.inputSize,E=w/x.width,b=w/x.height,C=f.arraySync(),_=y.map(function(R){var D=[Math.max(0,C[R][0]),Math.min(1,C[R][2])].map(function(V){return V*b}),T=D[0],z=D[1],O=[Math.max(0,C[R][1]),Math.min(1,C[R][3])].map(function(V){return V*E}),$=O[0],q=O[1];return new Ar(p[R],new sv($,T,q-$,z-T),{height:s.getInputHeight(0),width:s.getInputWidth(0)})}),f.dispose(),d.dispose(),[2,_]}})})},t.prototype.getDefaultModelName=function(){return"ssd_mobilenetv1_model"},t.prototype.extractParamsFromWeigthMap=function(n){return vF(n)},t.prototype.extractParams=function(n){return hF(n)},t}(Qr);(function(e){be(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t})(Wb);var RF=.4,kF=[new We(.738768,.874946),new We(2.42204,2.65704),new We(4.30971,7.04493),new We(10.246,4.59428),new We(12.6868,11.8741)],IF=[new We(1.603231,2.094468),new We(6.041143,7.080126),new We(2.882459,3.518061),new We(4.266906,5.178857),new We(9.041765,10.66308)],DF=[117.001,114.697,97.404],TF="tiny_yolov2_model",NF="tiny_yolov2_separable_conv_model",Uu=function(e){return typeof e=="number"};function AF(e){if(!e)throw new Error("invalid config: "+e);if(typeof e.withSeparableConvs!="boolean")throw new Error("config.withSeparableConvs has to be a boolean, have: "+e.withSeparableConvs);if(!Uu(e.iouThreshold)||e.iouThreshold<0||e.iouThreshold>1)throw new Error("config.iouThreshold has to be a number between [0, 1], have: "+e.iouThreshold);if(!Array.isArray(e.classes)||!e.classes.length||!e.classes.every(function(t){return typeof t=="string"}))throw new Error("config.classes has to be an array class names: string[], have: "+JSON.stringify(e.classes));if(!Array.isArray(e.anchors)||!e.anchors.length||!e.anchors.map(function(t){return t||{}}).every(function(t){return Uu(t.x)&&Uu(t.y)}))throw new Error("config.anchors has to be an array of { x: number, y: number }, have: "+JSON.stringify(e.anchors));if(e.meanRgb&&(!Array.isArray(e.meanRgb)||e.meanRgb.length!==3||!e.meanRgb.every(Uu)))throw new Error("config.meanRgb has to be an array of shape [number, number, number], have: "+JSON.stringify(e.meanRgb))}function yv(e){return oe(function(){var t=Qt(e,ne(.10000000149011612));return Ae(ut(It(e,t)),t)})}function oo(e,t){return oe(function(){var n=mi(e,[[0,0],[1,1],[1,1],[0,0]]);return n=qn(n,t.conv.filters,[1,1],"valid"),n=It(n,t.bn.sub),n=Qt(n,t.bn.truediv),n=Ae(n,t.conv.bias),yv(n)})}function io(e,t){return oe(function(){var n=mi(e,[[0,0],[1,1],[1,1],[0,0]]);return n=Kp(n,t.depthwise_filter,t.pointwise_filter,[1,1],"valid"),n=Ae(n,t.bias),yv(n)})}function PF(e,t){var n=Wc(e,t);function r(a,s){var u=wt(e(a)),l=wt(e(a));return t.push({paramPath:s+"/sub"},{paramPath:s+"/truediv"}),{sub:u,truediv:l}}function o(a,s,u){var l=n(a,s,3,u+"/conv"),c=r(s,u+"/bn");return{conv:l,bn:c}}var i=pv(e,t);return{extractConvParams:n,extractConvWithBatchNormParams:o,extractSeparableConvParams:i}}function FF(e,t,n,r){var o=Zr(e),i=o.extractWeights,a=o.getRemainingWeights,s=[],u=PF(i,s),l=u.extractConvParams,c=u.extractConvWithBatchNormParams,f=u.extractSeparableConvParams,d;if(t.withSeparableConvs){var h=r[0],p=r[1],v=r[2],g=r[3],m=r[4],y=r[5],x=r[6],w=r[7],E=r[8],b=t.isFirstLayerConv2d?l(h,p,3,"conv0"):f(h,p,"conv0"),C=f(p,v,"conv1"),_=f(v,g,"conv2"),S=f(g,m,"conv3"),R=f(m,y,"conv4"),D=f(y,x,"conv5"),T=w?f(x,w,"conv6"):void 0,z=E?f(w,E,"conv7"):void 0,O=l(E||w||x,5*n,1,"conv8");d={conv0:b,conv1:C,conv2:_,conv3:S,conv4:R,conv5:D,conv6:T,conv7:z,conv8:O}}else{var h=r[0],p=r[1],v=r[2],g=r[3],m=r[4],y=r[5],x=r[6],w=r[7],E=r[8],b=c(h,p,"conv0"),C=c(p,v,"conv1"),_=c(v,g,"conv2"),S=c(g,m,"conv3"),R=c(m,y,"conv4"),D=c(y,x,"conv5"),T=c(x,w,"conv6"),z=c(w,E,"conv7"),O=l(E,5*n,1,"conv8");d={conv0:b,conv1:C,conv2:_,conv3:S,conv4:R,conv5:D,conv6:T,conv7:z,conv8:O}}if(a().length!==0)throw new Error("weights remaing after extract: "+a().length);return{params:d,paramMappings:s}}function MF(e,t){var n=Lo(e,t);function r(s){var u=n(s+"/sub",1),l=n(s+"/truediv",1);return{sub:u,truediv:l}}function o(s){var u=n(s+"/filters",4),l=n(s+"/bias",1);return{filters:u,bias:l}}function i(s){var u=o(s+"/conv"),l=r(s+"/bn");return{conv:u,bn:l}}var a=vv(n);return{extractConvParams:o,extractConvWithBatchNormParams:i,extractSeparableConvParams:a}}function OF(e,t){var n=[],r=MF(e,n),o=r.extractConvParams,i=r.extractConvWithBatchNormParams,a=r.extractSeparableConvParams,s;if(t.withSeparableConvs){var u=t.filterSizes&&t.filterSizes.length||9;s={conv0:t.isFirstLayerConv2d?o("conv0"):a("conv0"),conv1:a("conv1"),conv2:a("conv2"),conv3:a("conv3"),conv4:a("conv4"),conv5:a("conv5"),conv6:u>7?a("conv6"):void 0,conv7:u>8?a("conv7"):void 0,conv8:o("conv8")}}else s={conv0:i("conv0"),conv1:i("conv1"),conv2:i("conv2"),conv3:i("conv3"),conv4:i("conv4"),conv5:i("conv5"),conv6:i("conv6"),conv7:i("conv7"),conv8:o("conv8")};return Jr(e,n),{params:s,paramMappings:n}}var Ny;(function(e){e[e.XS=224]="XS",e[e.SM=320]="SM",e[e.MD=416]="MD",e[e.LG=608]="LG"})(Ny||(Ny={}));var xv=function(){function e(t){var n=t===void 0?{}:t,r=n.inputSize,o=n.scoreThreshold;if(this._name="TinyYolov2Options",this._inputSize=r||416,this._scoreThreshold=o||.5,typeof this._inputSize!="number"||this._inputSize%32!==0)throw new Error(this._name+" - expected inputSize to be a number divisible by 32");if(typeof this._scoreThreshold!="number"||this._scoreThreshold<=0||this._scoreThreshold>=1)throw new Error(this._name+" - expected scoreThreshold to be a number between 0 and 1")}return Object.defineProperty(e.prototype,"inputSize",{get:function(){return this._inputSize},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"scoreThreshold",{get:function(){return this._scoreThreshold},enumerable:!0,configurable:!0}),e}(),zb=function(e){be(t,e);function t(n){var r=e.call(this,"TinyYolov2")||this;return AF(n),r._config=n,r}return Object.defineProperty(t.prototype,"config",{get:function(){return this._config},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"withClassScores",{get:function(){return this.config.withClassScores||this.config.classes.length>1},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"boxEncodingSize",{get:function(){return 5+(this.withClassScores?this.config.classes.length:0)},enumerable:!0,configurable:!0}),t.prototype.runTinyYolov2=function(n,r){var o=oo(n,r.conv0);return o=Tt(o,[2,2],[2,2],"same"),o=oo(o,r.conv1),o=Tt(o,[2,2],[2,2],"same"),o=oo(o,r.conv2),o=Tt(o,[2,2],[2,2],"same"),o=oo(o,r.conv3),o=Tt(o,[2,2],[2,2],"same"),o=oo(o,r.conv4),o=Tt(o,[2,2],[2,2],"same"),o=oo(o,r.conv5),o=Tt(o,[2,2],[1,1],"same"),o=oo(o,r.conv6),o=oo(o,r.conv7),ar(o,r.conv8,"valid",!1)},t.prototype.runMobilenet=function(n,r){var o=this.config.isFirstLayerConv2d?yv(ar(n,r.conv0,"valid",!1)):io(n,r.conv0);return o=Tt(o,[2,2],[2,2],"same"),o=io(o,r.conv1),o=Tt(o,[2,2],[2,2],"same"),o=io(o,r.conv2),o=Tt(o,[2,2],[2,2],"same"),o=io(o,r.conv3),o=Tt(o,[2,2],[2,2],"same"),o=io(o,r.conv4),o=Tt(o,[2,2],[2,2],"same"),o=io(o,r.conv5),o=Tt(o,[2,2],[1,1],"same"),o=r.conv6?io(o,r.conv6):o,o=r.conv7?io(o,r.conv7):o,ar(o,r.conv8,"valid",!1)},t.prototype.forwardInput=function(n,r){var o=this,i=this.params;if(!i)throw new Error("TinyYolov2 - load model before inference");return oe(function(){var a=n.toBatchTensor(r,!1).toFloat();return a=o.config.meanRgb?eu(a,o.config.meanRgb):a,a=a.div(ne(256)),o.config.withSeparableConvs?o.runMobilenet(a,i):o.runTinyYolov2(a,i)})},t.prototype.forward=function(n,r){return fe(this,void 0,void 0,function(){var o;return de(this,function(i){switch(i.label){case 0:return o=this.forwardInput,[4,Mt(n)];case 1:return[4,o.apply(this,[i.sent(),r])];case 2:return[2,i.sent()]}})})},t.prototype.detect=function(n,r){return r===void 0&&(r={}),fe(this,void 0,void 0,function(){var o,i,a,s,u,l,c,f,d,h,p,v,g,m,y=this;return de(this,function(x){switch(x.label){case 0:return o=new xv(r),i=o.inputSize,a=o.scoreThreshold,[4,Mt(n)];case 1:return s=x.sent(),[4,this.forwardInput(s,i)];case 2:return u=x.sent(),l=oe(function(){return Rt(u)[0].expandDims()}),c={width:s.getInputWidth(0),height:s.getInputHeight(0)},[4,this.extractBoxes(l,s.getReshapedInputDimensions(0),a)];case 3:return f=x.sent(),u.dispose(),l.dispose(),d=f.map(function(w){return w.box}),h=f.map(function(w){return w.score}),p=f.map(function(w){return w.classScore}),v=f.map(function(w){return y.config.classes[w.label]}),g=Ls(d.map(function(w){return w.rescale(i)}),h,this.config.iouThreshold,!0),m=g.map(function(w){return new hb(h[w],p[w],v[w],d[w],c)}),[2,m]}})})},t.prototype.getDefaultModelName=function(){return""},t.prototype.extractParamsFromWeigthMap=function(n){return OF(n,this.config)},t.prototype.extractParams=function(n){var r=this.config.filterSizes||t.DEFAULT_FILTER_SIZES,o=r?r.length:void 0;if(o!==7&&o!==8&&o!==9)throw new Error("TinyYolov2 - expected 7 | 8 | 9 convolutional filters, but found "+o+" filterSizes in config");return FF(n,this.config,this.boxEncodingSize,r)},t.prototype.extractBoxes=function(n,r,o){return fe(this,void 0,void 0,function(){var i,a,s,u,l,c,f,d,h,p,v,g,m,y,x,w,E,b,C,_,S,R,D,T,z,O,$,q,V,F=this;return de(this,function(L){switch(L.label){case 0:return i=r.width,a=r.height,s=Math.max(i,a),u=s/i,l=s/a,c=n.shape[1],f=this.config.anchors.length,d=oe(function(){var U=n.reshape([c,c,f,F.boxEncodingSize]),Q=U.slice([0,0,0,0],[c,c,f,4]),ee=U.slice([0,0,0,4],[c,c,f,1]),ae=F.withClassScores?Xr(U.slice([0,0,0,5],[c,c,f,F.config.classes.length]),3):ne(0);return[Q,ee,ae]}),h=d[0],p=d[1],v=d[2],g=[],[4,p.array()];case 1:return m=L.sent(),[4,h.array()];case 2:y=L.sent(),x=0,L.label=3;case 3:if(!(x<c))return[3,12];w=0,L.label=4;case 4:if(!(w<c))return[3,11];E=0,L.label=5;case 5:return E<f?(b=Yf(m[x][w][E][0]),!o||b>o?(C=(w+Yf(y[x][w][E][0]))/c*u,_=(x+Yf(y[x][w][E][1]))/c*l,S=Math.exp(y[x][w][E][2])*this.config.anchors[E].x/c*u,R=Math.exp(y[x][w][E][3])*this.config.anchors[E].y/c*l,D=C-S/2,T=_-R/2,z={row:x,col:w,anchor:E},this.withClassScores?[4,this.extractPredictedClass(v,z)]:[3,7]):[3,9]):[3,10];case 6:return V=L.sent(),[3,8];case 7:V={classScore:1,label:0},L.label=8;case 8:O=V,$=O.classScore,q=O.label,g.push(Kt({box:new Bc(D,T,D+S,T+R),score:b,classScore:b*$,label:q},z)),L.label=9;case 9:return E++,[3,5];case 10:return w++,[3,4];case 11:return x++,[3,3];case 12:return h.dispose(),p.dispose(),v.dispose(),[2,g]}})})},t.prototype.extractPredictedClass=function(n,r){return fe(this,void 0,void 0,function(){var o,i,a,s;return de(this,function(u){switch(u.label){case 0:return o=r.row,i=r.col,a=r.anchor,[4,n.array()];case 1:return s=u.sent(),[2,Array(this.config.classes.length).fill(0).map(function(l,c){return s[o][i][a][c]}).map(function(l,c){return{classScore:l,label:c}}).reduce(function(l,c){return l.classScore>c.classScore?l:c})]}})})},t.DEFAULT_FILTER_SIZES=[3,16,32,64,128,256,512,1024,1024],t}(Qr),LF=function(e){be(t,e);function t(n){n===void 0&&(n=!0);var r=this,o=Object.assign({},{withSeparableConvs:n,iouThreshold:RF,classes:["face"]},n?{anchors:IF,meanRgb:DF}:{anchors:kF,withClassScores:!0});return r=e.call(this,o)||this,r}return Object.defineProperty(t.prototype,"withSeparableConvs",{get:function(){return this.config.withSeparableConvs},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"anchors",{get:function(){return this.config.anchors},enumerable:!0,configurable:!0}),t.prototype.locateFaces=function(n,r){return fe(this,void 0,void 0,function(){var o;return de(this,function(i){switch(i.label){case 0:return[4,this.detect(n,r)];case 1:return o=i.sent(),[2,o.map(function(a){return new Ar(a.score,a.relativeBox,{width:a.imageWidth,height:a.imageHeight})})]}})})},t.prototype.getDefaultModelName=function(){return this.withSeparableConvs?NF:TF},t.prototype.extractParamsFromWeigthMap=function(n){return e.prototype.extractParamsFromWeigthMap.call(this,n)},t}(zb),wv=function(e){be(t,e);function t(){var n=e!==null&&e.apply(this,arguments)||this;return n._name="TinyFaceDetectorOptions",n}return t}(xv),tu=function(){function e(){}return e.prototype.then=function(t){return fe(this,void 0,void 0,function(){var n;return de(this,function(r){switch(r.label){case 0:return n=t,[4,this.run()];case 1:return[2,n.apply(void 0,[r.sent()])]}})})},e.prototype.run=function(){return fe(this,void 0,void 0,function(){return de(this,function(t){throw new Error("ComposableTask - run is not implemented")})})},e}();function jc(e,t,n,r,o){return o===void 0&&(o=function(i){var a=i.alignedRect;return a}),fe(this,void 0,void 0,function(){var i,a,s,u,l;return de(this,function(c){switch(c.label){case 0:return i=e.map(function(f){return HP(f)?o(f):f.detection}),s=r,s?[3,5]:t instanceof st?[4,dv(t,i)]:[3,2];case 1:return u=c.sent(),[3,4];case 2:return[4,fv(t,i)];case 3:u=c.sent(),c.label=4;case 4:s=u,c.label=5;case 5:return a=s,[4,n(a)];case 6:return l=c.sent(),a.forEach(function(f){return f instanceof st&&f.dispose()}),[2,l]}})})}function bv(e,t,n,r,o){return fe(this,void 0,void 0,function(){var i=this;return de(this,function(a){return[2,jc([e],t,function(s){return fe(i,void 0,void 0,function(){return de(this,function(u){return[2,n(s[0])]})})},r,o)]})})}function BF(e){return oe(function(){return Dn(Rt(e,3).reverse(),3)})}var Wu=2,tc=12;function UF(e,t){var n=Wc(e,t),r=hv(e,t);function o(l,c){var f=wt(e(l));return t.push({paramPath:c}),f}function i(l,c,f){f===void 0&&(f=!1);var d=n(l[0],l[1],3,c+"/conv1"),h=o(l[1],c+"/prelu1_alpha"),p=n(l[1],l[2],3,c+"/conv2"),v=o(l[2],c+"/prelu2_alpha"),g=n(l[2],l[3],f?2:3,c+"/conv3"),m=o(l[3],c+"/prelu3_alpha");return{conv1:d,prelu1_alpha:h,conv2:p,prelu2_alpha:v,conv3:g,prelu3_alpha:m}}function a(){var l=i([3,10,16,32],"pnet"),c=n(32,2,1,"pnet/conv4_1"),f=n(32,4,1,"pnet/conv4_2");return Kt(Kt({},l),{conv4_1:c,conv4_2:f})}function s(){var l=i([3,28,48,64],"rnet",!0),c=r(576,128,"rnet/fc1"),f=o(128,"rnet/prelu4_alpha"),d=r(128,2,"rnet/fc2_1"),h=r(128,4,"rnet/fc2_2");return Kt(Kt({},l),{fc1:c,prelu4_alpha:f,fc2_1:d,fc2_2:h})}function u(){var l=i([3,32,64,64],"onet"),c=n(64,128,2,"onet/conv4"),f=o(128,"onet/prelu4_alpha"),d=r(1152,256,"onet/fc1"),h=o(256,"onet/prelu5_alpha"),p=r(256,2,"onet/fc2_1"),v=r(256,4,"onet/fc2_2"),g=r(256,10,"onet/fc2_3");return Kt(Kt({},l),{conv4:c,prelu4_alpha:f,fc1:d,prelu5_alpha:h,fc2_1:p,fc2_2:v,fc2_3:g})}return{extractPNetParams:a,extractRNetParams:s,extractONetParams:u}}function WF(e){var t=Zr(e),n=t.extractWeights,r=t.getRemainingWeights,o=[],i=UF(n,o),a=i.extractPNetParams,s=i.extractRNetParams,u=i.extractONetParams,l=a(),c=s(),f=u();if(r().length!==0)throw new Error("weights remaing after extract: "+r().length);return{params:{pnet:l,rnet:c,onet:f},paramMappings:o}}function zF(e,t){var n=Lo(e,t);function r(c){var f=n(c+"/weights",4,c+"/filters"),d=n(c+"/bias",1);return{filters:f,bias:d}}function o(c){var f=n(c+"/weights",2),d=n(c+"/bias",1);return{weights:f,bias:d}}function i(c){return n(c,1)}function a(c){var f=r(c+"/conv1"),d=i(c+"/prelu1_alpha"),h=r(c+"/conv2"),p=i(c+"/prelu2_alpha"),v=r(c+"/conv3"),g=i(c+"/prelu3_alpha");return{conv1:f,prelu1_alpha:d,conv2:h,prelu2_alpha:p,conv3:v,prelu3_alpha:g}}function s(){var c=a("pnet"),f=r("pnet/conv4_1"),d=r("pnet/conv4_2");return Kt(Kt({},c),{conv4_1:f,conv4_2:d})}function u(){var c=a("rnet"),f=o("rnet/fc1"),d=i("rnet/prelu4_alpha"),h=o("rnet/fc2_1"),p=o("rnet/fc2_2");return Kt(Kt({},c),{fc1:f,prelu4_alpha:d,fc2_1:h,fc2_2:p})}function l(){var c=a("onet"),f=r("onet/conv4"),d=i("onet/prelu4_alpha"),h=o("onet/fc1"),p=i("onet/prelu5_alpha"),v=o("onet/fc2_1"),g=o("onet/fc2_2"),m=o("onet/fc2_3");return Kt(Kt({},c),{conv4:f,prelu4_alpha:d,fc1:h,prelu5_alpha:p,fc2_1:v,fc2_2:g,fc2_3:m})}return{extractPNetParams:s,extractRNetParams:u,extractONetParams:l}}function jF(e){var t=[],n=zF(e,t),r=n.extractPNetParams,o=n.extractRNetParams,i=n.extractONetParams,a=r(),s=o(),u=i();return Jr(e,t),{params:{pnet:a,rnet:s,onet:u},paramMappings:t}}function Ch(e,t){var n=t[0],r=t[1];return{height:Math.floor(n*e),width:Math.floor(r*e)}}function VF(e,t,n){for(var r=n[0],o=n[1],i=tc/e,a=[],s=Math.min(r,o)*i,u=0;s>=12;)a.push(i*Math.pow(t,u)),s=s*t,u+=1;return a}var Ev=function(e){be(t,e);function t(n,r,o,i){return e.call(this,{left:n,top:r,right:o,bottom:i},!0)||this}return t}(To);function jb(e){return oe(function(){return Qt(It(e,ne(127.5)),ne(.0078125))})}function la(e,t){return oe(function(){return Ae(ut(e),Qt(t,Kl(ut(Kl(e)))))})}function Cv(e,t,n){return n===void 0&&(n=!1),oe(function(){var r=ar(e,t.conv1,"valid");return r=la(r,t.prelu1_alpha),r=Tt(r,n?[2,2]:[3,3],[2,2],"same"),r=ar(r,t.conv2,"valid"),r=la(r,t.prelu2_alpha),r=n?r:Tt(r,[3,3],[2,2],"valid"),r=ar(r,t.conv3,"valid"),r=la(r,t.prelu3_alpha),r})}function $F(e,t){return oe(function(){var n=Cv(e,t,!0),r=ar(n,t.conv4_1,"valid"),o=Un(Fc(r,3),3),i=Xr(It(r,o),3),a=ar(n,t.conv4_2,"valid");return{prob:i,regions:a}})}function HF(e,t){return oe(function(){var n=Ch(t,e.shape.slice(1)),r=n.height,o=n.width,i=Zp.resizeBilinear(e,[r,o]),a=jb(i);return Do(a,[0,2,1,3])})}function GF(e,t,n,r){for(var o=[],i=e.arraySync(),a=0;a<e.shape[0];a++)for(var s=0;s<e.shape[1];s++)i[a][s]>=r&&o.push(new We(s,a));var u=o.map(function(l){var c=new Bc(Math.round((l.y*Wu+1)/n),Math.round((l.x*Wu+1)/n),Math.round((l.y*Wu+tc)/n),Math.round((l.x*Wu+tc)/n)),f=i[l.y][l.x],d=t.arraySync(),h=new Ev(d[l.y][l.x][0],d[l.y][l.x][1],d[l.y][l.x][2],d[l.y][l.x][3]);return{cell:c,score:f,region:h}});return u}function qF(e,t,n,r,o){o.stage1=[];var i=t.map(function(d){return oe(function(){var h={scale:d},p=HF(e,d),v=Date.now(),g=$F(p,r),m=g.prob,y=g.regions;h.pnet=Date.now()-v;var x=Rt(Rt(m,3)[1])[0],w=Rt(y)[0];return{scoresTensor:x,regionsTensor:w,scale:d,statsForScale:h}})}),a=i.map(function(d){var h=d.scoresTensor,p=d.regionsTensor,v=d.scale,g=d.statsForScale,m=GF(h,p,v,n);if(h.dispose(),p.dispose(),!m.length)return o.stage1.push(g),[];var y=Date.now(),x=Ls(m.map(function(w){return w.cell}),m.map(function(w){return w.score}),.5);return g.nms=Date.now()-y,g.numBoxes=x.length,o.stage1.push(g),x.map(function(w){return m[w]})}),s=a.reduce(function(d,h){return d.concat(h)},[]),u=[],l=[];if(s.length>0){var c=Date.now(),f=Ls(s.map(function(d){return d.cell}),s.map(function(d){return d.score}),.7);o.stage1_nms=Date.now()-c,l=f.map(function(d){return s[d].score}),u=f.map(function(d){return s[d]}).map(function(d){var h=d.cell,p=d.region;return new Bc(h.left+p.left*h.width,h.top+p.top*h.height,h.right+p.right*h.width,h.bottom+p.bottom*h.height).toSquare().round()})}return{boxes:u,scores:l}}function Vb(e,t,n){var r=n.width,o=n.height;return fe(this,void 0,void 0,function(){var i,a,s,u=this;return de(this,function(l){switch(l.label){case 0:return i=ci(e),[4,Promise.all(t.map(function(c){return fe(u,void 0,void 0,function(){var f,d,h,p,v,g,m,y;return de(this,function(x){return f=c.padAtBorders(e.height,e.width),d=f.y,h=f.ey,p=f.x,v=f.ex,g=p-1,m=d-1,y=i.getImageData(g,m,v-g,h-m),[2,Zt.isNodejs()?cv(y):createImageBitmap(y)]})})}))];case 1:return a=l.sent(),s=[],a.forEach(function(c){var f=Uc({width:r,height:o}),d=ci(f);d.drawImage(c,0,0,r,o);for(var h=d.getImageData(0,0,r,o).data,p=[],v=0;v<h.length;v+=4)p.push(h[v+2]),p.push(h[v+1]),p.push(h[v]);s.push(p)}),[2,s.map(function(c){var f=oe(function(){var d=Do(un(c,[1,r,o,3]),[0,2,1,3]).toFloat();return jb(d)});return f})]}})})}function KF(e,t){return oe(function(){var n=Cv(e,t),r=nr(n,[n.shape[0],t.fc1.weights.shape[0]]),o=Er(r,t.fc1),i=la(o,t.prelu4_alpha),a=Er(i,t.fc2_1),s=Un(Fc(a,1),1),u=Xr(It(a,s),1),l=Er(i,t.fc2_2),c=Rt(u,1)[1];return{scores:c,regions:l}})}function XF(e,t,n,r,o){return fe(this,void 0,void 0,function(){var i,a,s,u,l,c,f,d,h,p,v,g,m,y;return de(this,function(x){switch(x.label){case 0:return i=Date.now(),[4,Vb(e,t,{width:24,height:24})];case 1:return a=x.sent(),o.stage2_extractImagePatches=Date.now()-i,i=Date.now(),s=a.map(function(w){var E=KF(w,r);return w.dispose(),E}),o.stage2_rnet=Date.now()-i,u=s.length>1?St(s.map(function(w){return w.scores})):s[0].scores,f=(c=Array).from,[4,u.data()];case 2:return l=f.apply(c,[x.sent()]),u.dispose(),d=l.map(function(w,E){return{score:w,idx:E}}).filter(function(w){return w.score>n}).map(function(w){var E=w.idx;return E}),h=d.map(function(w){return t[w]}),p=d.map(function(w){return l[w]}),v=[],g=[],h.length>0&&(i=Date.now(),m=Ls(h,p,.7),o.stage2_nms=Date.now()-i,y=m.map(function(w){var E=s[d[w]].regions.arraySync();return new Ev(E[0][0],E[0][1],E[0][2],E[0][3])}),g=m.map(function(w){return p[w]}),v=m.map(function(w,E){return h[w].calibrate(y[E])})),s.forEach(function(w){w.regions.dispose(),w.scores.dispose()}),[2,{boxes:v,scores:g}]}})})}function YF(e,t){return oe(function(){var n=Cv(e,t);n=Tt(n,[2,2],[2,2],"same"),n=ar(n,t.conv4,"valid"),n=la(n,t.prelu4_alpha);var r=nr(n,[n.shape[0],t.fc1.weights.shape[0]]),o=Er(r,t.fc1),i=la(o,t.prelu5_alpha),a=Er(i,t.fc2_1),s=Un(Fc(a,1),1),u=Xr(It(a,s),1),l=Er(i,t.fc2_2),c=Er(i,t.fc2_3),f=Rt(u,1)[1];return{scores:f,regions:l,points:c}})}function QF(e,t,n,r,o){return fe(this,void 0,void 0,function(){var i,a,s,u,l,c,f,d,h,p,v,g,m,y,x;return de(this,function(w){switch(w.label){case 0:return i=Date.now(),[4,Vb(e,t,{width:48,height:48})];case 1:return a=w.sent(),o.stage3_extractImagePatches=Date.now()-i,i=Date.now(),s=a.map(function(E){var b=YF(E,r);return E.dispose(),b}),o.stage3_onet=Date.now()-i,u=s.length>1?St(s.map(function(E){return E.scores})):s[0].scores,f=(c=Array).from,[4,u.data()];case 2:return l=f.apply(c,[w.sent()]),u.dispose(),d=l.map(function(E,b){return{score:E,idx:b}}).filter(function(E){return E.score>n}).map(function(E){var b=E.idx;return b}),h=d.map(function(E){var b=s[E].regions.arraySync();return new Ev(b[0][0],b[0][1],b[0][2],b[0][3])}),p=d.map(function(E,b){return t[E].calibrate(h[b])}),v=d.map(function(E){return l[E]}),g=[],m=[],y=[],p.length>0&&(i=Date.now(),x=Ls(p,v,.7,!1),o.stage3_nms=Date.now()-i,g=x.map(function(E){return p[E]}),m=x.map(function(E){return v[E]}),y=x.map(function(E,b){return Array(5).fill(0).map(function(C,_){var S=s[E].points.arraySync();return new We(S[0][_]*(g[b].width+1)+g[b].left,S[0][_+5]*(g[b].height+1)+g[b].top)})})),s.forEach(function(E){E.regions.dispose(),E.scores.dispose(),E.points.dispose()}),[2,{boxes:g,scores:m,points:y}]}})})}var JF=function(e){be(t,e);function t(){return e.call(this,"Mtcnn")||this}return t.prototype.load=function(n){return fe(this,void 0,void 0,function(){return de(this,function(r){return console.warn("mtcnn is deprecated and will be removed soon"),[2,e.prototype.load.call(this,n)]})})},t.prototype.loadFromDisk=function(n){return fe(this,void 0,void 0,function(){return de(this,function(r){return console.warn("mtcnn is deprecated and will be removed soon"),[2,e.prototype.loadFromDisk.call(this,n)]})})},t.prototype.forwardInput=function(n,r){return r===void 0&&(r={}),fe(this,void 0,void 0,function(){var o,i,a,s,u,l,c,f,d,h,p,v,g,m,y,x,w,E,b,C,_;return de(this,function(S){switch(S.label){case 0:if(o=this.params,!o)throw new Error("Mtcnn - load model before inference");if(i=n.canvases[0],!i)throw new Error("Mtcnn - inputCanvas is not defined, note that passing tensors into Mtcnn.forwardInput is not supported yet.");return a={},s=Date.now(),u=oe(function(){return BF(Un(iv.fromPixels(i)).toFloat())}),l=function(R){return u.dispose(),a.total=Date.now()-s,R},c=u.shape.slice(1),f=c[0],d=c[1],h=new Ub(r),p=h.minFaceSize,v=h.scaleFactor,g=h.maxNumScales,m=h.scoreThresholds,y=h.scaleSteps,x=(y||VF(p,v,[f,d])).filter(function(R){var D=Ch(R,[f,d]);return Math.min(D.width,D.height)>tc}).slice(0,g),a.scales=x,a.pyramid=x.map(function(R){return Ch(R,[f,d])}),w=Date.now(),[4,qF(u,x,m[0],o.pnet,a)];case 1:return E=S.sent(),a.total_stage1=Date.now()-w,E.boxes.length?(a.stage2_numInputBoxes=E.boxes.length,w=Date.now(),[4,XF(i,E.boxes,m[1],o.rnet,a)]):[2,l({results:[],stats:a})];case 2:return b=S.sent(),a.total_stage2=Date.now()-w,b.boxes.length?(a.stage3_numInputBoxes=b.boxes.length,w=Date.now(),[4,QF(i,b.boxes,m[2],o.onet,a)]):[2,l({results:[],stats:a})];case 3:return C=S.sent(),a.total_stage3=Date.now()-w,_=C.boxes.map(function(R,D){return mv(uv({},new Ar(C.scores[D],new sv(R.left/d,R.top/f,R.width/d,R.height/f),{height:f,width:d})),new IP(C.points[D].map(function(T){return T.sub(new We(R.left,R.top)).div(new We(R.width,R.height))}),{width:R.width,height:R.height}))}),[2,l({results:_,stats:a})]}})})},t.prototype.forward=function(n,r){return r===void 0&&(r={}),fe(this,void 0,void 0,function(){var o;return de(this,function(i){switch(i.label){case 0:return o=this.forwardInput,[4,Mt(n)];case 1:return[4,o.apply(this,[i.sent(),r])];case 2:return[2,i.sent().results]}})})},t.prototype.forwardWithStats=function(n,r){return r===void 0&&(r={}),fe(this,void 0,void 0,function(){var o;return de(this,function(i){switch(i.label){case 0:return o=this.forwardInput,[4,Mt(n)];case 1:return[2,o.apply(this,[i.sent(),r])]}})})},t.prototype.getDefaultModelName=function(){return"mtcnn_model"},t.prototype.extractParamsFromWeigthMap=function(n){return jF(n)},t.prototype.extractParams=function(n){return WF(n)},t}(Qr),ZF=.4,e3=[new We(1.603231,2.094468),new We(6.041143,7.080126),new We(2.882459,3.518061),new We(4.266906,5.178857),new We(9.041765,10.66308)],t3=[117.001,114.697,97.404],n3=function(e){be(t,e);function t(){var n=this,r={withSeparableConvs:!0,iouThreshold:ZF,classes:["face"],anchors:e3,meanRgb:t3,isFirstLayerConv2d:!0,filterSizes:[3,16,32,64,128,256,512]};return n=e.call(this,r)||this,n}return Object.defineProperty(t.prototype,"anchors",{get:function(){return this.config.anchors},enumerable:!0,configurable:!0}),t.prototype.locateFaces=function(n,r){return fe(this,void 0,void 0,function(){var o;return de(this,function(i){switch(i.label){case 0:return[4,this.detect(n,r)];case 1:return o=i.sent(),[2,o.map(function(a){return new Ar(a.score,a.relativeBox,{width:a.imageWidth,height:a.imageHeight})})]}})})},t.prototype.getDefaultModelName=function(){return"tiny_face_detector_model"},t.prototype.extractParamsFromWeigthMap=function(n){return e.prototype.extractParamsFromWeigthMap.call(this,n)},t}(zb),At={ssdMobilenetv1:new Wb,tinyFaceDetector:new n3,tinyYolov2:new LF,mtcnn:new JF,faceLandmark68Net:new Pb,faceLandmark68TinyNet:new oF,faceRecognitionNet:new fF,faceExpressionNet:new $P,ageGenderNet:new eF},$b=function(e){be(t,e);function t(n,r,o){var i=e.call(this)||this;return i.parentTask=n,i.input=r,i.extractedFaces=o,i}return t}(tu),_v=function(e){be(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.run=function(){return fe(this,void 0,void 0,function(){var n,r,o=this;return de(this,function(i){switch(i.label){case 0:return[4,this.parentTask];case 1:return n=i.sent(),[4,jc(n,this.input,function(a){return fe(o,void 0,void 0,function(){return de(this,function(s){switch(s.label){case 0:return[4,Promise.all(a.map(function(u){return At.faceExpressionNet.predictExpressions(u)}))];case 1:return[2,s.sent()]}})})},this.extractedFaces)];case 2:return r=i.sent(),[2,n.map(function(a,s){return Tb(a,r[s])})]}})})},t.prototype.withAgeAndGender=function(){return new Iv(this,this.input)},t}($b),Sv=function(e){be(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.run=function(){return fe(this,void 0,void 0,function(){var n,r;return de(this,function(o){switch(o.label){case 0:return[4,this.parentTask];case 1:return n=o.sent(),n?[4,bv(n,this.input,function(i){return At.faceExpressionNet.predictExpressions(i)},this.extractedFaces)]:[2];case 2:return r=o.sent(),[2,Tb(n,r)]}})})},t.prototype.withAgeAndGender=function(){return new Dv(this,this.input)},t}($b),Rv=function(e){be(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.withAgeAndGender=function(){return new Tv(this,this.input)},t.prototype.withFaceDescriptors=function(){return new Av(this,this.input)},t}(_v),kv=function(e){be(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.withAgeAndGender=function(){return new Nv(this,this.input)},t.prototype.withFaceDescriptor=function(){return new Pv(this,this.input)},t}(Sv),Hb=function(e){be(t,e);function t(n,r,o){var i=e.call(this)||this;return i.parentTask=n,i.input=r,i.extractedFaces=o,i}return t}(tu),Iv=function(e){be(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.run=function(){return fe(this,void 0,void 0,function(){var n,r,o=this;return de(this,function(i){switch(i.label){case 0:return[4,this.parentTask];case 1:return n=i.sent(),[4,jc(n,this.input,function(a){return fe(o,void 0,void 0,function(){return de(this,function(s){switch(s.label){case 0:return[4,Promise.all(a.map(function(u){return At.ageGenderNet.predictAgeAndGender(u)}))];case 1:return[2,s.sent()]}})})},this.extractedFaces)];case 2:return r=i.sent(),[2,n.map(function(a,s){var u=r[s],l=u.age,c=u.gender,f=u.genderProbability;return Lb(Bb(a,c,f),l)})]}})})},t.prototype.withFaceExpressions=function(){return new _v(this,this.input)},t}(Hb),Dv=function(e){be(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.run=function(){return fe(this,void 0,void 0,function(){var n,r,o,i,a;return de(this,function(s){switch(s.label){case 0:return[4,this.parentTask];case 1:return n=s.sent(),n?[4,bv(n,this.input,function(u){return At.ageGenderNet.predictAgeAndGender(u)},this.extractedFaces)]:[2];case 2:return r=s.sent(),o=r.age,i=r.gender,a=r.genderProbability,[2,Lb(Bb(n,i,a),o)]}})})},t.prototype.withFaceExpressions=function(){return new Sv(this,this.input)},t}(Hb),Tv=function(e){be(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.withFaceExpressions=function(){return new Rv(this,this.input)},t.prototype.withFaceDescriptors=function(){return new Av(this,this.input)},t}(Iv),Nv=function(e){be(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.withFaceExpressions=function(){return new kv(this,this.input)},t.prototype.withFaceDescriptor=function(){return new Pv(this,this.input)},t}(Dv),Gb=function(e){be(t,e);function t(n,r){var o=e.call(this)||this;return o.parentTask=n,o.input=r,o}return t}(tu),Av=function(e){be(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.run=function(){return fe(this,void 0,void 0,function(){var n,r;return de(this,function(o){switch(o.label){case 0:return[4,this.parentTask];case 1:return n=o.sent(),[4,jc(n,this.input,function(i){return Promise.all(i.map(function(a){return At.faceRecognitionNet.computeFaceDescriptor(a)}))},null,function(i){return i.landmarks.align(null,{useDlibAlignment:!0})})];case 2:return r=o.sent(),[2,r.map(function(i,a){return Ob(n[a],i)})]}})})},t.prototype.withFaceExpressions=function(){return new Rv(this,this.input)},t.prototype.withAgeAndGender=function(){return new Tv(this,this.input)},t}(Gb),Pv=function(e){be(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.run=function(){return fe(this,void 0,void 0,function(){var n,r;return de(this,function(o){switch(o.label){case 0:return[4,this.parentTask];case 1:return n=o.sent(),n?[4,bv(n,this.input,function(i){return At.faceRecognitionNet.computeFaceDescriptor(i)},null,function(i){return i.landmarks.align(null,{useDlibAlignment:!0})})]:[2];case 2:return r=o.sent(),[2,Ob(n,r)]}})})},t.prototype.withFaceExpressions=function(){return new kv(this,this.input)},t.prototype.withAgeAndGender=function(){return new Nv(this,this.input)},t}(Gb),qb=function(e){be(t,e);function t(n,r,o){var i=e.call(this)||this;return i.parentTask=n,i.input=r,i.useTinyLandmarkNet=o,i}return Object.defineProperty(t.prototype,"landmarkNet",{get:function(){return this.useTinyLandmarkNet?At.faceLandmark68TinyNet:At.faceLandmark68Net},enumerable:!0,configurable:!0}),t}(tu),r3=function(e){be(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.run=function(){return fe(this,void 0,void 0,function(){var n,r,o,i,a,s=this;return de(this,function(u){switch(u.label){case 0:return[4,this.parentTask];case 1:return n=u.sent(),r=n.map(function(l){return l.detection}),this.input instanceof st?[4,dv(this.input,r)]:[3,3];case 2:return i=u.sent(),[3,5];case 3:return[4,fv(this.input,r)];case 4:i=u.sent(),u.label=5;case 5:return o=i,[4,Promise.all(o.map(function(l){return s.landmarkNet.detectLandmarks(l)}))];case 6:return a=u.sent(),o.forEach(function(l){return l instanceof st&&l.dispose()}),[2,n.map(function(l,c){return mv(l,a[c])})]}})})},t.prototype.withFaceExpressions=function(){return new Rv(this,this.input)},t.prototype.withAgeAndGender=function(){return new Tv(this,this.input)},t.prototype.withFaceDescriptors=function(){return new Av(this,this.input)},t}(qb),o3=function(e){be(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.run=function(){return fe(this,void 0,void 0,function(){var n,r,o,i,a;return de(this,function(s){switch(s.label){case 0:return[4,this.parentTask];case 1:return n=s.sent(),n?(r=n.detection,this.input instanceof st?[4,dv(this.input,[r])]:[3,3]):[2];case 2:return i=s.sent(),[3,5];case 3:return[4,fv(this.input,[r])];case 4:i=s.sent(),s.label=5;case 5:return o=i,[4,this.landmarkNet.detectLandmarks(o[0])];case 6:return a=s.sent(),o.forEach(function(u){return u instanceof st&&u.dispose()}),[2,mv(n,a)]}})})},t.prototype.withFaceExpressions=function(){return new kv(this,this.input)},t.prototype.withAgeAndGender=function(){return new Nv(this,this.input)},t.prototype.withFaceDescriptor=function(){return new Pv(this,this.input)},t}(qb),Kb=function(e){be(t,e);function t(n,r){r===void 0&&(r=new zc);var o=e.call(this)||this;return o.input=n,o.options=r,o}return t}(tu),i3=function(e){be(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.run=function(){return fe(this,void 0,void 0,function(){var n,r,o,i;return de(this,function(a){switch(a.label){case 0:return n=this,r=n.input,o=n.options,o instanceof Ub?[4,At.mtcnn.forward(r,o)]:[3,2];case 1:return[2,a.sent().map(function(s){return s.detection})];case 2:if(i=o instanceof wv?function(s){return At.tinyFaceDetector.locateFaces(s,o)}:o instanceof zc?function(s){return At.ssdMobilenetv1.locateFaces(s,o)}:o instanceof xv?function(s){return At.tinyYolov2.locateFaces(s,o)}:null,!i)throw new Error("detectFaces - expected options to be instance of TinyFaceDetectorOptions | SsdMobilenetv1Options | MtcnnOptions | TinyYolov2Options");return[2,i(r)]}})})},t.prototype.runAndExtendWithFaceDetections=function(){var n=this;return new Promise(function(r){return fe(n,void 0,void 0,function(){var o;return de(this,function(i){switch(i.label){case 0:return[4,this.run()];case 1:return o=i.sent(),[2,r(o.map(function(a){return uv({},a)}))]}})})})},t.prototype.withFaceLandmarks=function(n){return n===void 0&&(n=!1),new r3(this.runAndExtendWithFaceDetections(),this.input,n)},t.prototype.withFaceExpressions=function(){return new _v(this.runAndExtendWithFaceDetections(),this.input)},t.prototype.withAgeAndGender=function(){return new Iv(this.runAndExtendWithFaceDetections(),this.input)},t}(Kb),a3=function(e){be(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.run=function(){return fe(this,void 0,void 0,function(){var n,r;return de(this,function(o){switch(o.label){case 0:return[4,new i3(this.input,this.options)];case 1:return n=o.sent(),r=n[0],n.forEach(function(i){i.score>r.score&&(r=i)}),[2,r]}})})},t.prototype.runAndExtendWithFaceDetection=function(){var n=this;return new Promise(function(r){return fe(n,void 0,void 0,function(){var o;return de(this,function(i){switch(i.label){case 0:return[4,this.run()];case 1:return o=i.sent(),[2,r(o?uv({},o):void 0)]}})})})},t.prototype.withFaceLandmarks=function(n){return n===void 0&&(n=!1),new o3(this.runAndExtendWithFaceDetection(),this.input,n)},t.prototype.withFaceExpressions=function(){return new Sv(this.runAndExtendWithFaceDetection(),this.input)},t.prototype.withAgeAndGender=function(){return new Dv(this.runAndExtendWithFaceDetection(),this.input)},t}(Kb);function Xb(e,t){return t===void 0&&(t=new zc),new a3(e,t)}function s3(e,t){if(e.length!==t.length)throw new Error("euclideanDistance: arr1.length !== arr2.length");var n=Array.from(e),r=Array.from(t);return Math.sqrt(n.map(function(o,i){return o-r[i]}).reduce(function(o,i){return o+Math.pow(i,2)},0))}(function(){function e(t,n){n===void 0&&(n=.6),this._distanceThreshold=n;var r=Array.isArray(t)?t:[t];if(!r.length)throw new Error("FaceRecognizer.constructor - expected atleast one input");var o=1,i=function(){return"person "+o++};this._labeledDescriptors=r.map(function(a){if(a instanceof Ou)return a;if(a instanceof Float32Array)return new Ou(i(),[a]);if(a.descriptor&&a.descriptor instanceof Float32Array)return new Ou(i(),[a.descriptor]);throw new Error("FaceRecognizer.constructor - expected inputs to be of type LabeledFaceDescriptors | WithFaceDescriptor<any> | Float32Array | Array<LabeledFaceDescriptors | WithFaceDescriptor<any> | Float32Array>")})}return Object.defineProperty(e.prototype,"labeledDescriptors",{get:function(){return this._labeledDescriptors},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"distanceThreshold",{get:function(){return this._distanceThreshold},enumerable:!0,configurable:!0}),e.prototype.computeMeanDistance=function(t,n){return n.map(function(r){return s3(r,t)}).reduce(function(r,o){return r+o},0)/(n.length||1)},e.prototype.matchDescriptor=function(t){var n=this;return this.labeledDescriptors.map(function(r){var o=r.descriptors,i=r.label;return new Ry(i,n.computeMeanDistance(t,o))}).reduce(function(r,o){return r.distance<o.distance?r:o})},e.prototype.findBestMatch=function(t){var n=this.matchDescriptor(t);return n.distance<this.distanceThreshold?n:new Ry("unknown",n.distance)},e.prototype.toJSON=function(){return{distanceThreshold:this.distanceThreshold,labeledDescriptors:this.labeledDescriptors.map(function(t){return t.toJSON()})}},e.fromJSON=function(t){var n=t.labeledDescriptors.map(function(r){return Ou.fromJSON(r)});return new e(n,t.distanceThreshold)},e})();function u3(){const[e,t]=X.useState(""),[n,r]=X.useState(""),[o,i]=X.useState(""),[a,s]=X.useState(null),u=X.useRef(null),l=bc(),[c,f]=X.useState(!1);X.useEffect(()=>{(async()=>{const v=`${window.location.origin}/models/`;try{await At.tinyFaceDetector.loadFromUri(v+"tiny_face_detector/"),await At.faceLandmark68Net.loadFromUri(v+"face_landmark_68/"),await At.faceRecognitionNet.loadFromUri(v+"face_recognition/"),f(!0),console.log("Models loaded successfully")}catch(g){console.error("Error loading model:",g)}})()},[]);const d=async()=>{if(!c){i("Models are still loading. Please wait.");return}const p=u.current.video,v=await Xb(p,new wv).withFaceLandmarks().withFaceDescriptor();v?(s(v.descriptor),console.log("Face descriptor captured:",v.descriptor)):i("Face not detected. Please try again.")},h=async p=>{p.preventDefault();try{const v=await Xe.post("https://sdl-back.vercel.app/users/login",{email:e,password:n,face_descriptor:a?Array.from(a):null},{withCredentials:!0});if(!a){i("Face not captured. Please capture your face before logging in.");return}v.status===200&&l("/mark-attendance")}catch(v){i("Login failed. Please check your credentials."),console.error("Login error:",v)}};return Z.jsx("div",{className:"container d-flex justify-content-center align-items-center min-vh-100",children:Z.jsxs("div",{className:"wrapper",children:[Z.jsx("div",{className:"logo",children:Z.jsx("img",{src:"/profile.jpg",alt:"Logo"})}),Z.jsx("div",{className:"name",children:"Login"}),o&&Z.jsx("div",{className:"alert alert-danger",children:o}),Z.jsx(Ax,{ref:u,width:320,height:240}),Z.jsx("button",{className:"btn",onClick:d,children:"Capture Face"}),Z.jsxs("form",{onSubmit:h,children:[Z.jsxs("div",{className:"form-field",children:[Z.jsx("i",{className:"fas fa-user"}),Z.jsx("input",{type:"email",placeholder:"Email",value:e,onChange:p=>t(p.target.value),required:!0})]}),Z.jsxs("div",{className:"form-field",children:[Z.jsx("i",{className:"fas fa-lock"}),Z.jsx("input",{type:"password",placeholder:"Password",value:n,onChange:p=>r(p.target.value),required:!0})]}),Z.jsx("button",{className:"btn",type:"submit",children:"Login"}),Z.jsx("div",{className:"text-center mt-3",children:Z.jsx(Tl,{to:"/users/register",children:"New User?"})})]})]})})}function l3(){const[e,t]=X.useState([]),[n,r]=X.useState({name:"",minlat:"",maxlat:"",minlon:"",maxlon:""});X.useEffect(()=>{o()},[]);const o=async()=>{try{const u=await Xe.get("https://sdl-back.vercel.app/admin/dashboard");t(u.data)}catch(u){console.error("Error fetching rooms",u)}},i=async()=>{try{const u=await Xe.post("https://sdl-back.vercel.app/admin/dashboard",n);t([...e,u.data]),r({name:"",minlat:"",maxlat:"",minlon:"",maxlon:""}),alert("Room added successfully")}catch(u){console.error("Error adding room",u)}},a=async u=>{try{await Xe.post("https://sdl-back.vercel.app/admin/select-room",{roomId:u}),o(),alert("Room selected successfully")}catch(l){console.error("Error selecting room",l)}},s=u=>{const{name:l,value:c}=u.target;r({...n,[l]:c})};return Z.jsxs("div",{children:[Z.jsx("h1",{children:"Admin Dashboard"}),Z.jsx("h2",{children:"Select Room"}),Z.jsx("ul",{children:e.map(u=>Z.jsxs("li",{children:[u.name," - Lat: ",u.minlat," to ",u.maxlat,", Lon: ",u.minlon," to ",u.maxlon,Z.jsx("button",{onClick:()=>a(u.id),children:u.selected?"Currently Selected":"Select"})]},u.id))}),Z.jsx("h2",{children:"Add Room"}),Z.jsxs("div",{children:[Z.jsx("input",{type:"text",name:"name",placeholder:"Room Name",value:n.name,onChange:s}),Z.jsx("input",{type:"number",name:"minlat",placeholder:"Min Latitude",value:n.minlat,onChange:s}),Z.jsx("input",{type:"number",name:"maxlat",placeholder:"Max Latitude",value:n.maxlat,onChange:s}),Z.jsx("input",{type:"number",name:"minlon",placeholder:"Min Longitude",value:n.minlon,onChange:s}),Z.jsx("input",{type:"number",name:"maxlon",placeholder:"Max Longitude",value:n.maxlon,onChange:s}),Z.jsx("button",{onClick:i,children:"Add Room"})]})]})}const c3=()=>{const[e,t]=X.useState(""),[n,r]=X.useState(""),[o,i]=X.useState(""),[a,s]=X.useState(""),[u,l]=X.useState(null),c=X.useRef(null),f=bc();X.useEffect(()=>{(async()=>{const v=`${window.location.origin}/models/`;try{await At.tinyFaceDetector.loadFromUri(v+"tiny_face_detector/"),await At.faceLandmark68Net.loadFromUri(v+"face_landmark_68/"),await At.faceRecognitionNet.loadFromUri(v+"face_recognition/")}catch(g){console.error("Error loading model:",g)}})()},[]);const d=async()=>{const p=c.current.video,v=await Xb(p,new wv).withFaceLandmarks().withFaceDescriptor();v?(l(v.descriptor),console.log("Face descriptor captured:",v.descriptor)):s("Face not detected. Please try again.")},h=async p=>{if(p.preventDefault(),!u){s("Please capture your face before registering.");return}try{(await Xe.post("https://sdl-back.vercel.app/users/register",{email:e,password:n,phone_number:o,face_descriptor:Array.from(u)})).status===201&&(alert("User registered successfully."),f("/mark-attendance"))}catch(v){console.error("Error during registration:",v),s("User already exists.")}};return Z.jsxs("div",{className:"wrapper",children:[Z.jsx("div",{className:"logo",children:Z.jsx("img",{src:"/profile.jpg",alt:"Logo"})}),Z.jsx("div",{className:"name",children:"Register"}),Z.jsx(Ax,{audio:!1,ref:c,screenshotFormat:"image/jpeg",width:320,height:240}),Z.jsx("button",{onClick:d,className:"btn",children:"Capture Face"}),Z.jsxs("form",{onSubmit:h,children:[a&&Z.jsx("p",{className:"error",children:a}),Z.jsx("div",{className:"form-field",children:Z.jsx("input",{type:"email",placeholder:"Email",value:e,onChange:p=>t(p.target.value),required:!0})}),Z.jsx("div",{className:"form-field",children:Z.jsx("input",{type:"text",placeholder:"Phone Number",value:o,onChange:p=>i(p.target.value),required:!0})}),Z.jsx("div",{className:"form-field",children:Z.jsx("input",{type:"password",placeholder:"Password",value:n,onChange:p=>r(p.target.value),required:!0})}),Z.jsx("button",{type:"submit",className:"btn",children:"Register"})]}),Z.jsx("div",{style:{textAlign:"center",marginTop:"20px"},children:Z.jsx(Tl,{to:"/users/login",children:"Already Registered?"})})]})};function f3(){const[e,t]=X.useState(""),[n,r]=X.useState(""),[o,i]=X.useState(""),a=bc(),s=async u=>{u.preventDefault();try{(await Xe.post("https://sdl-back.vercel.app/admin/login",{email:e,password:n},{withCredentials:!0})).status===200&&a("/admin/dashboard")}catch(l){i("Login failed. Please check your credentials."),console.error("Login error:",l)}};return Z.jsx("div",{className:"container d-flex justify-content-center align-items-center min-vh-100",children:Z.jsxs("div",{className:"wrapper",children:[Z.jsx("div",{className:"logo",children:Z.jsx("img",{src:"/profile.jpg",alt:"Logo"})}),Z.jsx("div",{className:"name",children:"Admin Login"}),o&&Z.jsx("div",{className:"alert alert-danger",children:o}),Z.jsxs("form",{onSubmit:s,children:[Z.jsxs("div",{className:"form-field",children:[Z.jsx("i",{className:"fas fa-user"}),Z.jsx("input",{type:"email",placeholder:"Email",value:e,onChange:u=>t(u.target.value),required:!0})]}),Z.jsxs("div",{className:"form-field",children:[Z.jsx("i",{className:"fas fa-lock"}),Z.jsx("input",{type:"password",placeholder:"Password",value:n,onChange:u=>r(u.target.value),required:!0})]}),Z.jsx("button",{className:"btn",type:"submit",children:"Login"})]})]})})}const d3=Y_([{path:"/",element:Z.jsx(fS,{})},{path:"/users/login",element:Z.jsx(u3,{})},{path:"/mark-attendance",element:Z.jsx(BR,{})},{path:"/admin/dashboard",element:Z.jsx(l3,{})},{path:"/users/register",element:Z.jsx(c3,{})},{path:"/admin/login",element:Z.jsx(f3,{})}]);Zf.createRoot(document.getElementById("root")).render(Z.jsx(Vy.StrictMode,{children:Z.jsx(iS,{router:d3})}))});export default h3();
